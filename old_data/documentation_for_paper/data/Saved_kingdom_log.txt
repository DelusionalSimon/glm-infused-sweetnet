Initializing infusion_trial_kingdom_2 experiment with 4 configurations and 10 runs per configuration.
----------------
Run 1/10

All random seeds set to: 420
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.6730 LRAP: 0.3370 NDCG: 0.5929
val Loss: 1.2748 LRAP: 0.6406 NDCG: 0.6949
Validation loss decreased (0.000000 --> 1.274805).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2031 LRAP: 0.6609 NDCG: 0.7348
val Loss: 1.1435 LRAP: 0.6891 NDCG: 0.7518
Validation loss decreased (1.274805 --> 1.143471).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1100 LRAP: 0.6881 NDCG: 0.7628
val Loss: 1.0516 LRAP: 0.7017 NDCG: 0.7661
Validation loss decreased (1.143471 --> 1.051616).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0540 LRAP: 0.6989 NDCG: 0.7798
val Loss: 1.0355 LRAP: 0.7074 NDCG: 0.7842
Validation loss decreased (1.051616 --> 1.035496).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0321 LRAP: 0.7077 NDCG: 0.7930
val Loss: 1.0218 LRAP: 0.6863 NDCG: 0.7883
Validation loss decreased (1.035496 --> 1.021822).  Saving model ...

Epoch 5/99
----------
train Loss: 0.9987 LRAP: 0.7142 NDCG: 0.8059
val Loss: 1.0055 LRAP: 0.7365 NDCG: 0.8168
Validation loss decreased (1.021822 --> 1.005521).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9774 LRAP: 0.7151 NDCG: 0.8098
val Loss: 0.9810 LRAP: 0.7262 NDCG: 0.8144
Validation loss decreased (1.005521 --> 0.981044).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9627 LRAP: 0.7212 NDCG: 0.8170
val Loss: 0.9679 LRAP: 0.7345 NDCG: 0.8233
Validation loss decreased (0.981044 --> 0.967926).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9416 LRAP: 0.7217 NDCG: 0.8221
val Loss: 0.9664 LRAP: 0.7522 NDCG: 0.8273
Validation loss decreased (0.967926 --> 0.966401).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9293 LRAP: 0.7402 NDCG: 0.8285
val Loss: 0.9557 LRAP: 0.7613 NDCG: 0.8346
Validation loss decreased (0.966401 --> 0.955720).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9151 LRAP: 0.7408 NDCG: 0.8304
val Loss: 0.9622 LRAP: 0.7619 NDCG: 0.8403
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 0.9092 LRAP: 0.7492 NDCG: 0.8359
val Loss: 0.9366 LRAP: 0.7696 NDCG: 0.8393
Validation loss decreased (0.955720 --> 0.936575).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8913 LRAP: 0.7545 NDCG: 0.8412
val Loss: 0.9570 LRAP: 0.7525 NDCG: 0.8358
EarlyStopping counter: 1 out of 25

Epoch 13/99
----------
train Loss: 0.8921 LRAP: 0.7541 NDCG: 0.8406
val Loss: 0.9299 LRAP: 0.7628 NDCG: 0.8414
Validation loss decreased (0.936575 --> 0.929916).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8789 LRAP: 0.7609 NDCG: 0.8434
val Loss: 0.9281 LRAP: 0.7816 NDCG: 0.8488
Validation loss decreased (0.929916 --> 0.928133).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8696 LRAP: 0.7673 NDCG: 0.8473
val Loss: 0.9450 LRAP: 0.7930 NDCG: 0.8557
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8687 LRAP: 0.7726 NDCG: 0.8475
val Loss: 0.9347 LRAP: 0.7562 NDCG: 0.8420
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 0.8560 LRAP: 0.7728 NDCG: 0.8439
val Loss: 0.9428 LRAP: 0.7688 NDCG: 0.8439
EarlyStopping counter: 3 out of 25

Epoch 18/99
----------
train Loss: 0.8489 LRAP: 0.7703 NDCG: 0.8358
val Loss: 0.9347 LRAP: 0.7554 NDCG: 0.8256
EarlyStopping counter: 4 out of 25

Epoch 19/99
----------
train Loss: 0.8480 LRAP: 0.7750 NDCG: 0.8315
val Loss: 0.9273 LRAP: 0.7979 NDCG: 0.8513
Validation loss decreased (0.928133 --> 0.927323).  Saving model ...

Epoch 20/99
----------
train Loss: 0.8406 LRAP: 0.7764 NDCG: 0.8282
val Loss: 0.9275 LRAP: 0.8070 NDCG: 0.8576
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 0.8338 LRAP: 0.7816 NDCG: 0.8255
val Loss: 0.9278 LRAP: 0.7979 NDCG: 0.8501
EarlyStopping counter: 2 out of 25

Epoch 22/99
----------
train Loss: 0.8280 LRAP: 0.7844 NDCG: 0.8326
val Loss: 0.9318 LRAP: 0.8090 NDCG: 0.8481
EarlyStopping counter: 3 out of 25

Epoch 23/99
----------
train Loss: 0.8214 LRAP: 0.7872 NDCG: 0.8191
val Loss: 0.9297 LRAP: 0.7973 NDCG: 0.8481
EarlyStopping counter: 4 out of 25

Epoch 24/99
----------
train Loss: 0.8160 LRAP: 0.7936 NDCG: 0.8253
val Loss: 0.9294 LRAP: 0.8019 NDCG: 0.8428
EarlyStopping counter: 5 out of 25

Epoch 25/99
----------
train Loss: 0.7972 LRAP: 0.7975 NDCG: 0.8183
val Loss: 0.9149 LRAP: 0.8093 NDCG: 0.8430
Validation loss decreased (0.927323 --> 0.914945).  Saving model ...

Epoch 26/99
----------
train Loss: 0.7897 LRAP: 0.7995 NDCG: 0.8161
val Loss: 0.9139 LRAP: 0.8110 NDCG: 0.8442
Validation loss decreased (0.914945 --> 0.913896).  Saving model ...

Epoch 27/99
----------
train Loss: 0.7853 LRAP: 0.8003 NDCG: 0.8130
val Loss: 0.9117 LRAP: 0.8182 NDCG: 0.8469
Validation loss decreased (0.913896 --> 0.911708).  Saving model ...

Epoch 28/99
----------
train Loss: 0.7829 LRAP: 0.8023 NDCG: 0.8114
val Loss: 0.9153 LRAP: 0.8107 NDCG: 0.8329
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.7789 LRAP: 0.7997 NDCG: 0.8098
val Loss: 0.9141 LRAP: 0.8027 NDCG: 0.8267
EarlyStopping counter: 2 out of 25

Epoch 30/99
----------
train Loss: 0.7785 LRAP: 0.8017 NDCG: 0.8113
val Loss: 0.9107 LRAP: 0.8139 NDCG: 0.8384
Validation loss decreased (0.911708 --> 0.910693).  Saving model ...

Epoch 31/99
----------
train Loss: 0.7747 LRAP: 0.8033 NDCG: 0.8126
val Loss: 0.9107 LRAP: 0.8124 NDCG: 0.8377
Validation loss decreased (0.910693 --> 0.910690).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7713 LRAP: 0.8024 NDCG: 0.8095
val Loss: 0.9149 LRAP: 0.8144 NDCG: 0.8317
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.7675 LRAP: 0.8026 NDCG: 0.8039
val Loss: 0.9127 LRAP: 0.8190 NDCG: 0.8518
EarlyStopping counter: 2 out of 25

Epoch 34/99
----------
train Loss: 0.7666 LRAP: 0.8077 NDCG: 0.8125
val Loss: 0.9117 LRAP: 0.8045 NDCG: 0.8459
EarlyStopping counter: 3 out of 25

Epoch 35/99
----------
train Loss: 0.7641 LRAP: 0.8137 NDCG: 0.8214
val Loss: 0.9102 LRAP: 0.8090 NDCG: 0.8401
Validation loss decreased (0.910690 --> 0.910237).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7633 LRAP: 0.8099 NDCG: 0.8152
val Loss: 0.9130 LRAP: 0.8210 NDCG: 0.8422
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.7616 LRAP: 0.8049 NDCG: 0.8085
val Loss: 0.9117 LRAP: 0.8170 NDCG: 0.8364
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.7592 LRAP: 0.8096 NDCG: 0.8118
val Loss: 0.9135 LRAP: 0.8193 NDCG: 0.8462
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.7584 LRAP: 0.8131 NDCG: 0.8161
val Loss: 0.9166 LRAP: 0.8230 NDCG: 0.8498
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.7576 LRAP: 0.8139 NDCG: 0.8195
val Loss: 0.9146 LRAP: 0.8284 NDCG: 0.8535
EarlyStopping counter: 5 out of 25

Epoch 41/99
----------
train Loss: 0.7506 LRAP: 0.8162 NDCG: 0.8181
val Loss: 0.9125 LRAP: 0.8264 NDCG: 0.8448
EarlyStopping counter: 6 out of 25

Epoch 42/99
----------
train Loss: 0.7478 LRAP: 0.8194 NDCG: 0.8117
val Loss: 0.9127 LRAP: 0.8259 NDCG: 0.8473
EarlyStopping counter: 7 out of 25

Epoch 43/99
----------
train Loss: 0.7486 LRAP: 0.8164 NDCG: 0.8160
val Loss: 0.9116 LRAP: 0.8224 NDCG: 0.8419
EarlyStopping counter: 8 out of 25

Epoch 44/99
----------
train Loss: 0.7468 LRAP: 0.8172 NDCG: 0.8181
val Loss: 0.9099 LRAP: 0.8244 NDCG: 0.8514
Validation loss decreased (0.910237 --> 0.909882).  Saving model ...

Epoch 45/99
----------
train Loss: 0.7459 LRAP: 0.8193 NDCG: 0.8197
val Loss: 0.9116 LRAP: 0.8287 NDCG: 0.8534
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.7458 LRAP: 0.8202 NDCG: 0.8214
val Loss: 0.9125 LRAP: 0.8287 NDCG: 0.8435
EarlyStopping counter: 2 out of 25

Epoch 47/99
----------
train Loss: 0.7448 LRAP: 0.8234 NDCG: 0.8197
val Loss: 0.9116 LRAP: 0.8281 NDCG: 0.8505
EarlyStopping counter: 3 out of 25

Epoch 48/99
----------
train Loss: 0.7443 LRAP: 0.8205 NDCG: 0.8184
val Loss: 0.9118 LRAP: 0.8290 NDCG: 0.8491
EarlyStopping counter: 4 out of 25

Epoch 49/99
----------
train Loss: 0.7442 LRAP: 0.8226 NDCG: 0.8188
val Loss: 0.9110 LRAP: 0.8261 NDCG: 0.8457
EarlyStopping counter: 5 out of 25

Epoch 50/99
----------
train Loss: 0.7425 LRAP: 0.8241 NDCG: 0.8196
val Loss: 0.9112 LRAP: 0.8330 NDCG: 0.8558
EarlyStopping counter: 6 out of 25

Epoch 51/99
----------
train Loss: 0.7440 LRAP: 0.8203 NDCG: 0.8185
val Loss: 0.9104 LRAP: 0.8296 NDCG: 0.8534
EarlyStopping counter: 7 out of 25

Epoch 52/99
----------
train Loss: 0.7408 LRAP: 0.8194 NDCG: 0.8190
val Loss: 0.9106 LRAP: 0.8287 NDCG: 0.8480
EarlyStopping counter: 8 out of 25

Epoch 53/99
----------
train Loss: 0.7426 LRAP: 0.8208 NDCG: 0.8153
val Loss: 0.9121 LRAP: 0.8313 NDCG: 0.8537
EarlyStopping counter: 9 out of 25

Epoch 54/99
----------
train Loss: 0.7413 LRAP: 0.8209 NDCG: 0.8186
val Loss: 0.9120 LRAP: 0.8290 NDCG: 0.8480
EarlyStopping counter: 10 out of 25

Epoch 55/99
----------
train Loss: 0.7414 LRAP: 0.8255 NDCG: 0.8211
val Loss: 0.9122 LRAP: 0.8270 NDCG: 0.8415
EarlyStopping counter: 11 out of 25

Epoch 56/99
----------
train Loss: 0.7409 LRAP: 0.8225 NDCG: 0.8180
val Loss: 0.9144 LRAP: 0.8273 NDCG: 0.8443
EarlyStopping counter: 12 out of 25

Epoch 57/99
----------
train Loss: 0.7427 LRAP: 0.8254 NDCG: 0.8184
val Loss: 0.9117 LRAP: 0.8259 NDCG: 0.8428
EarlyStopping counter: 13 out of 25

Epoch 58/99
----------
train Loss: 0.7423 LRAP: 0.8223 NDCG: 0.8176
val Loss: 0.9132 LRAP: 0.8267 NDCG: 0.8432
EarlyStopping counter: 14 out of 25

Epoch 59/99
----------
train Loss: 0.7400 LRAP: 0.8246 NDCG: 0.8192
val Loss: 0.9130 LRAP: 0.8307 NDCG: 0.8477
EarlyStopping counter: 15 out of 25

Epoch 60/99
----------
train Loss: 0.7405 LRAP: 0.8214 NDCG: 0.8148
val Loss: 0.9118 LRAP: 0.8261 NDCG: 0.8403
EarlyStopping counter: 16 out of 25

Epoch 61/99
----------
train Loss: 0.7405 LRAP: 0.8261 NDCG: 0.8215
val Loss: 0.9125 LRAP: 0.8259 NDCG: 0.8426
EarlyStopping counter: 17 out of 25

Epoch 62/99
----------
train Loss: 0.7436 LRAP: 0.8205 NDCG: 0.8164
val Loss: 0.9128 LRAP: 0.8242 NDCG: 0.8358
EarlyStopping counter: 18 out of 25

Epoch 63/99
----------
train Loss: 0.7410 LRAP: 0.8232 NDCG: 0.8197
val Loss: 0.9114 LRAP: 0.8270 NDCG: 0.8443
EarlyStopping counter: 19 out of 25

Epoch 64/99
----------
train Loss: 0.7403 LRAP: 0.8216 NDCG: 0.8179
val Loss: 0.9118 LRAP: 0.8301 NDCG: 0.8491
EarlyStopping counter: 20 out of 25

Epoch 65/99
----------
train Loss: 0.7427 LRAP: 0.8214 NDCG: 0.8169
val Loss: 0.9124 LRAP: 0.8273 NDCG: 0.8476
EarlyStopping counter: 21 out of 25

Epoch 66/99
----------
train Loss: 0.7405 LRAP: 0.8255 NDCG: 0.8192
val Loss: 0.9130 LRAP: 0.8347 NDCG: 0.8518
EarlyStopping counter: 22 out of 25

Epoch 67/99
----------
train Loss: 0.7398 LRAP: 0.8210 NDCG: 0.8169
val Loss: 0.9124 LRAP: 0.8310 NDCG: 0.8546
EarlyStopping counter: 23 out of 25

Epoch 68/99
----------
train Loss: 0.7414 LRAP: 0.8202 NDCG: 0.8167
val Loss: 0.9131 LRAP: 0.8256 NDCG: 0.8430
EarlyStopping counter: 24 out of 25

Epoch 69/99
----------
train Loss: 0.7393 LRAP: 0.8235 NDCG: 0.8182
val Loss: 0.9139 LRAP: 0.8304 NDCG: 0.8488
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 6m 39s
Best val loss: 0.909882, best LRAP score: 0.9598

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.9265 LRAP: 0.0986 NDCG: 0.5429
val Loss: 1.6213 LRAP: 0.2960 NDCG: 0.6067
Validation loss decreased (0.000000 --> 1.621314).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3316 LRAP: 0.4586 NDCG: 0.6717
val Loss: 1.1773 LRAP: 0.5929 NDCG: 0.7102
Validation loss decreased (1.621314 --> 1.177273).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1786 LRAP: 0.5978 NDCG: 0.7256
val Loss: 1.0992 LRAP: 0.6637 NDCG: 0.7632
Validation loss decreased (1.177273 --> 1.099188).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1164 LRAP: 0.6340 NDCG: 0.7446
val Loss: 1.0579 LRAP: 0.6674 NDCG: 0.7549
Validation loss decreased (1.099188 --> 1.057868).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0726 LRAP: 0.6434 NDCG: 0.7542
val Loss: 1.0473 LRAP: 0.6763 NDCG: 0.7660
Validation loss decreased (1.057868 --> 1.047304).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0507 LRAP: 0.6478 NDCG: 0.7628
val Loss: 1.0280 LRAP: 0.6788 NDCG: 0.7735
Validation loss decreased (1.047304 --> 1.027967).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0208 LRAP: 0.6615 NDCG: 0.7742
val Loss: 1.0035 LRAP: 0.6951 NDCG: 0.7881
Validation loss decreased (1.027967 --> 1.003470).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9958 LRAP: 0.6506 NDCG: 0.7770
val Loss: 0.9944 LRAP: 0.7031 NDCG: 0.7930
Validation loss decreased (1.003470 --> 0.994381).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9735 LRAP: 0.6630 NDCG: 0.7853
val Loss: 0.9680 LRAP: 0.6794 NDCG: 0.7859
Validation loss decreased (0.994381 --> 0.968048).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9517 LRAP: 0.6678 NDCG: 0.7914
val Loss: 0.9728 LRAP: 0.7145 NDCG: 0.8119
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9371 LRAP: 0.6843 NDCG: 0.8002
val Loss: 0.9571 LRAP: 0.7122 NDCG: 0.8164
Validation loss decreased (0.968048 --> 0.957067).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9209 LRAP: 0.6914 NDCG: 0.8062
val Loss: 0.9722 LRAP: 0.7374 NDCG: 0.8252
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.9113 LRAP: 0.7058 NDCG: 0.8110
val Loss: 0.9532 LRAP: 0.7377 NDCG: 0.8259
Validation loss decreased (0.957067 --> 0.953166).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9004 LRAP: 0.7129 NDCG: 0.8137
val Loss: 0.9535 LRAP: 0.7494 NDCG: 0.8312
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.8904 LRAP: 0.7098 NDCG: 0.8125
val Loss: 0.9622 LRAP: 0.7554 NDCG: 0.8342
EarlyStopping counter: 2 out of 25

Epoch 15/99
----------
train Loss: 0.8833 LRAP: 0.7075 NDCG: 0.8114
val Loss: 0.9379 LRAP: 0.7648 NDCG: 0.8394
Validation loss decreased (0.953166 --> 0.937913).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8735 LRAP: 0.7235 NDCG: 0.8192
val Loss: 0.9490 LRAP: 0.7565 NDCG: 0.8391
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.8694 LRAP: 0.7310 NDCG: 0.8163
val Loss: 0.9322 LRAP: 0.7596 NDCG: 0.8376
Validation loss decreased (0.937913 --> 0.932182).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8578 LRAP: 0.7295 NDCG: 0.8153
val Loss: 0.9297 LRAP: 0.7613 NDCG: 0.8425
Validation loss decreased (0.932182 --> 0.929655).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8574 LRAP: 0.7287 NDCG: 0.8110
val Loss: 0.9339 LRAP: 0.7431 NDCG: 0.8204
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8494 LRAP: 0.7309 NDCG: 0.7988
val Loss: 0.9279 LRAP: 0.7662 NDCG: 0.8399
Validation loss decreased (0.929655 --> 0.927945).  Saving model ...

Epoch 21/99
----------
train Loss: 0.8435 LRAP: 0.7340 NDCG: 0.7996
val Loss: 0.9278 LRAP: 0.7545 NDCG: 0.8278
Validation loss decreased (0.927945 --> 0.927816).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8374 LRAP: 0.7454 NDCG: 0.8032
val Loss: 0.9219 LRAP: 0.7608 NDCG: 0.8311
Validation loss decreased (0.927816 --> 0.921892).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8333 LRAP: 0.7402 NDCG: 0.7991
val Loss: 0.9338 LRAP: 0.7722 NDCG: 0.8322
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8298 LRAP: 0.7504 NDCG: 0.7951
val Loss: 0.9226 LRAP: 0.7762 NDCG: 0.8347
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.8207 LRAP: 0.7537 NDCG: 0.7885
val Loss: 0.9185 LRAP: 0.7474 NDCG: 0.8107
Validation loss decreased (0.921892 --> 0.918509).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8170 LRAP: 0.7492 NDCG: 0.7735
val Loss: 0.9188 LRAP: 0.7394 NDCG: 0.7980
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.8134 LRAP: 0.7554 NDCG: 0.7923
val Loss: 0.9138 LRAP: 0.7782 NDCG: 0.8352
Validation loss decreased (0.918509 --> 0.913826).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8076 LRAP: 0.7523 NDCG: 0.7682
val Loss: 0.9184 LRAP: 0.7876 NDCG: 0.8370
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.7985 LRAP: 0.7625 NDCG: 0.7774
val Loss: 0.9125 LRAP: 0.7785 NDCG: 0.7769
Validation loss decreased (0.913826 --> 0.912454).  Saving model ...

Epoch 30/99
----------
train Loss: 0.7970 LRAP: 0.7606 NDCG: 0.7679
val Loss: 0.9180 LRAP: 0.7619 NDCG: 0.7983
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.7932 LRAP: 0.7677 NDCG: 0.7666
val Loss: 0.9333 LRAP: 0.7542 NDCG: 0.7772
EarlyStopping counter: 2 out of 25

Epoch 32/99
----------
train Loss: 0.7897 LRAP: 0.7655 NDCG: 0.7570
val Loss: 0.9082 LRAP: 0.7913 NDCG: 0.8447
Validation loss decreased (0.912454 --> 0.908225).  Saving model ...

Epoch 33/99
----------
train Loss: 0.7847 LRAP: 0.7634 NDCG: 0.7723
val Loss: 0.9201 LRAP: 0.8130 NDCG: 0.8510
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.7823 LRAP: 0.7760 NDCG: 0.7819
val Loss: 0.9184 LRAP: 0.7862 NDCG: 0.7807
EarlyStopping counter: 2 out of 25

Epoch 35/99
----------
train Loss: 0.7788 LRAP: 0.7701 NDCG: 0.7723
val Loss: 0.9084 LRAP: 0.7745 NDCG: 0.7724
EarlyStopping counter: 3 out of 25

Epoch 36/99
----------
train Loss: 0.7726 LRAP: 0.7719 NDCG: 0.7608
val Loss: 0.9076 LRAP: 0.7927 NDCG: 0.8281
Validation loss decreased (0.908225 --> 0.907620).  Saving model ...

Epoch 37/99
----------
train Loss: 0.7716 LRAP: 0.7701 NDCG: 0.7622
val Loss: 0.9101 LRAP: 0.8133 NDCG: 0.8320
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.7725 LRAP: 0.7705 NDCG: 0.7563
val Loss: 0.9128 LRAP: 0.7950 NDCG: 0.7798
EarlyStopping counter: 2 out of 25

Epoch 39/99
----------
train Loss: 0.7677 LRAP: 0.7734 NDCG: 0.7528
val Loss: 0.9113 LRAP: 0.8087 NDCG: 0.8364
EarlyStopping counter: 3 out of 25

Epoch 40/99
----------
train Loss: 0.7633 LRAP: 0.7751 NDCG: 0.7600
val Loss: 0.9075 LRAP: 0.8082 NDCG: 0.8196
Validation loss decreased (0.907620 --> 0.907543).  Saving model ...

Epoch 41/99
----------
train Loss: 0.7589 LRAP: 0.7796 NDCG: 0.7635
val Loss: 0.9214 LRAP: 0.7913 NDCG: 0.7717
EarlyStopping counter: 1 out of 25

Epoch 42/99
----------
train Loss: 0.7418 LRAP: 0.7825 NDCG: 0.7653
val Loss: 0.8983 LRAP: 0.8210 NDCG: 0.8334
Validation loss decreased (0.907543 --> 0.898336).  Saving model ...

Epoch 43/99
----------
train Loss: 0.7329 LRAP: 0.7933 NDCG: 0.7641
val Loss: 0.8979 LRAP: 0.8130 NDCG: 0.7973
Validation loss decreased (0.898336 --> 0.897902).  Saving model ...

Epoch 44/99
----------
train Loss: 0.7328 LRAP: 0.7973 NDCG: 0.7702
val Loss: 0.8956 LRAP: 0.8193 NDCG: 0.8136
Validation loss decreased (0.897902 --> 0.895568).  Saving model ...

Epoch 45/99
----------
train Loss: 0.7292 LRAP: 0.7955 NDCG: 0.7693
val Loss: 0.9009 LRAP: 0.8202 NDCG: 0.8172
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.7271 LRAP: 0.7989 NDCG: 0.7712
val Loss: 0.8965 LRAP: 0.8253 NDCG: 0.8241
EarlyStopping counter: 2 out of 25

Epoch 47/99
----------
train Loss: 0.7277 LRAP: 0.7969 NDCG: 0.7688
val Loss: 0.8960 LRAP: 0.8170 NDCG: 0.8006
EarlyStopping counter: 3 out of 25

Epoch 48/99
----------
train Loss: 0.7245 LRAP: 0.8026 NDCG: 0.7704
val Loss: 0.8952 LRAP: 0.8247 NDCG: 0.8267
Validation loss decreased (0.895568 --> 0.895227).  Saving model ...

Epoch 49/99
----------
train Loss: 0.7223 LRAP: 0.8065 NDCG: 0.7740
val Loss: 0.8952 LRAP: 0.8273 NDCG: 0.8208
Validation loss decreased (0.895227 --> 0.895195).  Saving model ...

Epoch 50/99
----------
train Loss: 0.7218 LRAP: 0.8046 NDCG: 0.7754
val Loss: 0.8981 LRAP: 0.8253 NDCG: 0.8087
EarlyStopping counter: 1 out of 25

Epoch 51/99
----------
train Loss: 0.7207 LRAP: 0.8061 NDCG: 0.7776
val Loss: 0.8940 LRAP: 0.8316 NDCG: 0.8311
Validation loss decreased (0.895195 --> 0.893977).  Saving model ...

Epoch 52/99
----------
train Loss: 0.7220 LRAP: 0.8025 NDCG: 0.7696
val Loss: 0.8964 LRAP: 0.8287 NDCG: 0.8272
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.7185 LRAP: 0.8098 NDCG: 0.7779
val Loss: 0.8964 LRAP: 0.8319 NDCG: 0.8311
EarlyStopping counter: 2 out of 25

Epoch 54/99
----------
train Loss: 0.7178 LRAP: 0.8110 NDCG: 0.7820
val Loss: 0.8955 LRAP: 0.8261 NDCG: 0.8267
EarlyStopping counter: 3 out of 25

Epoch 55/99
----------
train Loss: 0.7151 LRAP: 0.8109 NDCG: 0.7784
val Loss: 0.8964 LRAP: 0.8410 NDCG: 0.8553
EarlyStopping counter: 4 out of 25

Epoch 56/99
----------
train Loss: 0.7159 LRAP: 0.8088 NDCG: 0.7776
val Loss: 0.8986 LRAP: 0.8299 NDCG: 0.8270
EarlyStopping counter: 5 out of 25

Epoch 57/99
----------
train Loss: 0.7132 LRAP: 0.8069 NDCG: 0.7709
val Loss: 0.8943 LRAP: 0.8339 NDCG: 0.8370
EarlyStopping counter: 6 out of 25

Epoch 58/99
----------
train Loss: 0.7103 LRAP: 0.8107 NDCG: 0.7732
val Loss: 0.8960 LRAP: 0.8293 NDCG: 0.8292
EarlyStopping counter: 7 out of 25

Epoch 59/99
----------
train Loss: 0.7093 LRAP: 0.8117 NDCG: 0.7821
val Loss: 0.8959 LRAP: 0.8284 NDCG: 0.8278
EarlyStopping counter: 8 out of 25

Epoch 60/99
----------
train Loss: 0.7093 LRAP: 0.8147 NDCG: 0.7856
val Loss: 0.8965 LRAP: 0.8327 NDCG: 0.8289
EarlyStopping counter: 9 out of 25

Epoch 61/99
----------
train Loss: 0.7095 LRAP: 0.8128 NDCG: 0.7872
val Loss: 0.8971 LRAP: 0.8359 NDCG: 0.8302
EarlyStopping counter: 10 out of 25

Epoch 62/99
----------
train Loss: 0.7087 LRAP: 0.8140 NDCG: 0.7809
val Loss: 0.8975 LRAP: 0.8307 NDCG: 0.8276
EarlyStopping counter: 11 out of 25

Epoch 63/99
----------
train Loss: 0.7085 LRAP: 0.8138 NDCG: 0.7808
val Loss: 0.8947 LRAP: 0.8390 NDCG: 0.8443
EarlyStopping counter: 12 out of 25

Epoch 64/99
----------
train Loss: 0.7080 LRAP: 0.8142 NDCG: 0.7816
val Loss: 0.8953 LRAP: 0.8384 NDCG: 0.8405
EarlyStopping counter: 13 out of 25

Epoch 65/99
----------
train Loss: 0.7078 LRAP: 0.8136 NDCG: 0.7794
val Loss: 0.9003 LRAP: 0.8456 NDCG: 0.8496
EarlyStopping counter: 14 out of 25

Epoch 66/99
----------
train Loss: 0.7080 LRAP: 0.8157 NDCG: 0.7841
val Loss: 0.8966 LRAP: 0.8379 NDCG: 0.8384
EarlyStopping counter: 15 out of 25

Epoch 67/99
----------
train Loss: 0.7087 LRAP: 0.8144 NDCG: 0.7822
val Loss: 0.8967 LRAP: 0.8310 NDCG: 0.8312
EarlyStopping counter: 16 out of 25

Epoch 68/99
----------
train Loss: 0.7074 LRAP: 0.8159 NDCG: 0.7853
val Loss: 0.8953 LRAP: 0.8359 NDCG: 0.8350
EarlyStopping counter: 17 out of 25

Epoch 69/99
----------
train Loss: 0.7082 LRAP: 0.8146 NDCG: 0.7838
val Loss: 0.8969 LRAP: 0.8301 NDCG: 0.8264
EarlyStopping counter: 18 out of 25

Epoch 70/99
----------
train Loss: 0.7088 LRAP: 0.8119 NDCG: 0.7800
val Loss: 0.8991 LRAP: 0.8293 NDCG: 0.8200
EarlyStopping counter: 19 out of 25

Epoch 71/99
----------
train Loss: 0.7078 LRAP: 0.8142 NDCG: 0.7845
val Loss: 0.8953 LRAP: 0.8416 NDCG: 0.8406
EarlyStopping counter: 20 out of 25

Epoch 72/99
----------
train Loss: 0.7079 LRAP: 0.8144 NDCG: 0.7859
val Loss: 0.8955 LRAP: 0.8341 NDCG: 0.8327
EarlyStopping counter: 21 out of 25

Epoch 73/99
----------
train Loss: 0.7089 LRAP: 0.8115 NDCG: 0.7797
val Loss: 0.8966 LRAP: 0.8356 NDCG: 0.8342
EarlyStopping counter: 22 out of 25

Epoch 74/99
----------
train Loss: 0.7084 LRAP: 0.8131 NDCG: 0.7802
val Loss: 0.8962 LRAP: 0.8404 NDCG: 0.8399
EarlyStopping counter: 23 out of 25

Epoch 75/99
----------
train Loss: 0.7089 LRAP: 0.8139 NDCG: 0.7783
val Loss: 0.9012 LRAP: 0.8336 NDCG: 0.8251
EarlyStopping counter: 24 out of 25

Epoch 76/99
----------
train Loss: 0.7092 LRAP: 0.8146 NDCG: 0.7817
val Loss: 0.8982 LRAP: 0.8347 NDCG: 0.8363
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 9s
Best val loss: 0.893977, best LRAP score: 0.9609

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7520 LRAP: 0.2114 NDCG: 0.5759
val Loss: 1.3471 LRAP: 0.5564 NDCG: 0.6686
Validation loss decreased (0.000000 --> 1.347111).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2664 LRAP: 0.6242 NDCG: 0.7114
val Loss: 1.2248 LRAP: 0.6300 NDCG: 0.7010
Validation loss decreased (1.347111 --> 1.224822).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1895 LRAP: 0.6417 NDCG: 0.7169
val Loss: 1.1625 LRAP: 0.6597 NDCG: 0.7250
Validation loss decreased (1.224822 --> 1.162528).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1440 LRAP: 0.6654 NDCG: 0.7297
val Loss: 1.2774 LRAP: 0.6018 NDCG: 0.6844
EarlyStopping counter: 1 out of 25

Epoch 4/99
----------
train Loss: 1.1052 LRAP: 0.6768 NDCG: 0.7424
val Loss: 1.0822 LRAP: 0.6931 NDCG: 0.7572
Validation loss decreased (1.162528 --> 1.082215).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0840 LRAP: 0.6787 NDCG: 0.7534
val Loss: 1.0951 LRAP: 0.6509 NDCG: 0.7377
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.0794 LRAP: 0.6675 NDCG: 0.7539
val Loss: 1.1417 LRAP: 0.7205 NDCG: 0.7897
EarlyStopping counter: 2 out of 25

Epoch 7/99
----------
train Loss: 1.0485 LRAP: 0.6759 NDCG: 0.7653
val Loss: 1.1513 LRAP: 0.5507 NDCG: 0.7207
EarlyStopping counter: 3 out of 25

Epoch 8/99
----------
train Loss: 1.0379 LRAP: 0.6688 NDCG: 0.7698
val Loss: 1.0747 LRAP: 0.7114 NDCG: 0.7787
Validation loss decreased (1.082215 --> 1.074729).  Saving model ...

Epoch 9/99
----------
train Loss: 1.0291 LRAP: 0.6718 NDCG: 0.7741
val Loss: 1.0986 LRAP: 0.6640 NDCG: 0.7610
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 1.0189 LRAP: 0.6692 NDCG: 0.7757
val Loss: 1.2775 LRAP: 0.4479 NDCG: 0.6826
EarlyStopping counter: 2 out of 25

Epoch 11/99
----------
train Loss: 1.0089 LRAP: 0.6836 NDCG: 0.7825
val Loss: 1.0549 LRAP: 0.6934 NDCG: 0.7791
Validation loss decreased (1.074729 --> 1.054865).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9915 LRAP: 0.6855 NDCG: 0.7870
val Loss: 1.0026 LRAP: 0.6911 NDCG: 0.7886
Validation loss decreased (1.054865 --> 1.002574).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9888 LRAP: 0.6868 NDCG: 0.7913
val Loss: 1.0128 LRAP: 0.6375 NDCG: 0.7771
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.9680 LRAP: 0.6923 NDCG: 0.7931
val Loss: 1.0517 LRAP: 0.6689 NDCG: 0.7838
EarlyStopping counter: 2 out of 25

Epoch 15/99
----------
train Loss: 0.9604 LRAP: 0.6992 NDCG: 0.7945
val Loss: 0.9819 LRAP: 0.7088 NDCG: 0.8012
Validation loss decreased (1.002574 --> 0.981881).  Saving model ...

Epoch 16/99
----------
train Loss: 0.9527 LRAP: 0.7032 NDCG: 0.7984
val Loss: 1.0117 LRAP: 0.6806 NDCG: 0.7883
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.9510 LRAP: 0.6989 NDCG: 0.7941
val Loss: 0.9757 LRAP: 0.7211 NDCG: 0.8131
Validation loss decreased (0.981881 --> 0.975660).  Saving model ...

Epoch 18/99
----------
train Loss: 0.9477 LRAP: 0.6931 NDCG: 0.7872
val Loss: 0.9986 LRAP: 0.7391 NDCG: 0.8030
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.9338 LRAP: 0.7052 NDCG: 0.7875
val Loss: 0.9844 LRAP: 0.7436 NDCG: 0.8243
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 0.9302 LRAP: 0.7088 NDCG: 0.7918
val Loss: 0.9692 LRAP: 0.7208 NDCG: 0.8117
Validation loss decreased (0.975660 --> 0.969157).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9252 LRAP: 0.7001 NDCG: 0.7888
val Loss: 1.0247 LRAP: 0.6760 NDCG: 0.7821
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.9212 LRAP: 0.7096 NDCG: 0.7855
val Loss: 0.9505 LRAP: 0.7459 NDCG: 0.8228
Validation loss decreased (0.969157 --> 0.950523).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9160 LRAP: 0.7063 NDCG: 0.7812
val Loss: 0.9869 LRAP: 0.7511 NDCG: 0.8183
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9082 LRAP: 0.7195 NDCG: 0.7876
val Loss: 0.9610 LRAP: 0.6917 NDCG: 0.7837
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.9070 LRAP: 0.7131 NDCG: 0.7841
val Loss: 0.9364 LRAP: 0.7425 NDCG: 0.8159
Validation loss decreased (0.950523 --> 0.936386).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8994 LRAP: 0.7178 NDCG: 0.7792
val Loss: 0.9441 LRAP: 0.7399 NDCG: 0.8133
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.8944 LRAP: 0.7230 NDCG: 0.7807
val Loss: 0.9765 LRAP: 0.7317 NDCG: 0.7942
EarlyStopping counter: 2 out of 25

Epoch 28/99
----------
train Loss: 0.8921 LRAP: 0.7186 NDCG: 0.7745
val Loss: 0.9444 LRAP: 0.7308 NDCG: 0.7851
EarlyStopping counter: 3 out of 25

Epoch 29/99
----------
train Loss: 0.8866 LRAP: 0.7238 NDCG: 0.7750
val Loss: 0.9393 LRAP: 0.7456 NDCG: 0.7917
EarlyStopping counter: 4 out of 25

Epoch 30/99
----------
train Loss: 0.8848 LRAP: 0.7262 NDCG: 0.7741
val Loss: 0.9456 LRAP: 0.7574 NDCG: 0.8129
EarlyStopping counter: 5 out of 25

Epoch 31/99
----------
train Loss: 0.8633 LRAP: 0.7293 NDCG: 0.7627
val Loss: 0.9241 LRAP: 0.7691 NDCG: 0.8135
Validation loss decreased (0.936386 --> 0.924065).  Saving model ...

Epoch 32/99
----------
train Loss: 0.8523 LRAP: 0.7373 NDCG: 0.7621
val Loss: 0.9290 LRAP: 0.7633 NDCG: 0.8076
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.8503 LRAP: 0.7341 NDCG: 0.7667
val Loss: 0.9197 LRAP: 0.7653 NDCG: 0.7883
Validation loss decreased (0.924065 --> 0.919705).  Saving model ...

Epoch 34/99
----------
train Loss: 0.8477 LRAP: 0.7394 NDCG: 0.7678
val Loss: 0.9165 LRAP: 0.7619 NDCG: 0.8026
Validation loss decreased (0.919705 --> 0.916528).  Saving model ...

Epoch 35/99
----------
train Loss: 0.8472 LRAP: 0.7369 NDCG: 0.7631
val Loss: 0.9197 LRAP: 0.7679 NDCG: 0.8082
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.8449 LRAP: 0.7424 NDCG: 0.7680
val Loss: 0.9155 LRAP: 0.7708 NDCG: 0.8091
Validation loss decreased (0.916528 --> 0.915522).  Saving model ...

Epoch 37/99
----------
train Loss: 0.8454 LRAP: 0.7394 NDCG: 0.7739
val Loss: 0.9151 LRAP: 0.7756 NDCG: 0.8155
Validation loss decreased (0.915522 --> 0.915086).  Saving model ...

Epoch 38/99
----------
train Loss: 0.8419 LRAP: 0.7374 NDCG: 0.7673
val Loss: 0.9187 LRAP: 0.7653 NDCG: 0.7977
EarlyStopping counter: 1 out of 25

Epoch 39/99
----------
train Loss: 0.8377 LRAP: 0.7413 NDCG: 0.7658
val Loss: 0.9210 LRAP: 0.7793 NDCG: 0.8213
EarlyStopping counter: 2 out of 25

Epoch 40/99
----------
train Loss: 0.8337 LRAP: 0.7421 NDCG: 0.7663
val Loss: 0.9189 LRAP: 0.7753 NDCG: 0.8116
EarlyStopping counter: 3 out of 25

Epoch 41/99
----------
train Loss: 0.8359 LRAP: 0.7438 NDCG: 0.7670
val Loss: 0.9159 LRAP: 0.7733 NDCG: 0.8026
EarlyStopping counter: 4 out of 25

Epoch 42/99
----------
train Loss: 0.8336 LRAP: 0.7454 NDCG: 0.7739
val Loss: 0.9243 LRAP: 0.7745 NDCG: 0.8171
EarlyStopping counter: 5 out of 25

Epoch 43/99
----------
train Loss: 0.8280 LRAP: 0.7449 NDCG: 0.7667
val Loss: 0.9132 LRAP: 0.7688 NDCG: 0.7992
Validation loss decreased (0.915086 --> 0.913224).  Saving model ...

Epoch 44/99
----------
train Loss: 0.8246 LRAP: 0.7471 NDCG: 0.7695
val Loss: 0.9123 LRAP: 0.7665 NDCG: 0.7973
Validation loss decreased (0.913224 --> 0.912348).  Saving model ...

Epoch 45/99
----------
train Loss: 0.8246 LRAP: 0.7465 NDCG: 0.7718
val Loss: 0.9139 LRAP: 0.7722 NDCG: 0.8045
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.8253 LRAP: 0.7465 NDCG: 0.7645
val Loss: 0.9107 LRAP: 0.7759 NDCG: 0.8112
Validation loss decreased (0.912348 --> 0.910715).  Saving model ...

Epoch 47/99
----------
train Loss: 0.8238 LRAP: 0.7483 NDCG: 0.7687
val Loss: 0.9125 LRAP: 0.7762 NDCG: 0.8085
EarlyStopping counter: 1 out of 25

Epoch 48/99
----------
train Loss: 0.8223 LRAP: 0.7517 NDCG: 0.7724
val Loss: 0.9115 LRAP: 0.7759 NDCG: 0.8117
EarlyStopping counter: 2 out of 25

Epoch 49/99
----------
train Loss: 0.8222 LRAP: 0.7500 NDCG: 0.7674
val Loss: 0.9135 LRAP: 0.7708 NDCG: 0.8028
EarlyStopping counter: 3 out of 25

Epoch 50/99
----------
train Loss: 0.8242 LRAP: 0.7463 NDCG: 0.7718
val Loss: 0.9131 LRAP: 0.7750 NDCG: 0.8067
EarlyStopping counter: 4 out of 25

Epoch 51/99
----------
train Loss: 0.8217 LRAP: 0.7536 NDCG: 0.7706
val Loss: 0.9119 LRAP: 0.7739 NDCG: 0.8029
EarlyStopping counter: 5 out of 25

Epoch 52/99
----------
train Loss: 0.8195 LRAP: 0.7490 NDCG: 0.7679
val Loss: 0.9119 LRAP: 0.7768 NDCG: 0.8050
EarlyStopping counter: 6 out of 25

Epoch 53/99
----------
train Loss: 0.8214 LRAP: 0.7493 NDCG: 0.7724
val Loss: 0.9118 LRAP: 0.7762 NDCG: 0.8070
EarlyStopping counter: 7 out of 25

Epoch 54/99
----------
train Loss: 0.8192 LRAP: 0.7494 NDCG: 0.7704
val Loss: 0.9118 LRAP: 0.7785 NDCG: 0.8071
EarlyStopping counter: 8 out of 25

Epoch 55/99
----------
train Loss: 0.8193 LRAP: 0.7507 NDCG: 0.7687
val Loss: 0.9112 LRAP: 0.7773 NDCG: 0.8094
EarlyStopping counter: 9 out of 25

Epoch 56/99
----------
train Loss: 0.8202 LRAP: 0.7520 NDCG: 0.7697
val Loss: 0.9131 LRAP: 0.7725 NDCG: 0.7982
EarlyStopping counter: 10 out of 25

Epoch 57/99
----------
train Loss: 0.8165 LRAP: 0.7541 NDCG: 0.7705
val Loss: 0.9136 LRAP: 0.7748 NDCG: 0.8004
EarlyStopping counter: 11 out of 25

Epoch 58/99
----------
train Loss: 0.8200 LRAP: 0.7521 NDCG: 0.7720
val Loss: 0.9130 LRAP: 0.7750 NDCG: 0.8058
EarlyStopping counter: 12 out of 25

Epoch 59/99
----------
train Loss: 0.8201 LRAP: 0.7499 NDCG: 0.7672
val Loss: 0.9128 LRAP: 0.7768 NDCG: 0.8043
EarlyStopping counter: 13 out of 25

Epoch 60/99
----------
train Loss: 0.8172 LRAP: 0.7538 NDCG: 0.7764
val Loss: 0.9115 LRAP: 0.7788 NDCG: 0.8102
EarlyStopping counter: 14 out of 25

Epoch 61/99
----------
train Loss: 0.8188 LRAP: 0.7485 NDCG: 0.7679
val Loss: 0.9122 LRAP: 0.7725 NDCG: 0.8000
EarlyStopping counter: 15 out of 25

Epoch 62/99
----------
train Loss: 0.8194 LRAP: 0.7504 NDCG: 0.7719
val Loss: 0.9103 LRAP: 0.7839 NDCG: 0.8140
Validation loss decreased (0.910715 --> 0.910298).  Saving model ...

Epoch 63/99
----------
train Loss: 0.8202 LRAP: 0.7500 NDCG: 0.7707
val Loss: 0.9121 LRAP: 0.7762 NDCG: 0.8044
EarlyStopping counter: 1 out of 25

Epoch 64/99
----------
train Loss: 0.8184 LRAP: 0.7503 NDCG: 0.7701
val Loss: 0.9126 LRAP: 0.7731 NDCG: 0.8021
EarlyStopping counter: 2 out of 25

Epoch 65/99
----------
train Loss: 0.8171 LRAP: 0.7501 NDCG: 0.7710
val Loss: 0.9106 LRAP: 0.7788 NDCG: 0.8097
EarlyStopping counter: 3 out of 25

Epoch 66/99
----------
train Loss: 0.8209 LRAP: 0.7519 NDCG: 0.7686
val Loss: 0.9122 LRAP: 0.7822 NDCG: 0.8104
EarlyStopping counter: 4 out of 25

Epoch 67/99
----------
train Loss: 0.8173 LRAP: 0.7487 NDCG: 0.7691
val Loss: 0.9130 LRAP: 0.7719 NDCG: 0.8004
EarlyStopping counter: 5 out of 25

Epoch 68/99
----------
train Loss: 0.8170 LRAP: 0.7476 NDCG: 0.7671
val Loss: 0.9126 LRAP: 0.7765 NDCG: 0.8043
EarlyStopping counter: 6 out of 25

Epoch 69/99
----------
train Loss: 0.8168 LRAP: 0.7515 NDCG: 0.7666
val Loss: 0.9126 LRAP: 0.7793 NDCG: 0.8088
EarlyStopping counter: 7 out of 25

Epoch 70/99
----------
train Loss: 0.8206 LRAP: 0.7503 NDCG: 0.7696
val Loss: 0.9134 LRAP: 0.7819 NDCG: 0.8152
EarlyStopping counter: 8 out of 25

Epoch 71/99
----------
train Loss: 0.8173 LRAP: 0.7545 NDCG: 0.7728
val Loss: 0.9124 LRAP: 0.7773 NDCG: 0.8077
EarlyStopping counter: 9 out of 25

Epoch 72/99
----------
train Loss: 0.8179 LRAP: 0.7526 NDCG: 0.7733
val Loss: 0.9106 LRAP: 0.7785 NDCG: 0.8114
EarlyStopping counter: 10 out of 25

Epoch 73/99
----------
train Loss: 0.8197 LRAP: 0.7516 NDCG: 0.7742
val Loss: 0.9117 LRAP: 0.7713 NDCG: 0.7973
EarlyStopping counter: 11 out of 25

Epoch 74/99
----------
train Loss: 0.8197 LRAP: 0.7541 NDCG: 0.7702
val Loss: 0.9108 LRAP: 0.7805 NDCG: 0.8097
EarlyStopping counter: 12 out of 25

Epoch 75/99
----------
train Loss: 0.8169 LRAP: 0.7505 NDCG: 0.7677
val Loss: 0.9130 LRAP: 0.7768 NDCG: 0.8050
EarlyStopping counter: 13 out of 25

Epoch 76/99
----------
train Loss: 0.8177 LRAP: 0.7539 NDCG: 0.7692
val Loss: 0.9120 LRAP: 0.7779 NDCG: 0.8060
EarlyStopping counter: 14 out of 25

Epoch 77/99
----------
train Loss: 0.8190 LRAP: 0.7543 NDCG: 0.7715
val Loss: 0.9130 LRAP: 0.7793 NDCG: 0.8059
EarlyStopping counter: 15 out of 25

Epoch 78/99
----------
train Loss: 0.8168 LRAP: 0.7541 NDCG: 0.7764
val Loss: 0.9120 LRAP: 0.7802 NDCG: 0.8139
EarlyStopping counter: 16 out of 25

Epoch 79/99
----------
train Loss: 0.8179 LRAP: 0.7515 NDCG: 0.7697
val Loss: 0.9130 LRAP: 0.7733 NDCG: 0.8042
EarlyStopping counter: 17 out of 25

Epoch 80/99
----------
train Loss: 0.8210 LRAP: 0.7511 NDCG: 0.7726
val Loss: 0.9119 LRAP: 0.7805 NDCG: 0.8114
EarlyStopping counter: 18 out of 25

Epoch 81/99
----------
train Loss: 0.8190 LRAP: 0.7473 NDCG: 0.7687
val Loss: 0.9122 LRAP: 0.7739 NDCG: 0.8015
EarlyStopping counter: 19 out of 25

Epoch 82/99
----------
train Loss: 0.8194 LRAP: 0.7507 NDCG: 0.7719
val Loss: 0.9126 LRAP: 0.7742 NDCG: 0.8033
EarlyStopping counter: 20 out of 25

Epoch 83/99
----------
train Loss: 0.8173 LRAP: 0.7499 NDCG: 0.7729
val Loss: 0.9137 LRAP: 0.7733 NDCG: 0.8033
EarlyStopping counter: 21 out of 25

Epoch 84/99
----------
train Loss: 0.8189 LRAP: 0.7537 NDCG: 0.7705
val Loss: 0.9115 LRAP: 0.7799 NDCG: 0.8100
EarlyStopping counter: 22 out of 25

Epoch 85/99
----------
train Loss: 0.8197 LRAP: 0.7531 NDCG: 0.7733
val Loss: 0.9129 LRAP: 0.7725 NDCG: 0.7962
EarlyStopping counter: 23 out of 25

Epoch 86/99
----------
train Loss: 0.8186 LRAP: 0.7519 NDCG: 0.7727
val Loss: 0.9125 LRAP: 0.7739 NDCG: 0.7982
EarlyStopping counter: 24 out of 25

Epoch 87/99
----------
train Loss: 0.8204 LRAP: 0.7541 NDCG: 0.7731
val Loss: 0.9123 LRAP: 0.7736 NDCG: 0.8073
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 8m 33s
Best val loss: 0.910298, best LRAP score: 0.9581

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7482 LRAP: 0.2134 NDCG: 0.5774
val Loss: 1.4216 LRAP: 0.2444 NDCG: 0.6126
Validation loss decreased (0.000000 --> 1.421564).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3161 LRAP: 0.5783 NDCG: 0.6901
val Loss: 1.3396 LRAP: 0.5707 NDCG: 0.6776
Validation loss decreased (1.421564 --> 1.339561).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2502 LRAP: 0.6004 NDCG: 0.7075
val Loss: 2.5038 LRAP: 0.2195 NDCG: 0.5507
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.2225 LRAP: 0.6116 NDCG: 0.7177
val Loss: 1.2553 LRAP: 0.5701 NDCG: 0.6935
Validation loss decreased (1.339561 --> 1.255330).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1933 LRAP: 0.6185 NDCG: 0.7274
val Loss: 2.0378 LRAP: 0.1867 NDCG: 0.5207
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.1640 LRAP: 0.6218 NDCG: 0.7335
val Loss: 1.2612 LRAP: 0.6951 NDCG: 0.7717
EarlyStopping counter: 2 out of 25

Epoch 6/99
----------
train Loss: 1.1604 LRAP: 0.6193 NDCG: 0.7405
val Loss: 1.2377 LRAP: 0.5712 NDCG: 0.7331
Validation loss decreased (1.255330 --> 1.237676).  Saving model ...

Epoch 7/99
----------
train Loss: 1.1469 LRAP: 0.6184 NDCG: 0.7435
val Loss: 1.2928 LRAP: 0.6911 NDCG: 0.7716
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 1.1295 LRAP: 0.6160 NDCG: 0.7458
val Loss: 1.1574 LRAP: 0.5772 NDCG: 0.7312
Validation loss decreased (1.237676 --> 1.157442).  Saving model ...

Epoch 9/99
----------
train Loss: 1.1231 LRAP: 0.6105 NDCG: 0.7490
val Loss: 1.3103 LRAP: 0.4890 NDCG: 0.6800
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 1.1140 LRAP: 0.6245 NDCG: 0.7541
val Loss: 1.1476 LRAP: 0.5815 NDCG: 0.7303
Validation loss decreased (1.157442 --> 1.147646).  Saving model ...

Epoch 11/99
----------
train Loss: 1.1002 LRAP: 0.6327 NDCG: 0.7592
val Loss: 1.3582 LRAP: 0.4054 NDCG: 0.6818
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 1.0886 LRAP: 0.6307 NDCG: 0.7607
val Loss: 1.0956 LRAP: 0.6360 NDCG: 0.7545
Validation loss decreased (1.147646 --> 1.095611).  Saving model ...

Epoch 13/99
----------
train Loss: 1.0865 LRAP: 0.6315 NDCG: 0.7620
val Loss: 1.1010 LRAP: 0.6352 NDCG: 0.7566
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 1.0759 LRAP: 0.6383 NDCG: 0.7646
val Loss: 1.3918 LRAP: 0.3791 NDCG: 0.6855
EarlyStopping counter: 2 out of 25

Epoch 15/99
----------
train Loss: 1.0654 LRAP: 0.6459 NDCG: 0.7694
val Loss: 1.1228 LRAP: 0.6512 NDCG: 0.7625
EarlyStopping counter: 3 out of 25

Epoch 16/99
----------
train Loss: 1.0599 LRAP: 0.6483 NDCG: 0.7692
val Loss: 1.1163 LRAP: 0.7017 NDCG: 0.7777
EarlyStopping counter: 4 out of 25

Epoch 17/99
----------
train Loss: 1.0489 LRAP: 0.6534 NDCG: 0.7732
val Loss: 1.0544 LRAP: 0.6983 NDCG: 0.7987
Validation loss decreased (1.095611 --> 1.054381).  Saving model ...

Epoch 18/99
----------
train Loss: 1.0433 LRAP: 0.6526 NDCG: 0.7716
val Loss: 1.1142 LRAP: 0.6663 NDCG: 0.7784
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 1.0344 LRAP: 0.6526 NDCG: 0.7706
val Loss: 1.0695 LRAP: 0.7085 NDCG: 0.8010
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 1.0315 LRAP: 0.6628 NDCG: 0.7732
val Loss: 1.1133 LRAP: 0.7251 NDCG: 0.8030
EarlyStopping counter: 3 out of 25

Epoch 21/99
----------
train Loss: 1.0215 LRAP: 0.6550 NDCG: 0.7709
val Loss: 1.0412 LRAP: 0.7005 NDCG: 0.7974
Validation loss decreased (1.054381 --> 1.041226).  Saving model ...

Epoch 22/99
----------
train Loss: 1.0127 LRAP: 0.6626 NDCG: 0.7748
val Loss: 1.0533 LRAP: 0.7322 NDCG: 0.8050
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 1.0160 LRAP: 0.6618 NDCG: 0.7727
val Loss: 1.0823 LRAP: 0.7265 NDCG: 0.7953
EarlyStopping counter: 2 out of 25

Epoch 24/99
----------
train Loss: 1.0061 LRAP: 0.6672 NDCG: 0.7741
val Loss: 1.0577 LRAP: 0.6649 NDCG: 0.7721
EarlyStopping counter: 3 out of 25

Epoch 25/99
----------
train Loss: 0.9947 LRAP: 0.6636 NDCG: 0.7722
val Loss: 1.0458 LRAP: 0.7274 NDCG: 0.8076
EarlyStopping counter: 4 out of 25

Epoch 26/99
----------
train Loss: 0.9900 LRAP: 0.6675 NDCG: 0.7720
val Loss: 1.1643 LRAP: 0.7028 NDCG: 0.7911
EarlyStopping counter: 5 out of 25

Epoch 27/99
----------
train Loss: 0.9678 LRAP: 0.6753 NDCG: 0.7716
val Loss: 0.9882 LRAP: 0.7331 NDCG: 0.8072
Validation loss decreased (1.041226 --> 0.988160).  Saving model ...

Epoch 28/99
----------
train Loss: 0.9535 LRAP: 0.6845 NDCG: 0.7761
val Loss: 0.9887 LRAP: 0.7325 NDCG: 0.8013
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.9540 LRAP: 0.6886 NDCG: 0.7749
val Loss: 0.9847 LRAP: 0.7339 NDCG: 0.8010
Validation loss decreased (0.988160 --> 0.984663).  Saving model ...

Epoch 30/99
----------
train Loss: 0.9499 LRAP: 0.6924 NDCG: 0.7743
val Loss: 0.9920 LRAP: 0.7214 NDCG: 0.7959
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.9504 LRAP: 0.6902 NDCG: 0.7751
val Loss: 0.9852 LRAP: 0.7297 NDCG: 0.7992
EarlyStopping counter: 2 out of 25

Epoch 32/99
----------
train Loss: 0.9452 LRAP: 0.6926 NDCG: 0.7761
val Loss: 0.9835 LRAP: 0.7259 NDCG: 0.7948
Validation loss decreased (0.984663 --> 0.983451).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9417 LRAP: 0.6929 NDCG: 0.7721
val Loss: 0.9834 LRAP: 0.7399 NDCG: 0.7972
Validation loss decreased (0.983451 --> 0.983372).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9373 LRAP: 0.6948 NDCG: 0.7743
val Loss: 0.9866 LRAP: 0.7299 NDCG: 0.7954
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.9374 LRAP: 0.6968 NDCG: 0.7745
val Loss: 0.9851 LRAP: 0.7288 NDCG: 0.7923
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.9374 LRAP: 0.6954 NDCG: 0.7752
val Loss: 0.9930 LRAP: 0.7262 NDCG: 0.7873
EarlyStopping counter: 3 out of 25

Epoch 37/99
----------
train Loss: 0.9359 LRAP: 0.6962 NDCG: 0.7735
val Loss: 0.9908 LRAP: 0.7388 NDCG: 0.7908
EarlyStopping counter: 4 out of 25

Epoch 38/99
----------
train Loss: 0.9276 LRAP: 0.6998 NDCG: 0.7751
val Loss: 0.9784 LRAP: 0.7485 NDCG: 0.8001
Validation loss decreased (0.983372 --> 0.978363).  Saving model ...

Epoch 39/99
----------
train Loss: 0.9277 LRAP: 0.6972 NDCG: 0.7724
val Loss: 0.9776 LRAP: 0.7485 NDCG: 0.7985
Validation loss decreased (0.978363 --> 0.977606).  Saving model ...

Epoch 40/99
----------
train Loss: 0.9278 LRAP: 0.7004 NDCG: 0.7741
val Loss: 0.9771 LRAP: 0.7508 NDCG: 0.8026
Validation loss decreased (0.977606 --> 0.977123).  Saving model ...

Epoch 41/99
----------
train Loss: 0.9246 LRAP: 0.6989 NDCG: 0.7710
val Loss: 0.9779 LRAP: 0.7534 NDCG: 0.8035
EarlyStopping counter: 1 out of 25

Epoch 42/99
----------
train Loss: 0.9211 LRAP: 0.7054 NDCG: 0.7742
val Loss: 0.9770 LRAP: 0.7488 NDCG: 0.8005
Validation loss decreased (0.977123 --> 0.976998).  Saving model ...

Epoch 43/99
----------
train Loss: 0.9229 LRAP: 0.6992 NDCG: 0.7715
val Loss: 0.9788 LRAP: 0.7494 NDCG: 0.7990
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.9243 LRAP: 0.7016 NDCG: 0.7740
val Loss: 0.9768 LRAP: 0.7494 NDCG: 0.7979
Validation loss decreased (0.976998 --> 0.976817).  Saving model ...

Epoch 45/99
----------
train Loss: 0.9236 LRAP: 0.7031 NDCG: 0.7744
val Loss: 0.9784 LRAP: 0.7448 NDCG: 0.7974
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.9224 LRAP: 0.7067 NDCG: 0.7735
val Loss: 0.9773 LRAP: 0.7534 NDCG: 0.8024
EarlyStopping counter: 2 out of 25

Epoch 47/99
----------
train Loss: 0.9236 LRAP: 0.7031 NDCG: 0.7705
val Loss: 0.9764 LRAP: 0.7485 NDCG: 0.8000
Validation loss decreased (0.976817 --> 0.976378).  Saving model ...

Epoch 48/99
----------
train Loss: 0.9216 LRAP: 0.7040 NDCG: 0.7713
val Loss: 0.9762 LRAP: 0.7491 NDCG: 0.8009
Validation loss decreased (0.976378 --> 0.976225).  Saving model ...

Epoch 49/99
----------
train Loss: 0.9181 LRAP: 0.7047 NDCG: 0.7763
val Loss: 0.9767 LRAP: 0.7534 NDCG: 0.8035
EarlyStopping counter: 1 out of 25

Epoch 50/99
----------
train Loss: 0.9210 LRAP: 0.7065 NDCG: 0.7761
val Loss: 0.9760 LRAP: 0.7496 NDCG: 0.7982
Validation loss decreased (0.976225 --> 0.976039).  Saving model ...

Epoch 51/99
----------
train Loss: 0.9174 LRAP: 0.7014 NDCG: 0.7720
val Loss: 0.9756 LRAP: 0.7505 NDCG: 0.8012
Validation loss decreased (0.976039 --> 0.975582).  Saving model ...

Epoch 52/99
----------
train Loss: 0.9208 LRAP: 0.7073 NDCG: 0.7733
val Loss: 0.9768 LRAP: 0.7445 NDCG: 0.7980
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.9172 LRAP: 0.7060 NDCG: 0.7721
val Loss: 0.9746 LRAP: 0.7502 NDCG: 0.8011
Validation loss decreased (0.975582 --> 0.974623).  Saving model ...

Epoch 54/99
----------
train Loss: 0.9161 LRAP: 0.7044 NDCG: 0.7754
val Loss: 0.9750 LRAP: 0.7508 NDCG: 0.8029
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.9176 LRAP: 0.7054 NDCG: 0.7757
val Loss: 0.9744 LRAP: 0.7539 NDCG: 0.8003
Validation loss decreased (0.974623 --> 0.974386).  Saving model ...

Epoch 56/99
----------
train Loss: 0.9165 LRAP: 0.7070 NDCG: 0.7703
val Loss: 0.9744 LRAP: 0.7516 NDCG: 0.8020
Validation loss decreased (0.974386 --> 0.974383).  Saving model ...

Epoch 57/99
----------
train Loss: 0.9182 LRAP: 0.7015 NDCG: 0.7702
val Loss: 0.9757 LRAP: 0.7531 NDCG: 0.8016
EarlyStopping counter: 1 out of 25

Epoch 58/99
----------
train Loss: 0.9184 LRAP: 0.7071 NDCG: 0.7763
val Loss: 0.9733 LRAP: 0.7494 NDCG: 0.8019
Validation loss decreased (0.974383 --> 0.973328).  Saving model ...

Epoch 59/99
----------
train Loss: 0.9172 LRAP: 0.7083 NDCG: 0.7742
val Loss: 0.9755 LRAP: 0.7568 NDCG: 0.8070
EarlyStopping counter: 1 out of 25

Epoch 60/99
----------
train Loss: 0.9185 LRAP: 0.7050 NDCG: 0.7696
val Loss: 0.9743 LRAP: 0.7539 NDCG: 0.8041
EarlyStopping counter: 2 out of 25

Epoch 61/99
----------
train Loss: 0.9151 LRAP: 0.7124 NDCG: 0.7737
val Loss: 0.9736 LRAP: 0.7522 NDCG: 0.8017
EarlyStopping counter: 3 out of 25

Epoch 62/99
----------
train Loss: 0.9160 LRAP: 0.7080 NDCG: 0.7724
val Loss: 0.9749 LRAP: 0.7514 NDCG: 0.7992
EarlyStopping counter: 4 out of 25

Epoch 63/99
----------
train Loss: 0.9158 LRAP: 0.7101 NDCG: 0.7734
val Loss: 0.9742 LRAP: 0.7488 NDCG: 0.8018
EarlyStopping counter: 5 out of 25

Epoch 64/99
----------
train Loss: 0.9144 LRAP: 0.7109 NDCG: 0.7741
val Loss: 0.9731 LRAP: 0.7531 NDCG: 0.8029
Validation loss decreased (0.973328 --> 0.973115).  Saving model ...

Epoch 65/99
----------
train Loss: 0.9131 LRAP: 0.7101 NDCG: 0.7749
val Loss: 0.9742 LRAP: 0.7488 NDCG: 0.8001
EarlyStopping counter: 1 out of 25

Epoch 66/99
----------
train Loss: 0.9128 LRAP: 0.7114 NDCG: 0.7739
val Loss: 0.9740 LRAP: 0.7531 NDCG: 0.8005
EarlyStopping counter: 2 out of 25

Epoch 67/99
----------
train Loss: 0.9131 LRAP: 0.7138 NDCG: 0.7747
val Loss: 0.9735 LRAP: 0.7488 NDCG: 0.7997
EarlyStopping counter: 3 out of 25

Epoch 68/99
----------
train Loss: 0.9093 LRAP: 0.7107 NDCG: 0.7752
val Loss: 0.9730 LRAP: 0.7522 NDCG: 0.8026
Validation loss decreased (0.973115 --> 0.973030).  Saving model ...

Epoch 69/99
----------
train Loss: 0.9134 LRAP: 0.7103 NDCG: 0.7723
val Loss: 0.9743 LRAP: 0.7494 NDCG: 0.7997
EarlyStopping counter: 1 out of 25

Epoch 70/99
----------
train Loss: 0.9100 LRAP: 0.7099 NDCG: 0.7743
val Loss: 0.9747 LRAP: 0.7465 NDCG: 0.7985
EarlyStopping counter: 2 out of 25

Epoch 71/99
----------
train Loss: 0.9087 LRAP: 0.7124 NDCG: 0.7762
val Loss: 0.9747 LRAP: 0.7562 NDCG: 0.8038
EarlyStopping counter: 3 out of 25

Epoch 72/99
----------
train Loss: 0.9102 LRAP: 0.7126 NDCG: 0.7772
val Loss: 0.9745 LRAP: 0.7479 NDCG: 0.7976
EarlyStopping counter: 4 out of 25

Epoch 73/99
----------
train Loss: 0.9102 LRAP: 0.7076 NDCG: 0.7725
val Loss: 0.9726 LRAP: 0.7539 NDCG: 0.8029
Validation loss decreased (0.973030 --> 0.972647).  Saving model ...

Epoch 74/99
----------
train Loss: 0.9102 LRAP: 0.7068 NDCG: 0.7706
val Loss: 0.9736 LRAP: 0.7491 NDCG: 0.8009
EarlyStopping counter: 1 out of 25

Epoch 75/99
----------
train Loss: 0.9103 LRAP: 0.7101 NDCG: 0.7741
val Loss: 0.9739 LRAP: 0.7465 NDCG: 0.7969
EarlyStopping counter: 2 out of 25

Epoch 76/99
----------
train Loss: 0.9135 LRAP: 0.7139 NDCG: 0.7740
val Loss: 0.9727 LRAP: 0.7525 NDCG: 0.8026
EarlyStopping counter: 3 out of 25

Epoch 77/99
----------
train Loss: 0.9085 LRAP: 0.7135 NDCG: 0.7747
val Loss: 0.9729 LRAP: 0.7496 NDCG: 0.8015
EarlyStopping counter: 4 out of 25

Epoch 78/99
----------
train Loss: 0.9116 LRAP: 0.7078 NDCG: 0.7742
val Loss: 0.9742 LRAP: 0.7488 NDCG: 0.7989
EarlyStopping counter: 5 out of 25

Epoch 79/99
----------
train Loss: 0.9113 LRAP: 0.7109 NDCG: 0.7762
val Loss: 0.9741 LRAP: 0.7502 NDCG: 0.8016
EarlyStopping counter: 6 out of 25

Epoch 80/99
----------
train Loss: 0.9094 LRAP: 0.7102 NDCG: 0.7758
val Loss: 0.9735 LRAP: 0.7568 NDCG: 0.8039
EarlyStopping counter: 7 out of 25

Epoch 81/99
----------
train Loss: 0.9105 LRAP: 0.7103 NDCG: 0.7715
val Loss: 0.9729 LRAP: 0.7502 NDCG: 0.8038
EarlyStopping counter: 8 out of 25

Epoch 82/99
----------
train Loss: 0.9106 LRAP: 0.7143 NDCG: 0.7750
val Loss: 0.9732 LRAP: 0.7554 NDCG: 0.8017
EarlyStopping counter: 9 out of 25

Epoch 83/99
----------
train Loss: 0.9092 LRAP: 0.7120 NDCG: 0.7721
val Loss: 0.9727 LRAP: 0.7545 NDCG: 0.8040
EarlyStopping counter: 10 out of 25

Epoch 84/99
----------
train Loss: 0.9101 LRAP: 0.7102 NDCG: 0.7752
val Loss: 0.9750 LRAP: 0.7451 NDCG: 0.7961
EarlyStopping counter: 11 out of 25

Epoch 85/99
----------
train Loss: 0.9115 LRAP: 0.7121 NDCG: 0.7752
val Loss: 0.9742 LRAP: 0.7522 NDCG: 0.8015
EarlyStopping counter: 12 out of 25

Epoch 86/99
----------
train Loss: 0.9111 LRAP: 0.7116 NDCG: 0.7733
val Loss: 0.9737 LRAP: 0.7479 NDCG: 0.7987
EarlyStopping counter: 13 out of 25

Epoch 87/99
----------
train Loss: 0.9098 LRAP: 0.7126 NDCG: 0.7764
val Loss: 0.9737 LRAP: 0.7522 NDCG: 0.8016
EarlyStopping counter: 14 out of 25

Epoch 88/99
----------
train Loss: 0.9113 LRAP: 0.7112 NDCG: 0.7754
val Loss: 0.9744 LRAP: 0.7442 NDCG: 0.7955
EarlyStopping counter: 15 out of 25

Epoch 89/99
----------
train Loss: 0.9110 LRAP: 0.7095 NDCG: 0.7728
val Loss: 0.9733 LRAP: 0.7571 NDCG: 0.8051
EarlyStopping counter: 16 out of 25

Epoch 90/99
----------
train Loss: 0.9140 LRAP: 0.7084 NDCG: 0.7709
val Loss: 0.9730 LRAP: 0.7534 NDCG: 0.8033
EarlyStopping counter: 17 out of 25

Epoch 91/99
----------
train Loss: 0.9129 LRAP: 0.7127 NDCG: 0.7744
val Loss: 0.9727 LRAP: 0.7593 NDCG: 0.8066
EarlyStopping counter: 18 out of 25

Epoch 92/99
----------
train Loss: 0.9102 LRAP: 0.7118 NDCG: 0.7743
val Loss: 0.9732 LRAP: 0.7505 NDCG: 0.8004
EarlyStopping counter: 19 out of 25

Epoch 93/99
----------
train Loss: 0.9111 LRAP: 0.7079 NDCG: 0.7759
val Loss: 0.9732 LRAP: 0.7502 NDCG: 0.7993
EarlyStopping counter: 20 out of 25

Epoch 94/99
----------
train Loss: 0.9129 LRAP: 0.7079 NDCG: 0.7727
val Loss: 0.9744 LRAP: 0.7456 NDCG: 0.7954
EarlyStopping counter: 21 out of 25

Epoch 95/99
----------
train Loss: 0.9101 LRAP: 0.7113 NDCG: 0.7772
val Loss: 0.9729 LRAP: 0.7528 NDCG: 0.8029
EarlyStopping counter: 22 out of 25

Epoch 96/99
----------
train Loss: 0.9116 LRAP: 0.7112 NDCG: 0.7776
val Loss: 0.9729 LRAP: 0.7534 NDCG: 0.8047
EarlyStopping counter: 23 out of 25

Epoch 97/99
----------
train Loss: 0.9116 LRAP: 0.7124 NDCG: 0.7753
val Loss: 0.9737 LRAP: 0.7491 NDCG: 0.7995
EarlyStopping counter: 24 out of 25

Epoch 98/99
----------
train Loss: 0.9096 LRAP: 0.7107 NDCG: 0.7747
val Loss: 0.9735 LRAP: 0.7528 NDCG: 0.8039
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 9m 16s
Best val loss: 0.972647, best LRAP score: 0.9482

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 2/10

All random seeds set to: 421
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.6860 LRAP: 0.2269 NDCG: 0.5782
val Loss: 1.2553 LRAP: 0.5727 NDCG: 0.6919
Validation loss decreased (0.000000 --> 1.255299).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2124 LRAP: 0.6323 NDCG: 0.7204
val Loss: 1.1342 LRAP: 0.6569 NDCG: 0.7387
Validation loss decreased (1.255299 --> 1.134225).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1014 LRAP: 0.6793 NDCG: 0.7544
val Loss: 1.0398 LRAP: 0.6951 NDCG: 0.7626
Validation loss decreased (1.134225 --> 1.039754).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0584 LRAP: 0.6917 NDCG: 0.7698
val Loss: 1.0596 LRAP: 0.6660 NDCG: 0.7667
EarlyStopping counter: 1 out of 25

Epoch 4/99
----------
train Loss: 1.0233 LRAP: 0.7033 NDCG: 0.7867
val Loss: 1.0134 LRAP: 0.6977 NDCG: 0.7947
Validation loss decreased (1.039754 --> 1.013434).  Saving model ...

Epoch 5/99
----------
train Loss: 0.9893 LRAP: 0.7051 NDCG: 0.7963
val Loss: 0.9842 LRAP: 0.7182 NDCG: 0.7996
Validation loss decreased (1.013434 --> 0.984171).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9638 LRAP: 0.7101 NDCG: 0.8036
val Loss: 0.9807 LRAP: 0.7377 NDCG: 0.8217
Validation loss decreased (0.984171 --> 0.980739).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9484 LRAP: 0.7183 NDCG: 0.8149
val Loss: 0.9666 LRAP: 0.7371 NDCG: 0.8219
Validation loss decreased (0.980739 --> 0.966557).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9300 LRAP: 0.7267 NDCG: 0.8204
val Loss: 0.9511 LRAP: 0.7391 NDCG: 0.8282
Validation loss decreased (0.966557 --> 0.951062).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9116 LRAP: 0.7275 NDCG: 0.8265
val Loss: 0.9512 LRAP: 0.7448 NDCG: 0.8339
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9079 LRAP: 0.7356 NDCG: 0.8292
val Loss: 0.9394 LRAP: 0.7382 NDCG: 0.8356
Validation loss decreased (0.951062 --> 0.939408).  Saving model ...

Epoch 11/99
----------
train Loss: 0.8903 LRAP: 0.7424 NDCG: 0.8354
val Loss: 0.9615 LRAP: 0.7636 NDCG: 0.8426
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.8883 LRAP: 0.7434 NDCG: 0.8366
val Loss: 0.9449 LRAP: 0.6997 NDCG: 0.8215
EarlyStopping counter: 2 out of 25

Epoch 13/99
----------
train Loss: 0.8709 LRAP: 0.7440 NDCG: 0.8401
val Loss: 0.9481 LRAP: 0.7753 NDCG: 0.8492
EarlyStopping counter: 3 out of 25

Epoch 14/99
----------
train Loss: 0.8629 LRAP: 0.7543 NDCG: 0.8435
val Loss: 0.9333 LRAP: 0.7325 NDCG: 0.8383
Validation loss decreased (0.939408 --> 0.933316).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8601 LRAP: 0.7521 NDCG: 0.8401
val Loss: 0.9248 LRAP: 0.7873 NDCG: 0.8587
Validation loss decreased (0.933316 --> 0.924795).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8475 LRAP: 0.7628 NDCG: 0.8452
val Loss: 0.9271 LRAP: 0.7631 NDCG: 0.8504
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.8437 LRAP: 0.7630 NDCG: 0.8444
val Loss: 0.9239 LRAP: 0.7985 NDCG: 0.8603
Validation loss decreased (0.924795 --> 0.923884).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8353 LRAP: 0.7712 NDCG: 0.8392
val Loss: 0.9314 LRAP: 0.7659 NDCG: 0.8451
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.8316 LRAP: 0.7687 NDCG: 0.8407
val Loss: 0.9193 LRAP: 0.7905 NDCG: 0.8541
Validation loss decreased (0.923884 --> 0.919250).  Saving model ...

Epoch 20/99
----------
train Loss: 0.8279 LRAP: 0.7698 NDCG: 0.8338
val Loss: 0.9222 LRAP: 0.7842 NDCG: 0.8554
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 0.8213 LRAP: 0.7742 NDCG: 0.8357
val Loss: 0.9230 LRAP: 0.7651 NDCG: 0.8381
EarlyStopping counter: 2 out of 25

Epoch 22/99
----------
train Loss: 0.8167 LRAP: 0.7740 NDCG: 0.8261
val Loss: 0.9100 LRAP: 0.7671 NDCG: 0.8446
Validation loss decreased (0.919250 --> 0.910019).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8078 LRAP: 0.7837 NDCG: 0.8292
val Loss: 0.9078 LRAP: 0.8007 NDCG: 0.8551
Validation loss decreased (0.910019 --> 0.907799).  Saving model ...

Epoch 24/99
----------
train Loss: 0.8044 LRAP: 0.7813 NDCG: 0.8261
val Loss: 0.9157 LRAP: 0.8025 NDCG: 0.8475
EarlyStopping counter: 1 out of 25

Epoch 25/99
----------
train Loss: 0.7959 LRAP: 0.7868 NDCG: 0.8216
val Loss: 0.9066 LRAP: 0.8113 NDCG: 0.8577
Validation loss decreased (0.907799 --> 0.906557).  Saving model ...

Epoch 26/99
----------
train Loss: 0.7945 LRAP: 0.7811 NDCG: 0.8130
val Loss: 0.9265 LRAP: 0.7873 NDCG: 0.8453
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.7934 LRAP: 0.7886 NDCG: 0.8147
val Loss: 0.9066 LRAP: 0.7925 NDCG: 0.8506
EarlyStopping counter: 2 out of 25

Epoch 28/99
----------
train Loss: 0.7837 LRAP: 0.7928 NDCG: 0.8206
val Loss: 0.8964 LRAP: 0.8045 NDCG: 0.8488
Validation loss decreased (0.906557 --> 0.896384).  Saving model ...

Epoch 29/99
----------
train Loss: 0.7817 LRAP: 0.7924 NDCG: 0.8167
val Loss: 0.8932 LRAP: 0.7873 NDCG: 0.8449
Validation loss decreased (0.896384 --> 0.893197).  Saving model ...

Epoch 30/99
----------
train Loss: 0.7778 LRAP: 0.7908 NDCG: 0.8162
val Loss: 0.9046 LRAP: 0.8213 NDCG: 0.8550
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.7722 LRAP: 0.7901 NDCG: 0.8059
val Loss: 0.8984 LRAP: 0.7956 NDCG: 0.8494
EarlyStopping counter: 2 out of 25

Epoch 32/99
----------
train Loss: 0.7757 LRAP: 0.7962 NDCG: 0.8219
val Loss: 0.9054 LRAP: 0.8244 NDCG: 0.8557
EarlyStopping counter: 3 out of 25

Epoch 33/99
----------
train Loss: 0.7661 LRAP: 0.8010 NDCG: 0.8138
val Loss: 0.8983 LRAP: 0.8236 NDCG: 0.8563
EarlyStopping counter: 4 out of 25

Epoch 34/99
----------
train Loss: 0.7663 LRAP: 0.7999 NDCG: 0.8088
val Loss: 0.9033 LRAP: 0.8156 NDCG: 0.8410
EarlyStopping counter: 5 out of 25

Epoch 35/99
----------
train Loss: 0.7518 LRAP: 0.8045 NDCG: 0.8040
val Loss: 0.8857 LRAP: 0.8287 NDCG: 0.8541
Validation loss decreased (0.893197 --> 0.885725).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7420 LRAP: 0.8098 NDCG: 0.8115
val Loss: 0.8843 LRAP: 0.8307 NDCG: 0.8648
Validation loss decreased (0.885725 --> 0.884341).  Saving model ...

Epoch 37/99
----------
train Loss: 0.7384 LRAP: 0.8123 NDCG: 0.8159
val Loss: 0.8846 LRAP: 0.8299 NDCG: 0.8553
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.7361 LRAP: 0.8160 NDCG: 0.8111
val Loss: 0.8816 LRAP: 0.8327 NDCG: 0.8603
Validation loss decreased (0.884341 --> 0.881646).  Saving model ...

Epoch 39/99
----------
train Loss: 0.7340 LRAP: 0.8173 NDCG: 0.8177
val Loss: 0.8861 LRAP: 0.8347 NDCG: 0.8641
EarlyStopping counter: 1 out of 25

Epoch 40/99
----------
train Loss: 0.7319 LRAP: 0.8224 NDCG: 0.8223
val Loss: 0.8836 LRAP: 0.8330 NDCG: 0.8615
EarlyStopping counter: 2 out of 25

Epoch 41/99
----------
train Loss: 0.7315 LRAP: 0.8208 NDCG: 0.8205
val Loss: 0.8868 LRAP: 0.8310 NDCG: 0.8545
EarlyStopping counter: 3 out of 25

Epoch 42/99
----------
train Loss: 0.7285 LRAP: 0.8255 NDCG: 0.8235
val Loss: 0.8885 LRAP: 0.8433 NDCG: 0.8644
EarlyStopping counter: 4 out of 25

Epoch 43/99
----------
train Loss: 0.7256 LRAP: 0.8273 NDCG: 0.8218
val Loss: 0.8920 LRAP: 0.8304 NDCG: 0.8625
EarlyStopping counter: 5 out of 25

Epoch 44/99
----------
train Loss: 0.7254 LRAP: 0.8226 NDCG: 0.8239
val Loss: 0.8888 LRAP: 0.8396 NDCG: 0.8624
EarlyStopping counter: 6 out of 25

Epoch 45/99
----------
train Loss: 0.7225 LRAP: 0.8306 NDCG: 0.8252
val Loss: 0.8834 LRAP: 0.8384 NDCG: 0.8641
EarlyStopping counter: 7 out of 25

Epoch 46/99
----------
train Loss: 0.7220 LRAP: 0.8306 NDCG: 0.8297
val Loss: 0.8850 LRAP: 0.8384 NDCG: 0.8632
EarlyStopping counter: 8 out of 25

Epoch 47/99
----------
train Loss: 0.7228 LRAP: 0.8309 NDCG: 0.8329
val Loss: 0.8880 LRAP: 0.8376 NDCG: 0.8615
EarlyStopping counter: 9 out of 25

Epoch 48/99
----------
train Loss: 0.7208 LRAP: 0.8303 NDCG: 0.8289
val Loss: 0.8842 LRAP: 0.8401 NDCG: 0.8672
EarlyStopping counter: 10 out of 25

Epoch 49/99
----------
train Loss: 0.7198 LRAP: 0.8348 NDCG: 0.8341
val Loss: 0.8841 LRAP: 0.8373 NDCG: 0.8659
EarlyStopping counter: 11 out of 25

Epoch 50/99
----------
train Loss: 0.7202 LRAP: 0.8312 NDCG: 0.8289
val Loss: 0.8839 LRAP: 0.8393 NDCG: 0.8662
EarlyStopping counter: 12 out of 25

Epoch 51/99
----------
train Loss: 0.7200 LRAP: 0.8291 NDCG: 0.8318
val Loss: 0.8858 LRAP: 0.8399 NDCG: 0.8668
EarlyStopping counter: 13 out of 25

Epoch 52/99
----------
train Loss: 0.7208 LRAP: 0.8288 NDCG: 0.8252
val Loss: 0.8887 LRAP: 0.8319 NDCG: 0.8541
EarlyStopping counter: 14 out of 25

Epoch 53/99
----------
train Loss: 0.7206 LRAP: 0.8317 NDCG: 0.8314
val Loss: 0.8887 LRAP: 0.8376 NDCG: 0.8627
EarlyStopping counter: 15 out of 25

Epoch 54/99
----------
train Loss: 0.7177 LRAP: 0.8293 NDCG: 0.8280
val Loss: 0.8873 LRAP: 0.8339 NDCG: 0.8579
EarlyStopping counter: 16 out of 25

Epoch 55/99
----------
train Loss: 0.7195 LRAP: 0.8333 NDCG: 0.8311
val Loss: 0.8860 LRAP: 0.8356 NDCG: 0.8580
EarlyStopping counter: 17 out of 25

Epoch 56/99
----------
train Loss: 0.7184 LRAP: 0.8307 NDCG: 0.8281
val Loss: 0.8850 LRAP: 0.8399 NDCG: 0.8652
EarlyStopping counter: 18 out of 25

Epoch 57/99
----------
train Loss: 0.7194 LRAP: 0.8324 NDCG: 0.8276
val Loss: 0.8856 LRAP: 0.8376 NDCG: 0.8644
EarlyStopping counter: 19 out of 25

Epoch 58/99
----------
train Loss: 0.7198 LRAP: 0.8312 NDCG: 0.8283
val Loss: 0.8861 LRAP: 0.8344 NDCG: 0.8590
EarlyStopping counter: 20 out of 25

Epoch 59/99
----------
train Loss: 0.7207 LRAP: 0.8300 NDCG: 0.8250
val Loss: 0.8862 LRAP: 0.8387 NDCG: 0.8634
EarlyStopping counter: 21 out of 25

Epoch 60/99
----------
train Loss: 0.7192 LRAP: 0.8290 NDCG: 0.8247
val Loss: 0.8867 LRAP: 0.8410 NDCG: 0.8659
EarlyStopping counter: 22 out of 25

Epoch 61/99
----------
train Loss: 0.7193 LRAP: 0.8323 NDCG: 0.8321
val Loss: 0.8859 LRAP: 0.8364 NDCG: 0.8623
EarlyStopping counter: 23 out of 25

Epoch 62/99
----------
train Loss: 0.7203 LRAP: 0.8292 NDCG: 0.8258
val Loss: 0.8853 LRAP: 0.8418 NDCG: 0.8659
EarlyStopping counter: 24 out of 25

Epoch 63/99
----------
train Loss: 0.7186 LRAP: 0.8326 NDCG: 0.8312
val Loss: 0.8883 LRAP: 0.8341 NDCG: 0.8572
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 6m 9s
Best val loss: 0.881646, best LRAP score: 0.9632

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.6693 LRAP: 0.2698 NDCG: 0.6064
val Loss: 1.2285 LRAP: 0.5729 NDCG: 0.7175
Validation loss decreased (0.000000 --> 1.228495).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2050 LRAP: 0.6023 NDCG: 0.7398
val Loss: 1.1373 LRAP: 0.6138 NDCG: 0.7443
Validation loss decreased (1.228495 --> 1.137341).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1280 LRAP: 0.6419 NDCG: 0.7592
val Loss: 1.0626 LRAP: 0.6549 NDCG: 0.7729
Validation loss decreased (1.137341 --> 1.062624).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0844 LRAP: 0.6471 NDCG: 0.7720
val Loss: 1.0418 LRAP: 0.6794 NDCG: 0.7816
Validation loss decreased (1.062624 --> 1.041801).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0538 LRAP: 0.6606 NDCG: 0.7801
val Loss: 1.0492 LRAP: 0.6700 NDCG: 0.7818
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.0204 LRAP: 0.6715 NDCG: 0.7920
val Loss: 1.0066 LRAP: 0.7071 NDCG: 0.8103
Validation loss decreased (1.041801 --> 1.006613).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9917 LRAP: 0.6730 NDCG: 0.7956
val Loss: 0.9998 LRAP: 0.6917 NDCG: 0.8001
Validation loss decreased (1.006613 --> 0.999759).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9759 LRAP: 0.6861 NDCG: 0.8055
val Loss: 0.9877 LRAP: 0.7251 NDCG: 0.8234
Validation loss decreased (0.999759 --> 0.987652).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9510 LRAP: 0.6949 NDCG: 0.8129
val Loss: 0.9816 LRAP: 0.7174 NDCG: 0.8257
Validation loss decreased (0.987652 --> 0.981599).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9341 LRAP: 0.7028 NDCG: 0.8193
val Loss: 1.0002 LRAP: 0.7354 NDCG: 0.8288
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9275 LRAP: 0.7165 NDCG: 0.8248
val Loss: 0.9736 LRAP: 0.7448 NDCG: 0.8292
Validation loss decreased (0.981599 --> 0.973644).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9066 LRAP: 0.7238 NDCG: 0.8322
val Loss: 0.9523 LRAP: 0.7582 NDCG: 0.8448
Validation loss decreased (0.973644 --> 0.952267).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8904 LRAP: 0.7327 NDCG: 0.8395
val Loss: 0.9508 LRAP: 0.7622 NDCG: 0.8480
Validation loss decreased (0.952267 --> 0.950755).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8811 LRAP: 0.7401 NDCG: 0.8423
val Loss: 0.9500 LRAP: 0.7696 NDCG: 0.8502
Validation loss decreased (0.950755 --> 0.950004).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8709 LRAP: 0.7450 NDCG: 0.8440
val Loss: 0.9403 LRAP: 0.7682 NDCG: 0.8506
Validation loss decreased (0.950004 --> 0.940260).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8656 LRAP: 0.7506 NDCG: 0.8472
val Loss: 0.9454 LRAP: 0.7731 NDCG: 0.8516
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8578 LRAP: 0.7561 NDCG: 0.8464
val Loss: 0.9285 LRAP: 0.7782 NDCG: 0.8557
Validation loss decreased (0.940260 --> 0.928526).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8475 LRAP: 0.7529 NDCG: 0.8438
val Loss: 0.9263 LRAP: 0.7773 NDCG: 0.8539
Validation loss decreased (0.928526 --> 0.926266).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8393 LRAP: 0.7652 NDCG: 0.8473
val Loss: 0.9260 LRAP: 0.7633 NDCG: 0.8472
Validation loss decreased (0.926266 --> 0.926037).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8313 LRAP: 0.7754 NDCG: 0.8437
val Loss: 0.9344 LRAP: 0.7830 NDCG: 0.8525
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8300 LRAP: 0.7755 NDCG: 0.8429
val Loss: 0.9279 LRAP: 0.7848 NDCG: 0.8519
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 0.8224 LRAP: 0.7782 NDCG: 0.8404
val Loss: 0.9192 LRAP: 0.7602 NDCG: 0.8340
Validation loss decreased (0.926037 --> 0.919232).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8179 LRAP: 0.7810 NDCG: 0.8379
val Loss: 0.9234 LRAP: 0.8056 NDCG: 0.8635
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 0.8088 LRAP: 0.7824 NDCG: 0.8385
val Loss: 0.9297 LRAP: 0.8124 NDCG: 0.8658
EarlyStopping counter: 2 out of 25

Epoch 24/99
----------
train Loss: 0.8107 LRAP: 0.7843 NDCG: 0.8385
val Loss: 0.9107 LRAP: 0.8047 NDCG: 0.8562
Validation loss decreased (0.919232 --> 0.910725).  Saving model ...

Epoch 25/99
----------
train Loss: 0.8073 LRAP: 0.7873 NDCG: 0.8308
val Loss: 0.9139 LRAP: 0.8102 NDCG: 0.8530
EarlyStopping counter: 1 out of 25

Epoch 26/99
----------
train Loss: 0.7983 LRAP: 0.7862 NDCG: 0.8286
val Loss: 0.9088 LRAP: 0.8204 NDCG: 0.8646
Validation loss decreased (0.910725 --> 0.908750).  Saving model ...

Epoch 27/99
----------
train Loss: 0.7954 LRAP: 0.7908 NDCG: 0.8289
val Loss: 0.9187 LRAP: 0.7870 NDCG: 0.8396
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.7859 LRAP: 0.7873 NDCG: 0.8154
val Loss: 0.9160 LRAP: 0.7959 NDCG: 0.8245
EarlyStopping counter: 2 out of 25

Epoch 29/99
----------
train Loss: 0.7853 LRAP: 0.7900 NDCG: 0.8237
val Loss: 0.9021 LRAP: 0.8050 NDCG: 0.8448
Validation loss decreased (0.908750 --> 0.902139).  Saving model ...

Epoch 30/99
----------
train Loss: 0.7812 LRAP: 0.8017 NDCG: 0.8272
val Loss: 0.9160 LRAP: 0.7965 NDCG: 0.8480
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.7783 LRAP: 0.7968 NDCG: 0.8150
val Loss: 0.9069 LRAP: 0.8136 NDCG: 0.8527
EarlyStopping counter: 2 out of 25

Epoch 32/99
----------
train Loss: 0.7760 LRAP: 0.8030 NDCG: 0.8249
val Loss: 0.9130 LRAP: 0.8056 NDCG: 0.8444
EarlyStopping counter: 3 out of 25

Epoch 33/99
----------
train Loss: 0.7706 LRAP: 0.7958 NDCG: 0.8148
val Loss: 0.9109 LRAP: 0.7993 NDCG: 0.8401
EarlyStopping counter: 4 out of 25

Epoch 34/99
----------
train Loss: 0.7642 LRAP: 0.8047 NDCG: 0.8280
val Loss: 0.8990 LRAP: 0.8090 NDCG: 0.8470
Validation loss decreased (0.902139 --> 0.898963).  Saving model ...

Epoch 35/99
----------
train Loss: 0.7610 LRAP: 0.8074 NDCG: 0.8172
val Loss: 0.9018 LRAP: 0.8047 NDCG: 0.8484
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.7590 LRAP: 0.8112 NDCG: 0.8235
val Loss: 0.9087 LRAP: 0.8164 NDCG: 0.8509
EarlyStopping counter: 2 out of 25

Epoch 37/99
----------
train Loss: 0.7555 LRAP: 0.8107 NDCG: 0.8174
val Loss: 0.8956 LRAP: 0.8144 NDCG: 0.8614
Validation loss decreased (0.898963 --> 0.895551).  Saving model ...

Epoch 38/99
----------
train Loss: 0.7534 LRAP: 0.8067 NDCG: 0.8174
val Loss: 0.9020 LRAP: 0.8279 NDCG: 0.8565
EarlyStopping counter: 1 out of 25

Epoch 39/99
----------
train Loss: 0.7499 LRAP: 0.8139 NDCG: 0.8198
val Loss: 0.9002 LRAP: 0.8213 NDCG: 0.8475
EarlyStopping counter: 2 out of 25

Epoch 40/99
----------
train Loss: 0.7490 LRAP: 0.8140 NDCG: 0.8167
val Loss: 0.8911 LRAP: 0.8267 NDCG: 0.8470
Validation loss decreased (0.895551 --> 0.891057).  Saving model ...

Epoch 41/99
----------
train Loss: 0.7414 LRAP: 0.8142 NDCG: 0.8167
val Loss: 0.8982 LRAP: 0.8287 NDCG: 0.8540
EarlyStopping counter: 1 out of 25

Epoch 42/99
----------
train Loss: 0.7425 LRAP: 0.8192 NDCG: 0.8197
val Loss: 0.9019 LRAP: 0.8156 NDCG: 0.8550
EarlyStopping counter: 2 out of 25

Epoch 43/99
----------
train Loss: 0.7393 LRAP: 0.8199 NDCG: 0.8214
val Loss: 0.8959 LRAP: 0.8162 NDCG: 0.8492
EarlyStopping counter: 3 out of 25

Epoch 44/99
----------
train Loss: 0.7431 LRAP: 0.8152 NDCG: 0.8181
val Loss: 0.8909 LRAP: 0.8376 NDCG: 0.8697
Validation loss decreased (0.891057 --> 0.890889).  Saving model ...

Epoch 45/99
----------
train Loss: 0.7346 LRAP: 0.8191 NDCG: 0.8200
val Loss: 0.8956 LRAP: 0.8384 NDCG: 0.8658
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.7328 LRAP: 0.8254 NDCG: 0.8250
val Loss: 0.8995 LRAP: 0.8219 NDCG: 0.8525
EarlyStopping counter: 2 out of 25

Epoch 47/99
----------
train Loss: 0.7307 LRAP: 0.8193 NDCG: 0.8208
val Loss: 0.8959 LRAP: 0.8287 NDCG: 0.8550
EarlyStopping counter: 3 out of 25

Epoch 48/99
----------
train Loss: 0.7342 LRAP: 0.8174 NDCG: 0.8206
val Loss: 0.9006 LRAP: 0.8453 NDCG: 0.8640
EarlyStopping counter: 4 out of 25

Epoch 49/99
----------
train Loss: 0.7293 LRAP: 0.8246 NDCG: 0.8178
val Loss: 0.8951 LRAP: 0.8393 NDCG: 0.8773
EarlyStopping counter: 5 out of 25

Epoch 50/99
----------
train Loss: 0.7150 LRAP: 0.8272 NDCG: 0.8182
val Loss: 0.8817 LRAP: 0.8438 NDCG: 0.8660
Validation loss decreased (0.890889 --> 0.881699).  Saving model ...

Epoch 51/99
----------
train Loss: 0.7103 LRAP: 0.8352 NDCG: 0.8238
val Loss: 0.8803 LRAP: 0.8447 NDCG: 0.8691
Validation loss decreased (0.881699 --> 0.880349).  Saving model ...

Epoch 52/99
----------
train Loss: 0.7063 LRAP: 0.8381 NDCG: 0.8279
val Loss: 0.8788 LRAP: 0.8458 NDCG: 0.8683
Validation loss decreased (0.880349 --> 0.878848).  Saving model ...

Epoch 53/99
----------
train Loss: 0.7057 LRAP: 0.8365 NDCG: 0.8269
val Loss: 0.8799 LRAP: 0.8458 NDCG: 0.8676
EarlyStopping counter: 1 out of 25

Epoch 54/99
----------
train Loss: 0.7053 LRAP: 0.8381 NDCG: 0.8238
val Loss: 0.8804 LRAP: 0.8501 NDCG: 0.8753
EarlyStopping counter: 2 out of 25

Epoch 55/99
----------
train Loss: 0.7040 LRAP: 0.8411 NDCG: 0.8285
val Loss: 0.8796 LRAP: 0.8496 NDCG: 0.8736
EarlyStopping counter: 3 out of 25

Epoch 56/99
----------
train Loss: 0.7036 LRAP: 0.8420 NDCG: 0.8253
val Loss: 0.8819 LRAP: 0.8544 NDCG: 0.8765
EarlyStopping counter: 4 out of 25

Epoch 57/99
----------
train Loss: 0.7006 LRAP: 0.8419 NDCG: 0.8307
val Loss: 0.8825 LRAP: 0.8476 NDCG: 0.8645
EarlyStopping counter: 5 out of 25

Epoch 58/99
----------
train Loss: 0.6986 LRAP: 0.8458 NDCG: 0.8320
val Loss: 0.8817 LRAP: 0.8510 NDCG: 0.8709
EarlyStopping counter: 6 out of 25

Epoch 59/99
----------
train Loss: 0.6989 LRAP: 0.8419 NDCG: 0.8276
val Loss: 0.8820 LRAP: 0.8513 NDCG: 0.8716
EarlyStopping counter: 7 out of 25

Epoch 60/99
----------
train Loss: 0.6990 LRAP: 0.8436 NDCG: 0.8292
val Loss: 0.8823 LRAP: 0.8484 NDCG: 0.8662
EarlyStopping counter: 8 out of 25

Epoch 61/99
----------
train Loss: 0.6981 LRAP: 0.8470 NDCG: 0.8322
val Loss: 0.8823 LRAP: 0.8487 NDCG: 0.8684
EarlyStopping counter: 9 out of 25

Epoch 62/99
----------
train Loss: 0.6979 LRAP: 0.8457 NDCG: 0.8299
val Loss: 0.8819 LRAP: 0.8484 NDCG: 0.8669
EarlyStopping counter: 10 out of 25

Epoch 63/99
----------
train Loss: 0.6978 LRAP: 0.8455 NDCG: 0.8302
val Loss: 0.8806 LRAP: 0.8484 NDCG: 0.8675
EarlyStopping counter: 11 out of 25

Epoch 64/99
----------
train Loss: 0.6967 LRAP: 0.8446 NDCG: 0.8321
val Loss: 0.8839 LRAP: 0.8521 NDCG: 0.8690
EarlyStopping counter: 12 out of 25

Epoch 65/99
----------
train Loss: 0.6953 LRAP: 0.8465 NDCG: 0.8342
val Loss: 0.8811 LRAP: 0.8487 NDCG: 0.8675
EarlyStopping counter: 13 out of 25

Epoch 66/99
----------
train Loss: 0.6971 LRAP: 0.8465 NDCG: 0.8346
val Loss: 0.8812 LRAP: 0.8504 NDCG: 0.8682
EarlyStopping counter: 14 out of 25

Epoch 67/99
----------
train Loss: 0.6966 LRAP: 0.8449 NDCG: 0.8335
val Loss: 0.8832 LRAP: 0.8510 NDCG: 0.8672
EarlyStopping counter: 15 out of 25

Epoch 68/99
----------
train Loss: 0.6959 LRAP: 0.8479 NDCG: 0.8319
val Loss: 0.8817 LRAP: 0.8490 NDCG: 0.8663
EarlyStopping counter: 16 out of 25

Epoch 69/99
----------
train Loss: 0.6957 LRAP: 0.8463 NDCG: 0.8336
val Loss: 0.8810 LRAP: 0.8558 NDCG: 0.8746
EarlyStopping counter: 17 out of 25

Epoch 70/99
----------
train Loss: 0.6966 LRAP: 0.8453 NDCG: 0.8341
val Loss: 0.8826 LRAP: 0.8524 NDCG: 0.8711
EarlyStopping counter: 18 out of 25

Epoch 71/99
----------
train Loss: 0.6966 LRAP: 0.8476 NDCG: 0.8304
val Loss: 0.8806 LRAP: 0.8530 NDCG: 0.8733
EarlyStopping counter: 19 out of 25

Epoch 72/99
----------
train Loss: 0.6969 LRAP: 0.8463 NDCG: 0.8329
val Loss: 0.8818 LRAP: 0.8504 NDCG: 0.8678
EarlyStopping counter: 20 out of 25

Epoch 73/99
----------
train Loss: 0.6969 LRAP: 0.8423 NDCG: 0.8319
val Loss: 0.8827 LRAP: 0.8501 NDCG: 0.8647
EarlyStopping counter: 21 out of 25

Epoch 74/99
----------
train Loss: 0.6960 LRAP: 0.8460 NDCG: 0.8336
val Loss: 0.8821 LRAP: 0.8518 NDCG: 0.8672
EarlyStopping counter: 22 out of 25

Epoch 75/99
----------
train Loss: 0.6972 LRAP: 0.8448 NDCG: 0.8316
val Loss: 0.8818 LRAP: 0.8524 NDCG: 0.8692
EarlyStopping counter: 23 out of 25

Epoch 76/99
----------
train Loss: 0.6973 LRAP: 0.8465 NDCG: 0.8316
val Loss: 0.8816 LRAP: 0.8498 NDCG: 0.8674
EarlyStopping counter: 24 out of 25

Epoch 77/99
----------
train Loss: 0.6965 LRAP: 0.8482 NDCG: 0.8358
val Loss: 0.8824 LRAP: 0.8490 NDCG: 0.8637
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 19s
Best val loss: 0.878848, best LRAP score: 0.9635

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.8646 LRAP: 0.1562 NDCG: 0.5482
val Loss: 1.5040 LRAP: 0.4316 NDCG: 0.6589
Validation loss decreased (0.000000 --> 1.503998).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2957 LRAP: 0.5265 NDCG: 0.6840
val Loss: 1.2222 LRAP: 0.5552 NDCG: 0.6817
Validation loss decreased (1.503998 --> 1.222195).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1799 LRAP: 0.6225 NDCG: 0.7181
val Loss: 2.4099 LRAP: 0.1876 NDCG: 0.4926
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.1313 LRAP: 0.6442 NDCG: 0.7399
val Loss: 1.0980 LRAP: 0.6463 NDCG: 0.7380
Validation loss decreased (1.222195 --> 1.098002).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1055 LRAP: 0.6496 NDCG: 0.7483
val Loss: 1.1778 LRAP: 0.5729 NDCG: 0.7004
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.0742 LRAP: 0.6617 NDCG: 0.7553
val Loss: 1.0997 LRAP: 0.6092 NDCG: 0.7363
EarlyStopping counter: 2 out of 25

Epoch 6/99
----------
train Loss: 1.0599 LRAP: 0.6715 NDCG: 0.7638
val Loss: 1.0958 LRAP: 0.7068 NDCG: 0.7723
Validation loss decreased (1.098002 --> 1.095800).  Saving model ...

Epoch 7/99
----------
train Loss: 1.0427 LRAP: 0.6701 NDCG: 0.7660
val Loss: 1.1766 LRAP: 0.6737 NDCG: 0.7607
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 1.0367 LRAP: 0.6716 NDCG: 0.7735
val Loss: 1.0365 LRAP: 0.7054 NDCG: 0.7762
Validation loss decreased (1.095800 --> 1.036507).  Saving model ...

Epoch 9/99
----------
train Loss: 1.0247 LRAP: 0.6682 NDCG: 0.7744
val Loss: 1.0714 LRAP: 0.6866 NDCG: 0.7804
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 1.0043 LRAP: 0.6712 NDCG: 0.7782
val Loss: 1.0641 LRAP: 0.6035 NDCG: 0.7591
EarlyStopping counter: 2 out of 25

Epoch 11/99
----------
train Loss: 0.9930 LRAP: 0.6743 NDCG: 0.7861
val Loss: 1.0490 LRAP: 0.6489 NDCG: 0.7619
EarlyStopping counter: 3 out of 25

Epoch 12/99
----------
train Loss: 0.9878 LRAP: 0.6743 NDCG: 0.7881
val Loss: 1.0179 LRAP: 0.6203 NDCG: 0.7730
Validation loss decreased (1.036507 --> 1.017937).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9719 LRAP: 0.6785 NDCG: 0.7922
val Loss: 0.9969 LRAP: 0.7088 NDCG: 0.7993
Validation loss decreased (1.017937 --> 0.996877).  Saving model ...

Epoch 14/99
----------
train Loss: 0.9637 LRAP: 0.6759 NDCG: 0.7935
val Loss: 1.0495 LRAP: 0.6717 NDCG: 0.7940
EarlyStopping counter: 1 out of 25

Epoch 15/99
----------
train Loss: 0.9529 LRAP: 0.6757 NDCG: 0.7933
val Loss: 0.9908 LRAP: 0.7305 NDCG: 0.8119
Validation loss decreased (0.996877 --> 0.990832).  Saving model ...

Epoch 16/99
----------
train Loss: 0.9420 LRAP: 0.6825 NDCG: 0.7901
val Loss: 1.1458 LRAP: 0.6426 NDCG: 0.7719
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.9362 LRAP: 0.6847 NDCG: 0.7969
val Loss: 0.9954 LRAP: 0.7362 NDCG: 0.8191
EarlyStopping counter: 2 out of 25

Epoch 18/99
----------
train Loss: 0.9298 LRAP: 0.6904 NDCG: 0.7917
val Loss: 0.9773 LRAP: 0.6851 NDCG: 0.7969
Validation loss decreased (0.990832 --> 0.977289).  Saving model ...

Epoch 19/99
----------
train Loss: 0.9148 LRAP: 0.6931 NDCG: 0.7961
val Loss: 0.9954 LRAP: 0.7197 NDCG: 0.8007
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.9110 LRAP: 0.7048 NDCG: 0.8031
val Loss: 0.9750 LRAP: 0.7574 NDCG: 0.8304
Validation loss decreased (0.977289 --> 0.975007).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9063 LRAP: 0.7046 NDCG: 0.7927
val Loss: 0.9545 LRAP: 0.7339 NDCG: 0.8152
Validation loss decreased (0.975007 --> 0.954455).  Saving model ...

Epoch 22/99
----------
train Loss: 0.9038 LRAP: 0.7034 NDCG: 0.7876
val Loss: 1.0024 LRAP: 0.7045 NDCG: 0.7795
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 0.8979 LRAP: 0.7036 NDCG: 0.7852
val Loss: 0.9566 LRAP: 0.7408 NDCG: 0.8166
EarlyStopping counter: 2 out of 25

Epoch 24/99
----------
train Loss: 0.8872 LRAP: 0.7044 NDCG: 0.7780
val Loss: 0.9587 LRAP: 0.7494 NDCG: 0.8173
EarlyStopping counter: 3 out of 25

Epoch 25/99
----------
train Loss: 0.8838 LRAP: 0.7120 NDCG: 0.7821
val Loss: 0.9924 LRAP: 0.7162 NDCG: 0.7896
EarlyStopping counter: 4 out of 25

Epoch 26/99
----------
train Loss: 0.8808 LRAP: 0.7183 NDCG: 0.7843
val Loss: 0.9704 LRAP: 0.7399 NDCG: 0.7996
EarlyStopping counter: 5 out of 25

Epoch 27/99
----------
train Loss: 0.8587 LRAP: 0.7148 NDCG: 0.7797
val Loss: 0.9425 LRAP: 0.7502 NDCG: 0.8143
Validation loss decreased (0.954455 --> 0.942546).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8495 LRAP: 0.7263 NDCG: 0.7842
val Loss: 0.9379 LRAP: 0.7414 NDCG: 0.8069
Validation loss decreased (0.942546 --> 0.937947).  Saving model ...

Epoch 29/99
----------
train Loss: 0.8470 LRAP: 0.7151 NDCG: 0.7762
val Loss: 0.9369 LRAP: 0.7582 NDCG: 0.8198
Validation loss decreased (0.937947 --> 0.936895).  Saving model ...

Epoch 30/99
----------
train Loss: 0.8412 LRAP: 0.7250 NDCG: 0.7754
val Loss: 0.9382 LRAP: 0.7525 NDCG: 0.8108
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.8401 LRAP: 0.7242 NDCG: 0.7687
val Loss: 0.9366 LRAP: 0.7565 NDCG: 0.8093
Validation loss decreased (0.936895 --> 0.936557).  Saving model ...

Epoch 32/99
----------
train Loss: 0.8376 LRAP: 0.7251 NDCG: 0.7677
val Loss: 0.9342 LRAP: 0.7556 NDCG: 0.8119
Validation loss decreased (0.936557 --> 0.934211).  Saving model ...

Epoch 33/99
----------
train Loss: 0.8361 LRAP: 0.7328 NDCG: 0.7752
val Loss: 0.9362 LRAP: 0.7554 NDCG: 0.8087
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.8362 LRAP: 0.7267 NDCG: 0.7730
val Loss: 0.9325 LRAP: 0.7522 NDCG: 0.8079
Validation loss decreased (0.934211 --> 0.932487).  Saving model ...

Epoch 35/99
----------
train Loss: 0.8296 LRAP: 0.7321 NDCG: 0.7725
val Loss: 0.9315 LRAP: 0.7494 NDCG: 0.8035
Validation loss decreased (0.932487 --> 0.931475).  Saving model ...

Epoch 36/99
----------
train Loss: 0.8274 LRAP: 0.7351 NDCG: 0.7755
val Loss: 0.9324 LRAP: 0.7599 NDCG: 0.8090
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.8270 LRAP: 0.7341 NDCG: 0.7749
val Loss: 0.9345 LRAP: 0.7605 NDCG: 0.8047
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.8241 LRAP: 0.7375 NDCG: 0.7695
val Loss: 0.9369 LRAP: 0.7479 NDCG: 0.7943
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.8240 LRAP: 0.7309 NDCG: 0.7647
val Loss: 0.9316 LRAP: 0.7539 NDCG: 0.8053
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.8216 LRAP: 0.7347 NDCG: 0.7646
val Loss: 0.9296 LRAP: 0.7582 NDCG: 0.8050
Validation loss decreased (0.931475 --> 0.929587).  Saving model ...

Epoch 41/99
----------
train Loss: 0.8199 LRAP: 0.7380 NDCG: 0.7697
val Loss: 0.9282 LRAP: 0.7516 NDCG: 0.8033
Validation loss decreased (0.929587 --> 0.928155).  Saving model ...

Epoch 42/99
----------
train Loss: 0.8157 LRAP: 0.7362 NDCG: 0.7711
val Loss: 0.9379 LRAP: 0.7631 NDCG: 0.8092
EarlyStopping counter: 1 out of 25

Epoch 43/99
----------
train Loss: 0.8175 LRAP: 0.7346 NDCG: 0.7713
val Loss: 0.9305 LRAP: 0.7659 NDCG: 0.8196
EarlyStopping counter: 2 out of 25

Epoch 44/99
----------
train Loss: 0.8139 LRAP: 0.7402 NDCG: 0.7686
val Loss: 0.9318 LRAP: 0.7648 NDCG: 0.8055
EarlyStopping counter: 3 out of 25

Epoch 45/99
----------
train Loss: 0.8119 LRAP: 0.7461 NDCG: 0.7724
val Loss: 0.9266 LRAP: 0.7673 NDCG: 0.8185
Validation loss decreased (0.928155 --> 0.926590).  Saving model ...

Epoch 46/99
----------
train Loss: 0.8107 LRAP: 0.7430 NDCG: 0.7718
val Loss: 0.9289 LRAP: 0.7519 NDCG: 0.7960
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.8075 LRAP: 0.7444 NDCG: 0.7717
val Loss: 0.9302 LRAP: 0.7548 NDCG: 0.8037
EarlyStopping counter: 2 out of 25

Epoch 48/99
----------
train Loss: 0.8055 LRAP: 0.7447 NDCG: 0.7675
val Loss: 0.9254 LRAP: 0.7688 NDCG: 0.8124
Validation loss decreased (0.926590 --> 0.925422).  Saving model ...

Epoch 49/99
----------
train Loss: 0.8054 LRAP: 0.7458 NDCG: 0.7710
val Loss: 0.9370 LRAP: 0.7465 NDCG: 0.7894
EarlyStopping counter: 1 out of 25

Epoch 50/99
----------
train Loss: 0.8028 LRAP: 0.7476 NDCG: 0.7683
val Loss: 0.9231 LRAP: 0.7665 NDCG: 0.8095
Validation loss decreased (0.925422 --> 0.923132).  Saving model ...

Epoch 51/99
----------
train Loss: 0.8038 LRAP: 0.7488 NDCG: 0.7676
val Loss: 0.9247 LRAP: 0.7511 NDCG: 0.8014
EarlyStopping counter: 1 out of 25

Epoch 52/99
----------
train Loss: 0.8015 LRAP: 0.7503 NDCG: 0.7742
val Loss: 0.9284 LRAP: 0.7645 NDCG: 0.8002
EarlyStopping counter: 2 out of 25

Epoch 53/99
----------
train Loss: 0.7995 LRAP: 0.7522 NDCG: 0.7650
val Loss: 0.9240 LRAP: 0.7605 NDCG: 0.8019
EarlyStopping counter: 3 out of 25

Epoch 54/99
----------
train Loss: 0.7968 LRAP: 0.7530 NDCG: 0.7651
val Loss: 0.9273 LRAP: 0.7688 NDCG: 0.8090
EarlyStopping counter: 4 out of 25

Epoch 55/99
----------
train Loss: 0.7966 LRAP: 0.7526 NDCG: 0.7641
val Loss: 0.9246 LRAP: 0.7516 NDCG: 0.8106
EarlyStopping counter: 5 out of 25

Epoch 56/99
----------
train Loss: 0.7880 LRAP: 0.7529 NDCG: 0.7715
val Loss: 0.9186 LRAP: 0.7682 NDCG: 0.8069
Validation loss decreased (0.923132 --> 0.918571).  Saving model ...

Epoch 57/99
----------
train Loss: 0.7875 LRAP: 0.7559 NDCG: 0.7724
val Loss: 0.9196 LRAP: 0.7770 NDCG: 0.8178
EarlyStopping counter: 1 out of 25

Epoch 58/99
----------
train Loss: 0.7835 LRAP: 0.7570 NDCG: 0.7709
val Loss: 0.9188 LRAP: 0.7639 NDCG: 0.7971
EarlyStopping counter: 2 out of 25

Epoch 59/99
----------
train Loss: 0.7832 LRAP: 0.7608 NDCG: 0.7694
val Loss: 0.9160 LRAP: 0.7736 NDCG: 0.8111
Validation loss decreased (0.918571 --> 0.916049).  Saving model ...

Epoch 60/99
----------
train Loss: 0.7839 LRAP: 0.7569 NDCG: 0.7697
val Loss: 0.9189 LRAP: 0.7788 NDCG: 0.8239
EarlyStopping counter: 1 out of 25

Epoch 61/99
----------
train Loss: 0.7822 LRAP: 0.7625 NDCG: 0.7731
val Loss: 0.9185 LRAP: 0.7742 NDCG: 0.8101
EarlyStopping counter: 2 out of 25

Epoch 62/99
----------
train Loss: 0.7827 LRAP: 0.7578 NDCG: 0.7679
val Loss: 0.9184 LRAP: 0.7779 NDCG: 0.8123
EarlyStopping counter: 3 out of 25

Epoch 63/99
----------
train Loss: 0.7836 LRAP: 0.7570 NDCG: 0.7651
val Loss: 0.9207 LRAP: 0.7716 NDCG: 0.8057
EarlyStopping counter: 4 out of 25

Epoch 64/99
----------
train Loss: 0.7821 LRAP: 0.7619 NDCG: 0.7668
val Loss: 0.9178 LRAP: 0.7733 NDCG: 0.8092
EarlyStopping counter: 5 out of 25

Epoch 65/99
----------
train Loss: 0.7794 LRAP: 0.7605 NDCG: 0.7682
val Loss: 0.9171 LRAP: 0.7810 NDCG: 0.8177
EarlyStopping counter: 6 out of 25

Epoch 66/99
----------
train Loss: 0.7783 LRAP: 0.7623 NDCG: 0.7689
val Loss: 0.9173 LRAP: 0.7799 NDCG: 0.8155
EarlyStopping counter: 7 out of 25

Epoch 67/99
----------
train Loss: 0.7793 LRAP: 0.7635 NDCG: 0.7722
val Loss: 0.9197 LRAP: 0.7790 NDCG: 0.8121
EarlyStopping counter: 8 out of 25

Epoch 68/99
----------
train Loss: 0.7792 LRAP: 0.7603 NDCG: 0.7674
val Loss: 0.9190 LRAP: 0.7731 NDCG: 0.8065
EarlyStopping counter: 9 out of 25

Epoch 69/99
----------
train Loss: 0.7803 LRAP: 0.7601 NDCG: 0.7673
val Loss: 0.9174 LRAP: 0.7828 NDCG: 0.8174
EarlyStopping counter: 10 out of 25

Epoch 70/99
----------
train Loss: 0.7793 LRAP: 0.7632 NDCG: 0.7737
val Loss: 0.9197 LRAP: 0.7805 NDCG: 0.8088
EarlyStopping counter: 11 out of 25

Epoch 71/99
----------
train Loss: 0.7780 LRAP: 0.7611 NDCG: 0.7682
val Loss: 0.9183 LRAP: 0.7828 NDCG: 0.8198
EarlyStopping counter: 12 out of 25

Epoch 72/99
----------
train Loss: 0.7785 LRAP: 0.7589 NDCG: 0.7657
val Loss: 0.9192 LRAP: 0.7802 NDCG: 0.8151
EarlyStopping counter: 13 out of 25

Epoch 73/99
----------
train Loss: 0.7779 LRAP: 0.7627 NDCG: 0.7705
val Loss: 0.9180 LRAP: 0.7728 NDCG: 0.8104
EarlyStopping counter: 14 out of 25

Epoch 74/99
----------
train Loss: 0.7788 LRAP: 0.7638 NDCG: 0.7690
val Loss: 0.9190 LRAP: 0.7828 NDCG: 0.8140
EarlyStopping counter: 15 out of 25

Epoch 75/99
----------
train Loss: 0.7799 LRAP: 0.7603 NDCG: 0.7695
val Loss: 0.9184 LRAP: 0.7782 NDCG: 0.8094
EarlyStopping counter: 16 out of 25

Epoch 76/99
----------
train Loss: 0.7786 LRAP: 0.7610 NDCG: 0.7631
val Loss: 0.9187 LRAP: 0.7759 NDCG: 0.8069
EarlyStopping counter: 17 out of 25

Epoch 77/99
----------
train Loss: 0.7783 LRAP: 0.7621 NDCG: 0.7663
val Loss: 0.9166 LRAP: 0.7819 NDCG: 0.8207
EarlyStopping counter: 18 out of 25

Epoch 78/99
----------
train Loss: 0.7762 LRAP: 0.7615 NDCG: 0.7651
val Loss: 0.9186 LRAP: 0.7673 NDCG: 0.7930
EarlyStopping counter: 19 out of 25

Epoch 79/99
----------
train Loss: 0.7780 LRAP: 0.7642 NDCG: 0.7712
val Loss: 0.9198 LRAP: 0.7696 NDCG: 0.7962
EarlyStopping counter: 20 out of 25

Epoch 80/99
----------
train Loss: 0.7786 LRAP: 0.7606 NDCG: 0.7696
val Loss: 0.9206 LRAP: 0.7782 NDCG: 0.8092
EarlyStopping counter: 21 out of 25

Epoch 81/99
----------
train Loss: 0.7789 LRAP: 0.7592 NDCG: 0.7659
val Loss: 0.9212 LRAP: 0.7793 NDCG: 0.8075
EarlyStopping counter: 22 out of 25

Epoch 82/99
----------
train Loss: 0.7786 LRAP: 0.7628 NDCG: 0.7690
val Loss: 0.9185 LRAP: 0.7702 NDCG: 0.7972
EarlyStopping counter: 23 out of 25

Epoch 83/99
----------
train Loss: 0.7804 LRAP: 0.7624 NDCG: 0.7663
val Loss: 0.9179 LRAP: 0.7731 NDCG: 0.8051
EarlyStopping counter: 24 out of 25

Epoch 84/99
----------
train Loss: 0.7797 LRAP: 0.7618 NDCG: 0.7676
val Loss: 0.9189 LRAP: 0.7799 NDCG: 0.8116
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 8m 17s
Best val loss: 0.916049, best LRAP score: 0.9568

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.8895 LRAP: 0.1551 NDCG: 0.5484
val Loss: 2.1426 LRAP: 0.3089 NDCG: 0.5354
Validation loss decreased (0.000000 --> 2.142565).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3383 LRAP: 0.5595 NDCG: 0.6901
val Loss: 1.4338 LRAP: 0.5821 NDCG: 0.6922
Validation loss decreased (2.142565 --> 1.433804).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2603 LRAP: 0.6173 NDCG: 0.7091
val Loss: 1.3398 LRAP: 0.6566 NDCG: 0.7380
Validation loss decreased (1.433804 --> 1.339840).  Saving model ...

Epoch 3/99
----------
train Loss: 1.2296 LRAP: 0.6231 NDCG: 0.7180
val Loss: 1.3989 LRAP: 0.7034 NDCG: 0.7615
EarlyStopping counter: 1 out of 25

Epoch 4/99
----------
train Loss: 1.1999 LRAP: 0.6285 NDCG: 0.7254
val Loss: 1.1952 LRAP: 0.6343 NDCG: 0.7176
Validation loss decreased (1.339840 --> 1.195174).  Saving model ...

Epoch 5/99
----------
train Loss: 1.1737 LRAP: 0.6252 NDCG: 0.7340
val Loss: 1.4149 LRAP: 0.5156 NDCG: 0.7046
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.1669 LRAP: 0.6218 NDCG: 0.7343
val Loss: 1.1735 LRAP: 0.6306 NDCG: 0.7363
Validation loss decreased (1.195174 --> 1.173470).  Saving model ...

Epoch 7/99
----------
train Loss: 1.1470 LRAP: 0.6187 NDCG: 0.7395
val Loss: 1.1551 LRAP: 0.6046 NDCG: 0.7200
Validation loss decreased (1.173470 --> 1.155079).  Saving model ...

Epoch 8/99
----------
train Loss: 1.1295 LRAP: 0.6184 NDCG: 0.7432
val Loss: 1.4035 LRAP: 0.3617 NDCG: 0.6564
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 1.1157 LRAP: 0.6304 NDCG: 0.7513
val Loss: 1.1558 LRAP: 0.6295 NDCG: 0.7513
EarlyStopping counter: 2 out of 25

Epoch 10/99
----------
train Loss: 1.1023 LRAP: 0.6305 NDCG: 0.7542
val Loss: 1.1386 LRAP: 0.6657 NDCG: 0.7571
Validation loss decreased (1.155079 --> 1.138637).  Saving model ...

Epoch 11/99
----------
train Loss: 1.0917 LRAP: 0.6269 NDCG: 0.7569
val Loss: 1.0951 LRAP: 0.6355 NDCG: 0.7597
Validation loss decreased (1.138637 --> 1.095117).  Saving model ...

Epoch 12/99
----------
train Loss: 1.0808 LRAP: 0.6391 NDCG: 0.7621
val Loss: 1.1137 LRAP: 0.6577 NDCG: 0.7766
EarlyStopping counter: 1 out of 25

Epoch 13/99
----------
train Loss: 1.0704 LRAP: 0.6340 NDCG: 0.7611
val Loss: 1.2121 LRAP: 0.5013 NDCG: 0.7073
EarlyStopping counter: 2 out of 25

Epoch 14/99
----------
train Loss: 1.0534 LRAP: 0.6433 NDCG: 0.7659
val Loss: 1.2378 LRAP: 0.5227 NDCG: 0.7129
EarlyStopping counter: 3 out of 25

Epoch 15/99
----------
train Loss: 1.0462 LRAP: 0.6466 NDCG: 0.7670
val Loss: 1.2180 LRAP: 0.4776 NDCG: 0.7136
EarlyStopping counter: 4 out of 25

Epoch 16/99
----------
train Loss: 1.0400 LRAP: 0.6459 NDCG: 0.7691
val Loss: 1.0845 LRAP: 0.6512 NDCG: 0.7716
Validation loss decreased (1.095117 --> 1.084479).  Saving model ...

Epoch 17/99
----------
train Loss: 1.0302 LRAP: 0.6428 NDCG: 0.7678
val Loss: 1.1453 LRAP: 0.5281 NDCG: 0.7284
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 1.0183 LRAP: 0.6556 NDCG: 0.7731
val Loss: 1.0429 LRAP: 0.6740 NDCG: 0.7852
Validation loss decreased (1.084479 --> 1.042928).  Saving model ...

Epoch 19/99
----------
train Loss: 1.0108 LRAP: 0.6535 NDCG: 0.7717
val Loss: 1.0990 LRAP: 0.6543 NDCG: 0.7718
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 1.0023 LRAP: 0.6622 NDCG: 0.7728
val Loss: 1.0177 LRAP: 0.7074 NDCG: 0.8039
Validation loss decreased (1.042928 --> 1.017658).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9952 LRAP: 0.6698 NDCG: 0.7759
val Loss: 1.0226 LRAP: 0.6983 NDCG: 0.8026
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.9929 LRAP: 0.6576 NDCG: 0.7649
val Loss: 1.1020 LRAP: 0.6734 NDCG: 0.7677
EarlyStopping counter: 2 out of 25

Epoch 23/99
----------
train Loss: 0.9849 LRAP: 0.6701 NDCG: 0.7736
val Loss: 1.0167 LRAP: 0.7200 NDCG: 0.7975
Validation loss decreased (1.017658 --> 1.016717).  Saving model ...

Epoch 24/99
----------
train Loss: 0.9797 LRAP: 0.6707 NDCG: 0.7664
val Loss: 1.0220 LRAP: 0.6720 NDCG: 0.7726
EarlyStopping counter: 1 out of 25

Epoch 25/99
----------
train Loss: 0.9677 LRAP: 0.6713 NDCG: 0.7625
val Loss: 1.0074 LRAP: 0.7100 NDCG: 0.7965
Validation loss decreased (1.016717 --> 1.007371).  Saving model ...

Epoch 26/99
----------
train Loss: 0.9635 LRAP: 0.6795 NDCG: 0.7685
val Loss: 1.0268 LRAP: 0.6423 NDCG: 0.7770
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.9612 LRAP: 0.6782 NDCG: 0.7651
val Loss: 1.1404 LRAP: 0.4607 NDCG: 0.6915
EarlyStopping counter: 2 out of 25

Epoch 28/99
----------
train Loss: 0.9575 LRAP: 0.6816 NDCG: 0.7623
val Loss: 0.9948 LRAP: 0.7248 NDCG: 0.8026
Validation loss decreased (1.007371 --> 0.994776).  Saving model ...

Epoch 29/99
----------
train Loss: 0.9527 LRAP: 0.6797 NDCG: 0.7667
val Loss: 0.9977 LRAP: 0.7374 NDCG: 0.8079
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.9441 LRAP: 0.6861 NDCG: 0.7628
val Loss: 0.9963 LRAP: 0.7060 NDCG: 0.7775
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.9349 LRAP: 0.6929 NDCG: 0.7638
val Loss: 0.9837 LRAP: 0.6209 NDCG: 0.7574
Validation loss decreased (0.994776 --> 0.983667).  Saving model ...

Epoch 32/99
----------
train Loss: 0.9352 LRAP: 0.6930 NDCG: 0.7612
val Loss: 0.9801 LRAP: 0.7197 NDCG: 0.7889
Validation loss decreased (0.983667 --> 0.980079).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9317 LRAP: 0.6964 NDCG: 0.7615
val Loss: 0.9710 LRAP: 0.7257 NDCG: 0.7761
Validation loss decreased (0.980079 --> 0.971047).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9249 LRAP: 0.6998 NDCG: 0.7592
val Loss: 0.9935 LRAP: 0.7425 NDCG: 0.8058
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.9232 LRAP: 0.7014 NDCG: 0.7595
val Loss: 1.0286 LRAP: 0.6983 NDCG: 0.7521
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.9213 LRAP: 0.7047 NDCG: 0.7623
val Loss: 0.9807 LRAP: 0.7428 NDCG: 0.7915
EarlyStopping counter: 3 out of 25

Epoch 37/99
----------
train Loss: 0.9169 LRAP: 0.7069 NDCG: 0.7568
val Loss: 0.9712 LRAP: 0.7488 NDCG: 0.8043
EarlyStopping counter: 4 out of 25

Epoch 38/99
----------
train Loss: 0.9150 LRAP: 0.7061 NDCG: 0.7529
val Loss: 0.9717 LRAP: 0.7496 NDCG: 0.7836
EarlyStopping counter: 5 out of 25

Epoch 39/99
----------
train Loss: 0.8892 LRAP: 0.7217 NDCG: 0.7594
val Loss: 0.9489 LRAP: 0.7522 NDCG: 0.7871
Validation loss decreased (0.971047 --> 0.948943).  Saving model ...

Epoch 40/99
----------
train Loss: 0.8822 LRAP: 0.7221 NDCG: 0.7574
val Loss: 0.9502 LRAP: 0.7605 NDCG: 0.7980
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.8817 LRAP: 0.7227 NDCG: 0.7581
val Loss: 0.9481 LRAP: 0.7613 NDCG: 0.8020
Validation loss decreased (0.948943 --> 0.948127).  Saving model ...

Epoch 42/99
----------
train Loss: 0.8777 LRAP: 0.7227 NDCG: 0.7591
val Loss: 0.9537 LRAP: 0.7482 NDCG: 0.7626
EarlyStopping counter: 1 out of 25

Epoch 43/99
----------
train Loss: 0.8764 LRAP: 0.7239 NDCG: 0.7601
val Loss: 0.9492 LRAP: 0.7642 NDCG: 0.7947
EarlyStopping counter: 2 out of 25

Epoch 44/99
----------
train Loss: 0.8738 LRAP: 0.7292 NDCG: 0.7588
val Loss: 0.9463 LRAP: 0.7588 NDCG: 0.7905
Validation loss decreased (0.948127 --> 0.946349).  Saving model ...

Epoch 45/99
----------
train Loss: 0.8731 LRAP: 0.7230 NDCG: 0.7579
val Loss: 0.9474 LRAP: 0.7682 NDCG: 0.7974
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.8710 LRAP: 0.7283 NDCG: 0.7599
val Loss: 0.9489 LRAP: 0.7616 NDCG: 0.7785
EarlyStopping counter: 2 out of 25

Epoch 47/99
----------
train Loss: 0.8679 LRAP: 0.7307 NDCG: 0.7618
val Loss: 0.9469 LRAP: 0.7653 NDCG: 0.7989
EarlyStopping counter: 3 out of 25

Epoch 48/99
----------
train Loss: 0.8672 LRAP: 0.7314 NDCG: 0.7639
val Loss: 0.9496 LRAP: 0.7671 NDCG: 0.7975
EarlyStopping counter: 4 out of 25

Epoch 49/99
----------
train Loss: 0.8650 LRAP: 0.7310 NDCG: 0.7603
val Loss: 0.9544 LRAP: 0.7725 NDCG: 0.8102
EarlyStopping counter: 5 out of 25

Epoch 50/99
----------
train Loss: 0.8618 LRAP: 0.7293 NDCG: 0.7533
val Loss: 0.9428 LRAP: 0.7673 NDCG: 0.7992
Validation loss decreased (0.946349 --> 0.942777).  Saving model ...

Epoch 51/99
----------
train Loss: 0.8592 LRAP: 0.7331 NDCG: 0.7612
val Loss: 0.9440 LRAP: 0.7591 NDCG: 0.7855
EarlyStopping counter: 1 out of 25

Epoch 52/99
----------
train Loss: 0.8576 LRAP: 0.7309 NDCG: 0.7569
val Loss: 0.9431 LRAP: 0.7642 NDCG: 0.7901
EarlyStopping counter: 2 out of 25

Epoch 53/99
----------
train Loss: 0.8556 LRAP: 0.7368 NDCG: 0.7586
val Loss: 0.9434 LRAP: 0.7696 NDCG: 0.7985
EarlyStopping counter: 3 out of 25

Epoch 54/99
----------
train Loss: 0.8572 LRAP: 0.7327 NDCG: 0.7587
val Loss: 0.9446 LRAP: 0.7639 NDCG: 0.7851
EarlyStopping counter: 4 out of 25

Epoch 55/99
----------
train Loss: 0.8558 LRAP: 0.7372 NDCG: 0.7614
val Loss: 0.9418 LRAP: 0.7671 NDCG: 0.7935
Validation loss decreased (0.942777 --> 0.941782).  Saving model ...

Epoch 56/99
----------
train Loss: 0.8576 LRAP: 0.7368 NDCG: 0.7601
val Loss: 0.9421 LRAP: 0.7651 NDCG: 0.7900
EarlyStopping counter: 1 out of 25

Epoch 57/99
----------
train Loss: 0.8565 LRAP: 0.7371 NDCG: 0.7595
val Loss: 0.9414 LRAP: 0.7636 NDCG: 0.7923
Validation loss decreased (0.941782 --> 0.941372).  Saving model ...

Epoch 58/99
----------
train Loss: 0.8562 LRAP: 0.7362 NDCG: 0.7623
val Loss: 0.9436 LRAP: 0.7633 NDCG: 0.7926
EarlyStopping counter: 1 out of 25

Epoch 59/99
----------
train Loss: 0.8546 LRAP: 0.7351 NDCG: 0.7596
val Loss: 0.9444 LRAP: 0.7622 NDCG: 0.7830
EarlyStopping counter: 2 out of 25

Epoch 60/99
----------
train Loss: 0.8568 LRAP: 0.7359 NDCG: 0.7606
val Loss: 0.9417 LRAP: 0.7665 NDCG: 0.7931
EarlyStopping counter: 3 out of 25

Epoch 61/99
----------
train Loss: 0.8533 LRAP: 0.7361 NDCG: 0.7641
val Loss: 0.9434 LRAP: 0.7673 NDCG: 0.7957
EarlyStopping counter: 4 out of 25

Epoch 62/99
----------
train Loss: 0.8539 LRAP: 0.7351 NDCG: 0.7602
val Loss: 0.9439 LRAP: 0.7642 NDCG: 0.7876
EarlyStopping counter: 5 out of 25

Epoch 63/99
----------
train Loss: 0.8507 LRAP: 0.7340 NDCG: 0.7635
val Loss: 0.9422 LRAP: 0.7653 NDCG: 0.7877
EarlyStopping counter: 6 out of 25

Epoch 64/99
----------
train Loss: 0.8534 LRAP: 0.7359 NDCG: 0.7585
val Loss: 0.9419 LRAP: 0.7651 NDCG: 0.7895
EarlyStopping counter: 7 out of 25

Epoch 65/99
----------
train Loss: 0.8511 LRAP: 0.7361 NDCG: 0.7626
val Loss: 0.9431 LRAP: 0.7653 NDCG: 0.7875
EarlyStopping counter: 8 out of 25

Epoch 66/99
----------
train Loss: 0.8527 LRAP: 0.7375 NDCG: 0.7606
val Loss: 0.9426 LRAP: 0.7659 NDCG: 0.7883
EarlyStopping counter: 9 out of 25

Epoch 67/99
----------
train Loss: 0.8534 LRAP: 0.7364 NDCG: 0.7647
val Loss: 0.9418 LRAP: 0.7676 NDCG: 0.7963
EarlyStopping counter: 10 out of 25

Epoch 68/99
----------
train Loss: 0.8540 LRAP: 0.7376 NDCG: 0.7619
val Loss: 0.9407 LRAP: 0.7676 NDCG: 0.7940
Validation loss decreased (0.941372 --> 0.940737).  Saving model ...

Epoch 69/99
----------
train Loss: 0.8535 LRAP: 0.7363 NDCG: 0.7622
val Loss: 0.9430 LRAP: 0.7682 NDCG: 0.7980
EarlyStopping counter: 1 out of 25

Epoch 70/99
----------
train Loss: 0.8521 LRAP: 0.7326 NDCG: 0.7595
val Loss: 0.9427 LRAP: 0.7671 NDCG: 0.7963
EarlyStopping counter: 2 out of 25

Epoch 71/99
----------
train Loss: 0.8520 LRAP: 0.7355 NDCG: 0.7582
val Loss: 0.9437 LRAP: 0.7588 NDCG: 0.7757
EarlyStopping counter: 3 out of 25

Epoch 72/99
----------
train Loss: 0.8514 LRAP: 0.7369 NDCG: 0.7620
val Loss: 0.9414 LRAP: 0.7676 NDCG: 0.8007
EarlyStopping counter: 4 out of 25

Epoch 73/99
----------
train Loss: 0.8519 LRAP: 0.7342 NDCG: 0.7626
val Loss: 0.9437 LRAP: 0.7668 NDCG: 0.7914
EarlyStopping counter: 5 out of 25

Epoch 74/99
----------
train Loss: 0.8522 LRAP: 0.7367 NDCG: 0.7614
val Loss: 0.9414 LRAP: 0.7665 NDCG: 0.7929
EarlyStopping counter: 6 out of 25

Epoch 75/99
----------
train Loss: 0.8507 LRAP: 0.7368 NDCG: 0.7650
val Loss: 0.9406 LRAP: 0.7628 NDCG: 0.7889
Validation loss decreased (0.940737 --> 0.940592).  Saving model ...

Epoch 76/99
----------
train Loss: 0.8513 LRAP: 0.7357 NDCG: 0.7622
val Loss: 0.9410 LRAP: 0.7656 NDCG: 0.7930
EarlyStopping counter: 1 out of 25

Epoch 77/99
----------
train Loss: 0.8516 LRAP: 0.7360 NDCG: 0.7606
val Loss: 0.9431 LRAP: 0.7673 NDCG: 0.7977
EarlyStopping counter: 2 out of 25

Epoch 78/99
----------
train Loss: 0.8500 LRAP: 0.7389 NDCG: 0.7600
val Loss: 0.9434 LRAP: 0.7691 NDCG: 0.7998
EarlyStopping counter: 3 out of 25

Epoch 79/99
----------
train Loss: 0.8504 LRAP: 0.7342 NDCG: 0.7574
val Loss: 0.9420 LRAP: 0.7662 NDCG: 0.7910
EarlyStopping counter: 4 out of 25

Epoch 80/99
----------
train Loss: 0.8529 LRAP: 0.7375 NDCG: 0.7599
val Loss: 0.9436 LRAP: 0.7642 NDCG: 0.7871
EarlyStopping counter: 5 out of 25

Epoch 81/99
----------
train Loss: 0.8525 LRAP: 0.7327 NDCG: 0.7573
val Loss: 0.9419 LRAP: 0.7676 NDCG: 0.7937
EarlyStopping counter: 6 out of 25

Epoch 82/99
----------
train Loss: 0.8529 LRAP: 0.7368 NDCG: 0.7590
val Loss: 0.9421 LRAP: 0.7648 NDCG: 0.7859
EarlyStopping counter: 7 out of 25

Epoch 83/99
----------
train Loss: 0.8513 LRAP: 0.7376 NDCG: 0.7608
val Loss: 0.9420 LRAP: 0.7673 NDCG: 0.7922
EarlyStopping counter: 8 out of 25

Epoch 84/99
----------
train Loss: 0.8504 LRAP: 0.7314 NDCG: 0.7579
val Loss: 0.9420 LRAP: 0.7693 NDCG: 0.7953
EarlyStopping counter: 9 out of 25

Epoch 85/99
----------
train Loss: 0.8486 LRAP: 0.7377 NDCG: 0.7607
val Loss: 0.9430 LRAP: 0.7645 NDCG: 0.7904
EarlyStopping counter: 10 out of 25

Epoch 86/99
----------
train Loss: 0.8484 LRAP: 0.7365 NDCG: 0.7642
val Loss: 0.9403 LRAP: 0.7668 NDCG: 0.7965
Validation loss decreased (0.940592 --> 0.940324).  Saving model ...

Epoch 87/99
----------
train Loss: 0.8523 LRAP: 0.7343 NDCG: 0.7576
val Loss: 0.9431 LRAP: 0.7656 NDCG: 0.7893
EarlyStopping counter: 1 out of 25

Epoch 88/99
----------
train Loss: 0.8500 LRAP: 0.7359 NDCG: 0.7620
val Loss: 0.9429 LRAP: 0.7613 NDCG: 0.7821
EarlyStopping counter: 2 out of 25

Epoch 89/99
----------
train Loss: 0.8505 LRAP: 0.7370 NDCG: 0.7606
val Loss: 0.9416 LRAP: 0.7653 NDCG: 0.7960
EarlyStopping counter: 3 out of 25

Epoch 90/99
----------
train Loss: 0.8492 LRAP: 0.7354 NDCG: 0.7609
val Loss: 0.9430 LRAP: 0.7648 NDCG: 0.7899
EarlyStopping counter: 4 out of 25

Epoch 91/99
----------
train Loss: 0.8490 LRAP: 0.7378 NDCG: 0.7611
val Loss: 0.9411 LRAP: 0.7679 NDCG: 0.7941
EarlyStopping counter: 5 out of 25

Epoch 92/99
----------
train Loss: 0.8524 LRAP: 0.7347 NDCG: 0.7606
val Loss: 0.9426 LRAP: 0.7622 NDCG: 0.7893
EarlyStopping counter: 6 out of 25

Epoch 93/99
----------
train Loss: 0.8523 LRAP: 0.7347 NDCG: 0.7603
val Loss: 0.9410 LRAP: 0.7662 NDCG: 0.7917
EarlyStopping counter: 7 out of 25

Epoch 94/99
----------
train Loss: 0.8508 LRAP: 0.7362 NDCG: 0.7579
val Loss: 0.9415 LRAP: 0.7665 NDCG: 0.7932
EarlyStopping counter: 8 out of 25

Epoch 95/99
----------
train Loss: 0.8515 LRAP: 0.7352 NDCG: 0.7616
val Loss: 0.9429 LRAP: 0.7673 NDCG: 0.7986
EarlyStopping counter: 9 out of 25

Epoch 96/99
----------
train Loss: 0.8523 LRAP: 0.7341 NDCG: 0.7617
val Loss: 0.9421 LRAP: 0.7691 NDCG: 0.7954
EarlyStopping counter: 10 out of 25

Epoch 97/99
----------
train Loss: 0.8502 LRAP: 0.7370 NDCG: 0.7605
val Loss: 0.9421 LRAP: 0.7639 NDCG: 0.7837
EarlyStopping counter: 11 out of 25

Epoch 98/99
----------
train Loss: 0.8516 LRAP: 0.7376 NDCG: 0.7637
val Loss: 0.9424 LRAP: 0.7645 NDCG: 0.7927
EarlyStopping counter: 12 out of 25

Epoch 99/99
----------
train Loss: 0.8521 LRAP: 0.7346 NDCG: 0.7632
val Loss: 0.9425 LRAP: 0.7676 NDCG: 0.7949
EarlyStopping counter: 13 out of 25

Training complete in 9m 34s
Best val loss: 0.940324, best LRAP score: 0.9513

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 3/10

All random seeds set to: 422
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7273 LRAP: 0.2393 NDCG: 0.5737
val Loss: 1.2573 LRAP: 0.5866 NDCG: 0.7136
Validation loss decreased (0.000000 --> 1.257314).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2017 LRAP: 0.5987 NDCG: 0.7288
val Loss: 1.0830 LRAP: 0.7011 NDCG: 0.7805
Validation loss decreased (1.257314 --> 1.083005).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1103 LRAP: 0.6534 NDCG: 0.7611
val Loss: 1.0411 LRAP: 0.6843 NDCG: 0.7876
Validation loss decreased (1.083005 --> 1.041069).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0663 LRAP: 0.6680 NDCG: 0.7753
val Loss: 1.0243 LRAP: 0.7045 NDCG: 0.7925
Validation loss decreased (1.041069 --> 1.024263).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0242 LRAP: 0.6842 NDCG: 0.7907
val Loss: 1.0161 LRAP: 0.7202 NDCG: 0.8023
Validation loss decreased (1.024263 --> 1.016148).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0066 LRAP: 0.6989 NDCG: 0.7982
val Loss: 1.0115 LRAP: 0.7128 NDCG: 0.8072
Validation loss decreased (1.016148 --> 1.011480).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9786 LRAP: 0.6986 NDCG: 0.8036
val Loss: 0.9769 LRAP: 0.7331 NDCG: 0.8128
Validation loss decreased (1.011480 --> 0.976862).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9628 LRAP: 0.7099 NDCG: 0.8114
val Loss: 1.0046 LRAP: 0.7125 NDCG: 0.8161
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 0.9528 LRAP: 0.7016 NDCG: 0.8118
val Loss: 0.9608 LRAP: 0.7325 NDCG: 0.8259
Validation loss decreased (0.976862 --> 0.960768).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9335 LRAP: 0.7125 NDCG: 0.8197
val Loss: 0.9462 LRAP: 0.7716 NDCG: 0.8413
Validation loss decreased (0.960768 --> 0.946235).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9118 LRAP: 0.7271 NDCG: 0.8290
val Loss: 0.9339 LRAP: 0.7397 NDCG: 0.8267
Validation loss decreased (0.946235 --> 0.933925).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9108 LRAP: 0.7238 NDCG: 0.8278
val Loss: 0.9363 LRAP: 0.7397 NDCG: 0.8323
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.8953 LRAP: 0.7340 NDCG: 0.8310
val Loss: 0.9243 LRAP: 0.7571 NDCG: 0.8413
Validation loss decreased (0.933925 --> 0.924338).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8842 LRAP: 0.7474 NDCG: 0.8384
val Loss: 0.9341 LRAP: 0.7836 NDCG: 0.8537
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.8831 LRAP: 0.7475 NDCG: 0.8395
val Loss: 0.9202 LRAP: 0.7608 NDCG: 0.8475
Validation loss decreased (0.924338 --> 0.920221).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8812 LRAP: 0.7387 NDCG: 0.8347
val Loss: 0.9124 LRAP: 0.7779 NDCG: 0.8532
Validation loss decreased (0.920221 --> 0.912393).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8639 LRAP: 0.7523 NDCG: 0.8382
val Loss: 0.9183 LRAP: 0.7762 NDCG: 0.8518
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.8611 LRAP: 0.7512 NDCG: 0.8331
val Loss: 0.9207 LRAP: 0.7793 NDCG: 0.8514
EarlyStopping counter: 2 out of 25

Epoch 18/99
----------
train Loss: 0.8576 LRAP: 0.7549 NDCG: 0.8324
val Loss: 0.9048 LRAP: 0.7953 NDCG: 0.8635
Validation loss decreased (0.912393 --> 0.904763).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8525 LRAP: 0.7606 NDCG: 0.8380
val Loss: 0.9153 LRAP: 0.7819 NDCG: 0.8544
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8468 LRAP: 0.7628 NDCG: 0.8287
val Loss: 0.9051 LRAP: 0.7736 NDCG: 0.8371
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 0.8328 LRAP: 0.7729 NDCG: 0.8248
val Loss: 0.9171 LRAP: 0.8059 NDCG: 0.8514
EarlyStopping counter: 3 out of 25

Epoch 22/99
----------
train Loss: 0.8320 LRAP: 0.7731 NDCG: 0.8295
val Loss: 0.8932 LRAP: 0.8056 NDCG: 0.8506
Validation loss decreased (0.904763 --> 0.893215).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8253 LRAP: 0.7758 NDCG: 0.8167
val Loss: 0.8890 LRAP: 0.8119 NDCG: 0.8529
Validation loss decreased (0.893215 --> 0.889034).  Saving model ...

Epoch 24/99
----------
train Loss: 0.8203 LRAP: 0.7796 NDCG: 0.8194
val Loss: 0.9300 LRAP: 0.7908 NDCG: 0.8305
EarlyStopping counter: 1 out of 25

Epoch 25/99
----------
train Loss: 0.8158 LRAP: 0.7787 NDCG: 0.8181
val Loss: 0.8938 LRAP: 0.8204 NDCG: 0.8474
EarlyStopping counter: 2 out of 25

Epoch 26/99
----------
train Loss: 0.8137 LRAP: 0.7818 NDCG: 0.8153
val Loss: 0.8919 LRAP: 0.8190 NDCG: 0.8482
EarlyStopping counter: 3 out of 25

Epoch 27/99
----------
train Loss: 0.8096 LRAP: 0.7790 NDCG: 0.8090
val Loss: 0.8829 LRAP: 0.8187 NDCG: 0.8559
Validation loss decreased (0.889034 --> 0.882923).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8058 LRAP: 0.7816 NDCG: 0.8137
val Loss: 0.8900 LRAP: 0.8084 NDCG: 0.8508
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.8011 LRAP: 0.7817 NDCG: 0.8157
val Loss: 0.8885 LRAP: 0.8162 NDCG: 0.8519
EarlyStopping counter: 2 out of 25

Epoch 30/99
----------
train Loss: 0.7956 LRAP: 0.7879 NDCG: 0.8027
val Loss: 0.8859 LRAP: 0.8122 NDCG: 0.8436
EarlyStopping counter: 3 out of 25

Epoch 31/99
----------
train Loss: 0.7895 LRAP: 0.7926 NDCG: 0.8086
val Loss: 0.8937 LRAP: 0.8179 NDCG: 0.8363
EarlyStopping counter: 4 out of 25

Epoch 32/99
----------
train Loss: 0.7903 LRAP: 0.7912 NDCG: 0.8051
val Loss: 0.8940 LRAP: 0.8019 NDCG: 0.8482
EarlyStopping counter: 5 out of 25

Epoch 33/99
----------
train Loss: 0.7686 LRAP: 0.8025 NDCG: 0.8176
val Loss: 0.8687 LRAP: 0.8290 NDCG: 0.8534
Validation loss decreased (0.882923 --> 0.868748).  Saving model ...

Epoch 34/99
----------
train Loss: 0.7609 LRAP: 0.8039 NDCG: 0.8092
val Loss: 0.8705 LRAP: 0.8236 NDCG: 0.8469
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.7554 LRAP: 0.8097 NDCG: 0.8128
val Loss: 0.8685 LRAP: 0.8296 NDCG: 0.8538
Validation loss decreased (0.868748 --> 0.868546).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7526 LRAP: 0.8078 NDCG: 0.8115
val Loss: 0.8714 LRAP: 0.8361 NDCG: 0.8529
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.7516 LRAP: 0.8115 NDCG: 0.8138
val Loss: 0.8691 LRAP: 0.8284 NDCG: 0.8532
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.7483 LRAP: 0.8125 NDCG: 0.8153
val Loss: 0.8703 LRAP: 0.8359 NDCG: 0.8596
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.7480 LRAP: 0.8173 NDCG: 0.8211
val Loss: 0.8695 LRAP: 0.8370 NDCG: 0.8570
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.7435 LRAP: 0.8153 NDCG: 0.8131
val Loss: 0.8711 LRAP: 0.8336 NDCG: 0.8473
EarlyStopping counter: 5 out of 25

Epoch 41/99
----------
train Loss: 0.7401 LRAP: 0.8142 NDCG: 0.8071
val Loss: 0.8718 LRAP: 0.8321 NDCG: 0.8479
EarlyStopping counter: 6 out of 25

Epoch 42/99
----------
train Loss: 0.7397 LRAP: 0.8151 NDCG: 0.8097
val Loss: 0.8698 LRAP: 0.8359 NDCG: 0.8569
EarlyStopping counter: 7 out of 25

Epoch 43/99
----------
train Loss: 0.7383 LRAP: 0.8177 NDCG: 0.8096
val Loss: 0.8709 LRAP: 0.8324 NDCG: 0.8517
EarlyStopping counter: 8 out of 25

Epoch 44/99
----------
train Loss: 0.7364 LRAP: 0.8171 NDCG: 0.8156
val Loss: 0.8751 LRAP: 0.8310 NDCG: 0.8479
EarlyStopping counter: 9 out of 25

Epoch 45/99
----------
train Loss: 0.7385 LRAP: 0.8164 NDCG: 0.8131
val Loss: 0.8734 LRAP: 0.8356 NDCG: 0.8552
EarlyStopping counter: 10 out of 25

Epoch 46/99
----------
train Loss: 0.7377 LRAP: 0.8192 NDCG: 0.8140
val Loss: 0.8742 LRAP: 0.8341 NDCG: 0.8533
EarlyStopping counter: 11 out of 25

Epoch 47/99
----------
train Loss: 0.7345 LRAP: 0.8175 NDCG: 0.8159
val Loss: 0.8743 LRAP: 0.8396 NDCG: 0.8573
EarlyStopping counter: 12 out of 25

Epoch 48/99
----------
train Loss: 0.7373 LRAP: 0.8194 NDCG: 0.8177
val Loss: 0.8730 LRAP: 0.8367 NDCG: 0.8564
EarlyStopping counter: 13 out of 25

Epoch 49/99
----------
train Loss: 0.7358 LRAP: 0.8184 NDCG: 0.8143
val Loss: 0.8731 LRAP: 0.8373 NDCG: 0.8560
EarlyStopping counter: 14 out of 25

Epoch 50/99
----------
train Loss: 0.7369 LRAP: 0.8180 NDCG: 0.8156
val Loss: 0.8715 LRAP: 0.8367 NDCG: 0.8575
EarlyStopping counter: 15 out of 25

Epoch 51/99
----------
train Loss: 0.7351 LRAP: 0.8192 NDCG: 0.8143
val Loss: 0.8732 LRAP: 0.8373 NDCG: 0.8556
EarlyStopping counter: 16 out of 25

Epoch 52/99
----------
train Loss: 0.7365 LRAP: 0.8203 NDCG: 0.8152
val Loss: 0.8718 LRAP: 0.8336 NDCG: 0.8551
EarlyStopping counter: 17 out of 25

Epoch 53/99
----------
train Loss: 0.7358 LRAP: 0.8201 NDCG: 0.8146
val Loss: 0.8738 LRAP: 0.8367 NDCG: 0.8541
EarlyStopping counter: 18 out of 25

Epoch 54/99
----------
train Loss: 0.7359 LRAP: 0.8176 NDCG: 0.8123
val Loss: 0.8752 LRAP: 0.8339 NDCG: 0.8522
EarlyStopping counter: 19 out of 25

Epoch 55/99
----------
train Loss: 0.7358 LRAP: 0.8197 NDCG: 0.8136
val Loss: 0.8774 LRAP: 0.8301 NDCG: 0.8449
EarlyStopping counter: 20 out of 25

Epoch 56/99
----------
train Loss: 0.7350 LRAP: 0.8216 NDCG: 0.8169
val Loss: 0.8763 LRAP: 0.8244 NDCG: 0.8409
EarlyStopping counter: 21 out of 25

Epoch 57/99
----------
train Loss: 0.7344 LRAP: 0.8198 NDCG: 0.8173
val Loss: 0.8763 LRAP: 0.8224 NDCG: 0.8408
EarlyStopping counter: 22 out of 25

Epoch 58/99
----------
train Loss: 0.7356 LRAP: 0.8174 NDCG: 0.8141
val Loss: 0.8736 LRAP: 0.8327 NDCG: 0.8492
EarlyStopping counter: 23 out of 25

Epoch 59/99
----------
train Loss: 0.7352 LRAP: 0.8178 NDCG: 0.8115
val Loss: 0.8753 LRAP: 0.8321 NDCG: 0.8515
EarlyStopping counter: 24 out of 25

Epoch 60/99
----------
train Loss: 0.7357 LRAP: 0.8170 NDCG: 0.8132
val Loss: 0.8723 LRAP: 0.8373 NDCG: 0.8579
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 5m 55s
Best val loss: 0.868546, best LRAP score: 0.9648

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.8030 LRAP: 0.1967 NDCG: 0.5524
val Loss: 1.4288 LRAP: 0.4276 NDCG: 0.6298
Validation loss decreased (0.000000 --> 1.428816).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3233 LRAP: 0.5398 NDCG: 0.6869
val Loss: 1.1780 LRAP: 0.6297 NDCG: 0.7239
Validation loss decreased (1.428816 --> 1.178028).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1789 LRAP: 0.6247 NDCG: 0.7350
val Loss: 1.0878 LRAP: 0.6417 NDCG: 0.7453
Validation loss decreased (1.178028 --> 1.087760).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1368 LRAP: 0.6359 NDCG: 0.7473
val Loss: 1.0608 LRAP: 0.6757 NDCG: 0.7689
Validation loss decreased (1.087760 --> 1.060754).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0862 LRAP: 0.6635 NDCG: 0.7640
val Loss: 1.0574 LRAP: 0.6623 NDCG: 0.7752
Validation loss decreased (1.060754 --> 1.057425).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0487 LRAP: 0.6640 NDCG: 0.7699
val Loss: 1.0265 LRAP: 0.6971 NDCG: 0.7866
Validation loss decreased (1.057425 --> 1.026547).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0294 LRAP: 0.6632 NDCG: 0.7755
val Loss: 1.0393 LRAP: 0.6674 NDCG: 0.7768
EarlyStopping counter: 1 out of 25

Epoch 7/99
----------
train Loss: 1.0017 LRAP: 0.6770 NDCG: 0.7856
val Loss: 1.0087 LRAP: 0.6808 NDCG: 0.7898
Validation loss decreased (1.026547 --> 1.008739).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9903 LRAP: 0.6853 NDCG: 0.7893
val Loss: 0.9798 LRAP: 0.6971 NDCG: 0.7943
Validation loss decreased (1.008739 --> 0.979821).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9670 LRAP: 0.6852 NDCG: 0.7965
val Loss: 0.9658 LRAP: 0.7034 NDCG: 0.8089
Validation loss decreased (0.979821 --> 0.965801).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9482 LRAP: 0.6845 NDCG: 0.8015
val Loss: 0.9612 LRAP: 0.7063 NDCG: 0.8045
Validation loss decreased (0.965801 --> 0.961223).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9421 LRAP: 0.6929 NDCG: 0.8073
val Loss: 0.9404 LRAP: 0.7105 NDCG: 0.8169
Validation loss decreased (0.961223 --> 0.940382).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9266 LRAP: 0.7091 NDCG: 0.8141
val Loss: 0.9343 LRAP: 0.7131 NDCG: 0.8162
Validation loss decreased (0.940382 --> 0.934279).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9127 LRAP: 0.7184 NDCG: 0.8166
val Loss: 0.9345 LRAP: 0.7311 NDCG: 0.8264
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.9018 LRAP: 0.7222 NDCG: 0.8196
val Loss: 0.9283 LRAP: 0.7496 NDCG: 0.8314
Validation loss decreased (0.934279 --> 0.928257).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8921 LRAP: 0.7252 NDCG: 0.8216
val Loss: 0.9100 LRAP: 0.7579 NDCG: 0.8400
Validation loss decreased (0.928257 --> 0.909973).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8840 LRAP: 0.7310 NDCG: 0.8184
val Loss: 0.9085 LRAP: 0.7611 NDCG: 0.8417
Validation loss decreased (0.909973 --> 0.908535).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8768 LRAP: 0.7362 NDCG: 0.8216
val Loss: 0.9081 LRAP: 0.7648 NDCG: 0.8418
Validation loss decreased (0.908535 --> 0.908138).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8713 LRAP: 0.7392 NDCG: 0.8132
val Loss: 0.9097 LRAP: 0.7716 NDCG: 0.8458
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.8597 LRAP: 0.7403 NDCG: 0.8161
val Loss: 0.9196 LRAP: 0.7728 NDCG: 0.8367
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 0.8572 LRAP: 0.7488 NDCG: 0.8117
val Loss: 0.9246 LRAP: 0.7705 NDCG: 0.8330
EarlyStopping counter: 3 out of 25

Epoch 21/99
----------
train Loss: 0.8528 LRAP: 0.7510 NDCG: 0.8119
val Loss: 0.9084 LRAP: 0.7785 NDCG: 0.8342
EarlyStopping counter: 4 out of 25

Epoch 22/99
----------
train Loss: 0.8411 LRAP: 0.7509 NDCG: 0.7963
val Loss: 0.9096 LRAP: 0.7833 NDCG: 0.8372
EarlyStopping counter: 5 out of 25

Epoch 23/99
----------
train Loss: 0.8243 LRAP: 0.7609 NDCG: 0.8073
val Loss: 0.8872 LRAP: 0.7913 NDCG: 0.8416
Validation loss decreased (0.908138 --> 0.887157).  Saving model ...

Epoch 24/99
----------
train Loss: 0.8114 LRAP: 0.7630 NDCG: 0.8026
val Loss: 0.8861 LRAP: 0.7868 NDCG: 0.8269
Validation loss decreased (0.887157 --> 0.886095).  Saving model ...

Epoch 25/99
----------
train Loss: 0.8060 LRAP: 0.7663 NDCG: 0.8023
val Loss: 0.8843 LRAP: 0.8016 NDCG: 0.8411
Validation loss decreased (0.886095 --> 0.884265).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8062 LRAP: 0.7683 NDCG: 0.7986
val Loss: 0.8873 LRAP: 0.7959 NDCG: 0.8344
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.8018 LRAP: 0.7694 NDCG: 0.7993
val Loss: 0.8870 LRAP: 0.7987 NDCG: 0.8346
EarlyStopping counter: 2 out of 25

Epoch 28/99
----------
train Loss: 0.7970 LRAP: 0.7720 NDCG: 0.7999
val Loss: 0.8845 LRAP: 0.8042 NDCG: 0.8417
EarlyStopping counter: 3 out of 25

Epoch 29/99
----------
train Loss: 0.7953 LRAP: 0.7734 NDCG: 0.8043
val Loss: 0.8814 LRAP: 0.7945 NDCG: 0.8354
Validation loss decreased (0.884265 --> 0.881414).  Saving model ...

Epoch 30/99
----------
train Loss: 0.7931 LRAP: 0.7799 NDCG: 0.8036
val Loss: 0.8836 LRAP: 0.8042 NDCG: 0.8339
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.7944 LRAP: 0.7720 NDCG: 0.7957
val Loss: 0.8865 LRAP: 0.7976 NDCG: 0.8294
EarlyStopping counter: 2 out of 25

Epoch 32/99
----------
train Loss: 0.7898 LRAP: 0.7762 NDCG: 0.7961
val Loss: 0.8875 LRAP: 0.8119 NDCG: 0.8413
EarlyStopping counter: 3 out of 25

Epoch 33/99
----------
train Loss: 0.7907 LRAP: 0.7791 NDCG: 0.7988
val Loss: 0.8865 LRAP: 0.7987 NDCG: 0.8343
EarlyStopping counter: 4 out of 25

Epoch 34/99
----------
train Loss: 0.7851 LRAP: 0.7806 NDCG: 0.7961
val Loss: 0.8821 LRAP: 0.8022 NDCG: 0.8409
EarlyStopping counter: 5 out of 25

Epoch 35/99
----------
train Loss: 0.7787 LRAP: 0.7832 NDCG: 0.8005
val Loss: 0.8820 LRAP: 0.8056 NDCG: 0.8367
EarlyStopping counter: 6 out of 25

Epoch 36/99
----------
train Loss: 0.7779 LRAP: 0.7832 NDCG: 0.7992
val Loss: 0.8813 LRAP: 0.8116 NDCG: 0.8444
Validation loss decreased (0.881414 --> 0.881318).  Saving model ...

Epoch 37/99
----------
train Loss: 0.7764 LRAP: 0.7864 NDCG: 0.7984
val Loss: 0.8816 LRAP: 0.8124 NDCG: 0.8400
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.7765 LRAP: 0.7837 NDCG: 0.7985
val Loss: 0.8798 LRAP: 0.8133 NDCG: 0.8448
Validation loss decreased (0.881318 --> 0.879822).  Saving model ...

Epoch 39/99
----------
train Loss: 0.7769 LRAP: 0.7823 NDCG: 0.7993
val Loss: 0.8806 LRAP: 0.8062 NDCG: 0.8341
EarlyStopping counter: 1 out of 25

Epoch 40/99
----------
train Loss: 0.7740 LRAP: 0.7890 NDCG: 0.8062
val Loss: 0.8802 LRAP: 0.8079 NDCG: 0.8382
EarlyStopping counter: 2 out of 25

Epoch 41/99
----------
train Loss: 0.7749 LRAP: 0.7863 NDCG: 0.7998
val Loss: 0.8818 LRAP: 0.8067 NDCG: 0.8367
EarlyStopping counter: 3 out of 25

Epoch 42/99
----------
train Loss: 0.7726 LRAP: 0.7883 NDCG: 0.8032
val Loss: 0.8813 LRAP: 0.8099 NDCG: 0.8421
EarlyStopping counter: 4 out of 25

Epoch 43/99
----------
train Loss: 0.7725 LRAP: 0.7898 NDCG: 0.8019
val Loss: 0.8825 LRAP: 0.8062 NDCG: 0.8344
EarlyStopping counter: 5 out of 25

Epoch 44/99
----------
train Loss: 0.7707 LRAP: 0.7909 NDCG: 0.8074
val Loss: 0.8823 LRAP: 0.8144 NDCG: 0.8437
EarlyStopping counter: 6 out of 25

Epoch 45/99
----------
train Loss: 0.7719 LRAP: 0.7871 NDCG: 0.8045
val Loss: 0.8810 LRAP: 0.8073 NDCG: 0.8372
EarlyStopping counter: 7 out of 25

Epoch 46/99
----------
train Loss: 0.7708 LRAP: 0.7882 NDCG: 0.8021
val Loss: 0.8798 LRAP: 0.8119 NDCG: 0.8435
EarlyStopping counter: 8 out of 25

Epoch 47/99
----------
train Loss: 0.7682 LRAP: 0.7887 NDCG: 0.8063
val Loss: 0.8819 LRAP: 0.8076 NDCG: 0.8403
EarlyStopping counter: 9 out of 25

Epoch 48/99
----------
train Loss: 0.7702 LRAP: 0.7907 NDCG: 0.8040
val Loss: 0.8817 LRAP: 0.8045 NDCG: 0.8346
EarlyStopping counter: 10 out of 25

Epoch 49/99
----------
train Loss: 0.7690 LRAP: 0.7899 NDCG: 0.8040
val Loss: 0.8815 LRAP: 0.8084 NDCG: 0.8387
EarlyStopping counter: 11 out of 25

Epoch 50/99
----------
train Loss: 0.7688 LRAP: 0.7895 NDCG: 0.8029
val Loss: 0.8821 LRAP: 0.8087 NDCG: 0.8387
EarlyStopping counter: 12 out of 25

Epoch 51/99
----------
train Loss: 0.7702 LRAP: 0.7846 NDCG: 0.8001
val Loss: 0.8830 LRAP: 0.8070 NDCG: 0.8377
EarlyStopping counter: 13 out of 25

Epoch 52/99
----------
train Loss: 0.7717 LRAP: 0.7881 NDCG: 0.8001
val Loss: 0.8823 LRAP: 0.8142 NDCG: 0.8393
EarlyStopping counter: 14 out of 25

Epoch 53/99
----------
train Loss: 0.7688 LRAP: 0.7881 NDCG: 0.8030
val Loss: 0.8810 LRAP: 0.8122 NDCG: 0.8437
EarlyStopping counter: 15 out of 25

Epoch 54/99
----------
train Loss: 0.7721 LRAP: 0.7883 NDCG: 0.8059
val Loss: 0.8812 LRAP: 0.8119 NDCG: 0.8406
EarlyStopping counter: 16 out of 25

Epoch 55/99
----------
train Loss: 0.7717 LRAP: 0.7886 NDCG: 0.8009
val Loss: 0.8821 LRAP: 0.8102 NDCG: 0.8395
EarlyStopping counter: 17 out of 25

Epoch 56/99
----------
train Loss: 0.7709 LRAP: 0.7895 NDCG: 0.8015
val Loss: 0.8824 LRAP: 0.7987 NDCG: 0.8300
EarlyStopping counter: 18 out of 25

Epoch 57/99
----------
train Loss: 0.7708 LRAP: 0.7876 NDCG: 0.7997
val Loss: 0.8810 LRAP: 0.8127 NDCG: 0.8431
EarlyStopping counter: 19 out of 25

Epoch 58/99
----------
train Loss: 0.7703 LRAP: 0.7895 NDCG: 0.8008
val Loss: 0.8814 LRAP: 0.8076 NDCG: 0.8393
EarlyStopping counter: 20 out of 25

Epoch 59/99
----------
train Loss: 0.7690 LRAP: 0.7903 NDCG: 0.8043
val Loss: 0.8802 LRAP: 0.8153 NDCG: 0.8444
EarlyStopping counter: 21 out of 25

Epoch 60/99
----------
train Loss: 0.7699 LRAP: 0.7879 NDCG: 0.8039
val Loss: 0.8814 LRAP: 0.8065 NDCG: 0.8393
EarlyStopping counter: 22 out of 25

Epoch 61/99
----------
train Loss: 0.7698 LRAP: 0.7893 NDCG: 0.8036
val Loss: 0.8825 LRAP: 0.8139 NDCG: 0.8412
EarlyStopping counter: 23 out of 25

Epoch 62/99
----------
train Loss: 0.7708 LRAP: 0.7883 NDCG: 0.8025
val Loss: 0.8808 LRAP: 0.8116 NDCG: 0.8413
EarlyStopping counter: 24 out of 25

Epoch 63/99
----------
train Loss: 0.7715 LRAP: 0.7887 NDCG: 0.7996
val Loss: 0.8812 LRAP: 0.8082 NDCG: 0.8411
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 5m 57s
Best val loss: 0.879822, best LRAP score: 0.9634

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.8115 LRAP: 0.2248 NDCG: 0.5782
val Loss: 1.5764 LRAP: 0.5187 NDCG: 0.6602
Validation loss decreased (0.000000 --> 1.576382).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2609 LRAP: 0.6133 NDCG: 0.7135
val Loss: 1.1899 LRAP: 0.7160 NDCG: 0.7580
Validation loss decreased (1.576382 --> 1.189901).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1733 LRAP: 0.6665 NDCG: 0.7366
val Loss: 1.2332 LRAP: 0.4613 NDCG: 0.6814
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.1361 LRAP: 0.6748 NDCG: 0.7554
val Loss: 1.1055 LRAP: 0.6734 NDCG: 0.7579
Validation loss decreased (1.189901 --> 1.105504).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1058 LRAP: 0.6830 NDCG: 0.7619
val Loss: 1.0977 LRAP: 0.6669 NDCG: 0.7634
Validation loss decreased (1.105504 --> 1.097741).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0783 LRAP: 0.6894 NDCG: 0.7737
val Loss: 1.1082 LRAP: 0.6831 NDCG: 0.7724
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.0679 LRAP: 0.6927 NDCG: 0.7782
val Loss: 1.5144 LRAP: 0.4787 NDCG: 0.6621
EarlyStopping counter: 2 out of 25

Epoch 7/99
----------
train Loss: 1.0487 LRAP: 0.7027 NDCG: 0.7874
val Loss: 1.0505 LRAP: 0.6994 NDCG: 0.7820
Validation loss decreased (1.097741 --> 1.050497).  Saving model ...

Epoch 8/99
----------
train Loss: 1.0372 LRAP: 0.6954 NDCG: 0.7888
val Loss: 1.1874 LRAP: 0.5778 NDCG: 0.7367
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 1.0367 LRAP: 0.7016 NDCG: 0.7902
val Loss: 1.0198 LRAP: 0.7279 NDCG: 0.7998
Validation loss decreased (1.050497 --> 1.019807).  Saving model ...

Epoch 10/99
----------
train Loss: 1.0238 LRAP: 0.7008 NDCG: 0.7915
val Loss: 1.0310 LRAP: 0.7257 NDCG: 0.8006
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 1.0103 LRAP: 0.7085 NDCG: 0.7962
val Loss: 1.0461 LRAP: 0.6857 NDCG: 0.7834
EarlyStopping counter: 2 out of 25

Epoch 12/99
----------
train Loss: 1.0053 LRAP: 0.7040 NDCG: 0.7993
val Loss: 1.0066 LRAP: 0.7134 NDCG: 0.8029
Validation loss decreased (1.019807 --> 1.006623).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9943 LRAP: 0.6992 NDCG: 0.7993
val Loss: 1.0773 LRAP: 0.5524 NDCG: 0.7402
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.9756 LRAP: 0.7148 NDCG: 0.8069
val Loss: 1.2247 LRAP: 0.7371 NDCG: 0.7975
EarlyStopping counter: 2 out of 25

Epoch 15/99
----------
train Loss: 0.9738 LRAP: 0.7131 NDCG: 0.8060
val Loss: 1.3573 LRAP: 0.3971 NDCG: 0.6781
EarlyStopping counter: 3 out of 25

Epoch 16/99
----------
train Loss: 0.9634 LRAP: 0.7050 NDCG: 0.8034
val Loss: 1.0024 LRAP: 0.7374 NDCG: 0.8207
Validation loss decreased (1.006623 --> 1.002358).  Saving model ...

Epoch 17/99
----------
train Loss: 0.9532 LRAP: 0.7159 NDCG: 0.8053
val Loss: 1.0698 LRAP: 0.6143 NDCG: 0.7642
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.9501 LRAP: 0.7127 NDCG: 0.8052
val Loss: 1.0537 LRAP: 0.6757 NDCG: 0.7798
EarlyStopping counter: 2 out of 25

Epoch 19/99
----------
train Loss: 0.9389 LRAP: 0.7189 NDCG: 0.7991
val Loss: 1.0014 LRAP: 0.7000 NDCG: 0.8019
Validation loss decreased (1.002358 --> 1.001375).  Saving model ...

Epoch 20/99
----------
train Loss: 0.9349 LRAP: 0.7168 NDCG: 0.8026
val Loss: 1.1339 LRAP: 0.6100 NDCG: 0.7388
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 0.9262 LRAP: 0.7201 NDCG: 0.7985
val Loss: 0.9533 LRAP: 0.7448 NDCG: 0.8251
Validation loss decreased (1.001375 --> 0.953261).  Saving model ...

Epoch 22/99
----------
train Loss: 0.9228 LRAP: 0.7215 NDCG: 0.7992
val Loss: 0.9517 LRAP: 0.7542 NDCG: 0.8277
Validation loss decreased (0.953261 --> 0.951725).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9088 LRAP: 0.7222 NDCG: 0.7975
val Loss: 0.9699 LRAP: 0.7585 NDCG: 0.8329
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9051 LRAP: 0.7220 NDCG: 0.7980
val Loss: 0.9388 LRAP: 0.7365 NDCG: 0.8188
Validation loss decreased (0.951725 --> 0.938773).  Saving model ...

Epoch 25/99
----------
train Loss: 0.9059 LRAP: 0.7309 NDCG: 0.8027
val Loss: 0.9746 LRAP: 0.7317 NDCG: 0.8199
EarlyStopping counter: 1 out of 25

Epoch 26/99
----------
train Loss: 0.8971 LRAP: 0.7239 NDCG: 0.7963
val Loss: 0.9423 LRAP: 0.7496 NDCG: 0.7998
EarlyStopping counter: 2 out of 25

Epoch 27/99
----------
train Loss: 0.8918 LRAP: 0.7277 NDCG: 0.7919
val Loss: 0.9287 LRAP: 0.7605 NDCG: 0.8179
Validation loss decreased (0.938773 --> 0.928705).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8900 LRAP: 0.7312 NDCG: 0.7932
val Loss: 0.9206 LRAP: 0.7456 NDCG: 0.8281
Validation loss decreased (0.928705 --> 0.920600).  Saving model ...

Epoch 29/99
----------
train Loss: 0.8872 LRAP: 0.7203 NDCG: 0.7847
val Loss: 0.9339 LRAP: 0.7750 NDCG: 0.8382
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.8838 LRAP: 0.7298 NDCG: 0.7928
val Loss: 0.9563 LRAP: 0.7571 NDCG: 0.8185
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.8775 LRAP: 0.7316 NDCG: 0.7874
val Loss: 0.9268 LRAP: 0.7713 NDCG: 0.8412
EarlyStopping counter: 3 out of 25

Epoch 32/99
----------
train Loss: 0.8717 LRAP: 0.7399 NDCG: 0.7946
val Loss: 0.9073 LRAP: 0.7742 NDCG: 0.8441
Validation loss decreased (0.920600 --> 0.907263).  Saving model ...

Epoch 33/99
----------
train Loss: 0.8653 LRAP: 0.7372 NDCG: 0.7848
val Loss: 0.9199 LRAP: 0.7708 NDCG: 0.8370
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.8702 LRAP: 0.7241 NDCG: 0.7802
val Loss: 0.9331 LRAP: 0.7479 NDCG: 0.8091
EarlyStopping counter: 2 out of 25

Epoch 35/99
----------
train Loss: 0.8578 LRAP: 0.7322 NDCG: 0.7840
val Loss: 0.9160 LRAP: 0.7865 NDCG: 0.8345
EarlyStopping counter: 3 out of 25

Epoch 36/99
----------
train Loss: 0.8579 LRAP: 0.7374 NDCG: 0.7779
val Loss: 0.9259 LRAP: 0.7651 NDCG: 0.8111
EarlyStopping counter: 4 out of 25

Epoch 37/99
----------
train Loss: 0.8471 LRAP: 0.7439 NDCG: 0.7781
val Loss: 0.9180 LRAP: 0.7611 NDCG: 0.8147
EarlyStopping counter: 5 out of 25

Epoch 38/99
----------
train Loss: 0.8277 LRAP: 0.7478 NDCG: 0.7764
val Loss: 0.8835 LRAP: 0.7756 NDCG: 0.8078
Validation loss decreased (0.907263 --> 0.883488).  Saving model ...

Epoch 39/99
----------
train Loss: 0.8184 LRAP: 0.7554 NDCG: 0.7835
val Loss: 0.8806 LRAP: 0.7842 NDCG: 0.8191
Validation loss decreased (0.883488 --> 0.880592).  Saving model ...

Epoch 40/99
----------
train Loss: 0.8175 LRAP: 0.7515 NDCG: 0.7746
val Loss: 0.8860 LRAP: 0.7850 NDCG: 0.8216
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.8130 LRAP: 0.7564 NDCG: 0.7867
val Loss: 0.8839 LRAP: 0.7808 NDCG: 0.8123
EarlyStopping counter: 2 out of 25

Epoch 42/99
----------
train Loss: 0.8115 LRAP: 0.7567 NDCG: 0.7809
val Loss: 0.8833 LRAP: 0.7868 NDCG: 0.8233
EarlyStopping counter: 3 out of 25

Epoch 43/99
----------
train Loss: 0.8095 LRAP: 0.7589 NDCG: 0.7869
val Loss: 0.8849 LRAP: 0.7850 NDCG: 0.8147
EarlyStopping counter: 4 out of 25

Epoch 44/99
----------
train Loss: 0.8061 LRAP: 0.7581 NDCG: 0.7855
val Loss: 0.8854 LRAP: 0.7865 NDCG: 0.8128
EarlyStopping counter: 5 out of 25

Epoch 45/99
----------
train Loss: 0.8005 LRAP: 0.7679 NDCG: 0.7886
val Loss: 0.8824 LRAP: 0.7862 NDCG: 0.8162
EarlyStopping counter: 6 out of 25

Epoch 46/99
----------
train Loss: 0.8012 LRAP: 0.7633 NDCG: 0.7855
val Loss: 0.8827 LRAP: 0.7905 NDCG: 0.8241
EarlyStopping counter: 7 out of 25

Epoch 47/99
----------
train Loss: 0.7996 LRAP: 0.7651 NDCG: 0.7848
val Loss: 0.8810 LRAP: 0.7850 NDCG: 0.8165
EarlyStopping counter: 8 out of 25

Epoch 48/99
----------
train Loss: 0.7985 LRAP: 0.7630 NDCG: 0.7878
val Loss: 0.8823 LRAP: 0.7927 NDCG: 0.8242
EarlyStopping counter: 9 out of 25

Epoch 49/99
----------
train Loss: 0.8010 LRAP: 0.7643 NDCG: 0.7876
val Loss: 0.8824 LRAP: 0.7916 NDCG: 0.8223
EarlyStopping counter: 10 out of 25

Epoch 50/99
----------
train Loss: 0.7971 LRAP: 0.7603 NDCG: 0.7851
val Loss: 0.8814 LRAP: 0.7876 NDCG: 0.8158
EarlyStopping counter: 11 out of 25

Epoch 51/99
----------
train Loss: 0.7975 LRAP: 0.7633 NDCG: 0.7861
val Loss: 0.8816 LRAP: 0.7882 NDCG: 0.8204
EarlyStopping counter: 12 out of 25

Epoch 52/99
----------
train Loss: 0.7955 LRAP: 0.7667 NDCG: 0.7859
val Loss: 0.8817 LRAP: 0.7879 NDCG: 0.8180
EarlyStopping counter: 13 out of 25

Epoch 53/99
----------
train Loss: 0.7963 LRAP: 0.7680 NDCG: 0.7903
val Loss: 0.8804 LRAP: 0.7908 NDCG: 0.8238
Validation loss decreased (0.880592 --> 0.880382).  Saving model ...

Epoch 54/99
----------
train Loss: 0.7965 LRAP: 0.7647 NDCG: 0.7877
val Loss: 0.8826 LRAP: 0.7930 NDCG: 0.8289
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.7988 LRAP: 0.7655 NDCG: 0.7806
val Loss: 0.8813 LRAP: 0.7879 NDCG: 0.8249
EarlyStopping counter: 2 out of 25

Epoch 56/99
----------
train Loss: 0.7972 LRAP: 0.7652 NDCG: 0.7905
val Loss: 0.8849 LRAP: 0.7939 NDCG: 0.8269
EarlyStopping counter: 3 out of 25

Epoch 57/99
----------
train Loss: 0.7963 LRAP: 0.7657 NDCG: 0.7865
val Loss: 0.8824 LRAP: 0.7913 NDCG: 0.8239
EarlyStopping counter: 4 out of 25

Epoch 58/99
----------
train Loss: 0.7969 LRAP: 0.7668 NDCG: 0.7889
val Loss: 0.8848 LRAP: 0.7933 NDCG: 0.8272
EarlyStopping counter: 5 out of 25

Epoch 59/99
----------
train Loss: 0.7971 LRAP: 0.7660 NDCG: 0.7843
val Loss: 0.8816 LRAP: 0.7888 NDCG: 0.8170
EarlyStopping counter: 6 out of 25

Epoch 60/99
----------
train Loss: 0.7960 LRAP: 0.7663 NDCG: 0.7892
val Loss: 0.8810 LRAP: 0.7908 NDCG: 0.8239
EarlyStopping counter: 7 out of 25

Epoch 61/99
----------
train Loss: 0.7967 LRAP: 0.7666 NDCG: 0.7895
val Loss: 0.8833 LRAP: 0.7936 NDCG: 0.8267
EarlyStopping counter: 8 out of 25

Epoch 62/99
----------
train Loss: 0.7957 LRAP: 0.7624 NDCG: 0.7832
val Loss: 0.8814 LRAP: 0.7913 NDCG: 0.8226
EarlyStopping counter: 9 out of 25

Epoch 63/99
----------
train Loss: 0.7986 LRAP: 0.7660 NDCG: 0.7850
val Loss: 0.8816 LRAP: 0.7885 NDCG: 0.8183
EarlyStopping counter: 10 out of 25

Epoch 64/99
----------
train Loss: 0.7938 LRAP: 0.7660 NDCG: 0.7875
val Loss: 0.8808 LRAP: 0.7908 NDCG: 0.8235
EarlyStopping counter: 11 out of 25

Epoch 65/99
----------
train Loss: 0.7965 LRAP: 0.7680 NDCG: 0.7870
val Loss: 0.8823 LRAP: 0.7850 NDCG: 0.8106
EarlyStopping counter: 12 out of 25

Epoch 66/99
----------
train Loss: 0.7966 LRAP: 0.7625 NDCG: 0.7863
val Loss: 0.8820 LRAP: 0.7922 NDCG: 0.8235
EarlyStopping counter: 13 out of 25

Epoch 67/99
----------
train Loss: 0.7990 LRAP: 0.7674 NDCG: 0.7900
val Loss: 0.8820 LRAP: 0.7850 NDCG: 0.8160
EarlyStopping counter: 14 out of 25

Epoch 68/99
----------
train Loss: 0.7964 LRAP: 0.7682 NDCG: 0.7887
val Loss: 0.8812 LRAP: 0.7888 NDCG: 0.8201
EarlyStopping counter: 15 out of 25

Epoch 69/99
----------
train Loss: 0.7969 LRAP: 0.7678 NDCG: 0.7891
val Loss: 0.8823 LRAP: 0.7936 NDCG: 0.8275
EarlyStopping counter: 16 out of 25

Epoch 70/99
----------
train Loss: 0.7956 LRAP: 0.7671 NDCG: 0.7878
val Loss: 0.8818 LRAP: 0.7902 NDCG: 0.8200
EarlyStopping counter: 17 out of 25

Epoch 71/99
----------
train Loss: 0.7965 LRAP: 0.7704 NDCG: 0.7895
val Loss: 0.8814 LRAP: 0.7853 NDCG: 0.8147
EarlyStopping counter: 18 out of 25

Epoch 72/99
----------
train Loss: 0.7957 LRAP: 0.7683 NDCG: 0.7858
val Loss: 0.8834 LRAP: 0.7905 NDCG: 0.8215
EarlyStopping counter: 19 out of 25

Epoch 73/99
----------
train Loss: 0.7940 LRAP: 0.7646 NDCG: 0.7829
val Loss: 0.8817 LRAP: 0.7848 NDCG: 0.8156
EarlyStopping counter: 20 out of 25

Epoch 74/99
----------
train Loss: 0.7974 LRAP: 0.7632 NDCG: 0.7854
val Loss: 0.8817 LRAP: 0.7893 NDCG: 0.8191
EarlyStopping counter: 21 out of 25

Epoch 75/99
----------
train Loss: 0.7953 LRAP: 0.7652 NDCG: 0.7890
val Loss: 0.8822 LRAP: 0.7896 NDCG: 0.8166
EarlyStopping counter: 22 out of 25

Epoch 76/99
----------
train Loss: 0.7946 LRAP: 0.7660 NDCG: 0.7894
val Loss: 0.8805 LRAP: 0.7959 NDCG: 0.8326
EarlyStopping counter: 23 out of 25

Epoch 77/99
----------
train Loss: 0.7980 LRAP: 0.7657 NDCG: 0.7884
val Loss: 0.8811 LRAP: 0.7893 NDCG: 0.8224
EarlyStopping counter: 24 out of 25

Epoch 78/99
----------
train Loss: 0.7979 LRAP: 0.7661 NDCG: 0.7830
val Loss: 0.8812 LRAP: 0.7888 NDCG: 0.8171
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 38s
Best val loss: 0.880382, best LRAP score: 0.9625

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.8566 LRAP: 0.1785 NDCG: 0.5589
val Loss: 1.8566 LRAP: 0.1716 NDCG: 0.5333
Validation loss decreased (0.000000 --> 1.856640).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3494 LRAP: 0.5725 NDCG: 0.6804
val Loss: 1.3418 LRAP: 0.6594 NDCG: 0.7277
Validation loss decreased (1.856640 --> 1.341836).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2488 LRAP: 0.6129 NDCG: 0.7013
val Loss: 1.2856 LRAP: 0.5655 NDCG: 0.6717
Validation loss decreased (1.341836 --> 1.285574).  Saving model ...

Epoch 3/99
----------
train Loss: 1.2202 LRAP: 0.6179 NDCG: 0.7135
val Loss: 1.1754 LRAP: 0.6417 NDCG: 0.7145
Validation loss decreased (1.285574 --> 1.175450).  Saving model ...

Epoch 4/99
----------
train Loss: 1.2069 LRAP: 0.6213 NDCG: 0.7178
val Loss: 1.5488 LRAP: 0.5784 NDCG: 0.6714
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.1878 LRAP: 0.6204 NDCG: 0.7261
val Loss: 1.2521 LRAP: 0.6460 NDCG: 0.7288
EarlyStopping counter: 2 out of 25

Epoch 6/99
----------
train Loss: 1.1619 LRAP: 0.6275 NDCG: 0.7325
val Loss: 1.5502 LRAP: 0.3075 NDCG: 0.6550
EarlyStopping counter: 3 out of 25

Epoch 7/99
----------
train Loss: 1.1527 LRAP: 0.6266 NDCG: 0.7367
val Loss: 1.1547 LRAP: 0.5689 NDCG: 0.7200
Validation loss decreased (1.175450 --> 1.154700).  Saving model ...

Epoch 8/99
----------
train Loss: 1.1368 LRAP: 0.6311 NDCG: 0.7444
val Loss: 1.3663 LRAP: 0.5381 NDCG: 0.6782
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 1.1258 LRAP: 0.6363 NDCG: 0.7488
val Loss: 1.4052 LRAP: 0.3928 NDCG: 0.6700
EarlyStopping counter: 2 out of 25

Epoch 10/99
----------
train Loss: 1.1142 LRAP: 0.6374 NDCG: 0.7511
val Loss: 1.2198 LRAP: 0.7048 NDCG: 0.7838
EarlyStopping counter: 3 out of 25

Epoch 11/99
----------
train Loss: 1.1077 LRAP: 0.6463 NDCG: 0.7582
val Loss: 1.6711 LRAP: 0.3634 NDCG: 0.6710
EarlyStopping counter: 4 out of 25

Epoch 12/99
----------
train Loss: 1.0941 LRAP: 0.6500 NDCG: 0.7608
val Loss: 1.1726 LRAP: 0.6454 NDCG: 0.7634
EarlyStopping counter: 5 out of 25

Epoch 13/99
----------
train Loss: 1.0668 LRAP: 0.6606 NDCG: 0.7665
val Loss: 1.0609 LRAP: 0.6971 NDCG: 0.7851
Validation loss decreased (1.154700 --> 1.060881).  Saving model ...

Epoch 14/99
----------
train Loss: 1.0584 LRAP: 0.6584 NDCG: 0.7685
val Loss: 1.0551 LRAP: 0.6937 NDCG: 0.7819
Validation loss decreased (1.060881 --> 1.055070).  Saving model ...

Epoch 15/99
----------
train Loss: 1.0546 LRAP: 0.6597 NDCG: 0.7690
val Loss: 1.0619 LRAP: 0.6794 NDCG: 0.7762
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 1.0480 LRAP: 0.6645 NDCG: 0.7724
val Loss: 1.0530 LRAP: 0.6991 NDCG: 0.7876
Validation loss decreased (1.055070 --> 1.052984).  Saving model ...

Epoch 17/99
----------
train Loss: 1.0439 LRAP: 0.6623 NDCG: 0.7742
val Loss: 1.0632 LRAP: 0.6657 NDCG: 0.7769
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 1.0418 LRAP: 0.6630 NDCG: 0.7752
val Loss: 1.0437 LRAP: 0.7048 NDCG: 0.7923
Validation loss decreased (1.052984 --> 1.043735).  Saving model ...

Epoch 19/99
----------
train Loss: 1.0407 LRAP: 0.6690 NDCG: 0.7770
val Loss: 1.0396 LRAP: 0.6800 NDCG: 0.7838
Validation loss decreased (1.043735 --> 1.039561).  Saving model ...

Epoch 20/99
----------
train Loss: 1.0349 LRAP: 0.6634 NDCG: 0.7757
val Loss: 1.0567 LRAP: 0.6563 NDCG: 0.7745
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 1.0329 LRAP: 0.6633 NDCG: 0.7778
val Loss: 1.0466 LRAP: 0.6957 NDCG: 0.7934
EarlyStopping counter: 2 out of 25

Epoch 22/99
----------
train Loss: 1.0319 LRAP: 0.6672 NDCG: 0.7783
val Loss: 1.0478 LRAP: 0.7125 NDCG: 0.8018
EarlyStopping counter: 3 out of 25

Epoch 23/99
----------
train Loss: 1.0247 LRAP: 0.6727 NDCG: 0.7823
val Loss: 1.0337 LRAP: 0.6940 NDCG: 0.7932
Validation loss decreased (1.039561 --> 1.033742).  Saving model ...

Epoch 24/99
----------
train Loss: 1.0237 LRAP: 0.6667 NDCG: 0.7793
val Loss: 1.0253 LRAP: 0.7142 NDCG: 0.8057
Validation loss decreased (1.033742 --> 1.025273).  Saving model ...

Epoch 25/99
----------
train Loss: 1.0182 LRAP: 0.6709 NDCG: 0.7814
val Loss: 1.0244 LRAP: 0.6983 NDCG: 0.7933
Validation loss decreased (1.025273 --> 1.024369).  Saving model ...

Epoch 26/99
----------
train Loss: 1.0171 LRAP: 0.6686 NDCG: 0.7794
val Loss: 1.0137 LRAP: 0.6988 NDCG: 0.7959
Validation loss decreased (1.024369 --> 1.013662).  Saving model ...

Epoch 27/99
----------
train Loss: 1.0113 LRAP: 0.6732 NDCG: 0.7837
val Loss: 1.0130 LRAP: 0.7145 NDCG: 0.8048
Validation loss decreased (1.013662 --> 1.012953).  Saving model ...

Epoch 28/99
----------
train Loss: 1.0065 LRAP: 0.6733 NDCG: 0.7827
val Loss: 1.0398 LRAP: 0.6366 NDCG: 0.7671
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 1.0050 LRAP: 0.6752 NDCG: 0.7844
val Loss: 1.0135 LRAP: 0.6977 NDCG: 0.7946
EarlyStopping counter: 2 out of 25

Epoch 30/99
----------
train Loss: 1.0007 LRAP: 0.6707 NDCG: 0.7837
val Loss: 1.0076 LRAP: 0.7040 NDCG: 0.7952
Validation loss decreased (1.012953 --> 1.007627).  Saving model ...

Epoch 31/99
----------
train Loss: 0.9985 LRAP: 0.6817 NDCG: 0.7855
val Loss: 1.0100 LRAP: 0.7185 NDCG: 0.8065
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.9950 LRAP: 0.6775 NDCG: 0.7861
val Loss: 1.0005 LRAP: 0.7145 NDCG: 0.8022
Validation loss decreased (1.007627 --> 1.000528).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9937 LRAP: 0.6872 NDCG: 0.7904
val Loss: 1.0019 LRAP: 0.6971 NDCG: 0.8013
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.9889 LRAP: 0.6869 NDCG: 0.7911
val Loss: 0.9999 LRAP: 0.7074 NDCG: 0.8030
Validation loss decreased (1.000528 --> 0.999932).  Saving model ...

Epoch 35/99
----------
train Loss: 0.9864 LRAP: 0.6846 NDCG: 0.7882
val Loss: 0.9901 LRAP: 0.7302 NDCG: 0.8123
Validation loss decreased (0.999932 --> 0.990135).  Saving model ...

Epoch 36/99
----------
train Loss: 0.9853 LRAP: 0.6957 NDCG: 0.7927
val Loss: 1.0240 LRAP: 0.6774 NDCG: 0.7832
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.9826 LRAP: 0.6957 NDCG: 0.7952
val Loss: 1.0009 LRAP: 0.7265 NDCG: 0.8118
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.9824 LRAP: 0.6941 NDCG: 0.7943
val Loss: 0.9969 LRAP: 0.7151 NDCG: 0.8020
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.9781 LRAP: 0.6933 NDCG: 0.7939
val Loss: 0.9929 LRAP: 0.7045 NDCG: 0.8053
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.9769 LRAP: 0.6976 NDCG: 0.7950
val Loss: 0.9921 LRAP: 0.6985 NDCG: 0.7996
EarlyStopping counter: 5 out of 25

Epoch 41/99
----------
train Loss: 0.9649 LRAP: 0.7061 NDCG: 0.7996
val Loss: 0.9729 LRAP: 0.7251 NDCG: 0.8123
Validation loss decreased (0.990135 --> 0.972876).  Saving model ...

Epoch 42/99
----------
train Loss: 0.9629 LRAP: 0.7041 NDCG: 0.7984
val Loss: 0.9710 LRAP: 0.7311 NDCG: 0.8161
Validation loss decreased (0.972876 --> 0.971027).  Saving model ...

Epoch 43/99
----------
train Loss: 0.9579 LRAP: 0.7066 NDCG: 0.8009
val Loss: 0.9702 LRAP: 0.7271 NDCG: 0.8129
Validation loss decreased (0.971027 --> 0.970164).  Saving model ...

Epoch 44/99
----------
train Loss: 0.9594 LRAP: 0.7109 NDCG: 0.8003
val Loss: 0.9692 LRAP: 0.7348 NDCG: 0.8169
Validation loss decreased (0.970164 --> 0.969196).  Saving model ...

Epoch 45/99
----------
train Loss: 0.9601 LRAP: 0.7056 NDCG: 0.8000
val Loss: 0.9665 LRAP: 0.7285 NDCG: 0.8137
Validation loss decreased (0.969196 --> 0.966546).  Saving model ...

Epoch 46/99
----------
train Loss: 0.9576 LRAP: 0.7085 NDCG: 0.7995
val Loss: 0.9659 LRAP: 0.7279 NDCG: 0.8127
Validation loss decreased (0.966546 --> 0.965891).  Saving model ...

Epoch 47/99
----------
train Loss: 0.9596 LRAP: 0.7075 NDCG: 0.8017
val Loss: 0.9668 LRAP: 0.7262 NDCG: 0.8139
EarlyStopping counter: 1 out of 25

Epoch 48/99
----------
train Loss: 0.9603 LRAP: 0.7121 NDCG: 0.8024
val Loss: 0.9647 LRAP: 0.7331 NDCG: 0.8150
Validation loss decreased (0.965891 --> 0.964680).  Saving model ...

Epoch 49/99
----------
train Loss: 0.9568 LRAP: 0.7094 NDCG: 0.8027
val Loss: 0.9641 LRAP: 0.7348 NDCG: 0.8192
Validation loss decreased (0.964680 --> 0.964145).  Saving model ...

Epoch 50/99
----------
train Loss: 0.9562 LRAP: 0.7079 NDCG: 0.8020
val Loss: 0.9629 LRAP: 0.7294 NDCG: 0.8138
Validation loss decreased (0.964145 --> 0.962881).  Saving model ...

Epoch 51/99
----------
train Loss: 0.9546 LRAP: 0.7106 NDCG: 0.8029
val Loss: 0.9649 LRAP: 0.7308 NDCG: 0.8173
EarlyStopping counter: 1 out of 25

Epoch 52/99
----------
train Loss: 0.9546 LRAP: 0.7107 NDCG: 0.8024
val Loss: 0.9654 LRAP: 0.7379 NDCG: 0.8185
EarlyStopping counter: 2 out of 25

Epoch 53/99
----------
train Loss: 0.9545 LRAP: 0.7130 NDCG: 0.8034
val Loss: 0.9629 LRAP: 0.7305 NDCG: 0.8164
Validation loss decreased (0.962881 --> 0.962873).  Saving model ...

Epoch 54/99
----------
train Loss: 0.9536 LRAP: 0.7115 NDCG: 0.8019
val Loss: 0.9618 LRAP: 0.7362 NDCG: 0.8179
Validation loss decreased (0.962873 --> 0.961790).  Saving model ...

Epoch 55/99
----------
train Loss: 0.9513 LRAP: 0.7097 NDCG: 0.8035
val Loss: 0.9633 LRAP: 0.7351 NDCG: 0.8173
EarlyStopping counter: 1 out of 25

Epoch 56/99
----------
train Loss: 0.9492 LRAP: 0.7114 NDCG: 0.8004
val Loss: 0.9614 LRAP: 0.7351 NDCG: 0.8178
Validation loss decreased (0.961790 --> 0.961374).  Saving model ...

Epoch 57/99
----------
train Loss: 0.9496 LRAP: 0.7149 NDCG: 0.8051
val Loss: 0.9616 LRAP: 0.7365 NDCG: 0.8177
EarlyStopping counter: 1 out of 25

Epoch 58/99
----------
train Loss: 0.9476 LRAP: 0.7161 NDCG: 0.8049
val Loss: 0.9616 LRAP: 0.7377 NDCG: 0.8191
EarlyStopping counter: 2 out of 25

Epoch 59/99
----------
train Loss: 0.9514 LRAP: 0.7172 NDCG: 0.8059
val Loss: 0.9602 LRAP: 0.7354 NDCG: 0.8179
Validation loss decreased (0.961374 --> 0.960160).  Saving model ...

Epoch 60/99
----------
train Loss: 0.9491 LRAP: 0.7130 NDCG: 0.8045
val Loss: 0.9586 LRAP: 0.7379 NDCG: 0.8190
Validation loss decreased (0.960160 --> 0.958615).  Saving model ...

Epoch 61/99
----------
train Loss: 0.9473 LRAP: 0.7135 NDCG: 0.8050
val Loss: 0.9613 LRAP: 0.7385 NDCG: 0.8192
EarlyStopping counter: 1 out of 25

Epoch 62/99
----------
train Loss: 0.9467 LRAP: 0.7164 NDCG: 0.8043
val Loss: 0.9583 LRAP: 0.7388 NDCG: 0.8179
Validation loss decreased (0.958615 --> 0.958263).  Saving model ...

Epoch 63/99
----------
train Loss: 0.9463 LRAP: 0.7159 NDCG: 0.8058
val Loss: 0.9591 LRAP: 0.7354 NDCG: 0.8188
EarlyStopping counter: 1 out of 25

Epoch 64/99
----------
train Loss: 0.9476 LRAP: 0.7140 NDCG: 0.8023
val Loss: 0.9568 LRAP: 0.7337 NDCG: 0.8175
Validation loss decreased (0.958263 --> 0.956832).  Saving model ...

Epoch 65/99
----------
train Loss: 0.9483 LRAP: 0.7164 NDCG: 0.8044
val Loss: 0.9593 LRAP: 0.7439 NDCG: 0.8208
EarlyStopping counter: 1 out of 25

Epoch 66/99
----------
train Loss: 0.9455 LRAP: 0.7195 NDCG: 0.8050
val Loss: 0.9541 LRAP: 0.7456 NDCG: 0.8227
Validation loss decreased (0.956832 --> 0.954100).  Saving model ...

Epoch 67/99
----------
train Loss: 0.9432 LRAP: 0.7199 NDCG: 0.8062
val Loss: 0.9561 LRAP: 0.7399 NDCG: 0.8200
EarlyStopping counter: 1 out of 25

Epoch 68/99
----------
train Loss: 0.9462 LRAP: 0.7170 NDCG: 0.8032
val Loss: 0.9566 LRAP: 0.7431 NDCG: 0.8220
EarlyStopping counter: 2 out of 25

Epoch 69/99
----------
train Loss: 0.9440 LRAP: 0.7177 NDCG: 0.8056
val Loss: 0.9564 LRAP: 0.7399 NDCG: 0.8183
EarlyStopping counter: 3 out of 25

Epoch 70/99
----------
train Loss: 0.9428 LRAP: 0.7178 NDCG: 0.8074
val Loss: 0.9558 LRAP: 0.7382 NDCG: 0.8196
EarlyStopping counter: 4 out of 25

Epoch 71/99
----------
train Loss: 0.9434 LRAP: 0.7182 NDCG: 0.8066
val Loss: 0.9542 LRAP: 0.7411 NDCG: 0.8219
EarlyStopping counter: 5 out of 25

Epoch 72/99
----------
train Loss: 0.9380 LRAP: 0.7229 NDCG: 0.8081
val Loss: 0.9535 LRAP: 0.7419 NDCG: 0.8217
Validation loss decreased (0.954100 --> 0.953502).  Saving model ...

Epoch 73/99
----------
train Loss: 0.9381 LRAP: 0.7220 NDCG: 0.8079
val Loss: 0.9529 LRAP: 0.7417 NDCG: 0.8213
Validation loss decreased (0.953502 --> 0.952947).  Saving model ...

Epoch 74/99
----------
train Loss: 0.9401 LRAP: 0.7205 NDCG: 0.8071
val Loss: 0.9525 LRAP: 0.7408 NDCG: 0.8218
Validation loss decreased (0.952947 --> 0.952470).  Saving model ...

Epoch 75/99
----------
train Loss: 0.9385 LRAP: 0.7206 NDCG: 0.8068
val Loss: 0.9531 LRAP: 0.7479 NDCG: 0.8245
EarlyStopping counter: 1 out of 25

Epoch 76/99
----------
train Loss: 0.9375 LRAP: 0.7223 NDCG: 0.8059
val Loss: 0.9531 LRAP: 0.7377 NDCG: 0.8192
EarlyStopping counter: 2 out of 25

Epoch 77/99
----------
train Loss: 0.9376 LRAP: 0.7216 NDCG: 0.8080
val Loss: 0.9525 LRAP: 0.7456 NDCG: 0.8226
Validation loss decreased (0.952470 --> 0.952456).  Saving model ...

Epoch 78/99
----------
train Loss: 0.9403 LRAP: 0.7194 NDCG: 0.8092
val Loss: 0.9529 LRAP: 0.7462 NDCG: 0.8230
EarlyStopping counter: 1 out of 25

Epoch 79/99
----------
train Loss: 0.9390 LRAP: 0.7207 NDCG: 0.8071
val Loss: 0.9520 LRAP: 0.7411 NDCG: 0.8209
Validation loss decreased (0.952456 --> 0.952005).  Saving model ...

Epoch 80/99
----------
train Loss: 0.9373 LRAP: 0.7188 NDCG: 0.8064
val Loss: 0.9539 LRAP: 0.7374 NDCG: 0.8195
EarlyStopping counter: 1 out of 25

Epoch 81/99
----------
train Loss: 0.9345 LRAP: 0.7236 NDCG: 0.8084
val Loss: 0.9529 LRAP: 0.7391 NDCG: 0.8206
EarlyStopping counter: 2 out of 25

Epoch 82/99
----------
train Loss: 0.9399 LRAP: 0.7208 NDCG: 0.8077
val Loss: 0.9515 LRAP: 0.7414 NDCG: 0.8213
Validation loss decreased (0.952005 --> 0.951521).  Saving model ...

Epoch 83/99
----------
train Loss: 0.9378 LRAP: 0.7208 NDCG: 0.8071
val Loss: 0.9535 LRAP: 0.7379 NDCG: 0.8193
EarlyStopping counter: 1 out of 25

Epoch 84/99
----------
train Loss: 0.9362 LRAP: 0.7207 NDCG: 0.8070
val Loss: 0.9504 LRAP: 0.7397 NDCG: 0.8206
Validation loss decreased (0.951521 --> 0.950435).  Saving model ...

Epoch 85/99
----------
train Loss: 0.9375 LRAP: 0.7225 NDCG: 0.8086
val Loss: 0.9509 LRAP: 0.7431 NDCG: 0.8226
EarlyStopping counter: 1 out of 25

Epoch 86/99
----------
train Loss: 0.9360 LRAP: 0.7217 NDCG: 0.8082
val Loss: 0.9514 LRAP: 0.7405 NDCG: 0.8213
EarlyStopping counter: 2 out of 25

Epoch 87/99
----------
train Loss: 0.9399 LRAP: 0.7209 NDCG: 0.8073
val Loss: 0.9510 LRAP: 0.7445 NDCG: 0.8231
EarlyStopping counter: 3 out of 25

Epoch 88/99
----------
train Loss: 0.9360 LRAP: 0.7238 NDCG: 0.8088
val Loss: 0.9521 LRAP: 0.7417 NDCG: 0.8220
EarlyStopping counter: 4 out of 25

Epoch 89/99
----------
train Loss: 0.9389 LRAP: 0.7222 NDCG: 0.8077
val Loss: 0.9520 LRAP: 0.7456 NDCG: 0.8236
EarlyStopping counter: 5 out of 25

Epoch 90/99
----------
train Loss: 0.9352 LRAP: 0.7223 NDCG: 0.8070
val Loss: 0.9520 LRAP: 0.7425 NDCG: 0.8215
EarlyStopping counter: 6 out of 25

Epoch 91/99
----------
train Loss: 0.9336 LRAP: 0.7230 NDCG: 0.8081
val Loss: 0.9519 LRAP: 0.7405 NDCG: 0.8212
EarlyStopping counter: 7 out of 25

Epoch 92/99
----------
train Loss: 0.9378 LRAP: 0.7216 NDCG: 0.8072
val Loss: 0.9507 LRAP: 0.7434 NDCG: 0.8220
EarlyStopping counter: 8 out of 25

Epoch 93/99
----------
train Loss: 0.9354 LRAP: 0.7222 NDCG: 0.8083
val Loss: 0.9515 LRAP: 0.7402 NDCG: 0.8203
EarlyStopping counter: 9 out of 25

Epoch 94/99
----------
train Loss: 0.9348 LRAP: 0.7189 NDCG: 0.8066
val Loss: 0.9517 LRAP: 0.7382 NDCG: 0.8198
EarlyStopping counter: 10 out of 25

Epoch 95/99
----------
train Loss: 0.9368 LRAP: 0.7217 NDCG: 0.8077
val Loss: 0.9526 LRAP: 0.7377 NDCG: 0.8199
EarlyStopping counter: 11 out of 25

Epoch 96/99
----------
train Loss: 0.9368 LRAP: 0.7228 NDCG: 0.8080
val Loss: 0.9516 LRAP: 0.7397 NDCG: 0.8203
EarlyStopping counter: 12 out of 25

Epoch 97/99
----------
train Loss: 0.9383 LRAP: 0.7244 NDCG: 0.8081
val Loss: 0.9508 LRAP: 0.7419 NDCG: 0.8221
EarlyStopping counter: 13 out of 25

Epoch 98/99
----------
train Loss: 0.9357 LRAP: 0.7235 NDCG: 0.8087
val Loss: 0.9517 LRAP: 0.7436 NDCG: 0.8221
EarlyStopping counter: 14 out of 25

Epoch 99/99
----------
train Loss: 0.9356 LRAP: 0.7208 NDCG: 0.8076
val Loss: 0.9518 LRAP: 0.7405 NDCG: 0.8217
EarlyStopping counter: 15 out of 25

Training complete in 9m 24s
Best val loss: 0.950435, best LRAP score: 0.9508

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 4/10

All random seeds set to: 423
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7822 LRAP: 0.2258 NDCG: 0.5634
val Loss: 1.3924 LRAP: 0.3928 NDCG: 0.6574
Validation loss decreased (0.000000 --> 1.392386).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2430 LRAP: 0.6033 NDCG: 0.7099
val Loss: 1.1368 LRAP: 0.6714 NDCG: 0.7496
Validation loss decreased (1.392386 --> 1.136846).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1359 LRAP: 0.6474 NDCG: 0.7451
val Loss: 1.0743 LRAP: 0.6609 NDCG: 0.7543
Validation loss decreased (1.136846 --> 1.074251).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0658 LRAP: 0.6781 NDCG: 0.7715
val Loss: 1.0373 LRAP: 0.6897 NDCG: 0.7753
Validation loss decreased (1.074251 --> 1.037314).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0270 LRAP: 0.6820 NDCG: 0.7838
val Loss: 1.0081 LRAP: 0.7003 NDCG: 0.7992
Validation loss decreased (1.037314 --> 1.008062).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0004 LRAP: 0.6730 NDCG: 0.7874
val Loss: 1.0124 LRAP: 0.6903 NDCG: 0.7936
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 0.9845 LRAP: 0.6808 NDCG: 0.7946
val Loss: 0.9849 LRAP: 0.7111 NDCG: 0.8065
Validation loss decreased (1.008062 --> 0.984852).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9630 LRAP: 0.6776 NDCG: 0.7994
val Loss: 0.9806 LRAP: 0.7197 NDCG: 0.8120
Validation loss decreased (0.984852 --> 0.980564).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9457 LRAP: 0.6953 NDCG: 0.8075
val Loss: 0.9728 LRAP: 0.7351 NDCG: 0.8254
Validation loss decreased (0.980564 --> 0.972768).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9353 LRAP: 0.7013 NDCG: 0.8121
val Loss: 0.9600 LRAP: 0.7571 NDCG: 0.8336
Validation loss decreased (0.972768 --> 0.960006).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9244 LRAP: 0.6974 NDCG: 0.8132
val Loss: 0.9619 LRAP: 0.7519 NDCG: 0.8331
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 0.9068 LRAP: 0.7153 NDCG: 0.8216
val Loss: 0.9437 LRAP: 0.7545 NDCG: 0.8338
Validation loss decreased (0.960006 --> 0.943664).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8951 LRAP: 0.7187 NDCG: 0.8237
val Loss: 0.9427 LRAP: 0.7234 NDCG: 0.8230
Validation loss decreased (0.943664 --> 0.942695).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8915 LRAP: 0.7229 NDCG: 0.8266
val Loss: 0.9377 LRAP: 0.7474 NDCG: 0.8302
Validation loss decreased (0.942695 --> 0.937743).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8808 LRAP: 0.7283 NDCG: 0.8288
val Loss: 0.9502 LRAP: 0.7722 NDCG: 0.8398
EarlyStopping counter: 1 out of 25

Epoch 15/99
----------
train Loss: 0.8717 LRAP: 0.7374 NDCG: 0.8309
val Loss: 0.9385 LRAP: 0.7225 NDCG: 0.8252
EarlyStopping counter: 2 out of 25

Epoch 16/99
----------
train Loss: 0.8660 LRAP: 0.7473 NDCG: 0.8346
val Loss: 0.9290 LRAP: 0.6894 NDCG: 0.8108
Validation loss decreased (0.937743 --> 0.929037).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8609 LRAP: 0.7457 NDCG: 0.8313
val Loss: 0.9377 LRAP: 0.7722 NDCG: 0.8402
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.8510 LRAP: 0.7476 NDCG: 0.8286
val Loss: 0.9345 LRAP: 0.7916 NDCG: 0.8447
EarlyStopping counter: 2 out of 25

Epoch 19/99
----------
train Loss: 0.8497 LRAP: 0.7540 NDCG: 0.8237
val Loss: 0.9224 LRAP: 0.7636 NDCG: 0.8311
Validation loss decreased (0.929037 --> 0.922425).  Saving model ...

Epoch 20/99
----------
train Loss: 0.8430 LRAP: 0.7531 NDCG: 0.8253
val Loss: 0.9253 LRAP: 0.7559 NDCG: 0.8206
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 0.8321 LRAP: 0.7622 NDCG: 0.8243
val Loss: 0.9169 LRAP: 0.7856 NDCG: 0.8345
Validation loss decreased (0.922425 --> 0.916860).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8224 LRAP: 0.7664 NDCG: 0.8220
val Loss: 0.9218 LRAP: 0.7842 NDCG: 0.8216
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 0.8217 LRAP: 0.7701 NDCG: 0.8266
val Loss: 0.9272 LRAP: 0.7725 NDCG: 0.8200
EarlyStopping counter: 2 out of 25

Epoch 24/99
----------
train Loss: 0.8191 LRAP: 0.7666 NDCG: 0.8246
val Loss: 0.9269 LRAP: 0.7605 NDCG: 0.8317
EarlyStopping counter: 3 out of 25

Epoch 25/99
----------
train Loss: 0.8164 LRAP: 0.7724 NDCG: 0.8236
val Loss: 0.9300 LRAP: 0.8090 NDCG: 0.8381
EarlyStopping counter: 4 out of 25

Epoch 26/99
----------
train Loss: 0.8113 LRAP: 0.7722 NDCG: 0.8173
val Loss: 0.9159 LRAP: 0.7890 NDCG: 0.8319
Validation loss decreased (0.916860 --> 0.915929).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8041 LRAP: 0.7792 NDCG: 0.8195
val Loss: 0.9203 LRAP: 0.7996 NDCG: 0.8369
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.8022 LRAP: 0.7765 NDCG: 0.8158
val Loss: 0.9238 LRAP: 0.7913 NDCG: 0.8279
EarlyStopping counter: 2 out of 25

Epoch 29/99
----------
train Loss: 0.7941 LRAP: 0.7837 NDCG: 0.8091
val Loss: 0.9219 LRAP: 0.7830 NDCG: 0.8266
EarlyStopping counter: 3 out of 25

Epoch 30/99
----------
train Loss: 0.7910 LRAP: 0.7877 NDCG: 0.8210
val Loss: 0.9096 LRAP: 0.7993 NDCG: 0.8378
Validation loss decreased (0.915929 --> 0.909578).  Saving model ...

Epoch 31/99
----------
train Loss: 0.7833 LRAP: 0.7940 NDCG: 0.8178
val Loss: 0.9087 LRAP: 0.7927 NDCG: 0.8369
Validation loss decreased (0.909578 --> 0.908698).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7821 LRAP: 0.7935 NDCG: 0.8157
val Loss: 0.9059 LRAP: 0.7970 NDCG: 0.8443
Validation loss decreased (0.908698 --> 0.905853).  Saving model ...

Epoch 33/99
----------
train Loss: 0.7799 LRAP: 0.7968 NDCG: 0.8111
val Loss: 0.9141 LRAP: 0.8184 NDCG: 0.8482
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.7770 LRAP: 0.7927 NDCG: 0.8090
val Loss: 0.9146 LRAP: 0.8136 NDCG: 0.8513
EarlyStopping counter: 2 out of 25

Epoch 35/99
----------
train Loss: 0.7728 LRAP: 0.7918 NDCG: 0.8053
val Loss: 0.9022 LRAP: 0.8162 NDCG: 0.8482
Validation loss decreased (0.905853 --> 0.902225).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7710 LRAP: 0.7929 NDCG: 0.8014
val Loss: 0.9086 LRAP: 0.8219 NDCG: 0.8416
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.7656 LRAP: 0.7949 NDCG: 0.8002
val Loss: 0.9095 LRAP: 0.8019 NDCG: 0.8350
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.7636 LRAP: 0.7981 NDCG: 0.8071
val Loss: 0.9118 LRAP: 0.8139 NDCG: 0.8484
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.7624 LRAP: 0.7990 NDCG: 0.8183
val Loss: 0.9063 LRAP: 0.7987 NDCG: 0.8487
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.7578 LRAP: 0.8018 NDCG: 0.8078
val Loss: 0.9024 LRAP: 0.8216 NDCG: 0.8474
EarlyStopping counter: 5 out of 25

Epoch 41/99
----------
train Loss: 0.7430 LRAP: 0.8065 NDCG: 0.8055
val Loss: 0.8983 LRAP: 0.8242 NDCG: 0.8471
Validation loss decreased (0.902225 --> 0.898284).  Saving model ...

Epoch 42/99
----------
train Loss: 0.7346 LRAP: 0.8123 NDCG: 0.8073
val Loss: 0.8941 LRAP: 0.8227 NDCG: 0.8446
Validation loss decreased (0.898284 --> 0.894132).  Saving model ...

Epoch 43/99
----------
train Loss: 0.7309 LRAP: 0.8128 NDCG: 0.8049
val Loss: 0.8974 LRAP: 0.8270 NDCG: 0.8492
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.7288 LRAP: 0.8157 NDCG: 0.8052
val Loss: 0.8972 LRAP: 0.8207 NDCG: 0.8457
EarlyStopping counter: 2 out of 25

Epoch 45/99
----------
train Loss: 0.7263 LRAP: 0.8175 NDCG: 0.8118
val Loss: 0.8967 LRAP: 0.8287 NDCG: 0.8482
EarlyStopping counter: 3 out of 25

Epoch 46/99
----------
train Loss: 0.7256 LRAP: 0.8162 NDCG: 0.8060
val Loss: 0.9004 LRAP: 0.8333 NDCG: 0.8500
EarlyStopping counter: 4 out of 25

Epoch 47/99
----------
train Loss: 0.7246 LRAP: 0.8140 NDCG: 0.8058
val Loss: 0.8983 LRAP: 0.8230 NDCG: 0.8393
EarlyStopping counter: 5 out of 25

Epoch 48/99
----------
train Loss: 0.7196 LRAP: 0.8227 NDCG: 0.8069
val Loss: 0.8954 LRAP: 0.8313 NDCG: 0.8490
EarlyStopping counter: 6 out of 25

Epoch 49/99
----------
train Loss: 0.7198 LRAP: 0.8216 NDCG: 0.8100
val Loss: 0.8998 LRAP: 0.8324 NDCG: 0.8441
EarlyStopping counter: 7 out of 25

Epoch 50/99
----------
train Loss: 0.7201 LRAP: 0.8189 NDCG: 0.8088
val Loss: 0.8978 LRAP: 0.8319 NDCG: 0.8464
EarlyStopping counter: 8 out of 25

Epoch 51/99
----------
train Loss: 0.7171 LRAP: 0.8228 NDCG: 0.8077
val Loss: 0.8962 LRAP: 0.8333 NDCG: 0.8476
EarlyStopping counter: 9 out of 25

Epoch 52/99
----------
train Loss: 0.7158 LRAP: 0.8270 NDCG: 0.8142
val Loss: 0.8944 LRAP: 0.8379 NDCG: 0.8529
EarlyStopping counter: 10 out of 25

Epoch 53/99
----------
train Loss: 0.7172 LRAP: 0.8266 NDCG: 0.8120
val Loss: 0.8949 LRAP: 0.8339 NDCG: 0.8495
EarlyStopping counter: 11 out of 25

Epoch 54/99
----------
train Loss: 0.7178 LRAP: 0.8232 NDCG: 0.8126
val Loss: 0.8944 LRAP: 0.8339 NDCG: 0.8489
EarlyStopping counter: 12 out of 25

Epoch 55/99
----------
train Loss: 0.7152 LRAP: 0.8232 NDCG: 0.8131
val Loss: 0.8987 LRAP: 0.8301 NDCG: 0.8434
EarlyStopping counter: 13 out of 25

Epoch 56/99
----------
train Loss: 0.7167 LRAP: 0.8232 NDCG: 0.8114
val Loss: 0.8973 LRAP: 0.8299 NDCG: 0.8415
EarlyStopping counter: 14 out of 25

Epoch 57/99
----------
train Loss: 0.7165 LRAP: 0.8244 NDCG: 0.8097
val Loss: 0.8933 LRAP: 0.8344 NDCG: 0.8488
Validation loss decreased (0.894132 --> 0.893298).  Saving model ...

Epoch 58/99
----------
train Loss: 0.7166 LRAP: 0.8250 NDCG: 0.8117
val Loss: 0.8958 LRAP: 0.8301 NDCG: 0.8467
EarlyStopping counter: 1 out of 25

Epoch 59/99
----------
train Loss: 0.7160 LRAP: 0.8221 NDCG: 0.8105
val Loss: 0.8964 LRAP: 0.8359 NDCG: 0.8523
EarlyStopping counter: 2 out of 25

Epoch 60/99
----------
train Loss: 0.7160 LRAP: 0.8231 NDCG: 0.8102
val Loss: 0.9000 LRAP: 0.8301 NDCG: 0.8414
EarlyStopping counter: 3 out of 25

Epoch 61/99
----------
train Loss: 0.7153 LRAP: 0.8275 NDCG: 0.8138
val Loss: 0.9000 LRAP: 0.8364 NDCG: 0.8522
EarlyStopping counter: 4 out of 25

Epoch 62/99
----------
train Loss: 0.7180 LRAP: 0.8255 NDCG: 0.8087
val Loss: 0.8986 LRAP: 0.8341 NDCG: 0.8477
EarlyStopping counter: 5 out of 25

Epoch 63/99
----------
train Loss: 0.7172 LRAP: 0.8239 NDCG: 0.8115
val Loss: 0.8945 LRAP: 0.8336 NDCG: 0.8485
EarlyStopping counter: 6 out of 25

Epoch 64/99
----------
train Loss: 0.7169 LRAP: 0.8268 NDCG: 0.8141
val Loss: 0.8984 LRAP: 0.8339 NDCG: 0.8450
EarlyStopping counter: 7 out of 25

Epoch 65/99
----------
train Loss: 0.7156 LRAP: 0.8225 NDCG: 0.8135
val Loss: 0.8991 LRAP: 0.8316 NDCG: 0.8459
EarlyStopping counter: 8 out of 25

Epoch 66/99
----------
train Loss: 0.7154 LRAP: 0.8244 NDCG: 0.8132
val Loss: 0.8969 LRAP: 0.8321 NDCG: 0.8472
EarlyStopping counter: 9 out of 25

Epoch 67/99
----------
train Loss: 0.7165 LRAP: 0.8251 NDCG: 0.8139
val Loss: 0.8961 LRAP: 0.8339 NDCG: 0.8499
EarlyStopping counter: 10 out of 25

Epoch 68/99
----------
train Loss: 0.7169 LRAP: 0.8282 NDCG: 0.8150
val Loss: 0.8953 LRAP: 0.8359 NDCG: 0.8531
EarlyStopping counter: 11 out of 25

Epoch 69/99
----------
train Loss: 0.7165 LRAP: 0.8254 NDCG: 0.8128
val Loss: 0.8980 LRAP: 0.8333 NDCG: 0.8472
EarlyStopping counter: 12 out of 25

Epoch 70/99
----------
train Loss: 0.7150 LRAP: 0.8252 NDCG: 0.8127
val Loss: 0.8972 LRAP: 0.8293 NDCG: 0.8438
EarlyStopping counter: 13 out of 25

Epoch 71/99
----------
train Loss: 0.7144 LRAP: 0.8248 NDCG: 0.8099
val Loss: 0.8960 LRAP: 0.8330 NDCG: 0.8470
EarlyStopping counter: 14 out of 25

Epoch 72/99
----------
train Loss: 0.7153 LRAP: 0.8288 NDCG: 0.8182
val Loss: 0.8944 LRAP: 0.8347 NDCG: 0.8542
EarlyStopping counter: 15 out of 25

Epoch 73/99
----------
train Loss: 0.7170 LRAP: 0.8266 NDCG: 0.8144
val Loss: 0.8982 LRAP: 0.8307 NDCG: 0.8461
EarlyStopping counter: 16 out of 25

Epoch 74/99
----------
train Loss: 0.7158 LRAP: 0.8249 NDCG: 0.8091
val Loss: 0.8964 LRAP: 0.8321 NDCG: 0.8463
EarlyStopping counter: 17 out of 25

Epoch 75/99
----------
train Loss: 0.7157 LRAP: 0.8246 NDCG: 0.8109
val Loss: 0.8944 LRAP: 0.8316 NDCG: 0.8451
EarlyStopping counter: 18 out of 25

Epoch 76/99
----------
train Loss: 0.7153 LRAP: 0.8285 NDCG: 0.8160
val Loss: 0.8964 LRAP: 0.8296 NDCG: 0.8422
EarlyStopping counter: 19 out of 25

Epoch 77/99
----------
train Loss: 0.7151 LRAP: 0.8254 NDCG: 0.8120
val Loss: 0.8945 LRAP: 0.8316 NDCG: 0.8470
EarlyStopping counter: 20 out of 25

Epoch 78/99
----------
train Loss: 0.7162 LRAP: 0.8255 NDCG: 0.8124
val Loss: 0.8961 LRAP: 0.8350 NDCG: 0.8502
EarlyStopping counter: 21 out of 25

Epoch 79/99
----------
train Loss: 0.7158 LRAP: 0.8271 NDCG: 0.8149
val Loss: 0.8963 LRAP: 0.8321 NDCG: 0.8451
EarlyStopping counter: 22 out of 25

Epoch 80/99
----------
train Loss: 0.7142 LRAP: 0.8255 NDCG: 0.8143
val Loss: 0.8990 LRAP: 0.8310 NDCG: 0.8409
EarlyStopping counter: 23 out of 25

Epoch 81/99
----------
train Loss: 0.7160 LRAP: 0.8254 NDCG: 0.8129
val Loss: 0.8995 LRAP: 0.8344 NDCG: 0.8482
EarlyStopping counter: 24 out of 25

Epoch 82/99
----------
train Loss: 0.7148 LRAP: 0.8255 NDCG: 0.8137
val Loss: 0.8990 LRAP: 0.8333 NDCG: 0.8461
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 8m 0s
Best val loss: 0.893298, best LRAP score: 0.9612

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7376 LRAP: 0.2293 NDCG: 0.5879
val Loss: 1.3035 LRAP: 0.5390 NDCG: 0.6993
Validation loss decreased (0.000000 --> 1.303458).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2448 LRAP: 0.5974 NDCG: 0.7305
val Loss: 1.1297 LRAP: 0.6218 NDCG: 0.7581
Validation loss decreased (1.303458 --> 1.129679).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1445 LRAP: 0.6448 NDCG: 0.7642
val Loss: 1.1051 LRAP: 0.6472 NDCG: 0.7653
Validation loss decreased (1.129679 --> 1.105135).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0945 LRAP: 0.6504 NDCG: 0.7735
val Loss: 1.0605 LRAP: 0.6880 NDCG: 0.7892
Validation loss decreased (1.105135 --> 1.060503).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0573 LRAP: 0.6699 NDCG: 0.7836
val Loss: 1.0254 LRAP: 0.6811 NDCG: 0.7944
Validation loss decreased (1.060503 --> 1.025419).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0409 LRAP: 0.6733 NDCG: 0.7862
val Loss: 1.0411 LRAP: 0.6965 NDCG: 0.7974
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.0134 LRAP: 0.6811 NDCG: 0.7941
val Loss: 1.0196 LRAP: 0.6983 NDCG: 0.7996
Validation loss decreased (1.025419 --> 1.019643).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9861 LRAP: 0.6865 NDCG: 0.8000
val Loss: 1.0104 LRAP: 0.7268 NDCG: 0.8147
Validation loss decreased (1.019643 --> 1.010381).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9751 LRAP: 0.7000 NDCG: 0.8080
val Loss: 1.0078 LRAP: 0.7268 NDCG: 0.8184
Validation loss decreased (1.010381 --> 1.007846).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9547 LRAP: 0.7051 NDCG: 0.8157
val Loss: 1.0034 LRAP: 0.6880 NDCG: 0.8045
Validation loss decreased (1.007846 --> 1.003422).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9351 LRAP: 0.7124 NDCG: 0.8209
val Loss: 0.9951 LRAP: 0.7322 NDCG: 0.8233
Validation loss decreased (1.003422 --> 0.995102).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9209 LRAP: 0.7232 NDCG: 0.8260
val Loss: 0.9631 LRAP: 0.7451 NDCG: 0.8314
Validation loss decreased (0.995102 --> 0.963139).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9086 LRAP: 0.7297 NDCG: 0.8303
val Loss: 0.9484 LRAP: 0.7439 NDCG: 0.8339
Validation loss decreased (0.963139 --> 0.948362).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9009 LRAP: 0.7305 NDCG: 0.8328
val Loss: 0.9424 LRAP: 0.7671 NDCG: 0.8478
Validation loss decreased (0.948362 --> 0.942430).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8942 LRAP: 0.7312 NDCG: 0.8321
val Loss: 0.9399 LRAP: 0.7202 NDCG: 0.8235
Validation loss decreased (0.942430 --> 0.939904).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8815 LRAP: 0.7357 NDCG: 0.8353
val Loss: 0.9545 LRAP: 0.7742 NDCG: 0.8482
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8731 LRAP: 0.7506 NDCG: 0.8374
val Loss: 0.9357 LRAP: 0.7913 NDCG: 0.8620
Validation loss decreased (0.939904 --> 0.935745).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8629 LRAP: 0.7578 NDCG: 0.8407
val Loss: 0.9323 LRAP: 0.7639 NDCG: 0.8477
Validation loss decreased (0.935745 --> 0.932340).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8556 LRAP: 0.7616 NDCG: 0.8370
val Loss: 0.9273 LRAP: 0.7722 NDCG: 0.8461
Validation loss decreased (0.932340 --> 0.927271).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8533 LRAP: 0.7586 NDCG: 0.8272
val Loss: 0.9291 LRAP: 0.7996 NDCG: 0.8610
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8423 LRAP: 0.7606 NDCG: 0.8284
val Loss: 0.9217 LRAP: 0.7905 NDCG: 0.8523
Validation loss decreased (0.927271 --> 0.921667).  Saving model ...

Epoch 21/99
----------
train Loss: 0.8374 LRAP: 0.7621 NDCG: 0.8310
val Loss: 0.9187 LRAP: 0.7993 NDCG: 0.8517
Validation loss decreased (0.921667 --> 0.918728).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8309 LRAP: 0.7684 NDCG: 0.8236
val Loss: 0.9105 LRAP: 0.7813 NDCG: 0.8502
Validation loss decreased (0.918728 --> 0.910533).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8303 LRAP: 0.7723 NDCG: 0.8197
val Loss: 0.9228 LRAP: 0.7822 NDCG: 0.8409
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8250 LRAP: 0.7742 NDCG: 0.8166
val Loss: 0.9126 LRAP: 0.7947 NDCG: 0.8486
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.8189 LRAP: 0.7791 NDCG: 0.8192
val Loss: 0.9169 LRAP: 0.7882 NDCG: 0.8466
EarlyStopping counter: 3 out of 25

Epoch 26/99
----------
train Loss: 0.8159 LRAP: 0.7795 NDCG: 0.8222
val Loss: 0.9054 LRAP: 0.8099 NDCG: 0.8469
Validation loss decreased (0.910533 --> 0.905448).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8077 LRAP: 0.7849 NDCG: 0.8111
val Loss: 0.9136 LRAP: 0.7833 NDCG: 0.8349
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.8028 LRAP: 0.7865 NDCG: 0.8175
val Loss: 0.9062 LRAP: 0.8022 NDCG: 0.8470
EarlyStopping counter: 2 out of 25

Epoch 29/99
----------
train Loss: 0.8006 LRAP: 0.7841 NDCG: 0.8134
val Loss: 0.9075 LRAP: 0.8022 NDCG: 0.8439
EarlyStopping counter: 3 out of 25

Epoch 30/99
----------
train Loss: 0.7967 LRAP: 0.7888 NDCG: 0.8148
val Loss: 0.8961 LRAP: 0.8122 NDCG: 0.8484
Validation loss decreased (0.905448 --> 0.896138).  Saving model ...

Epoch 31/99
----------
train Loss: 0.7898 LRAP: 0.7904 NDCG: 0.8103
val Loss: 0.8998 LRAP: 0.7956 NDCG: 0.8442
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.7848 LRAP: 0.7903 NDCG: 0.8075
val Loss: 0.8981 LRAP: 0.7996 NDCG: 0.8525
EarlyStopping counter: 2 out of 25

Epoch 33/99
----------
train Loss: 0.7850 LRAP: 0.7958 NDCG: 0.8045
val Loss: 0.9013 LRAP: 0.8039 NDCG: 0.8426
EarlyStopping counter: 3 out of 25

Epoch 34/99
----------
train Loss: 0.7782 LRAP: 0.8035 NDCG: 0.8121
val Loss: 0.8936 LRAP: 0.7982 NDCG: 0.8440
Validation loss decreased (0.896138 --> 0.893584).  Saving model ...

Epoch 35/99
----------
train Loss: 0.7759 LRAP: 0.7984 NDCG: 0.8070
val Loss: 0.9034 LRAP: 0.8093 NDCG: 0.8350
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.7733 LRAP: 0.8018 NDCG: 0.8156
val Loss: 0.8975 LRAP: 0.7979 NDCG: 0.8438
EarlyStopping counter: 2 out of 25

Epoch 37/99
----------
train Loss: 0.7654 LRAP: 0.8047 NDCG: 0.8092
val Loss: 0.8892 LRAP: 0.8059 NDCG: 0.8471
Validation loss decreased (0.893584 --> 0.889224).  Saving model ...

Epoch 38/99
----------
train Loss: 0.7640 LRAP: 0.8018 NDCG: 0.8075
val Loss: 0.8930 LRAP: 0.8050 NDCG: 0.8213
EarlyStopping counter: 1 out of 25

Epoch 39/99
----------
train Loss: 0.7606 LRAP: 0.8060 NDCG: 0.8006
val Loss: 0.8826 LRAP: 0.8036 NDCG: 0.8455
Validation loss decreased (0.889224 --> 0.882571).  Saving model ...

Epoch 40/99
----------
train Loss: 0.7579 LRAP: 0.8115 NDCG: 0.8188
val Loss: 0.9057 LRAP: 0.8193 NDCG: 0.8410
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.7538 LRAP: 0.8144 NDCG: 0.8193
val Loss: 0.8909 LRAP: 0.8293 NDCG: 0.8556
EarlyStopping counter: 2 out of 25

Epoch 42/99
----------
train Loss: 0.7519 LRAP: 0.8120 NDCG: 0.8184
val Loss: 0.8863 LRAP: 0.8142 NDCG: 0.8301
EarlyStopping counter: 3 out of 25

Epoch 43/99
----------
train Loss: 0.7480 LRAP: 0.8118 NDCG: 0.8130
val Loss: 0.8947 LRAP: 0.8321 NDCG: 0.8587
EarlyStopping counter: 4 out of 25

Epoch 44/99
----------
train Loss: 0.7446 LRAP: 0.8193 NDCG: 0.8128
val Loss: 0.8925 LRAP: 0.8370 NDCG: 0.8584
EarlyStopping counter: 5 out of 25

Epoch 45/99
----------
train Loss: 0.7288 LRAP: 0.8259 NDCG: 0.8157
val Loss: 0.8766 LRAP: 0.8376 NDCG: 0.8581
Validation loss decreased (0.882571 --> 0.876590).  Saving model ...

Epoch 46/99
----------
train Loss: 0.7237 LRAP: 0.8313 NDCG: 0.8184
val Loss: 0.8763 LRAP: 0.8456 NDCG: 0.8689
Validation loss decreased (0.876590 --> 0.876334).  Saving model ...

Epoch 47/99
----------
train Loss: 0.7219 LRAP: 0.8290 NDCG: 0.8179
val Loss: 0.8761 LRAP: 0.8424 NDCG: 0.8576
Validation loss decreased (0.876334 --> 0.876090).  Saving model ...

Epoch 48/99
----------
train Loss: 0.7198 LRAP: 0.8329 NDCG: 0.8229
val Loss: 0.8793 LRAP: 0.8456 NDCG: 0.8599
EarlyStopping counter: 1 out of 25

Epoch 49/99
----------
train Loss: 0.7164 LRAP: 0.8351 NDCG: 0.8223
val Loss: 0.8789 LRAP: 0.8533 NDCG: 0.8671
EarlyStopping counter: 2 out of 25

Epoch 50/99
----------
train Loss: 0.7167 LRAP: 0.8403 NDCG: 0.8224
val Loss: 0.8774 LRAP: 0.8458 NDCG: 0.8680
EarlyStopping counter: 3 out of 25

Epoch 51/99
----------
train Loss: 0.7174 LRAP: 0.8327 NDCG: 0.8221
val Loss: 0.8743 LRAP: 0.8424 NDCG: 0.8565
Validation loss decreased (0.876090 --> 0.874292).  Saving model ...

Epoch 52/99
----------
train Loss: 0.7131 LRAP: 0.8399 NDCG: 0.8201
val Loss: 0.8754 LRAP: 0.8456 NDCG: 0.8680
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.7139 LRAP: 0.8355 NDCG: 0.8205
val Loss: 0.8826 LRAP: 0.8444 NDCG: 0.8602
EarlyStopping counter: 2 out of 25

Epoch 54/99
----------
train Loss: 0.7114 LRAP: 0.8367 NDCG: 0.8182
val Loss: 0.8821 LRAP: 0.8484 NDCG: 0.8620
EarlyStopping counter: 3 out of 25

Epoch 55/99
----------
train Loss: 0.7118 LRAP: 0.8435 NDCG: 0.8301
val Loss: 0.8848 LRAP: 0.8498 NDCG: 0.8677
EarlyStopping counter: 4 out of 25

Epoch 56/99
----------
train Loss: 0.7117 LRAP: 0.8430 NDCG: 0.8300
val Loss: 0.8813 LRAP: 0.8447 NDCG: 0.8564
EarlyStopping counter: 5 out of 25

Epoch 57/99
----------
train Loss: 0.7091 LRAP: 0.8438 NDCG: 0.8285
val Loss: 0.8805 LRAP: 0.8458 NDCG: 0.8597
EarlyStopping counter: 6 out of 25

Epoch 58/99
----------
train Loss: 0.7068 LRAP: 0.8416 NDCG: 0.8275
val Loss: 0.8781 LRAP: 0.8530 NDCG: 0.8687
EarlyStopping counter: 7 out of 25

Epoch 59/99
----------
train Loss: 0.7059 LRAP: 0.8446 NDCG: 0.8292
val Loss: 0.8803 LRAP: 0.8504 NDCG: 0.8652
EarlyStopping counter: 8 out of 25

Epoch 60/99
----------
train Loss: 0.7065 LRAP: 0.8425 NDCG: 0.8274
val Loss: 0.8777 LRAP: 0.8487 NDCG: 0.8632
EarlyStopping counter: 9 out of 25

Epoch 61/99
----------
train Loss: 0.7054 LRAP: 0.8394 NDCG: 0.8242
val Loss: 0.8776 LRAP: 0.8476 NDCG: 0.8642
EarlyStopping counter: 10 out of 25

Epoch 62/99
----------
train Loss: 0.7052 LRAP: 0.8443 NDCG: 0.8305
val Loss: 0.8784 LRAP: 0.8473 NDCG: 0.8629
EarlyStopping counter: 11 out of 25

Epoch 63/99
----------
train Loss: 0.7049 LRAP: 0.8454 NDCG: 0.8344
val Loss: 0.8787 LRAP: 0.8473 NDCG: 0.8608
EarlyStopping counter: 12 out of 25

Epoch 64/99
----------
train Loss: 0.7056 LRAP: 0.8466 NDCG: 0.8263
val Loss: 0.8774 LRAP: 0.8501 NDCG: 0.8645
EarlyStopping counter: 13 out of 25

Epoch 65/99
----------
train Loss: 0.7049 LRAP: 0.8467 NDCG: 0.8342
val Loss: 0.8778 LRAP: 0.8521 NDCG: 0.8703
EarlyStopping counter: 14 out of 25

Epoch 66/99
----------
train Loss: 0.7041 LRAP: 0.8430 NDCG: 0.8272
val Loss: 0.8778 LRAP: 0.8473 NDCG: 0.8642
EarlyStopping counter: 15 out of 25

Epoch 67/99
----------
train Loss: 0.7040 LRAP: 0.8420 NDCG: 0.8245
val Loss: 0.8782 LRAP: 0.8484 NDCG: 0.8656
EarlyStopping counter: 16 out of 25

Epoch 68/99
----------
train Loss: 0.7047 LRAP: 0.8441 NDCG: 0.8268
val Loss: 0.8782 LRAP: 0.8521 NDCG: 0.8687
EarlyStopping counter: 17 out of 25

Epoch 69/99
----------
train Loss: 0.7035 LRAP: 0.8436 NDCG: 0.8284
val Loss: 0.8794 LRAP: 0.8478 NDCG: 0.8624
EarlyStopping counter: 18 out of 25

Epoch 70/99
----------
train Loss: 0.7040 LRAP: 0.8455 NDCG: 0.8326
val Loss: 0.8786 LRAP: 0.8484 NDCG: 0.8633
EarlyStopping counter: 19 out of 25

Epoch 71/99
----------
train Loss: 0.7041 LRAP: 0.8451 NDCG: 0.8305
val Loss: 0.8807 LRAP: 0.8444 NDCG: 0.8563
EarlyStopping counter: 20 out of 25

Epoch 72/99
----------
train Loss: 0.7052 LRAP: 0.8449 NDCG: 0.8327
val Loss: 0.8799 LRAP: 0.8521 NDCG: 0.8661
EarlyStopping counter: 21 out of 25

Epoch 73/99
----------
train Loss: 0.7053 LRAP: 0.8444 NDCG: 0.8278
val Loss: 0.8801 LRAP: 0.8461 NDCG: 0.8604
EarlyStopping counter: 22 out of 25

Epoch 74/99
----------
train Loss: 0.7052 LRAP: 0.8465 NDCG: 0.8314
val Loss: 0.8796 LRAP: 0.8498 NDCG: 0.8633
EarlyStopping counter: 23 out of 25

Epoch 75/99
----------
train Loss: 0.7047 LRAP: 0.8465 NDCG: 0.8344
val Loss: 0.8800 LRAP: 0.8496 NDCG: 0.8619
EarlyStopping counter: 24 out of 25

Epoch 76/99
----------
train Loss: 0.7046 LRAP: 0.8441 NDCG: 0.8317
val Loss: 0.8786 LRAP: 0.8473 NDCG: 0.8605
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 17s
Best val loss: 0.874292, best LRAP score: 0.9638

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7637 LRAP: 0.2362 NDCG: 0.5789
val Loss: 1.4254 LRAP: 0.4622 NDCG: 0.6586
Validation loss decreased (0.000000 --> 1.425351).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2541 LRAP: 0.6192 NDCG: 0.7160
val Loss: 1.1610 LRAP: 0.5895 NDCG: 0.7143
Validation loss decreased (1.425351 --> 1.160992).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1754 LRAP: 0.6618 NDCG: 0.7361
val Loss: 1.7005 LRAP: 0.3474 NDCG: 0.6413
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.1342 LRAP: 0.6662 NDCG: 0.7480
val Loss: 1.2160 LRAP: 0.6409 NDCG: 0.7407
EarlyStopping counter: 2 out of 25

Epoch 4/99
----------
train Loss: 1.1039 LRAP: 0.6789 NDCG: 0.7593
val Loss: 1.0894 LRAP: 0.6600 NDCG: 0.7580
Validation loss decreased (1.160992 --> 1.089363).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0842 LRAP: 0.6812 NDCG: 0.7670
val Loss: 1.1429 LRAP: 0.6349 NDCG: 0.7485
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.0776 LRAP: 0.6838 NDCG: 0.7729
val Loss: 1.1463 LRAP: 0.6706 NDCG: 0.7525
EarlyStopping counter: 2 out of 25

Epoch 7/99
----------
train Loss: 1.0497 LRAP: 0.6877 NDCG: 0.7769
val Loss: 1.1143 LRAP: 0.6948 NDCG: 0.7711
EarlyStopping counter: 3 out of 25

Epoch 8/99
----------
train Loss: 1.0507 LRAP: 0.6893 NDCG: 0.7778
val Loss: 1.0893 LRAP: 0.6603 NDCG: 0.7618
Validation loss decreased (1.089363 --> 1.089349).  Saving model ...

Epoch 9/99
----------
train Loss: 1.0363 LRAP: 0.6909 NDCG: 0.7840
val Loss: 1.1301 LRAP: 0.7251 NDCG: 0.7929
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 1.0073 LRAP: 0.7008 NDCG: 0.7870
val Loss: 1.0002 LRAP: 0.7045 NDCG: 0.7963
Validation loss decreased (1.089349 --> 1.000179).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9996 LRAP: 0.6964 NDCG: 0.7909
val Loss: 1.0015 LRAP: 0.7063 NDCG: 0.7936
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.9966 LRAP: 0.7021 NDCG: 0.7949
val Loss: 1.0091 LRAP: 0.7114 NDCG: 0.7909
EarlyStopping counter: 2 out of 25

Epoch 13/99
----------
train Loss: 0.9875 LRAP: 0.6992 NDCG: 0.7938
val Loss: 0.9904 LRAP: 0.6983 NDCG: 0.7915
Validation loss decreased (1.000179 --> 0.990398).  Saving model ...

Epoch 14/99
----------
train Loss: 0.9907 LRAP: 0.6966 NDCG: 0.7941
val Loss: 0.9852 LRAP: 0.7051 NDCG: 0.7976
Validation loss decreased (0.990398 --> 0.985246).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9748 LRAP: 0.7031 NDCG: 0.7991
val Loss: 0.9784 LRAP: 0.7088 NDCG: 0.8013
Validation loss decreased (0.985246 --> 0.978440).  Saving model ...

Epoch 16/99
----------
train Loss: 0.9747 LRAP: 0.7001 NDCG: 0.7988
val Loss: 0.9818 LRAP: 0.7077 NDCG: 0.7986
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.9710 LRAP: 0.6966 NDCG: 0.8001
val Loss: 0.9944 LRAP: 0.6945 NDCG: 0.7974
EarlyStopping counter: 2 out of 25

Epoch 18/99
----------
train Loss: 0.9675 LRAP: 0.7001 NDCG: 0.8032
val Loss: 0.9783 LRAP: 0.7111 NDCG: 0.8044
Validation loss decreased (0.978440 --> 0.978259).  Saving model ...

Epoch 19/99
----------
train Loss: 0.9629 LRAP: 0.6994 NDCG: 0.8038
val Loss: 0.9795 LRAP: 0.7180 NDCG: 0.8107
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.9561 LRAP: 0.7017 NDCG: 0.8056
val Loss: 1.0053 LRAP: 0.6925 NDCG: 0.7951
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 0.9541 LRAP: 0.7099 NDCG: 0.8083
val Loss: 0.9730 LRAP: 0.7145 NDCG: 0.8113
Validation loss decreased (0.978259 --> 0.973045).  Saving model ...

Epoch 22/99
----------
train Loss: 0.9513 LRAP: 0.7065 NDCG: 0.8084
val Loss: 0.9722 LRAP: 0.6960 NDCG: 0.8044
Validation loss decreased (0.973045 --> 0.972151).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9450 LRAP: 0.7057 NDCG: 0.8103
val Loss: 0.9921 LRAP: 0.7017 NDCG: 0.8052
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9394 LRAP: 0.7088 NDCG: 0.8112
val Loss: 0.9672 LRAP: 0.7297 NDCG: 0.8182
Validation loss decreased (0.972151 --> 0.967170).  Saving model ...

Epoch 25/99
----------
train Loss: 0.9353 LRAP: 0.7180 NDCG: 0.8147
val Loss: 0.9609 LRAP: 0.7402 NDCG: 0.8248
Validation loss decreased (0.967170 --> 0.960906).  Saving model ...

Epoch 26/99
----------
train Loss: 0.9307 LRAP: 0.7191 NDCG: 0.8156
val Loss: 0.9653 LRAP: 0.7371 NDCG: 0.8256
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.9327 LRAP: 0.7206 NDCG: 0.8202
val Loss: 0.9618 LRAP: 0.7411 NDCG: 0.8258
EarlyStopping counter: 2 out of 25

Epoch 28/99
----------
train Loss: 0.9276 LRAP: 0.7203 NDCG: 0.8189
val Loss: 0.9560 LRAP: 0.7359 NDCG: 0.8229
Validation loss decreased (0.960906 --> 0.955997).  Saving model ...

Epoch 29/99
----------
train Loss: 0.9233 LRAP: 0.7234 NDCG: 0.8207
val Loss: 0.9511 LRAP: 0.7382 NDCG: 0.8313
Validation loss decreased (0.955997 --> 0.951109).  Saving model ...

Epoch 30/99
----------
train Loss: 0.9181 LRAP: 0.7209 NDCG: 0.8209
val Loss: 0.9498 LRAP: 0.7579 NDCG: 0.8347
Validation loss decreased (0.951109 --> 0.949800).  Saving model ...

Epoch 31/99
----------
train Loss: 0.9176 LRAP: 0.7272 NDCG: 0.8215
val Loss: 0.9554 LRAP: 0.7485 NDCG: 0.8325
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.9160 LRAP: 0.7269 NDCG: 0.8235
val Loss: 0.9551 LRAP: 0.7391 NDCG: 0.8324
EarlyStopping counter: 2 out of 25

Epoch 33/99
----------
train Loss: 0.9131 LRAP: 0.7309 NDCG: 0.8230
val Loss: 0.9405 LRAP: 0.7508 NDCG: 0.8320
Validation loss decreased (0.949800 --> 0.940483).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9115 LRAP: 0.7312 NDCG: 0.8252
val Loss: 0.9685 LRAP: 0.7465 NDCG: 0.8352
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.9088 LRAP: 0.7266 NDCG: 0.8224
val Loss: 0.9443 LRAP: 0.7482 NDCG: 0.8326
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.9059 LRAP: 0.7271 NDCG: 0.8248
val Loss: 0.9410 LRAP: 0.7542 NDCG: 0.8361
EarlyStopping counter: 3 out of 25

Epoch 37/99
----------
train Loss: 0.8996 LRAP: 0.7347 NDCG: 0.8265
val Loss: 0.9445 LRAP: 0.7665 NDCG: 0.8441
EarlyStopping counter: 4 out of 25

Epoch 38/99
----------
train Loss: 0.8977 LRAP: 0.7395 NDCG: 0.8308
val Loss: 0.9476 LRAP: 0.7588 NDCG: 0.8424
EarlyStopping counter: 5 out of 25

Epoch 39/99
----------
train Loss: 0.8872 LRAP: 0.7419 NDCG: 0.8308
val Loss: 0.9267 LRAP: 0.7593 NDCG: 0.8421
Validation loss decreased (0.940483 --> 0.926701).  Saving model ...

Epoch 40/99
----------
train Loss: 0.8818 LRAP: 0.7429 NDCG: 0.8314
val Loss: 0.9260 LRAP: 0.7648 NDCG: 0.8432
Validation loss decreased (0.926701 --> 0.926009).  Saving model ...

Epoch 41/99
----------
train Loss: 0.8839 LRAP: 0.7445 NDCG: 0.8334
val Loss: 0.9270 LRAP: 0.7622 NDCG: 0.8434
EarlyStopping counter: 1 out of 25

Epoch 42/99
----------
train Loss: 0.8840 LRAP: 0.7437 NDCG: 0.8327
val Loss: 0.9246 LRAP: 0.7636 NDCG: 0.8432
Validation loss decreased (0.926009 --> 0.924569).  Saving model ...

Epoch 43/99
----------
train Loss: 0.8830 LRAP: 0.7403 NDCG: 0.8321
val Loss: 0.9259 LRAP: 0.7625 NDCG: 0.8434
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.8796 LRAP: 0.7452 NDCG: 0.8349
val Loss: 0.9241 LRAP: 0.7668 NDCG: 0.8456
Validation loss decreased (0.924569 --> 0.924070).  Saving model ...

Epoch 45/99
----------
train Loss: 0.8803 LRAP: 0.7451 NDCG: 0.8348
val Loss: 0.9255 LRAP: 0.7619 NDCG: 0.8450
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.8764 LRAP: 0.7435 NDCG: 0.8353
val Loss: 0.9235 LRAP: 0.7642 NDCG: 0.8449
Validation loss decreased (0.924070 --> 0.923466).  Saving model ...

Epoch 47/99
----------
train Loss: 0.8767 LRAP: 0.7474 NDCG: 0.8359
val Loss: 0.9232 LRAP: 0.7633 NDCG: 0.8443
Validation loss decreased (0.923466 --> 0.923237).  Saving model ...

Epoch 48/99
----------
train Loss: 0.8764 LRAP: 0.7456 NDCG: 0.8355
val Loss: 0.9233 LRAP: 0.7633 NDCG: 0.8427
EarlyStopping counter: 1 out of 25

Epoch 49/99
----------
train Loss: 0.8775 LRAP: 0.7487 NDCG: 0.8361
val Loss: 0.9230 LRAP: 0.7696 NDCG: 0.8462
Validation loss decreased (0.923237 --> 0.923025).  Saving model ...

Epoch 50/99
----------
train Loss: 0.8756 LRAP: 0.7458 NDCG: 0.8335
val Loss: 0.9231 LRAP: 0.7648 NDCG: 0.8435
EarlyStopping counter: 1 out of 25

Epoch 51/99
----------
train Loss: 0.8746 LRAP: 0.7434 NDCG: 0.8341
val Loss: 0.9234 LRAP: 0.7636 NDCG: 0.8439
EarlyStopping counter: 2 out of 25

Epoch 52/99
----------
train Loss: 0.8737 LRAP: 0.7502 NDCG: 0.8359
val Loss: 0.9235 LRAP: 0.7673 NDCG: 0.8460
EarlyStopping counter: 3 out of 25

Epoch 53/99
----------
train Loss: 0.8689 LRAP: 0.7542 NDCG: 0.8393
val Loss: 0.9225 LRAP: 0.7682 NDCG: 0.8468
Validation loss decreased (0.923025 --> 0.922517).  Saving model ...

Epoch 54/99
----------
train Loss: 0.8724 LRAP: 0.7490 NDCG: 0.8344
val Loss: 0.9240 LRAP: 0.7679 NDCG: 0.8453
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.8720 LRAP: 0.7526 NDCG: 0.8359
val Loss: 0.9223 LRAP: 0.7750 NDCG: 0.8493
Validation loss decreased (0.922517 --> 0.922285).  Saving model ...

Epoch 56/99
----------
train Loss: 0.8696 LRAP: 0.7525 NDCG: 0.8377
val Loss: 0.9208 LRAP: 0.7696 NDCG: 0.8471
Validation loss decreased (0.922285 --> 0.920841).  Saving model ...

Epoch 57/99
----------
train Loss: 0.8689 LRAP: 0.7481 NDCG: 0.8383
val Loss: 0.9216 LRAP: 0.7682 NDCG: 0.8467
EarlyStopping counter: 1 out of 25

Epoch 58/99
----------
train Loss: 0.8685 LRAP: 0.7497 NDCG: 0.8392
val Loss: 0.9212 LRAP: 0.7696 NDCG: 0.8468
EarlyStopping counter: 2 out of 25

Epoch 59/99
----------
train Loss: 0.8683 LRAP: 0.7534 NDCG: 0.8395
val Loss: 0.9214 LRAP: 0.7719 NDCG: 0.8500
EarlyStopping counter: 3 out of 25

Epoch 60/99
----------
train Loss: 0.8659 LRAP: 0.7554 NDCG: 0.8405
val Loss: 0.9199 LRAP: 0.7762 NDCG: 0.8503
Validation loss decreased (0.920841 --> 0.919944).  Saving model ...

Epoch 61/99
----------
train Loss: 0.8655 LRAP: 0.7527 NDCG: 0.8403
val Loss: 0.9208 LRAP: 0.7742 NDCG: 0.8493
EarlyStopping counter: 1 out of 25

Epoch 62/99
----------
train Loss: 0.8646 LRAP: 0.7562 NDCG: 0.8400
val Loss: 0.9199 LRAP: 0.7696 NDCG: 0.8481
Validation loss decreased (0.919944 --> 0.919862).  Saving model ...

Epoch 63/99
----------
train Loss: 0.8658 LRAP: 0.7557 NDCG: 0.8396
val Loss: 0.9190 LRAP: 0.7728 NDCG: 0.8496
Validation loss decreased (0.919862 --> 0.919029).  Saving model ...

Epoch 64/99
----------
train Loss: 0.8647 LRAP: 0.7521 NDCG: 0.8389
val Loss: 0.9191 LRAP: 0.7753 NDCG: 0.8512
EarlyStopping counter: 1 out of 25

Epoch 65/99
----------
train Loss: 0.8664 LRAP: 0.7554 NDCG: 0.8393
val Loss: 0.9180 LRAP: 0.7705 NDCG: 0.8501
Validation loss decreased (0.919029 --> 0.917983).  Saving model ...

Epoch 66/99
----------
train Loss: 0.8603 LRAP: 0.7579 NDCG: 0.8421
val Loss: 0.9187 LRAP: 0.7770 NDCG: 0.8538
EarlyStopping counter: 1 out of 25

Epoch 67/99
----------
train Loss: 0.8646 LRAP: 0.7573 NDCG: 0.8410
val Loss: 0.9173 LRAP: 0.7739 NDCG: 0.8507
Validation loss decreased (0.917983 --> 0.917285).  Saving model ...

Epoch 68/99
----------
train Loss: 0.8641 LRAP: 0.7597 NDCG: 0.8407
val Loss: 0.9193 LRAP: 0.7722 NDCG: 0.8511
EarlyStopping counter: 1 out of 25

Epoch 69/99
----------
train Loss: 0.8600 LRAP: 0.7619 NDCG: 0.8415
val Loss: 0.9190 LRAP: 0.7711 NDCG: 0.8500
EarlyStopping counter: 2 out of 25

Epoch 70/99
----------
train Loss: 0.8604 LRAP: 0.7572 NDCG: 0.8411
val Loss: 0.9192 LRAP: 0.7742 NDCG: 0.8524
EarlyStopping counter: 3 out of 25

Epoch 71/99
----------
train Loss: 0.8597 LRAP: 0.7647 NDCG: 0.8447
val Loss: 0.9192 LRAP: 0.7731 NDCG: 0.8492
EarlyStopping counter: 4 out of 25

Epoch 72/99
----------
train Loss: 0.8606 LRAP: 0.7606 NDCG: 0.8444
val Loss: 0.9201 LRAP: 0.7725 NDCG: 0.8527
EarlyStopping counter: 5 out of 25

Epoch 73/99
----------
train Loss: 0.8550 LRAP: 0.7624 NDCG: 0.8442
val Loss: 0.9172 LRAP: 0.7736 NDCG: 0.8521
Validation loss decreased (0.917285 --> 0.917152).  Saving model ...

Epoch 74/99
----------
train Loss: 0.8555 LRAP: 0.7628 NDCG: 0.8446
val Loss: 0.9171 LRAP: 0.7759 NDCG: 0.8534
Validation loss decreased (0.917152 --> 0.917109).  Saving model ...

Epoch 75/99
----------
train Loss: 0.8555 LRAP: 0.7612 NDCG: 0.8435
val Loss: 0.9192 LRAP: 0.7679 NDCG: 0.8507
EarlyStopping counter: 1 out of 25

Epoch 76/99
----------
train Loss: 0.8558 LRAP: 0.7570 NDCG: 0.8427
val Loss: 0.9165 LRAP: 0.7745 NDCG: 0.8528
Validation loss decreased (0.917109 --> 0.916507).  Saving model ...

Epoch 77/99
----------
train Loss: 0.8537 LRAP: 0.7601 NDCG: 0.8430
val Loss: 0.9194 LRAP: 0.7711 NDCG: 0.8517
EarlyStopping counter: 1 out of 25

Epoch 78/99
----------
train Loss: 0.8550 LRAP: 0.7593 NDCG: 0.8406
val Loss: 0.9169 LRAP: 0.7765 NDCG: 0.8529
EarlyStopping counter: 2 out of 25

Epoch 79/99
----------
train Loss: 0.8551 LRAP: 0.7625 NDCG: 0.8433
val Loss: 0.9173 LRAP: 0.7762 NDCG: 0.8539
EarlyStopping counter: 3 out of 25

Epoch 80/99
----------
train Loss: 0.8544 LRAP: 0.7614 NDCG: 0.8420
val Loss: 0.9170 LRAP: 0.7762 NDCG: 0.8538
EarlyStopping counter: 4 out of 25

Epoch 81/99
----------
train Loss: 0.8555 LRAP: 0.7617 NDCG: 0.8437
val Loss: 0.9166 LRAP: 0.7756 NDCG: 0.8539
EarlyStopping counter: 5 out of 25

Epoch 82/99
----------
train Loss: 0.8521 LRAP: 0.7650 NDCG: 0.8456
val Loss: 0.9177 LRAP: 0.7742 NDCG: 0.8535
EarlyStopping counter: 6 out of 25

Epoch 83/99
----------
train Loss: 0.8541 LRAP: 0.7637 NDCG: 0.8438
val Loss: 0.9177 LRAP: 0.7753 NDCG: 0.8532
EarlyStopping counter: 7 out of 25

Epoch 84/99
----------
train Loss: 0.8552 LRAP: 0.7597 NDCG: 0.8429
val Loss: 0.9177 LRAP: 0.7748 NDCG: 0.8535
EarlyStopping counter: 8 out of 25

Epoch 85/99
----------
train Loss: 0.8549 LRAP: 0.7648 NDCG: 0.8449
val Loss: 0.9168 LRAP: 0.7768 NDCG: 0.8545
EarlyStopping counter: 9 out of 25

Epoch 86/99
----------
train Loss: 0.8527 LRAP: 0.7672 NDCG: 0.8459
val Loss: 0.9169 LRAP: 0.7759 NDCG: 0.8537
EarlyStopping counter: 10 out of 25

Epoch 87/99
----------
train Loss: 0.8552 LRAP: 0.7643 NDCG: 0.8432
val Loss: 0.9179 LRAP: 0.7759 NDCG: 0.8530
EarlyStopping counter: 11 out of 25

Epoch 88/99
----------
train Loss: 0.8547 LRAP: 0.7628 NDCG: 0.8437
val Loss: 0.9177 LRAP: 0.7768 NDCG: 0.8541
EarlyStopping counter: 12 out of 25

Epoch 89/99
----------
train Loss: 0.8539 LRAP: 0.7635 NDCG: 0.8449
val Loss: 0.9171 LRAP: 0.7762 NDCG: 0.8546
EarlyStopping counter: 13 out of 25

Epoch 90/99
----------
train Loss: 0.8544 LRAP: 0.7617 NDCG: 0.8429
val Loss: 0.9170 LRAP: 0.7759 NDCG: 0.8545
EarlyStopping counter: 14 out of 25

Epoch 91/99
----------
train Loss: 0.8537 LRAP: 0.7606 NDCG: 0.8437
val Loss: 0.9171 LRAP: 0.7765 NDCG: 0.8534
EarlyStopping counter: 15 out of 25

Epoch 92/99
----------
train Loss: 0.8553 LRAP: 0.7584 NDCG: 0.8417
val Loss: 0.9178 LRAP: 0.7753 NDCG: 0.8527
EarlyStopping counter: 16 out of 25

Epoch 93/99
----------
train Loss: 0.8552 LRAP: 0.7630 NDCG: 0.8442
val Loss: 0.9167 LRAP: 0.7748 NDCG: 0.8531
EarlyStopping counter: 17 out of 25

Epoch 94/99
----------
train Loss: 0.8541 LRAP: 0.7626 NDCG: 0.8445
val Loss: 0.9174 LRAP: 0.7742 NDCG: 0.8530
EarlyStopping counter: 18 out of 25

Epoch 95/99
----------
train Loss: 0.8535 LRAP: 0.7606 NDCG: 0.8425
val Loss: 0.9182 LRAP: 0.7722 NDCG: 0.8526
EarlyStopping counter: 19 out of 25

Epoch 96/99
----------
train Loss: 0.8526 LRAP: 0.7638 NDCG: 0.8438
val Loss: 0.9178 LRAP: 0.7768 NDCG: 0.8539
EarlyStopping counter: 20 out of 25

Epoch 97/99
----------
train Loss: 0.8564 LRAP: 0.7635 NDCG: 0.8428
val Loss: 0.9156 LRAP: 0.7768 NDCG: 0.8541
Validation loss decreased (0.916507 --> 0.915620).  Saving model ...

Epoch 98/99
----------
train Loss: 0.8522 LRAP: 0.7626 NDCG: 0.8440
val Loss: 0.9173 LRAP: 0.7742 NDCG: 0.8536
EarlyStopping counter: 1 out of 25

Epoch 99/99
----------
train Loss: 0.8518 LRAP: 0.7630 NDCG: 0.8431
val Loss: 0.9171 LRAP: 0.7768 NDCG: 0.8534
EarlyStopping counter: 2 out of 25

Training complete in 9m 44s
Best val loss: 0.915620, best LRAP score: 0.9559

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7821 LRAP: 0.2129 NDCG: 0.5650
val Loss: 1.4881 LRAP: 0.6312 NDCG: 0.7117
Validation loss decreased (0.000000 --> 1.488074).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2851 LRAP: 0.5713 NDCG: 0.6931
val Loss: 1.3748 LRAP: 0.3032 NDCG: 0.6254
Validation loss decreased (1.488074 --> 1.374777).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2243 LRAP: 0.5995 NDCG: 0.7170
val Loss: 1.2765 LRAP: 0.5812 NDCG: 0.7101
Validation loss decreased (1.374777 --> 1.276459).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1917 LRAP: 0.6103 NDCG: 0.7283
val Loss: 1.1789 LRAP: 0.6566 NDCG: 0.7561
Validation loss decreased (1.276459 --> 1.178891).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1658 LRAP: 0.6178 NDCG: 0.7357
val Loss: 1.4241 LRAP: 0.3831 NDCG: 0.6836
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.1549 LRAP: 0.6226 NDCG: 0.7403
val Loss: 1.1698 LRAP: 0.6563 NDCG: 0.7512
Validation loss decreased (1.178891 --> 1.169764).  Saving model ...

Epoch 6/99
----------
train Loss: 1.1294 LRAP: 0.6290 NDCG: 0.7490
val Loss: 1.3377 LRAP: 0.4057 NDCG: 0.6592
EarlyStopping counter: 1 out of 25

Epoch 7/99
----------
train Loss: 1.1215 LRAP: 0.6310 NDCG: 0.7526
val Loss: 1.1862 LRAP: 0.5709 NDCG: 0.7292
EarlyStopping counter: 2 out of 25

Epoch 8/99
----------
train Loss: 1.1112 LRAP: 0.6289 NDCG: 0.7553
val Loss: 1.9765 LRAP: 0.2969 NDCG: 0.6530
EarlyStopping counter: 3 out of 25

Epoch 9/99
----------
train Loss: 1.1049 LRAP: 0.6325 NDCG: 0.7566
val Loss: 1.1004 LRAP: 0.6594 NDCG: 0.7641
Validation loss decreased (1.169764 --> 1.100380).  Saving model ...

Epoch 10/99
----------
train Loss: 1.0898 LRAP: 0.6404 NDCG: 0.7628
val Loss: 1.2165 LRAP: 0.4550 NDCG: 0.6935
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 1.0702 LRAP: 0.6442 NDCG: 0.7665
val Loss: 1.2898 LRAP: 0.5304 NDCG: 0.7178
EarlyStopping counter: 2 out of 25

Epoch 12/99
----------
train Loss: 1.0634 LRAP: 0.6472 NDCG: 0.7700
val Loss: 1.1449 LRAP: 0.6492 NDCG: 0.7784
EarlyStopping counter: 3 out of 25

Epoch 13/99
----------
train Loss: 1.0601 LRAP: 0.6433 NDCG: 0.7658
val Loss: 1.0529 LRAP: 0.6651 NDCG: 0.7817
Validation loss decreased (1.100380 --> 1.052933).  Saving model ...

Epoch 14/99
----------
train Loss: 1.0493 LRAP: 0.6532 NDCG: 0.7740
val Loss: 1.0963 LRAP: 0.7077 NDCG: 0.7966
EarlyStopping counter: 1 out of 25

Epoch 15/99
----------
train Loss: 1.0397 LRAP: 0.6523 NDCG: 0.7750
val Loss: 1.1166 LRAP: 0.5749 NDCG: 0.7420
EarlyStopping counter: 2 out of 25

Epoch 16/99
----------
train Loss: 1.0297 LRAP: 0.6551 NDCG: 0.7708
val Loss: 1.0468 LRAP: 0.6743 NDCG: 0.7792
Validation loss decreased (1.052933 --> 1.046799).  Saving model ...

Epoch 17/99
----------
train Loss: 1.0212 LRAP: 0.6580 NDCG: 0.7702
val Loss: 1.0506 LRAP: 0.7100 NDCG: 0.7920
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 1.0196 LRAP: 0.6570 NDCG: 0.7705
val Loss: 1.0277 LRAP: 0.7034 NDCG: 0.7954
Validation loss decreased (1.046799 --> 1.027663).  Saving model ...

Epoch 19/99
----------
train Loss: 1.0083 LRAP: 0.6640 NDCG: 0.7716
val Loss: 1.0230 LRAP: 0.7083 NDCG: 0.7896
Validation loss decreased (1.027663 --> 1.022978).  Saving model ...

Epoch 20/99
----------
train Loss: 0.9979 LRAP: 0.6683 NDCG: 0.7760
val Loss: 1.0245 LRAP: 0.6734 NDCG: 0.7715
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 0.9944 LRAP: 0.6749 NDCG: 0.7727
val Loss: 1.0078 LRAP: 0.7171 NDCG: 0.7988
Validation loss decreased (1.022978 --> 1.007753).  Saving model ...

Epoch 22/99
----------
train Loss: 0.9874 LRAP: 0.6836 NDCG: 0.7740
val Loss: 0.9852 LRAP: 0.7077 NDCG: 0.7788
Validation loss decreased (1.007753 --> 0.985194).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9846 LRAP: 0.6775 NDCG: 0.7670
val Loss: 1.0509 LRAP: 0.7074 NDCG: 0.7876
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9786 LRAP: 0.6817 NDCG: 0.7667
val Loss: 0.9940 LRAP: 0.6985 NDCG: 0.7818
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.9730 LRAP: 0.6842 NDCG: 0.7659
val Loss: 0.9957 LRAP: 0.6717 NDCG: 0.7751
EarlyStopping counter: 3 out of 25

Epoch 26/99
----------
train Loss: 0.9642 LRAP: 0.6824 NDCG: 0.7646
val Loss: 0.9850 LRAP: 0.7080 NDCG: 0.7827
Validation loss decreased (0.985194 --> 0.985009).  Saving model ...

Epoch 27/99
----------
train Loss: 0.9641 LRAP: 0.6846 NDCG: 0.7675
val Loss: 1.0477 LRAP: 0.7134 NDCG: 0.7981
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.9573 LRAP: 0.6882 NDCG: 0.7636
val Loss: 0.9712 LRAP: 0.7288 NDCG: 0.8000
Validation loss decreased (0.985009 --> 0.971172).  Saving model ...

Epoch 29/99
----------
train Loss: 0.9517 LRAP: 0.6950 NDCG: 0.7621
val Loss: 0.9959 LRAP: 0.7137 NDCG: 0.7828
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.9477 LRAP: 0.6932 NDCG: 0.7687
val Loss: 0.9987 LRAP: 0.7131 NDCG: 0.7869
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.9474 LRAP: 0.6923 NDCG: 0.7573
val Loss: 0.9800 LRAP: 0.7476 NDCG: 0.8053
EarlyStopping counter: 3 out of 25

Epoch 32/99
----------
train Loss: 0.9419 LRAP: 0.6943 NDCG: 0.7583
val Loss: 0.9977 LRAP: 0.7294 NDCG: 0.7720
EarlyStopping counter: 4 out of 25

Epoch 33/99
----------
train Loss: 0.9381 LRAP: 0.6924 NDCG: 0.7588
val Loss: 0.9624 LRAP: 0.7094 NDCG: 0.7853
Validation loss decreased (0.971172 --> 0.962387).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9339 LRAP: 0.6966 NDCG: 0.7586
val Loss: 0.9757 LRAP: 0.7342 NDCG: 0.8047
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.9280 LRAP: 0.7003 NDCG: 0.7572
val Loss: 1.0110 LRAP: 0.7140 NDCG: 0.7287
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.9254 LRAP: 0.6999 NDCG: 0.7510
val Loss: 0.9680 LRAP: 0.7462 NDCG: 0.7892
EarlyStopping counter: 3 out of 25

Epoch 37/99
----------
train Loss: 0.9213 LRAP: 0.7024 NDCG: 0.7615
val Loss: 0.9550 LRAP: 0.7325 NDCG: 0.7895
Validation loss decreased (0.962387 --> 0.954986).  Saving model ...

Epoch 38/99
----------
train Loss: 0.9182 LRAP: 0.7064 NDCG: 0.7594
val Loss: 1.0032 LRAP: 0.7299 NDCG: 0.7654
EarlyStopping counter: 1 out of 25

Epoch 39/99
----------
train Loss: 0.9128 LRAP: 0.7115 NDCG: 0.7575
val Loss: 0.9628 LRAP: 0.7285 NDCG: 0.7870
EarlyStopping counter: 2 out of 25

Epoch 40/99
----------
train Loss: 0.9087 LRAP: 0.7109 NDCG: 0.7585
val Loss: 1.0016 LRAP: 0.7414 NDCG: 0.7721
EarlyStopping counter: 3 out of 25

Epoch 41/99
----------
train Loss: 0.9088 LRAP: 0.7069 NDCG: 0.7585
val Loss: 0.9719 LRAP: 0.7197 NDCG: 0.7628
EarlyStopping counter: 4 out of 25

Epoch 42/99
----------
train Loss: 0.9037 LRAP: 0.7175 NDCG: 0.7657
val Loss: 0.9628 LRAP: 0.7357 NDCG: 0.7903
EarlyStopping counter: 5 out of 25

Epoch 43/99
----------
train Loss: 0.8831 LRAP: 0.7260 NDCG: 0.7634
val Loss: 0.9321 LRAP: 0.7479 NDCG: 0.7888
Validation loss decreased (0.954986 --> 0.932136).  Saving model ...

Epoch 44/99
----------
train Loss: 0.8761 LRAP: 0.7266 NDCG: 0.7632
val Loss: 0.9351 LRAP: 0.7628 NDCG: 0.8101
EarlyStopping counter: 1 out of 25

Epoch 45/99
----------
train Loss: 0.8722 LRAP: 0.7316 NDCG: 0.7656
val Loss: 0.9378 LRAP: 0.7645 NDCG: 0.8014
EarlyStopping counter: 2 out of 25

Epoch 46/99
----------
train Loss: 0.8666 LRAP: 0.7310 NDCG: 0.7633
val Loss: 0.9309 LRAP: 0.7656 NDCG: 0.8075
Validation loss decreased (0.932136 --> 0.930879).  Saving model ...

Epoch 47/99
----------
train Loss: 0.8636 LRAP: 0.7329 NDCG: 0.7713
val Loss: 0.9311 LRAP: 0.7665 NDCG: 0.8038
EarlyStopping counter: 1 out of 25

Epoch 48/99
----------
train Loss: 0.8630 LRAP: 0.7357 NDCG: 0.7685
val Loss: 0.9306 LRAP: 0.7653 NDCG: 0.7946
Validation loss decreased (0.930879 --> 0.930569).  Saving model ...

Epoch 49/99
----------
train Loss: 0.8610 LRAP: 0.7340 NDCG: 0.7651
val Loss: 0.9278 LRAP: 0.7673 NDCG: 0.8077
Validation loss decreased (0.930569 --> 0.927827).  Saving model ...

Epoch 50/99
----------
train Loss: 0.8606 LRAP: 0.7339 NDCG: 0.7675
val Loss: 0.9307 LRAP: 0.7725 NDCG: 0.8125
EarlyStopping counter: 1 out of 25

Epoch 51/99
----------
train Loss: 0.8582 LRAP: 0.7335 NDCG: 0.7639
val Loss: 0.9260 LRAP: 0.7576 NDCG: 0.7956
Validation loss decreased (0.927827 --> 0.926025).  Saving model ...

Epoch 52/99
----------
train Loss: 0.8562 LRAP: 0.7337 NDCG: 0.7704
val Loss: 0.9279 LRAP: 0.7619 NDCG: 0.7941
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.8572 LRAP: 0.7367 NDCG: 0.7726
val Loss: 0.9242 LRAP: 0.7633 NDCG: 0.8056
Validation loss decreased (0.926025 --> 0.924164).  Saving model ...

Epoch 54/99
----------
train Loss: 0.8547 LRAP: 0.7322 NDCG: 0.7662
val Loss: 0.9278 LRAP: 0.7651 NDCG: 0.7981
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.8521 LRAP: 0.7379 NDCG: 0.7667
val Loss: 0.9288 LRAP: 0.7705 NDCG: 0.8148
EarlyStopping counter: 2 out of 25

Epoch 56/99
----------
train Loss: 0.8544 LRAP: 0.7372 NDCG: 0.7692
val Loss: 0.9249 LRAP: 0.7682 NDCG: 0.8149
EarlyStopping counter: 3 out of 25

Epoch 57/99
----------
train Loss: 0.8521 LRAP: 0.7379 NDCG: 0.7734
val Loss: 0.9344 LRAP: 0.7671 NDCG: 0.8004
EarlyStopping counter: 4 out of 25

Epoch 58/99
----------
train Loss: 0.8505 LRAP: 0.7358 NDCG: 0.7642
val Loss: 0.9247 LRAP: 0.7648 NDCG: 0.7924
EarlyStopping counter: 5 out of 25

Epoch 59/99
----------
train Loss: 0.8428 LRAP: 0.7408 NDCG: 0.7632
val Loss: 0.9243 LRAP: 0.7713 NDCG: 0.8034
EarlyStopping counter: 6 out of 25

Epoch 60/99
----------
train Loss: 0.8439 LRAP: 0.7446 NDCG: 0.7713
val Loss: 0.9245 LRAP: 0.7702 NDCG: 0.8032
EarlyStopping counter: 7 out of 25

Epoch 61/99
----------
train Loss: 0.8427 LRAP: 0.7434 NDCG: 0.7697
val Loss: 0.9224 LRAP: 0.7731 NDCG: 0.8094
Validation loss decreased (0.924164 --> 0.922369).  Saving model ...

Epoch 62/99
----------
train Loss: 0.8415 LRAP: 0.7435 NDCG: 0.7704
val Loss: 0.9216 LRAP: 0.7711 NDCG: 0.8120
Validation loss decreased (0.922369 --> 0.921614).  Saving model ...

Epoch 63/99
----------
train Loss: 0.8396 LRAP: 0.7411 NDCG: 0.7716
val Loss: 0.9227 LRAP: 0.7733 NDCG: 0.8058
EarlyStopping counter: 1 out of 25

Epoch 64/99
----------
train Loss: 0.8425 LRAP: 0.7430 NDCG: 0.7704
val Loss: 0.9219 LRAP: 0.7639 NDCG: 0.7944
EarlyStopping counter: 2 out of 25

Epoch 65/99
----------
train Loss: 0.8389 LRAP: 0.7441 NDCG: 0.7736
val Loss: 0.9205 LRAP: 0.7731 NDCG: 0.8121
Validation loss decreased (0.921614 --> 0.920470).  Saving model ...

Epoch 66/99
----------
train Loss: 0.8385 LRAP: 0.7430 NDCG: 0.7698
val Loss: 0.9226 LRAP: 0.7671 NDCG: 0.7999
EarlyStopping counter: 1 out of 25

Epoch 67/99
----------
train Loss: 0.8397 LRAP: 0.7469 NDCG: 0.7736
val Loss: 0.9203 LRAP: 0.7719 NDCG: 0.8068
Validation loss decreased (0.920470 --> 0.920339).  Saving model ...

Epoch 68/99
----------
train Loss: 0.8373 LRAP: 0.7439 NDCG: 0.7697
val Loss: 0.9216 LRAP: 0.7753 NDCG: 0.8138
EarlyStopping counter: 1 out of 25

Epoch 69/99
----------
train Loss: 0.8381 LRAP: 0.7454 NDCG: 0.7714
val Loss: 0.9212 LRAP: 0.7773 NDCG: 0.8189
EarlyStopping counter: 2 out of 25

Epoch 70/99
----------
train Loss: 0.8368 LRAP: 0.7463 NDCG: 0.7733
val Loss: 0.9197 LRAP: 0.7676 NDCG: 0.8037
Validation loss decreased (0.920339 --> 0.919747).  Saving model ...

Epoch 71/99
----------
train Loss: 0.8368 LRAP: 0.7426 NDCG: 0.7714
val Loss: 0.9224 LRAP: 0.7716 NDCG: 0.8087
EarlyStopping counter: 1 out of 25

Epoch 72/99
----------
train Loss: 0.8385 LRAP: 0.7433 NDCG: 0.7693
val Loss: 0.9197 LRAP: 0.7699 NDCG: 0.8050
Validation loss decreased (0.919747 --> 0.919741).  Saving model ...

Epoch 73/99
----------
train Loss: 0.8382 LRAP: 0.7422 NDCG: 0.7711
val Loss: 0.9196 LRAP: 0.7668 NDCG: 0.8018
Validation loss decreased (0.919741 --> 0.919586).  Saving model ...

Epoch 74/99
----------
train Loss: 0.8394 LRAP: 0.7427 NDCG: 0.7725
val Loss: 0.9203 LRAP: 0.7731 NDCG: 0.8105
EarlyStopping counter: 1 out of 25

Epoch 75/99
----------
train Loss: 0.8360 LRAP: 0.7461 NDCG: 0.7758
val Loss: 0.9205 LRAP: 0.7696 NDCG: 0.8065
EarlyStopping counter: 2 out of 25

Epoch 76/99
----------
train Loss: 0.8356 LRAP: 0.7461 NDCG: 0.7739
val Loss: 0.9200 LRAP: 0.7722 NDCG: 0.8044
EarlyStopping counter: 3 out of 25

Epoch 77/99
----------
train Loss: 0.8348 LRAP: 0.7476 NDCG: 0.7761
val Loss: 0.9198 LRAP: 0.7739 NDCG: 0.8101
EarlyStopping counter: 4 out of 25

Epoch 78/99
----------
train Loss: 0.8360 LRAP: 0.7473 NDCG: 0.7762
val Loss: 0.9209 LRAP: 0.7793 NDCG: 0.8165
EarlyStopping counter: 5 out of 25

Epoch 79/99
----------
train Loss: 0.8321 LRAP: 0.7476 NDCG: 0.7792
val Loss: 0.9191 LRAP: 0.7745 NDCG: 0.8138
Validation loss decreased (0.919586 --> 0.919059).  Saving model ...

Epoch 80/99
----------
train Loss: 0.8350 LRAP: 0.7468 NDCG: 0.7813
val Loss: 0.9199 LRAP: 0.7671 NDCG: 0.8033
EarlyStopping counter: 1 out of 25

Epoch 81/99
----------
train Loss: 0.8344 LRAP: 0.7465 NDCG: 0.7780
val Loss: 0.9205 LRAP: 0.7802 NDCG: 0.8171
EarlyStopping counter: 2 out of 25

Epoch 82/99
----------
train Loss: 0.8333 LRAP: 0.7461 NDCG: 0.7743
val Loss: 0.9205 LRAP: 0.7736 NDCG: 0.8100
EarlyStopping counter: 3 out of 25

Epoch 83/99
----------
train Loss: 0.8328 LRAP: 0.7467 NDCG: 0.7786
val Loss: 0.9196 LRAP: 0.7773 NDCG: 0.8137
EarlyStopping counter: 4 out of 25

Epoch 84/99
----------
train Loss: 0.8331 LRAP: 0.7481 NDCG: 0.7775
val Loss: 0.9201 LRAP: 0.7756 NDCG: 0.8108
EarlyStopping counter: 5 out of 25

Epoch 85/99
----------
train Loss: 0.8312 LRAP: 0.7470 NDCG: 0.7774
val Loss: 0.9199 LRAP: 0.7782 NDCG: 0.8166
EarlyStopping counter: 6 out of 25

Epoch 86/99
----------
train Loss: 0.8339 LRAP: 0.7450 NDCG: 0.7760
val Loss: 0.9200 LRAP: 0.7731 NDCG: 0.8077
EarlyStopping counter: 7 out of 25

Epoch 87/99
----------
train Loss: 0.8336 LRAP: 0.7524 NDCG: 0.7795
val Loss: 0.9205 LRAP: 0.7759 NDCG: 0.8130
EarlyStopping counter: 8 out of 25

Epoch 88/99
----------
train Loss: 0.8322 LRAP: 0.7479 NDCG: 0.7751
val Loss: 0.9206 LRAP: 0.7768 NDCG: 0.8131
EarlyStopping counter: 9 out of 25

Epoch 89/99
----------
train Loss: 0.8348 LRAP: 0.7494 NDCG: 0.7750
val Loss: 0.9198 LRAP: 0.7731 NDCG: 0.8105
EarlyStopping counter: 10 out of 25

Epoch 90/99
----------
train Loss: 0.8318 LRAP: 0.7491 NDCG: 0.7743
val Loss: 0.9203 LRAP: 0.7768 NDCG: 0.8117
EarlyStopping counter: 11 out of 25

Epoch 91/99
----------
train Loss: 0.8322 LRAP: 0.7485 NDCG: 0.7775
val Loss: 0.9202 LRAP: 0.7768 NDCG: 0.8135
EarlyStopping counter: 12 out of 25

Epoch 92/99
----------
train Loss: 0.8325 LRAP: 0.7462 NDCG: 0.7781
val Loss: 0.9201 LRAP: 0.7745 NDCG: 0.8099
EarlyStopping counter: 13 out of 25

Epoch 93/99
----------
train Loss: 0.8322 LRAP: 0.7460 NDCG: 0.7727
val Loss: 0.9215 LRAP: 0.7731 NDCG: 0.8103
EarlyStopping counter: 14 out of 25

Epoch 94/99
----------
train Loss: 0.8332 LRAP: 0.7454 NDCG: 0.7725
val Loss: 0.9220 LRAP: 0.7753 NDCG: 0.8091
EarlyStopping counter: 15 out of 25

Epoch 95/99
----------
train Loss: 0.8333 LRAP: 0.7498 NDCG: 0.7792
val Loss: 0.9222 LRAP: 0.7799 NDCG: 0.8192
EarlyStopping counter: 16 out of 25

Epoch 96/99
----------
train Loss: 0.8336 LRAP: 0.7489 NDCG: 0.7779
val Loss: 0.9212 LRAP: 0.7785 NDCG: 0.8153
EarlyStopping counter: 17 out of 25

Epoch 97/99
----------
train Loss: 0.8327 LRAP: 0.7455 NDCG: 0.7778
val Loss: 0.9210 LRAP: 0.7773 NDCG: 0.8139
EarlyStopping counter: 18 out of 25

Epoch 98/99
----------
train Loss: 0.8354 LRAP: 0.7483 NDCG: 0.7785
val Loss: 0.9216 LRAP: 0.7759 NDCG: 0.8098
EarlyStopping counter: 19 out of 25

Epoch 99/99
----------
train Loss: 0.8320 LRAP: 0.7463 NDCG: 0.7752
val Loss: 0.9196 LRAP: 0.7770 NDCG: 0.8166
EarlyStopping counter: 20 out of 25

Training complete in 9m 56s
Best val loss: 0.919059, best LRAP score: 0.9559

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 5/10

All random seeds set to: 424
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.8188 LRAP: 0.1268 NDCG: 0.5505
val Loss: 1.3361 LRAP: 0.5144 NDCG: 0.6879
Validation loss decreased (0.000000 --> 1.336054).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2434 LRAP: 0.5327 NDCG: 0.6990
val Loss: 1.1125 LRAP: 0.6317 NDCG: 0.7404
Validation loss decreased (1.336054 --> 1.112508).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1354 LRAP: 0.6350 NDCG: 0.7427
val Loss: 1.1045 LRAP: 0.6423 NDCG: 0.7550
Validation loss decreased (1.112508 --> 1.104535).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0889 LRAP: 0.6531 NDCG: 0.7530
val Loss: 1.0060 LRAP: 0.5687 NDCG: 0.7462
Validation loss decreased (1.104535 --> 1.006001).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0446 LRAP: 0.6536 NDCG: 0.7607
val Loss: 0.9984 LRAP: 0.6691 NDCG: 0.7637
Validation loss decreased (1.006001 --> 0.998450).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0134 LRAP: 0.6486 NDCG: 0.7684
val Loss: 0.9632 LRAP: 0.7088 NDCG: 0.8022
Validation loss decreased (0.998450 --> 0.963208).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9850 LRAP: 0.6517 NDCG: 0.7793
val Loss: 0.9528 LRAP: 0.6654 NDCG: 0.7927
Validation loss decreased (0.963208 --> 0.952820).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9605 LRAP: 0.6548 NDCG: 0.7859
val Loss: 0.9517 LRAP: 0.7000 NDCG: 0.8061
Validation loss decreased (0.952820 --> 0.951673).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9368 LRAP: 0.6560 NDCG: 0.7895
val Loss: 0.9382 LRAP: 0.7074 NDCG: 0.8134
Validation loss decreased (0.951673 --> 0.938181).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9267 LRAP: 0.6684 NDCG: 0.7958
val Loss: 0.9439 LRAP: 0.7140 NDCG: 0.8193
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9134 LRAP: 0.6745 NDCG: 0.8004
val Loss: 0.9227 LRAP: 0.7371 NDCG: 0.8290
Validation loss decreased (0.938181 --> 0.922702).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9010 LRAP: 0.6877 NDCG: 0.8064
val Loss: 0.9160 LRAP: 0.7160 NDCG: 0.8213
Validation loss decreased (0.922702 --> 0.916020).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8890 LRAP: 0.6958 NDCG: 0.8118
val Loss: 0.9292 LRAP: 0.7160 NDCG: 0.8170
EarlyStopping counter: 1 out of 25

Epoch 13/99
----------
train Loss: 0.8765 LRAP: 0.7069 NDCG: 0.8163
val Loss: 0.9228 LRAP: 0.7331 NDCG: 0.8312
EarlyStopping counter: 2 out of 25

Epoch 14/99
----------
train Loss: 0.8724 LRAP: 0.7087 NDCG: 0.8210
val Loss: 0.9130 LRAP: 0.7554 NDCG: 0.8384
Validation loss decreased (0.916020 --> 0.913042).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8677 LRAP: 0.7168 NDCG: 0.8210
val Loss: 0.9136 LRAP: 0.7502 NDCG: 0.8384
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8565 LRAP: 0.7220 NDCG: 0.8238
val Loss: 0.9211 LRAP: 0.7636 NDCG: 0.8427
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 0.8516 LRAP: 0.7376 NDCG: 0.8291
val Loss: 0.9080 LRAP: 0.7499 NDCG: 0.8384
Validation loss decreased (0.913042 --> 0.908048).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8413 LRAP: 0.7290 NDCG: 0.8233
val Loss: 0.9084 LRAP: 0.7999 NDCG: 0.8531
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.8345 LRAP: 0.7398 NDCG: 0.8230
val Loss: 0.9007 LRAP: 0.7568 NDCG: 0.8270
Validation loss decreased (0.908048 --> 0.900657).  Saving model ...

Epoch 20/99
----------
train Loss: 0.8265 LRAP: 0.7375 NDCG: 0.8226
val Loss: 0.9044 LRAP: 0.7927 NDCG: 0.8438
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 0.8270 LRAP: 0.7465 NDCG: 0.8154
val Loss: 0.8991 LRAP: 0.7408 NDCG: 0.8217
Validation loss decreased (0.900657 --> 0.899067).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8219 LRAP: 0.7445 NDCG: 0.8156
val Loss: 0.8962 LRAP: 0.7785 NDCG: 0.8480
Validation loss decreased (0.899067 --> 0.896218).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8146 LRAP: 0.7425 NDCG: 0.8117
val Loss: 0.9009 LRAP: 0.7788 NDCG: 0.8344
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8115 LRAP: 0.7512 NDCG: 0.8079
val Loss: 0.8924 LRAP: 0.8076 NDCG: 0.8444
Validation loss decreased (0.896218 --> 0.892439).  Saving model ...

Epoch 25/99
----------
train Loss: 0.8018 LRAP: 0.7606 NDCG: 0.8049
val Loss: 0.8866 LRAP: 0.7656 NDCG: 0.8394
Validation loss decreased (0.892439 --> 0.886635).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8009 LRAP: 0.7669 NDCG: 0.8118
val Loss: 0.8842 LRAP: 0.8036 NDCG: 0.8391
Validation loss decreased (0.886635 --> 0.884168).  Saving model ...

Epoch 27/99
----------
train Loss: 0.7963 LRAP: 0.7630 NDCG: 0.8013
val Loss: 0.8815 LRAP: 0.7953 NDCG: 0.8418
Validation loss decreased (0.884168 --> 0.881548).  Saving model ...

Epoch 28/99
----------
train Loss: 0.7900 LRAP: 0.7645 NDCG: 0.7997
val Loss: 0.8966 LRAP: 0.7953 NDCG: 0.8382
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.7878 LRAP: 0.7613 NDCG: 0.7934
val Loss: 0.8915 LRAP: 0.8053 NDCG: 0.8286
EarlyStopping counter: 2 out of 25

Epoch 30/99
----------
train Loss: 0.7822 LRAP: 0.7682 NDCG: 0.8017
val Loss: 0.8789 LRAP: 0.8084 NDCG: 0.8422
Validation loss decreased (0.881548 --> 0.878947).  Saving model ...

Epoch 31/99
----------
train Loss: 0.7804 LRAP: 0.7700 NDCG: 0.7992
val Loss: 0.8805 LRAP: 0.7927 NDCG: 0.8275
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.7713 LRAP: 0.7748 NDCG: 0.7895
val Loss: 0.8861 LRAP: 0.8013 NDCG: 0.8300
EarlyStopping counter: 2 out of 25

Epoch 33/99
----------
train Loss: 0.7701 LRAP: 0.7723 NDCG: 0.7874
val Loss: 0.8858 LRAP: 0.8199 NDCG: 0.8392
EarlyStopping counter: 3 out of 25

Epoch 34/99
----------
train Loss: 0.7670 LRAP: 0.7794 NDCG: 0.8015
val Loss: 0.8848 LRAP: 0.8093 NDCG: 0.8396
EarlyStopping counter: 4 out of 25

Epoch 35/99
----------
train Loss: 0.7600 LRAP: 0.7780 NDCG: 0.7789
val Loss: 0.8760 LRAP: 0.8056 NDCG: 0.8249
Validation loss decreased (0.878947 --> 0.875961).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7607 LRAP: 0.7814 NDCG: 0.7794
val Loss: 0.8790 LRAP: 0.8096 NDCG: 0.8437
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.7552 LRAP: 0.7833 NDCG: 0.7944
val Loss: 0.8883 LRAP: 0.8019 NDCG: 0.8128
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.7549 LRAP: 0.7839 NDCG: 0.7883
val Loss: 0.8717 LRAP: 0.8261 NDCG: 0.8663
Validation loss decreased (0.875961 --> 0.871666).  Saving model ...

Epoch 39/99
----------
train Loss: 0.7506 LRAP: 0.7851 NDCG: 0.7835
val Loss: 0.8672 LRAP: 0.7927 NDCG: 0.8120
Validation loss decreased (0.871666 --> 0.867215).  Saving model ...

Epoch 40/99
----------
train Loss: 0.7483 LRAP: 0.7813 NDCG: 0.7790
val Loss: 0.8793 LRAP: 0.7967 NDCG: 0.8305
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.7483 LRAP: 0.7767 NDCG: 0.7623
val Loss: 0.8729 LRAP: 0.8153 NDCG: 0.8480
EarlyStopping counter: 2 out of 25

Epoch 42/99
----------
train Loss: 0.7449 LRAP: 0.7832 NDCG: 0.7686
val Loss: 0.8702 LRAP: 0.7902 NDCG: 0.7911
EarlyStopping counter: 3 out of 25

Epoch 43/99
----------
train Loss: 0.7396 LRAP: 0.7855 NDCG: 0.7731
val Loss: 0.8739 LRAP: 0.8119 NDCG: 0.8239
EarlyStopping counter: 4 out of 25

Epoch 44/99
----------
train Loss: 0.7374 LRAP: 0.7869 NDCG: 0.7690
val Loss: 0.8700 LRAP: 0.8259 NDCG: 0.8383
EarlyStopping counter: 5 out of 25

Epoch 45/99
----------
train Loss: 0.7239 LRAP: 0.7984 NDCG: 0.7820
val Loss: 0.8643 LRAP: 0.8293 NDCG: 0.8432
Validation loss decreased (0.867215 --> 0.864303).  Saving model ...

Epoch 46/99
----------
train Loss: 0.7175 LRAP: 0.7989 NDCG: 0.7713
val Loss: 0.8691 LRAP: 0.8267 NDCG: 0.8303
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.7169 LRAP: 0.8059 NDCG: 0.7798
val Loss: 0.8689 LRAP: 0.8279 NDCG: 0.8395
EarlyStopping counter: 2 out of 25

Epoch 48/99
----------
train Loss: 0.7134 LRAP: 0.8068 NDCG: 0.7783
val Loss: 0.8690 LRAP: 0.8333 NDCG: 0.8454
EarlyStopping counter: 3 out of 25

Epoch 49/99
----------
train Loss: 0.7132 LRAP: 0.8119 NDCG: 0.7840
val Loss: 0.8721 LRAP: 0.8384 NDCG: 0.8430
EarlyStopping counter: 4 out of 25

Epoch 50/99
----------
train Loss: 0.7116 LRAP: 0.8098 NDCG: 0.7793
val Loss: 0.8726 LRAP: 0.8247 NDCG: 0.8210
EarlyStopping counter: 5 out of 25

Epoch 51/99
----------
train Loss: 0.7094 LRAP: 0.8085 NDCG: 0.7768
val Loss: 0.8706 LRAP: 0.8353 NDCG: 0.8438
EarlyStopping counter: 6 out of 25

Epoch 52/99
----------
train Loss: 0.7079 LRAP: 0.8107 NDCG: 0.7832
val Loss: 0.8693 LRAP: 0.8393 NDCG: 0.8443
EarlyStopping counter: 7 out of 25

Epoch 53/99
----------
train Loss: 0.7076 LRAP: 0.8114 NDCG: 0.7828
val Loss: 0.8685 LRAP: 0.8353 NDCG: 0.8445
EarlyStopping counter: 8 out of 25

Epoch 54/99
----------
train Loss: 0.7083 LRAP: 0.8101 NDCG: 0.7776
val Loss: 0.8702 LRAP: 0.8356 NDCG: 0.8361
EarlyStopping counter: 9 out of 25

Epoch 55/99
----------
train Loss: 0.7068 LRAP: 0.8124 NDCG: 0.7864
val Loss: 0.8694 LRAP: 0.8336 NDCG: 0.8420
EarlyStopping counter: 10 out of 25

Epoch 56/99
----------
train Loss: 0.7059 LRAP: 0.8104 NDCG: 0.7800
val Loss: 0.8686 LRAP: 0.8379 NDCG: 0.8438
EarlyStopping counter: 11 out of 25

Epoch 57/99
----------
train Loss: 0.7065 LRAP: 0.8108 NDCG: 0.7815
val Loss: 0.8698 LRAP: 0.8396 NDCG: 0.8437
EarlyStopping counter: 12 out of 25

Epoch 58/99
----------
train Loss: 0.7066 LRAP: 0.8127 NDCG: 0.7828
val Loss: 0.8716 LRAP: 0.8404 NDCG: 0.8454
EarlyStopping counter: 13 out of 25

Epoch 59/99
----------
train Loss: 0.7052 LRAP: 0.8119 NDCG: 0.7824
val Loss: 0.8682 LRAP: 0.8421 NDCG: 0.8463
EarlyStopping counter: 14 out of 25

Epoch 60/99
----------
train Loss: 0.7051 LRAP: 0.8114 NDCG: 0.7843
val Loss: 0.8684 LRAP: 0.8418 NDCG: 0.8495
EarlyStopping counter: 15 out of 25

Epoch 61/99
----------
train Loss: 0.7054 LRAP: 0.8133 NDCG: 0.7805
val Loss: 0.8698 LRAP: 0.8401 NDCG: 0.8438
EarlyStopping counter: 16 out of 25

Epoch 62/99
----------
train Loss: 0.7061 LRAP: 0.8103 NDCG: 0.7832
val Loss: 0.8701 LRAP: 0.8401 NDCG: 0.8426
EarlyStopping counter: 17 out of 25

Epoch 63/99
----------
train Loss: 0.7056 LRAP: 0.8112 NDCG: 0.7837
val Loss: 0.8672 LRAP: 0.8404 NDCG: 0.8499
EarlyStopping counter: 18 out of 25

Epoch 64/99
----------
train Loss: 0.7063 LRAP: 0.8137 NDCG: 0.7835
val Loss: 0.8697 LRAP: 0.8410 NDCG: 0.8443
EarlyStopping counter: 19 out of 25

Epoch 65/99
----------
train Loss: 0.7052 LRAP: 0.8123 NDCG: 0.7811
val Loss: 0.8687 LRAP: 0.8441 NDCG: 0.8500
EarlyStopping counter: 20 out of 25

Epoch 66/99
----------
train Loss: 0.7044 LRAP: 0.8139 NDCG: 0.7780
val Loss: 0.8687 LRAP: 0.8401 NDCG: 0.8432
EarlyStopping counter: 21 out of 25

Epoch 67/99
----------
train Loss: 0.7059 LRAP: 0.8128 NDCG: 0.7790
val Loss: 0.8686 LRAP: 0.8418 NDCG: 0.8473
EarlyStopping counter: 22 out of 25

Epoch 68/99
----------
train Loss: 0.7059 LRAP: 0.8106 NDCG: 0.7815
val Loss: 0.8686 LRAP: 0.8387 NDCG: 0.8434
EarlyStopping counter: 23 out of 25

Epoch 69/99
----------
train Loss: 0.7064 LRAP: 0.8114 NDCG: 0.7763
val Loss: 0.8696 LRAP: 0.8427 NDCG: 0.8490
EarlyStopping counter: 24 out of 25

Epoch 70/99
----------
train Loss: 0.7067 LRAP: 0.8125 NDCG: 0.7841
val Loss: 0.8653 LRAP: 0.8436 NDCG: 0.8571
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 8m 42s
Best val loss: 0.864303, best LRAP score: 0.9656

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.8415 LRAP: 0.1393 NDCG: 0.5478
val Loss: 1.3725 LRAP: 0.3497 NDCG: 0.6347
Validation loss decreased (0.000000 --> 1.372472).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2923 LRAP: 0.5011 NDCG: 0.6894
val Loss: 1.1398 LRAP: 0.6132 NDCG: 0.7274
Validation loss decreased (1.372472 --> 1.139769).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1704 LRAP: 0.6040 NDCG: 0.7383
val Loss: 1.0924 LRAP: 0.6552 NDCG: 0.7665
Validation loss decreased (1.139769 --> 1.092364).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1193 LRAP: 0.6218 NDCG: 0.7510
val Loss: 1.0577 LRAP: 0.6446 NDCG: 0.7688
Validation loss decreased (1.092364 --> 1.057731).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0770 LRAP: 0.6218 NDCG: 0.7585
val Loss: 1.0366 LRAP: 0.6554 NDCG: 0.7696
Validation loss decreased (1.057731 --> 1.036591).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0463 LRAP: 0.6449 NDCG: 0.7695
val Loss: 1.0035 LRAP: 0.6791 NDCG: 0.7914
Validation loss decreased (1.036591 --> 1.003513).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0211 LRAP: 0.6518 NDCG: 0.7768
val Loss: 0.9796 LRAP: 0.6706 NDCG: 0.7953
Validation loss decreased (1.003513 --> 0.979558).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9974 LRAP: 0.6504 NDCG: 0.7825
val Loss: 0.9810 LRAP: 0.6734 NDCG: 0.7912
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 0.9741 LRAP: 0.6729 NDCG: 0.7934
val Loss: 0.9537 LRAP: 0.7297 NDCG: 0.8243
Validation loss decreased (0.979558 --> 0.953699).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9554 LRAP: 0.6826 NDCG: 0.8023
val Loss: 0.9558 LRAP: 0.7354 NDCG: 0.8250
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9354 LRAP: 0.6975 NDCG: 0.8128
val Loss: 0.9377 LRAP: 0.7436 NDCG: 0.8317
Validation loss decreased (0.953699 --> 0.937694).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9187 LRAP: 0.6978 NDCG: 0.8127
val Loss: 0.9416 LRAP: 0.7568 NDCG: 0.8370
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.9119 LRAP: 0.7100 NDCG: 0.8191
val Loss: 0.9328 LRAP: 0.7585 NDCG: 0.8304
Validation loss decreased (0.937694 --> 0.932812).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8966 LRAP: 0.7161 NDCG: 0.8213
val Loss: 0.9368 LRAP: 0.7613 NDCG: 0.8402
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.8861 LRAP: 0.7287 NDCG: 0.8281
val Loss: 0.9159 LRAP: 0.7776 NDCG: 0.8479
Validation loss decreased (0.932812 --> 0.915867).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8774 LRAP: 0.7339 NDCG: 0.8290
val Loss: 0.9033 LRAP: 0.7890 NDCG: 0.8550
Validation loss decreased (0.915867 --> 0.903317).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8719 LRAP: 0.7492 NDCG: 0.8337
val Loss: 0.9128 LRAP: 0.8030 NDCG: 0.8570
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.8612 LRAP: 0.7439 NDCG: 0.8310
val Loss: 0.9183 LRAP: 0.8045 NDCG: 0.8573
EarlyStopping counter: 2 out of 25

Epoch 18/99
----------
train Loss: 0.8564 LRAP: 0.7433 NDCG: 0.8244
val Loss: 0.9097 LRAP: 0.7414 NDCG: 0.8281
EarlyStopping counter: 3 out of 25

Epoch 19/99
----------
train Loss: 0.8494 LRAP: 0.7575 NDCG: 0.8278
val Loss: 0.9137 LRAP: 0.7822 NDCG: 0.8405
EarlyStopping counter: 4 out of 25

Epoch 20/99
----------
train Loss: 0.8432 LRAP: 0.7535 NDCG: 0.8206
val Loss: 0.9057 LRAP: 0.7645 NDCG: 0.8274
EarlyStopping counter: 5 out of 25

Epoch 21/99
----------
train Loss: 0.8181 LRAP: 0.7691 NDCG: 0.8243
val Loss: 0.8837 LRAP: 0.8096 NDCG: 0.8526
Validation loss decreased (0.903317 --> 0.883686).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8061 LRAP: 0.7787 NDCG: 0.8276
val Loss: 0.8829 LRAP: 0.8104 NDCG: 0.8482
Validation loss decreased (0.883686 --> 0.882932).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8025 LRAP: 0.7799 NDCG: 0.8237
val Loss: 0.8830 LRAP: 0.8119 NDCG: 0.8512
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8000 LRAP: 0.7842 NDCG: 0.8238
val Loss: 0.8798 LRAP: 0.8224 NDCG: 0.8531
Validation loss decreased (0.882932 --> 0.879763).  Saving model ...

Epoch 25/99
----------
train Loss: 0.7943 LRAP: 0.7842 NDCG: 0.8243
val Loss: 0.8816 LRAP: 0.8156 NDCG: 0.8533
EarlyStopping counter: 1 out of 25

Epoch 26/99
----------
train Loss: 0.7912 LRAP: 0.7841 NDCG: 0.8206
val Loss: 0.8787 LRAP: 0.8005 NDCG: 0.8409
Validation loss decreased (0.879763 --> 0.878655).  Saving model ...

Epoch 27/99
----------
train Loss: 0.7881 LRAP: 0.7844 NDCG: 0.8219
val Loss: 0.8776 LRAP: 0.8259 NDCG: 0.8543
Validation loss decreased (0.878655 --> 0.877649).  Saving model ...

Epoch 28/99
----------
train Loss: 0.7906 LRAP: 0.7899 NDCG: 0.8215
val Loss: 0.8892 LRAP: 0.8202 NDCG: 0.8435
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.7868 LRAP: 0.7933 NDCG: 0.8183
val Loss: 0.8802 LRAP: 0.8144 NDCG: 0.8383
EarlyStopping counter: 2 out of 25

Epoch 30/99
----------
train Loss: 0.7827 LRAP: 0.7918 NDCG: 0.8116
val Loss: 0.8801 LRAP: 0.8144 NDCG: 0.8429
EarlyStopping counter: 3 out of 25

Epoch 31/99
----------
train Loss: 0.7811 LRAP: 0.7909 NDCG: 0.8139
val Loss: 0.8785 LRAP: 0.8210 NDCG: 0.8457
EarlyStopping counter: 4 out of 25

Epoch 32/99
----------
train Loss: 0.7792 LRAP: 0.7976 NDCG: 0.8215
val Loss: 0.8813 LRAP: 0.8219 NDCG: 0.8426
EarlyStopping counter: 5 out of 25

Epoch 33/99
----------
train Loss: 0.7729 LRAP: 0.8023 NDCG: 0.8229
val Loss: 0.8776 LRAP: 0.8264 NDCG: 0.8497
Validation loss decreased (0.877649 --> 0.877573).  Saving model ...

Epoch 34/99
----------
train Loss: 0.7687 LRAP: 0.8036 NDCG: 0.8230
val Loss: 0.8764 LRAP: 0.8222 NDCG: 0.8459
Validation loss decreased (0.877573 --> 0.876419).  Saving model ...

Epoch 35/99
----------
train Loss: 0.7698 LRAP: 0.7992 NDCG: 0.8192
val Loss: 0.8776 LRAP: 0.8184 NDCG: 0.8387
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.7681 LRAP: 0.8000 NDCG: 0.8217
val Loss: 0.8772 LRAP: 0.8230 NDCG: 0.8433
EarlyStopping counter: 2 out of 25

Epoch 37/99
----------
train Loss: 0.7693 LRAP: 0.8037 NDCG: 0.8207
val Loss: 0.8781 LRAP: 0.8239 NDCG: 0.8439
EarlyStopping counter: 3 out of 25

Epoch 38/99
----------
train Loss: 0.7665 LRAP: 0.8030 NDCG: 0.8239
val Loss: 0.8770 LRAP: 0.8196 NDCG: 0.8413
EarlyStopping counter: 4 out of 25

Epoch 39/99
----------
train Loss: 0.7674 LRAP: 0.8002 NDCG: 0.8202
val Loss: 0.8772 LRAP: 0.8193 NDCG: 0.8334
EarlyStopping counter: 5 out of 25

Epoch 40/99
----------
train Loss: 0.7650 LRAP: 0.8043 NDCG: 0.8246
val Loss: 0.8764 LRAP: 0.8216 NDCG: 0.8392
EarlyStopping counter: 6 out of 25

Epoch 41/99
----------
train Loss: 0.7644 LRAP: 0.8054 NDCG: 0.8252
val Loss: 0.8769 LRAP: 0.8261 NDCG: 0.8437
EarlyStopping counter: 7 out of 25

Epoch 42/99
----------
train Loss: 0.7640 LRAP: 0.8049 NDCG: 0.8186
val Loss: 0.8752 LRAP: 0.8276 NDCG: 0.8474
Validation loss decreased (0.876419 --> 0.875181).  Saving model ...

Epoch 43/99
----------
train Loss: 0.7663 LRAP: 0.8057 NDCG: 0.8218
val Loss: 0.8767 LRAP: 0.8242 NDCG: 0.8421
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.7630 LRAP: 0.8015 NDCG: 0.8183
val Loss: 0.8765 LRAP: 0.8204 NDCG: 0.8414
EarlyStopping counter: 2 out of 25

Epoch 45/99
----------
train Loss: 0.7646 LRAP: 0.8007 NDCG: 0.8212
val Loss: 0.8784 LRAP: 0.8233 NDCG: 0.8411
EarlyStopping counter: 3 out of 25

Epoch 46/99
----------
train Loss: 0.7654 LRAP: 0.8024 NDCG: 0.8216
val Loss: 0.8763 LRAP: 0.8267 NDCG: 0.8450
EarlyStopping counter: 4 out of 25

Epoch 47/99
----------
train Loss: 0.7632 LRAP: 0.8069 NDCG: 0.8224
val Loss: 0.8758 LRAP: 0.8264 NDCG: 0.8452
EarlyStopping counter: 5 out of 25

Epoch 48/99
----------
train Loss: 0.7643 LRAP: 0.8056 NDCG: 0.8211
val Loss: 0.8773 LRAP: 0.8284 NDCG: 0.8461
EarlyStopping counter: 6 out of 25

Epoch 49/99
----------
train Loss: 0.7632 LRAP: 0.8041 NDCG: 0.8204
val Loss: 0.8753 LRAP: 0.8199 NDCG: 0.8390
EarlyStopping counter: 7 out of 25

Epoch 50/99
----------
train Loss: 0.7625 LRAP: 0.8068 NDCG: 0.8222
val Loss: 0.8768 LRAP: 0.8202 NDCG: 0.8390
EarlyStopping counter: 8 out of 25

Epoch 51/99
----------
train Loss: 0.7636 LRAP: 0.8074 NDCG: 0.8229
val Loss: 0.8752 LRAP: 0.8230 NDCG: 0.8428
Validation loss decreased (0.875181 --> 0.875177).  Saving model ...

Epoch 52/99
----------
train Loss: 0.7636 LRAP: 0.8042 NDCG: 0.8218
val Loss: 0.8785 LRAP: 0.8224 NDCG: 0.8372
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.7621 LRAP: 0.8062 NDCG: 0.8229
val Loss: 0.8766 LRAP: 0.8267 NDCG: 0.8429
EarlyStopping counter: 2 out of 25

Epoch 54/99
----------
train Loss: 0.7625 LRAP: 0.8061 NDCG: 0.8234
val Loss: 0.8773 LRAP: 0.8273 NDCG: 0.8450
EarlyStopping counter: 3 out of 25

Epoch 55/99
----------
train Loss: 0.7646 LRAP: 0.8057 NDCG: 0.8237
val Loss: 0.8778 LRAP: 0.8313 NDCG: 0.8499
EarlyStopping counter: 4 out of 25

Epoch 56/99
----------
train Loss: 0.7622 LRAP: 0.8041 NDCG: 0.8180
val Loss: 0.8768 LRAP: 0.8284 NDCG: 0.8471
EarlyStopping counter: 5 out of 25

Epoch 57/99
----------
train Loss: 0.7620 LRAP: 0.8032 NDCG: 0.8206
val Loss: 0.8762 LRAP: 0.8250 NDCG: 0.8407
EarlyStopping counter: 6 out of 25

Epoch 58/99
----------
train Loss: 0.7641 LRAP: 0.8024 NDCG: 0.8214
val Loss: 0.8775 LRAP: 0.8270 NDCG: 0.8448
EarlyStopping counter: 7 out of 25

Epoch 59/99
----------
train Loss: 0.7632 LRAP: 0.8006 NDCG: 0.8207
val Loss: 0.8766 LRAP: 0.8224 NDCG: 0.8391
EarlyStopping counter: 8 out of 25

Epoch 60/99
----------
train Loss: 0.7624 LRAP: 0.8027 NDCG: 0.8208
val Loss: 0.8752 LRAP: 0.8293 NDCG: 0.8482
EarlyStopping counter: 9 out of 25

Epoch 61/99
----------
train Loss: 0.7624 LRAP: 0.8051 NDCG: 0.8211
val Loss: 0.8763 LRAP: 0.8279 NDCG: 0.8469
EarlyStopping counter: 10 out of 25

Epoch 62/99
----------
train Loss: 0.7638 LRAP: 0.8074 NDCG: 0.8204
val Loss: 0.8759 LRAP: 0.8299 NDCG: 0.8493
EarlyStopping counter: 11 out of 25

Epoch 63/99
----------
train Loss: 0.7617 LRAP: 0.8064 NDCG: 0.8216
val Loss: 0.8768 LRAP: 0.8267 NDCG: 0.8439
EarlyStopping counter: 12 out of 25

Epoch 64/99
----------
train Loss: 0.7624 LRAP: 0.8043 NDCG: 0.8198
val Loss: 0.8762 LRAP: 0.8287 NDCG: 0.8468
EarlyStopping counter: 13 out of 25

Epoch 65/99
----------
train Loss: 0.7627 LRAP: 0.8058 NDCG: 0.8196
val Loss: 0.8768 LRAP: 0.8216 NDCG: 0.8398
EarlyStopping counter: 14 out of 25

Epoch 66/99
----------
train Loss: 0.7627 LRAP: 0.8025 NDCG: 0.8214
val Loss: 0.8765 LRAP: 0.8279 NDCG: 0.8472
EarlyStopping counter: 15 out of 25

Epoch 67/99
----------
train Loss: 0.7628 LRAP: 0.8062 NDCG: 0.8209
val Loss: 0.8778 LRAP: 0.8279 NDCG: 0.8437
EarlyStopping counter: 16 out of 25

Epoch 68/99
----------
train Loss: 0.7628 LRAP: 0.8051 NDCG: 0.8233
val Loss: 0.8763 LRAP: 0.8261 NDCG: 0.8434
EarlyStopping counter: 17 out of 25

Epoch 69/99
----------
train Loss: 0.7630 LRAP: 0.8058 NDCG: 0.8239
val Loss: 0.8757 LRAP: 0.8279 NDCG: 0.8474
EarlyStopping counter: 18 out of 25

Epoch 70/99
----------
train Loss: 0.7607 LRAP: 0.8059 NDCG: 0.8214
val Loss: 0.8772 LRAP: 0.8281 NDCG: 0.8466
EarlyStopping counter: 19 out of 25

Epoch 71/99
----------
train Loss: 0.7614 LRAP: 0.8058 NDCG: 0.8234
val Loss: 0.8773 LRAP: 0.8301 NDCG: 0.8494
EarlyStopping counter: 20 out of 25

Epoch 72/99
----------
train Loss: 0.7619 LRAP: 0.8060 NDCG: 0.8233
val Loss: 0.8769 LRAP: 0.8279 NDCG: 0.8454
EarlyStopping counter: 21 out of 25

Epoch 73/99
----------
train Loss: 0.7623 LRAP: 0.8088 NDCG: 0.8221
val Loss: 0.8777 LRAP: 0.8250 NDCG: 0.8421
EarlyStopping counter: 22 out of 25

Epoch 74/99
----------
train Loss: 0.7635 LRAP: 0.8086 NDCG: 0.8229
val Loss: 0.8777 LRAP: 0.8284 NDCG: 0.8460
EarlyStopping counter: 23 out of 25

Epoch 75/99
----------
train Loss: 0.7643 LRAP: 0.8060 NDCG: 0.8215
val Loss: 0.8777 LRAP: 0.8247 NDCG: 0.8427
EarlyStopping counter: 24 out of 25

Epoch 76/99
----------
train Loss: 0.7626 LRAP: 0.8073 NDCG: 0.8244
val Loss: 0.8780 LRAP: 0.8276 NDCG: 0.8428
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 50s
Best val loss: 0.875177, best LRAP score: 0.9632

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.6970 LRAP: 0.2854 NDCG: 0.6005
val Loss: 1.3939 LRAP: 0.3260 NDCG: 0.6522
Validation loss decreased (0.000000 --> 1.393911).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2457 LRAP: 0.6364 NDCG: 0.7206
val Loss: 1.2276 LRAP: 0.6252 NDCG: 0.7204
Validation loss decreased (1.393911 --> 1.227583).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1769 LRAP: 0.6678 NDCG: 0.7356
val Loss: 1.2647 LRAP: 0.6808 NDCG: 0.7404
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.1329 LRAP: 0.6748 NDCG: 0.7451
val Loss: 1.3817 LRAP: 0.7185 NDCG: 0.7825
EarlyStopping counter: 2 out of 25

Epoch 4/99
----------
train Loss: 1.1128 LRAP: 0.6825 NDCG: 0.7540
val Loss: 1.1685 LRAP: 0.6152 NDCG: 0.7247
Validation loss decreased (1.227583 --> 1.168482).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0873 LRAP: 0.6874 NDCG: 0.7654
val Loss: 1.0483 LRAP: 0.6980 NDCG: 0.7713
Validation loss decreased (1.168482 --> 1.048276).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0696 LRAP: 0.6833 NDCG: 0.7697
val Loss: 1.6351 LRAP: 0.3877 NDCG: 0.6385
EarlyStopping counter: 1 out of 25

Epoch 7/99
----------
train Loss: 1.0617 LRAP: 0.6751 NDCG: 0.7714
val Loss: 1.0819 LRAP: 0.7122 NDCG: 0.7871
EarlyStopping counter: 2 out of 25

Epoch 8/99
----------
train Loss: 1.0499 LRAP: 0.6853 NDCG: 0.7773
val Loss: 1.2374 LRAP: 0.5872 NDCG: 0.7326
EarlyStopping counter: 3 out of 25

Epoch 9/99
----------
train Loss: 1.0280 LRAP: 0.6861 NDCG: 0.7810
val Loss: 1.0986 LRAP: 0.6429 NDCG: 0.7750
EarlyStopping counter: 4 out of 25

Epoch 10/99
----------
train Loss: 1.0219 LRAP: 0.6902 NDCG: 0.7852
val Loss: 1.0573 LRAP: 0.6506 NDCG: 0.7604
EarlyStopping counter: 5 out of 25

Epoch 11/99
----------
train Loss: 0.9932 LRAP: 0.7061 NDCG: 0.7928
val Loss: 0.9722 LRAP: 0.7220 NDCG: 0.7968
Validation loss decreased (1.048276 --> 0.972204).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9783 LRAP: 0.7032 NDCG: 0.7921
val Loss: 0.9689 LRAP: 0.7228 NDCG: 0.8093
Validation loss decreased (0.972204 --> 0.968892).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9798 LRAP: 0.7029 NDCG: 0.7941
val Loss: 0.9735 LRAP: 0.6945 NDCG: 0.8007
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.9731 LRAP: 0.7065 NDCG: 0.7949
val Loss: 0.9603 LRAP: 0.7234 NDCG: 0.8096
Validation loss decreased (0.968892 --> 0.960308).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9666 LRAP: 0.7084 NDCG: 0.7983
val Loss: 0.9574 LRAP: 0.7254 NDCG: 0.8173
Validation loss decreased (0.960308 --> 0.957358).  Saving model ...

Epoch 16/99
----------
train Loss: 0.9627 LRAP: 0.7116 NDCG: 0.7993
val Loss: 0.9684 LRAP: 0.7334 NDCG: 0.8159
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.9625 LRAP: 0.7127 NDCG: 0.8005
val Loss: 0.9634 LRAP: 0.7028 NDCG: 0.8090
EarlyStopping counter: 2 out of 25

Epoch 18/99
----------
train Loss: 0.9566 LRAP: 0.7124 NDCG: 0.8008
val Loss: 0.9777 LRAP: 0.7182 NDCG: 0.8079
EarlyStopping counter: 3 out of 25

Epoch 19/99
----------
train Loss: 0.9511 LRAP: 0.7146 NDCG: 0.8031
val Loss: 0.9605 LRAP: 0.7325 NDCG: 0.8189
EarlyStopping counter: 4 out of 25

Epoch 20/99
----------
train Loss: 0.9504 LRAP: 0.7137 NDCG: 0.8024
val Loss: 0.9503 LRAP: 0.7368 NDCG: 0.8228
Validation loss decreased (0.957358 --> 0.950312).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9484 LRAP: 0.7172 NDCG: 0.8041
val Loss: 0.9768 LRAP: 0.7251 NDCG: 0.8148
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.9437 LRAP: 0.7192 NDCG: 0.8074
val Loss: 0.9454 LRAP: 0.7277 NDCG: 0.8166
Validation loss decreased (0.950312 --> 0.945371).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9424 LRAP: 0.7189 NDCG: 0.8048
val Loss: 0.9535 LRAP: 0.7257 NDCG: 0.8136
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9364 LRAP: 0.7231 NDCG: 0.8102
val Loss: 0.9669 LRAP: 0.7248 NDCG: 0.8188
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.9363 LRAP: 0.7264 NDCG: 0.8133
val Loss: 0.9460 LRAP: 0.7402 NDCG: 0.8197
EarlyStopping counter: 3 out of 25

Epoch 26/99
----------
train Loss: 0.9320 LRAP: 0.7276 NDCG: 0.8127
val Loss: 0.9347 LRAP: 0.7482 NDCG: 0.8267
Validation loss decreased (0.945371 --> 0.934670).  Saving model ...

Epoch 27/99
----------
train Loss: 0.9292 LRAP: 0.7304 NDCG: 0.8142
val Loss: 0.9315 LRAP: 0.7474 NDCG: 0.8316
Validation loss decreased (0.934670 --> 0.931488).  Saving model ...

Epoch 28/99
----------
train Loss: 0.9243 LRAP: 0.7318 NDCG: 0.8148
val Loss: 0.9765 LRAP: 0.7282 NDCG: 0.8195
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.9224 LRAP: 0.7361 NDCG: 0.8147
val Loss: 0.9315 LRAP: 0.7611 NDCG: 0.8356
EarlyStopping counter: 2 out of 25

Epoch 30/99
----------
train Loss: 0.9193 LRAP: 0.7365 NDCG: 0.8165
val Loss: 0.9278 LRAP: 0.7608 NDCG: 0.8394
Validation loss decreased (0.931488 --> 0.927778).  Saving model ...

Epoch 31/99
----------
train Loss: 0.9168 LRAP: 0.7348 NDCG: 0.8184
val Loss: 0.9332 LRAP: 0.7536 NDCG: 0.8350
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.9156 LRAP: 0.7320 NDCG: 0.8188
val Loss: 0.9246 LRAP: 0.7559 NDCG: 0.8378
Validation loss decreased (0.927778 --> 0.924646).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9130 LRAP: 0.7399 NDCG: 0.8185
val Loss: 0.9427 LRAP: 0.7071 NDCG: 0.8159
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.9081 LRAP: 0.7392 NDCG: 0.8179
val Loss: 0.9255 LRAP: 0.7659 NDCG: 0.8405
EarlyStopping counter: 2 out of 25

Epoch 35/99
----------
train Loss: 0.9046 LRAP: 0.7438 NDCG: 0.8258
val Loss: 0.9311 LRAP: 0.7568 NDCG: 0.8312
EarlyStopping counter: 3 out of 25

Epoch 36/99
----------
train Loss: 0.9028 LRAP: 0.7433 NDCG: 0.8247
val Loss: 0.9202 LRAP: 0.7668 NDCG: 0.8413
Validation loss decreased (0.924646 --> 0.920205).  Saving model ...

Epoch 37/99
----------
train Loss: 0.9013 LRAP: 0.7469 NDCG: 0.8268
val Loss: 0.9191 LRAP: 0.7582 NDCG: 0.8407
Validation loss decreased (0.920205 --> 0.919149).  Saving model ...

Epoch 38/99
----------
train Loss: 0.8944 LRAP: 0.7478 NDCG: 0.8270
val Loss: 0.9201 LRAP: 0.7636 NDCG: 0.8434
EarlyStopping counter: 1 out of 25

Epoch 39/99
----------
train Loss: 0.8968 LRAP: 0.7478 NDCG: 0.8264
val Loss: 0.9292 LRAP: 0.7465 NDCG: 0.8320
EarlyStopping counter: 2 out of 25

Epoch 40/99
----------
train Loss: 0.8896 LRAP: 0.7499 NDCG: 0.8295
val Loss: 0.9237 LRAP: 0.7722 NDCG: 0.8451
EarlyStopping counter: 3 out of 25

Epoch 41/99
----------
train Loss: 0.8866 LRAP: 0.7543 NDCG: 0.8285
val Loss: 0.9174 LRAP: 0.7688 NDCG: 0.8425
Validation loss decreased (0.919149 --> 0.917351).  Saving model ...

Epoch 42/99
----------
train Loss: 0.8888 LRAP: 0.7560 NDCG: 0.8281
val Loss: 0.9169 LRAP: 0.7582 NDCG: 0.8422
Validation loss decreased (0.917351 --> 0.916905).  Saving model ...

Epoch 43/99
----------
train Loss: 0.8824 LRAP: 0.7515 NDCG: 0.8279
val Loss: 0.9119 LRAP: 0.7571 NDCG: 0.8380
Validation loss decreased (0.916905 --> 0.911931).  Saving model ...

Epoch 44/99
----------
train Loss: 0.8834 LRAP: 0.7563 NDCG: 0.8278
val Loss: 0.9109 LRAP: 0.7653 NDCG: 0.8410
Validation loss decreased (0.911931 --> 0.910883).  Saving model ...

Epoch 45/99
----------
train Loss: 0.8783 LRAP: 0.7569 NDCG: 0.8307
val Loss: 0.9051 LRAP: 0.7890 NDCG: 0.8533
Validation loss decreased (0.910883 --> 0.905102).  Saving model ...

Epoch 46/99
----------
train Loss: 0.8768 LRAP: 0.7562 NDCG: 0.8287
val Loss: 0.9068 LRAP: 0.7813 NDCG: 0.8437
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.8744 LRAP: 0.7545 NDCG: 0.8281
val Loss: 0.9028 LRAP: 0.7685 NDCG: 0.8402
Validation loss decreased (0.905102 --> 0.902846).  Saving model ...

Epoch 48/99
----------
train Loss: 0.8735 LRAP: 0.7595 NDCG: 0.8287
val Loss: 0.9005 LRAP: 0.7868 NDCG: 0.8502
Validation loss decreased (0.902846 --> 0.900518).  Saving model ...

Epoch 49/99
----------
train Loss: 0.8705 LRAP: 0.7619 NDCG: 0.8308
val Loss: 0.8984 LRAP: 0.7793 NDCG: 0.8457
Validation loss decreased (0.900518 --> 0.898411).  Saving model ...

Epoch 50/99
----------
train Loss: 0.8669 LRAP: 0.7665 NDCG: 0.8343
val Loss: 0.8982 LRAP: 0.7959 NDCG: 0.8568
Validation loss decreased (0.898411 --> 0.898167).  Saving model ...

Epoch 51/99
----------
train Loss: 0.8650 LRAP: 0.7648 NDCG: 0.8365
val Loss: 0.9066 LRAP: 0.7739 NDCG: 0.8392
EarlyStopping counter: 1 out of 25

Epoch 52/99
----------
train Loss: 0.8607 LRAP: 0.7674 NDCG: 0.8334
val Loss: 0.8962 LRAP: 0.7947 NDCG: 0.8481
Validation loss decreased (0.898167 --> 0.896161).  Saving model ...

Epoch 53/99
----------
train Loss: 0.8599 LRAP: 0.7690 NDCG: 0.8299
val Loss: 0.8945 LRAP: 0.7936 NDCG: 0.8535
Validation loss decreased (0.896161 --> 0.894506).  Saving model ...

Epoch 54/99
----------
train Loss: 0.8556 LRAP: 0.7682 NDCG: 0.8309
val Loss: 0.8948 LRAP: 0.7562 NDCG: 0.8404
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.8552 LRAP: 0.7704 NDCG: 0.8334
val Loss: 0.8833 LRAP: 0.7856 NDCG: 0.8530
Validation loss decreased (0.894506 --> 0.883274).  Saving model ...

Epoch 56/99
----------
train Loss: 0.8565 LRAP: 0.7697 NDCG: 0.8322
val Loss: 0.8988 LRAP: 0.7879 NDCG: 0.8488
EarlyStopping counter: 1 out of 25

Epoch 57/99
----------
train Loss: 0.8587 LRAP: 0.7694 NDCG: 0.8335
val Loss: 0.8998 LRAP: 0.7782 NDCG: 0.8340
EarlyStopping counter: 2 out of 25

Epoch 58/99
----------
train Loss: 0.8474 LRAP: 0.7761 NDCG: 0.8334
val Loss: 0.8971 LRAP: 0.7862 NDCG: 0.8481
EarlyStopping counter: 3 out of 25

Epoch 59/99
----------
train Loss: 0.8465 LRAP: 0.7774 NDCG: 0.8354
val Loss: 0.8883 LRAP: 0.7833 NDCG: 0.8475
EarlyStopping counter: 4 out of 25

Epoch 60/99
----------
train Loss: 0.8450 LRAP: 0.7735 NDCG: 0.8322
val Loss: 0.8900 LRAP: 0.7913 NDCG: 0.8390
EarlyStopping counter: 5 out of 25

Epoch 61/99
----------
train Loss: 0.8330 LRAP: 0.7855 NDCG: 0.8360
val Loss: 0.8789 LRAP: 0.8013 NDCG: 0.8563
Validation loss decreased (0.883274 --> 0.878855).  Saving model ...

Epoch 62/99
----------
train Loss: 0.8314 LRAP: 0.7818 NDCG: 0.8344
val Loss: 0.8797 LRAP: 0.7967 NDCG: 0.8488
EarlyStopping counter: 1 out of 25

Epoch 63/99
----------
train Loss: 0.8299 LRAP: 0.7804 NDCG: 0.8348
val Loss: 0.8773 LRAP: 0.8010 NDCG: 0.8587
Validation loss decreased (0.878855 --> 0.877298).  Saving model ...

Epoch 64/99
----------
train Loss: 0.8275 LRAP: 0.7863 NDCG: 0.8373
val Loss: 0.8759 LRAP: 0.8045 NDCG: 0.8550
Validation loss decreased (0.877298 --> 0.875863).  Saving model ...

Epoch 65/99
----------
train Loss: 0.8276 LRAP: 0.7837 NDCG: 0.8384
val Loss: 0.8756 LRAP: 0.8016 NDCG: 0.8569
Validation loss decreased (0.875863 --> 0.875578).  Saving model ...

Epoch 66/99
----------
train Loss: 0.8258 LRAP: 0.7859 NDCG: 0.8371
val Loss: 0.8763 LRAP: 0.8067 NDCG: 0.8567
EarlyStopping counter: 1 out of 25

Epoch 67/99
----------
train Loss: 0.8258 LRAP: 0.7869 NDCG: 0.8386
val Loss: 0.8748 LRAP: 0.8056 NDCG: 0.8584
Validation loss decreased (0.875578 --> 0.874836).  Saving model ...

Epoch 68/99
----------
train Loss: 0.8243 LRAP: 0.7836 NDCG: 0.8364
val Loss: 0.8765 LRAP: 0.8039 NDCG: 0.8566
EarlyStopping counter: 1 out of 25

Epoch 69/99
----------
train Loss: 0.8245 LRAP: 0.7841 NDCG: 0.8387
val Loss: 0.8764 LRAP: 0.8073 NDCG: 0.8571
EarlyStopping counter: 2 out of 25

Epoch 70/99
----------
train Loss: 0.8255 LRAP: 0.7819 NDCG: 0.8360
val Loss: 0.8745 LRAP: 0.8030 NDCG: 0.8590
Validation loss decreased (0.874836 --> 0.874531).  Saving model ...

Epoch 71/99
----------
train Loss: 0.8207 LRAP: 0.7856 NDCG: 0.8355
val Loss: 0.8755 LRAP: 0.8047 NDCG: 0.8567
EarlyStopping counter: 1 out of 25

Epoch 72/99
----------
train Loss: 0.8217 LRAP: 0.7899 NDCG: 0.8385
val Loss: 0.8752 LRAP: 0.8039 NDCG: 0.8540
EarlyStopping counter: 2 out of 25

Epoch 73/99
----------
train Loss: 0.8196 LRAP: 0.7890 NDCG: 0.8395
val Loss: 0.8756 LRAP: 0.8070 NDCG: 0.8596
EarlyStopping counter: 3 out of 25

Epoch 74/99
----------
train Loss: 0.8186 LRAP: 0.7874 NDCG: 0.8381
val Loss: 0.8742 LRAP: 0.8087 NDCG: 0.8589
Validation loss decreased (0.874531 --> 0.874179).  Saving model ...

Epoch 75/99
----------
train Loss: 0.8193 LRAP: 0.7896 NDCG: 0.8409
val Loss: 0.8740 LRAP: 0.8042 NDCG: 0.8587
Validation loss decreased (0.874179 --> 0.873989).  Saving model ...

Epoch 76/99
----------
train Loss: 0.8179 LRAP: 0.7911 NDCG: 0.8414
val Loss: 0.8749 LRAP: 0.8013 NDCG: 0.8556
EarlyStopping counter: 1 out of 25

Epoch 77/99
----------
train Loss: 0.8163 LRAP: 0.7881 NDCG: 0.8368
val Loss: 0.8723 LRAP: 0.8102 NDCG: 0.8583
Validation loss decreased (0.873989 --> 0.872251).  Saving model ...

Epoch 78/99
----------
train Loss: 0.8170 LRAP: 0.7903 NDCG: 0.8378
val Loss: 0.8715 LRAP: 0.8067 NDCG: 0.8586
Validation loss decreased (0.872251 --> 0.871529).  Saving model ...

Epoch 79/99
----------
train Loss: 0.8174 LRAP: 0.7907 NDCG: 0.8412
val Loss: 0.8728 LRAP: 0.8090 NDCG: 0.8584
EarlyStopping counter: 1 out of 25

Epoch 80/99
----------
train Loss: 0.8163 LRAP: 0.7899 NDCG: 0.8403
val Loss: 0.8754 LRAP: 0.8073 NDCG: 0.8590
EarlyStopping counter: 2 out of 25

Epoch 81/99
----------
train Loss: 0.8150 LRAP: 0.7893 NDCG: 0.8397
val Loss: 0.8722 LRAP: 0.8084 NDCG: 0.8591
EarlyStopping counter: 3 out of 25

Epoch 82/99
----------
train Loss: 0.8145 LRAP: 0.7932 NDCG: 0.8389
val Loss: 0.8725 LRAP: 0.8042 NDCG: 0.8545
EarlyStopping counter: 4 out of 25

Epoch 83/99
----------
train Loss: 0.8139 LRAP: 0.7922 NDCG: 0.8375
val Loss: 0.8709 LRAP: 0.8090 NDCG: 0.8628
Validation loss decreased (0.871529 --> 0.870894).  Saving model ...

Epoch 84/99
----------
train Loss: 0.8164 LRAP: 0.7882 NDCG: 0.8375
val Loss: 0.8723 LRAP: 0.8113 NDCG: 0.8599
EarlyStopping counter: 1 out of 25

Epoch 85/99
----------
train Loss: 0.8119 LRAP: 0.7925 NDCG: 0.8383
val Loss: 0.8716 LRAP: 0.7996 NDCG: 0.8557
EarlyStopping counter: 2 out of 25

Epoch 86/99
----------
train Loss: 0.8120 LRAP: 0.7913 NDCG: 0.8379
val Loss: 0.8704 LRAP: 0.8042 NDCG: 0.8591
Validation loss decreased (0.870894 --> 0.870389).  Saving model ...

Epoch 87/99
----------
train Loss: 0.8100 LRAP: 0.7884 NDCG: 0.8385
val Loss: 0.8729 LRAP: 0.8107 NDCG: 0.8555
EarlyStopping counter: 1 out of 25

Epoch 88/99
----------
train Loss: 0.8112 LRAP: 0.7929 NDCG: 0.8394
val Loss: 0.8707 LRAP: 0.8090 NDCG: 0.8628
EarlyStopping counter: 2 out of 25

Epoch 89/99
----------
train Loss: 0.8087 LRAP: 0.7911 NDCG: 0.8373
val Loss: 0.8702 LRAP: 0.8162 NDCG: 0.8677
Validation loss decreased (0.870389 --> 0.870168).  Saving model ...

Epoch 90/99
----------
train Loss: 0.8090 LRAP: 0.7919 NDCG: 0.8388
val Loss: 0.8713 LRAP: 0.8119 NDCG: 0.8649
EarlyStopping counter: 1 out of 25

Epoch 91/99
----------
train Loss: 0.8069 LRAP: 0.7947 NDCG: 0.8414
val Loss: 0.8708 LRAP: 0.8073 NDCG: 0.8585
EarlyStopping counter: 2 out of 25

Epoch 92/99
----------
train Loss: 0.8066 LRAP: 0.7940 NDCG: 0.8375
val Loss: 0.8702 LRAP: 0.8079 NDCG: 0.8599
Validation loss decreased (0.870168 --> 0.870161).  Saving model ...

Epoch 93/99
----------
train Loss: 0.8097 LRAP: 0.7900 NDCG: 0.8389
val Loss: 0.8705 LRAP: 0.8110 NDCG: 0.8595
EarlyStopping counter: 1 out of 25

Epoch 94/99
----------
train Loss: 0.8058 LRAP: 0.7946 NDCG: 0.8413
val Loss: 0.8714 LRAP: 0.8093 NDCG: 0.8584
EarlyStopping counter: 2 out of 25

Epoch 95/99
----------
train Loss: 0.8050 LRAP: 0.7924 NDCG: 0.8378
val Loss: 0.8704 LRAP: 0.8124 NDCG: 0.8604
EarlyStopping counter: 3 out of 25

Epoch 96/99
----------
train Loss: 0.8034 LRAP: 0.7951 NDCG: 0.8417
val Loss: 0.8699 LRAP: 0.8144 NDCG: 0.8638
Validation loss decreased (0.870161 --> 0.869878).  Saving model ...

Epoch 97/99
----------
train Loss: 0.8017 LRAP: 0.8005 NDCG: 0.8446
val Loss: 0.8705 LRAP: 0.8159 NDCG: 0.8636
EarlyStopping counter: 1 out of 25

Epoch 98/99
----------
train Loss: 0.8026 LRAP: 0.7953 NDCG: 0.8432
val Loss: 0.8696 LRAP: 0.8122 NDCG: 0.8610
Validation loss decreased (0.869878 --> 0.869585).  Saving model ...

Epoch 99/99
----------
train Loss: 0.8042 LRAP: 0.7973 NDCG: 0.8405
val Loss: 0.8696 LRAP: 0.8167 NDCG: 0.8638
EarlyStopping counter: 1 out of 25

Training complete in 11m 52s
Best val loss: 0.869585, best LRAP score: 0.9624

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7698 LRAP: 0.1909 NDCG: 0.5732
val Loss: 1.4358 LRAP: 0.4202 NDCG: 0.6469
Validation loss decreased (0.000000 --> 1.435820).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3131 LRAP: 0.5769 NDCG: 0.6901
val Loss: 1.4749 LRAP: 0.3628 NDCG: 0.6013
EarlyStopping counter: 1 out of 25

Epoch 2/99
----------
train Loss: 1.2424 LRAP: 0.6126 NDCG: 0.7135
val Loss: 1.3610 LRAP: 0.4251 NDCG: 0.6505
Validation loss decreased (1.435820 --> 1.360954).  Saving model ...

Epoch 3/99
----------
train Loss: 1.2197 LRAP: 0.6174 NDCG: 0.7213
val Loss: 1.2769 LRAP: 0.7048 NDCG: 0.7609
Validation loss decreased (1.360954 --> 1.276945).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1906 LRAP: 0.6216 NDCG: 0.7314
val Loss: 1.1833 LRAP: 0.5992 NDCG: 0.7275
Validation loss decreased (1.276945 --> 1.183284).  Saving model ...

Epoch 5/99
----------
train Loss: 1.1612 LRAP: 0.6230 NDCG: 0.7375
val Loss: 1.2395 LRAP: 0.5989 NDCG: 0.7307
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.1504 LRAP: 0.6193 NDCG: 0.7430
val Loss: 1.1113 LRAP: 0.6315 NDCG: 0.7536
Validation loss decreased (1.183284 --> 1.111280).  Saving model ...

Epoch 7/99
----------
train Loss: 1.1317 LRAP: 0.6269 NDCG: 0.7529
val Loss: 1.2509 LRAP: 0.4065 NDCG: 0.6763
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 1.1174 LRAP: 0.6291 NDCG: 0.7556
val Loss: 1.1948 LRAP: 0.4659 NDCG: 0.7066
EarlyStopping counter: 2 out of 25

Epoch 9/99
----------
train Loss: 1.1075 LRAP: 0.6270 NDCG: 0.7570
val Loss: 1.0852 LRAP: 0.6360 NDCG: 0.7478
Validation loss decreased (1.111280 --> 1.085212).  Saving model ...

Epoch 10/99
----------
train Loss: 1.0885 LRAP: 0.6264 NDCG: 0.7607
val Loss: 1.2517 LRAP: 0.5001 NDCG: 0.7008
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 1.0833 LRAP: 0.6331 NDCG: 0.7641
val Loss: 1.0736 LRAP: 0.6275 NDCG: 0.7669
Validation loss decreased (1.085212 --> 1.073612).  Saving model ...

Epoch 12/99
----------
train Loss: 1.0704 LRAP: 0.6439 NDCG: 0.7711
val Loss: 1.0699 LRAP: 0.6337 NDCG: 0.7664
Validation loss decreased (1.073612 --> 1.069859).  Saving model ...

Epoch 13/99
----------
train Loss: 1.0676 LRAP: 0.6437 NDCG: 0.7715
val Loss: 1.0898 LRAP: 0.6160 NDCG: 0.7496
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 1.0552 LRAP: 0.6436 NDCG: 0.7725
val Loss: 1.0395 LRAP: 0.6808 NDCG: 0.7887
Validation loss decreased (1.069859 --> 1.039450).  Saving model ...

Epoch 15/99
----------
train Loss: 1.0455 LRAP: 0.6493 NDCG: 0.7742
val Loss: 1.1020 LRAP: 0.4999 NDCG: 0.7283
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 1.0371 LRAP: 0.6483 NDCG: 0.7766
val Loss: 1.0628 LRAP: 0.6863 NDCG: 0.7805
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 1.0323 LRAP: 0.6640 NDCG: 0.7826
val Loss: 1.0475 LRAP: 0.6677 NDCG: 0.7932
EarlyStopping counter: 3 out of 25

Epoch 18/99
----------
train Loss: 1.0207 LRAP: 0.6619 NDCG: 0.7825
val Loss: 1.0269 LRAP: 0.7102 NDCG: 0.8026
Validation loss decreased (1.039450 --> 1.026863).  Saving model ...

Epoch 19/99
----------
train Loss: 1.0111 LRAP: 0.6606 NDCG: 0.7817
val Loss: 1.0298 LRAP: 0.7031 NDCG: 0.7996
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 1.0163 LRAP: 0.6727 NDCG: 0.7843
val Loss: 1.0641 LRAP: 0.6537 NDCG: 0.7785
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 1.0060 LRAP: 0.6642 NDCG: 0.7807
val Loss: 1.1300 LRAP: 0.5886 NDCG: 0.7415
EarlyStopping counter: 3 out of 25

Epoch 22/99
----------
train Loss: 0.9941 LRAP: 0.6795 NDCG: 0.7852
val Loss: 1.0106 LRAP: 0.7131 NDCG: 0.7947
Validation loss decreased (1.026863 --> 1.010631).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9869 LRAP: 0.6770 NDCG: 0.7857
val Loss: 1.1346 LRAP: 0.5872 NDCG: 0.7463
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9839 LRAP: 0.6808 NDCG: 0.7845
val Loss: 1.1262 LRAP: 0.5079 NDCG: 0.7300
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.9779 LRAP: 0.6854 NDCG: 0.7846
val Loss: 1.0314 LRAP: 0.6537 NDCG: 0.7792
EarlyStopping counter: 3 out of 25

Epoch 26/99
----------
train Loss: 0.9744 LRAP: 0.6897 NDCG: 0.7841
val Loss: 0.9892 LRAP: 0.7074 NDCG: 0.8085
Validation loss decreased (1.010631 --> 0.989216).  Saving model ...

Epoch 27/99
----------
train Loss: 0.9635 LRAP: 0.6862 NDCG: 0.7819
val Loss: 0.9920 LRAP: 0.7240 NDCG: 0.8104
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.9587 LRAP: 0.6884 NDCG: 0.7826
val Loss: 1.0695 LRAP: 0.7308 NDCG: 0.7950
EarlyStopping counter: 2 out of 25

Epoch 29/99
----------
train Loss: 0.9659 LRAP: 0.6871 NDCG: 0.7797
val Loss: 1.0316 LRAP: 0.7342 NDCG: 0.8131
EarlyStopping counter: 3 out of 25

Epoch 30/99
----------
train Loss: 0.9527 LRAP: 0.6953 NDCG: 0.7790
val Loss: 0.9862 LRAP: 0.7205 NDCG: 0.7994
Validation loss decreased (0.989216 --> 0.986220).  Saving model ...

Epoch 31/99
----------
train Loss: 0.9462 LRAP: 0.7030 NDCG: 0.7817
val Loss: 0.9710 LRAP: 0.7314 NDCG: 0.7854
Validation loss decreased (0.986220 --> 0.971028).  Saving model ...

Epoch 32/99
----------
train Loss: 0.9427 LRAP: 0.7008 NDCG: 0.7758
val Loss: 0.9960 LRAP: 0.7282 NDCG: 0.8175
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.9462 LRAP: 0.6970 NDCG: 0.7775
val Loss: 0.9560 LRAP: 0.7542 NDCG: 0.8102
Validation loss decreased (0.971028 --> 0.955995).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9399 LRAP: 0.7080 NDCG: 0.7780
val Loss: 0.9571 LRAP: 0.7616 NDCG: 0.8195
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.9361 LRAP: 0.7046 NDCG: 0.7798
val Loss: 0.9458 LRAP: 0.7414 NDCG: 0.8121
Validation loss decreased (0.955995 --> 0.945818).  Saving model ...

Epoch 36/99
----------
train Loss: 0.9273 LRAP: 0.7129 NDCG: 0.7743
val Loss: 0.9574 LRAP: 0.7351 NDCG: 0.7876
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.9299 LRAP: 0.7040 NDCG: 0.7697
val Loss: 0.9650 LRAP: 0.7411 NDCG: 0.7981
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.9276 LRAP: 0.7134 NDCG: 0.7748
val Loss: 0.9545 LRAP: 0.6180 NDCG: 0.7590
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.9238 LRAP: 0.7072 NDCG: 0.7714
val Loss: 0.9584 LRAP: 0.7431 NDCG: 0.8158
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.9206 LRAP: 0.7211 NDCG: 0.7746
val Loss: 0.9498 LRAP: 0.7368 NDCG: 0.7960
EarlyStopping counter: 5 out of 25

Epoch 41/99
----------
train Loss: 0.8993 LRAP: 0.7167 NDCG: 0.7733
val Loss: 0.9189 LRAP: 0.7665 NDCG: 0.8200
Validation loss decreased (0.945818 --> 0.918926).  Saving model ...

Epoch 42/99
----------
train Loss: 0.8915 LRAP: 0.7312 NDCG: 0.7792
val Loss: 0.9206 LRAP: 0.7628 NDCG: 0.8141
EarlyStopping counter: 1 out of 25

Epoch 43/99
----------
train Loss: 0.8895 LRAP: 0.7276 NDCG: 0.7748
val Loss: 0.9183 LRAP: 0.7711 NDCG: 0.8190
Validation loss decreased (0.918926 --> 0.918337).  Saving model ...

Epoch 44/99
----------
train Loss: 0.8840 LRAP: 0.7318 NDCG: 0.7780
val Loss: 0.9179 LRAP: 0.7739 NDCG: 0.8235
Validation loss decreased (0.918337 --> 0.917940).  Saving model ...

Epoch 45/99
----------
train Loss: 0.8817 LRAP: 0.7345 NDCG: 0.7768
val Loss: 0.9160 LRAP: 0.7648 NDCG: 0.8107
Validation loss decreased (0.917940 --> 0.915963).  Saving model ...

Epoch 46/99
----------
train Loss: 0.8826 LRAP: 0.7354 NDCG: 0.7813
val Loss: 0.9210 LRAP: 0.7648 NDCG: 0.8101
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.8797 LRAP: 0.7351 NDCG: 0.7804
val Loss: 0.9160 LRAP: 0.7588 NDCG: 0.7985
EarlyStopping counter: 2 out of 25

Epoch 48/99
----------
train Loss: 0.8758 LRAP: 0.7358 NDCG: 0.7732
val Loss: 0.9145 LRAP: 0.7725 NDCG: 0.8129
Validation loss decreased (0.915963 --> 0.914513).  Saving model ...

Epoch 49/99
----------
train Loss: 0.8759 LRAP: 0.7403 NDCG: 0.7778
val Loss: 0.9189 LRAP: 0.7591 NDCG: 0.8028
EarlyStopping counter: 1 out of 25

Epoch 50/99
----------
train Loss: 0.8731 LRAP: 0.7393 NDCG: 0.7819
val Loss: 0.9151 LRAP: 0.7611 NDCG: 0.8007
EarlyStopping counter: 2 out of 25

Epoch 51/99
----------
train Loss: 0.8710 LRAP: 0.7384 NDCG: 0.7780
val Loss: 0.9142 LRAP: 0.7659 NDCG: 0.8095
Validation loss decreased (0.914513 --> 0.914200).  Saving model ...

Epoch 52/99
----------
train Loss: 0.8724 LRAP: 0.7371 NDCG: 0.7804
val Loss: 0.9143 LRAP: 0.7779 NDCG: 0.8227
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.8674 LRAP: 0.7422 NDCG: 0.7865
val Loss: 0.9160 LRAP: 0.7659 NDCG: 0.8018
EarlyStopping counter: 2 out of 25

Epoch 54/99
----------
train Loss: 0.8675 LRAP: 0.7425 NDCG: 0.7845
val Loss: 0.9219 LRAP: 0.7722 NDCG: 0.8080
EarlyStopping counter: 3 out of 25

Epoch 55/99
----------
train Loss: 0.8679 LRAP: 0.7394 NDCG: 0.7800
val Loss: 0.9126 LRAP: 0.7693 NDCG: 0.8082
Validation loss decreased (0.914200 --> 0.912579).  Saving model ...

Epoch 56/99
----------
train Loss: 0.8627 LRAP: 0.7479 NDCG: 0.7794
val Loss: 0.9148 LRAP: 0.7682 NDCG: 0.8149
EarlyStopping counter: 1 out of 25

Epoch 57/99
----------
train Loss: 0.8650 LRAP: 0.7428 NDCG: 0.7821
val Loss: 0.9200 LRAP: 0.7633 NDCG: 0.7992
EarlyStopping counter: 2 out of 25

Epoch 58/99
----------
train Loss: 0.8627 LRAP: 0.7403 NDCG: 0.7764
val Loss: 0.9163 LRAP: 0.7765 NDCG: 0.8090
EarlyStopping counter: 3 out of 25

Epoch 59/99
----------
train Loss: 0.8628 LRAP: 0.7460 NDCG: 0.7788
val Loss: 0.9148 LRAP: 0.7782 NDCG: 0.8182
EarlyStopping counter: 4 out of 25

Epoch 60/99
----------
train Loss: 0.8592 LRAP: 0.7456 NDCG: 0.7891
val Loss: 0.9123 LRAP: 0.7728 NDCG: 0.8150
Validation loss decreased (0.912579 --> 0.912258).  Saving model ...

Epoch 61/99
----------
train Loss: 0.8589 LRAP: 0.7458 NDCG: 0.7852
val Loss: 0.9087 LRAP: 0.7750 NDCG: 0.8121
Validation loss decreased (0.912258 --> 0.908653).  Saving model ...

Epoch 62/99
----------
train Loss: 0.8556 LRAP: 0.7490 NDCG: 0.7838
val Loss: 0.9095 LRAP: 0.7753 NDCG: 0.8084
EarlyStopping counter: 1 out of 25

Epoch 63/99
----------
train Loss: 0.8579 LRAP: 0.7513 NDCG: 0.7852
val Loss: 0.9122 LRAP: 0.7779 NDCG: 0.8133
EarlyStopping counter: 2 out of 25

Epoch 64/99
----------
train Loss: 0.8530 LRAP: 0.7498 NDCG: 0.7888
val Loss: 0.9098 LRAP: 0.7808 NDCG: 0.8245
EarlyStopping counter: 3 out of 25

Epoch 65/99
----------
train Loss: 0.8546 LRAP: 0.7520 NDCG: 0.7906
val Loss: 0.9143 LRAP: 0.7762 NDCG: 0.8099
EarlyStopping counter: 4 out of 25

Epoch 66/99
----------
train Loss: 0.8522 LRAP: 0.7509 NDCG: 0.7888
val Loss: 0.9124 LRAP: 0.7802 NDCG: 0.8145
EarlyStopping counter: 5 out of 25

Epoch 67/99
----------
train Loss: 0.8462 LRAP: 0.7509 NDCG: 0.7872
val Loss: 0.9071 LRAP: 0.7802 NDCG: 0.8180
Validation loss decreased (0.908653 --> 0.907134).  Saving model ...

Epoch 68/99
----------
train Loss: 0.8476 LRAP: 0.7589 NDCG: 0.7917
val Loss: 0.9086 LRAP: 0.7745 NDCG: 0.8124
EarlyStopping counter: 1 out of 25

Epoch 69/99
----------
train Loss: 0.8429 LRAP: 0.7564 NDCG: 0.7897
val Loss: 0.9092 LRAP: 0.7756 NDCG: 0.8084
EarlyStopping counter: 2 out of 25

Epoch 70/99
----------
train Loss: 0.8416 LRAP: 0.7560 NDCG: 0.7877
val Loss: 0.9078 LRAP: 0.7782 NDCG: 0.8155
EarlyStopping counter: 3 out of 25

Epoch 71/99
----------
train Loss: 0.8429 LRAP: 0.7538 NDCG: 0.7818
val Loss: 0.9075 LRAP: 0.7756 NDCG: 0.8103
EarlyStopping counter: 4 out of 25

Epoch 72/99
----------
train Loss: 0.8432 LRAP: 0.7537 NDCG: 0.7881
val Loss: 0.9069 LRAP: 0.7802 NDCG: 0.8145
Validation loss decreased (0.907134 --> 0.906917).  Saving model ...

Epoch 73/99
----------
train Loss: 0.8426 LRAP: 0.7568 NDCG: 0.7881
val Loss: 0.9056 LRAP: 0.7785 NDCG: 0.8194
Validation loss decreased (0.906917 --> 0.905631).  Saving model ...

Epoch 74/99
----------
train Loss: 0.8407 LRAP: 0.7598 NDCG: 0.7912
val Loss: 0.9057 LRAP: 0.7793 NDCG: 0.8175
EarlyStopping counter: 1 out of 25

Epoch 75/99
----------
train Loss: 0.8404 LRAP: 0.7583 NDCG: 0.7886
val Loss: 0.9052 LRAP: 0.7808 NDCG: 0.8182
Validation loss decreased (0.905631 --> 0.905158).  Saving model ...

Epoch 76/99
----------
train Loss: 0.8407 LRAP: 0.7576 NDCG: 0.7867
val Loss: 0.9058 LRAP: 0.7802 NDCG: 0.8146
EarlyStopping counter: 1 out of 25

Epoch 77/99
----------
train Loss: 0.8403 LRAP: 0.7597 NDCG: 0.7910
val Loss: 0.9068 LRAP: 0.7785 NDCG: 0.8168
EarlyStopping counter: 2 out of 25

Epoch 78/99
----------
train Loss: 0.8414 LRAP: 0.7576 NDCG: 0.7917
val Loss: 0.9052 LRAP: 0.7788 NDCG: 0.8162
EarlyStopping counter: 3 out of 25

Epoch 79/99
----------
train Loss: 0.8384 LRAP: 0.7584 NDCG: 0.7911
val Loss: 0.9074 LRAP: 0.7810 NDCG: 0.8165
EarlyStopping counter: 4 out of 25

Epoch 80/99
----------
train Loss: 0.8393 LRAP: 0.7576 NDCG: 0.7886
val Loss: 0.9075 LRAP: 0.7805 NDCG: 0.8165
EarlyStopping counter: 5 out of 25

Epoch 81/99
----------
train Loss: 0.8367 LRAP: 0.7600 NDCG: 0.7896
val Loss: 0.9071 LRAP: 0.7768 NDCG: 0.8107
EarlyStopping counter: 6 out of 25

Epoch 82/99
----------
train Loss: 0.8369 LRAP: 0.7575 NDCG: 0.7894
val Loss: 0.9067 LRAP: 0.7770 NDCG: 0.8143
EarlyStopping counter: 7 out of 25

Epoch 83/99
----------
train Loss: 0.8385 LRAP: 0.7600 NDCG: 0.7890
val Loss: 0.9066 LRAP: 0.7810 NDCG: 0.8144
EarlyStopping counter: 8 out of 25

Epoch 84/99
----------
train Loss: 0.8348 LRAP: 0.7608 NDCG: 0.7903
val Loss: 0.9058 LRAP: 0.7793 NDCG: 0.8119
EarlyStopping counter: 9 out of 25

Epoch 85/99
----------
train Loss: 0.8372 LRAP: 0.7557 NDCG: 0.7876
val Loss: 0.9058 LRAP: 0.7793 NDCG: 0.8164
EarlyStopping counter: 10 out of 25

Epoch 86/99
----------
train Loss: 0.8367 LRAP: 0.7587 NDCG: 0.7910
val Loss: 0.9059 LRAP: 0.7773 NDCG: 0.8142
EarlyStopping counter: 11 out of 25

Epoch 87/99
----------
train Loss: 0.8355 LRAP: 0.7608 NDCG: 0.7905
val Loss: 0.9066 LRAP: 0.7733 NDCG: 0.8082
EarlyStopping counter: 12 out of 25

Epoch 88/99
----------
train Loss: 0.8362 LRAP: 0.7585 NDCG: 0.7915
val Loss: 0.9057 LRAP: 0.7785 NDCG: 0.8151
EarlyStopping counter: 13 out of 25

Epoch 89/99
----------
train Loss: 0.8386 LRAP: 0.7580 NDCG: 0.7898
val Loss: 0.9051 LRAP: 0.7805 NDCG: 0.8171
Validation loss decreased (0.905158 --> 0.905111).  Saving model ...

Epoch 90/99
----------
train Loss: 0.8364 LRAP: 0.7581 NDCG: 0.7894
val Loss: 0.9058 LRAP: 0.7848 NDCG: 0.8164
EarlyStopping counter: 1 out of 25

Epoch 91/99
----------
train Loss: 0.8359 LRAP: 0.7615 NDCG: 0.7923
val Loss: 0.9049 LRAP: 0.7816 NDCG: 0.8225
Validation loss decreased (0.905111 --> 0.904875).  Saving model ...

Epoch 92/99
----------
train Loss: 0.8373 LRAP: 0.7560 NDCG: 0.7908
val Loss: 0.9071 LRAP: 0.7779 NDCG: 0.8123
EarlyStopping counter: 1 out of 25

Epoch 93/99
----------
train Loss: 0.8369 LRAP: 0.7544 NDCG: 0.7865
val Loss: 0.9079 LRAP: 0.7728 NDCG: 0.8091
EarlyStopping counter: 2 out of 25

Epoch 94/99
----------
train Loss: 0.8382 LRAP: 0.7580 NDCG: 0.7866
val Loss: 0.9058 LRAP: 0.7805 NDCG: 0.8177
EarlyStopping counter: 3 out of 25

Epoch 95/99
----------
train Loss: 0.8377 LRAP: 0.7619 NDCG: 0.7920
val Loss: 0.9058 LRAP: 0.7793 NDCG: 0.8151
EarlyStopping counter: 4 out of 25

Epoch 96/99
----------
train Loss: 0.8357 LRAP: 0.7602 NDCG: 0.7921
val Loss: 0.9067 LRAP: 0.7768 NDCG: 0.8101
EarlyStopping counter: 5 out of 25

Epoch 97/99
----------
train Loss: 0.8338 LRAP: 0.7599 NDCG: 0.7917
val Loss: 0.9053 LRAP: 0.7790 NDCG: 0.8177
EarlyStopping counter: 6 out of 25

Epoch 98/99
----------
train Loss: 0.8360 LRAP: 0.7625 NDCG: 0.7931
val Loss: 0.9062 LRAP: 0.7736 NDCG: 0.8086
EarlyStopping counter: 7 out of 25

Epoch 99/99
----------
train Loss: 0.8372 LRAP: 0.7587 NDCG: 0.7906
val Loss: 0.9057 LRAP: 0.7796 NDCG: 0.8158
EarlyStopping counter: 8 out of 25

Training complete in 13m 33s
Best val loss: 0.904875, best LRAP score: 0.9566

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 6/10

All random seeds set to: 425
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7133 LRAP: 0.2912 NDCG: 0.5946
val Loss: 1.2458 LRAP: 0.6415 NDCG: 0.7245
Validation loss decreased (0.000000 --> 1.245823).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2324 LRAP: 0.6447 NDCG: 0.7264
val Loss: 1.1190 LRAP: 0.6600 NDCG: 0.7468
Validation loss decreased (1.245823 --> 1.119047).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1397 LRAP: 0.6792 NDCG: 0.7596
val Loss: 1.0617 LRAP: 0.6820 NDCG: 0.7705
Validation loss decreased (1.119047 --> 1.061693).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0846 LRAP: 0.6933 NDCG: 0.7735
val Loss: 1.0380 LRAP: 0.6971 NDCG: 0.7955
Validation loss decreased (1.061693 --> 1.037964).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0467 LRAP: 0.7077 NDCG: 0.7885
val Loss: 1.0191 LRAP: 0.7222 NDCG: 0.8002
Validation loss decreased (1.037964 --> 1.019110).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0141 LRAP: 0.7162 NDCG: 0.7995
val Loss: 0.9843 LRAP: 0.7351 NDCG: 0.8128
Validation loss decreased (1.019110 --> 0.984337).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9911 LRAP: 0.7242 NDCG: 0.8085
val Loss: 0.9726 LRAP: 0.7374 NDCG: 0.8155
Validation loss decreased (0.984337 --> 0.972553).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9699 LRAP: 0.7290 NDCG: 0.8131
val Loss: 0.9708 LRAP: 0.7442 NDCG: 0.8252
Validation loss decreased (0.972553 --> 0.970783).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9539 LRAP: 0.7326 NDCG: 0.8201
val Loss: 0.9399 LRAP: 0.7479 NDCG: 0.8306
Validation loss decreased (0.970783 --> 0.939908).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9352 LRAP: 0.7250 NDCG: 0.8170
val Loss: 0.9427 LRAP: 0.7359 NDCG: 0.8257
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9300 LRAP: 0.7287 NDCG: 0.8222
val Loss: 0.9420 LRAP: 0.7508 NDCG: 0.8270
EarlyStopping counter: 2 out of 25

Epoch 11/99
----------
train Loss: 0.9120 LRAP: 0.7416 NDCG: 0.8298
val Loss: 0.9464 LRAP: 0.7668 NDCG: 0.8289
EarlyStopping counter: 3 out of 25

Epoch 12/99
----------
train Loss: 0.8998 LRAP: 0.7487 NDCG: 0.8327
val Loss: 0.9339 LRAP: 0.7568 NDCG: 0.8341
Validation loss decreased (0.939908 --> 0.933934).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8941 LRAP: 0.7453 NDCG: 0.8323
val Loss: 0.9170 LRAP: 0.7759 NDCG: 0.8456
Validation loss decreased (0.933934 --> 0.917028).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8847 LRAP: 0.7476 NDCG: 0.8330
val Loss: 0.9275 LRAP: 0.7171 NDCG: 0.8267
EarlyStopping counter: 1 out of 25

Epoch 15/99
----------
train Loss: 0.8800 LRAP: 0.7636 NDCG: 0.8424
val Loss: 0.9177 LRAP: 0.7753 NDCG: 0.8456
EarlyStopping counter: 2 out of 25

Epoch 16/99
----------
train Loss: 0.8746 LRAP: 0.7598 NDCG: 0.8378
val Loss: 0.9267 LRAP: 0.7813 NDCG: 0.8446
EarlyStopping counter: 3 out of 25

Epoch 17/99
----------
train Loss: 0.8613 LRAP: 0.7660 NDCG: 0.8340
val Loss: 0.9100 LRAP: 0.7879 NDCG: 0.8509
Validation loss decreased (0.917028 --> 0.910012).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8540 LRAP: 0.7707 NDCG: 0.8339
val Loss: 0.9051 LRAP: 0.7853 NDCG: 0.8523
Validation loss decreased (0.910012 --> 0.905100).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8464 LRAP: 0.7731 NDCG: 0.8390
val Loss: 0.9106 LRAP: 0.7930 NDCG: 0.8485
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8441 LRAP: 0.7709 NDCG: 0.8185
val Loss: 0.9113 LRAP: 0.7962 NDCG: 0.8444
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 0.8390 LRAP: 0.7732 NDCG: 0.8298
val Loss: 0.8979 LRAP: 0.7819 NDCG: 0.8321
Validation loss decreased (0.905100 --> 0.897927).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8348 LRAP: 0.7733 NDCG: 0.8212
val Loss: 0.8917 LRAP: 0.7970 NDCG: 0.8473
Validation loss decreased (0.897927 --> 0.891680).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8278 LRAP: 0.7739 NDCG: 0.8087
val Loss: 0.9012 LRAP: 0.8082 NDCG: 0.8512
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8205 LRAP: 0.7818 NDCG: 0.8256
val Loss: 0.9065 LRAP: 0.7856 NDCG: 0.8439
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.8149 LRAP: 0.7822 NDCG: 0.8142
val Loss: 0.8990 LRAP: 0.8256 NDCG: 0.8491
EarlyStopping counter: 3 out of 25

Epoch 26/99
----------
train Loss: 0.8115 LRAP: 0.7874 NDCG: 0.8134
val Loss: 0.8938 LRAP: 0.7933 NDCG: 0.8344
EarlyStopping counter: 4 out of 25

Epoch 27/99
----------
train Loss: 0.8045 LRAP: 0.7870 NDCG: 0.8040
val Loss: 0.8933 LRAP: 0.7893 NDCG: 0.8394
EarlyStopping counter: 5 out of 25

Epoch 28/99
----------
train Loss: 0.7872 LRAP: 0.7975 NDCG: 0.8167
val Loss: 0.8814 LRAP: 0.8033 NDCG: 0.8327
Validation loss decreased (0.891680 --> 0.881398).  Saving model ...

Epoch 29/99
----------
train Loss: 0.7814 LRAP: 0.7995 NDCG: 0.8180
val Loss: 0.8832 LRAP: 0.8162 NDCG: 0.8431
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.7752 LRAP: 0.8047 NDCG: 0.8134
val Loss: 0.8833 LRAP: 0.8184 NDCG: 0.8443
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.7723 LRAP: 0.8062 NDCG: 0.8068
val Loss: 0.8835 LRAP: 0.8170 NDCG: 0.8432
EarlyStopping counter: 3 out of 25

Epoch 32/99
----------
train Loss: 0.7690 LRAP: 0.8033 NDCG: 0.8059
val Loss: 0.8847 LRAP: 0.8110 NDCG: 0.8298
EarlyStopping counter: 4 out of 25

Epoch 33/99
----------
train Loss: 0.7685 LRAP: 0.8067 NDCG: 0.8065
val Loss: 0.8827 LRAP: 0.8179 NDCG: 0.8447
EarlyStopping counter: 5 out of 25

Epoch 34/99
----------
train Loss: 0.7626 LRAP: 0.8068 NDCG: 0.8110
val Loss: 0.8846 LRAP: 0.8307 NDCG: 0.8437
EarlyStopping counter: 6 out of 25

Epoch 35/99
----------
train Loss: 0.7611 LRAP: 0.8079 NDCG: 0.8090
val Loss: 0.8860 LRAP: 0.8299 NDCG: 0.8354
EarlyStopping counter: 7 out of 25

Epoch 36/99
----------
train Loss: 0.7597 LRAP: 0.8108 NDCG: 0.8123
val Loss: 0.8822 LRAP: 0.8296 NDCG: 0.8396
EarlyStopping counter: 8 out of 25

Epoch 37/99
----------
train Loss: 0.7583 LRAP: 0.8109 NDCG: 0.8093
val Loss: 0.8836 LRAP: 0.8304 NDCG: 0.8394
EarlyStopping counter: 9 out of 25

Epoch 38/99
----------
train Loss: 0.7582 LRAP: 0.8115 NDCG: 0.8091
val Loss: 0.8817 LRAP: 0.8344 NDCG: 0.8479
EarlyStopping counter: 10 out of 25

Epoch 39/99
----------
train Loss: 0.7563 LRAP: 0.8109 NDCG: 0.8077
val Loss: 0.8823 LRAP: 0.8353 NDCG: 0.8547
EarlyStopping counter: 11 out of 25

Epoch 40/99
----------
train Loss: 0.7557 LRAP: 0.8122 NDCG: 0.8115
val Loss: 0.8819 LRAP: 0.8356 NDCG: 0.8537
EarlyStopping counter: 12 out of 25

Epoch 41/99
----------
train Loss: 0.7563 LRAP: 0.8107 NDCG: 0.8096
val Loss: 0.8821 LRAP: 0.8310 NDCG: 0.8467
EarlyStopping counter: 13 out of 25

Epoch 42/99
----------
train Loss: 0.7558 LRAP: 0.8134 NDCG: 0.8127
val Loss: 0.8839 LRAP: 0.8276 NDCG: 0.8403
EarlyStopping counter: 14 out of 25

Epoch 43/99
----------
train Loss: 0.7577 LRAP: 0.8101 NDCG: 0.8083
val Loss: 0.8823 LRAP: 0.8321 NDCG: 0.8451
EarlyStopping counter: 15 out of 25

Epoch 44/99
----------
train Loss: 0.7567 LRAP: 0.8118 NDCG: 0.8132
val Loss: 0.8820 LRAP: 0.8321 NDCG: 0.8451
EarlyStopping counter: 16 out of 25

Epoch 45/99
----------
train Loss: 0.7566 LRAP: 0.8098 NDCG: 0.8061
val Loss: 0.8822 LRAP: 0.8267 NDCG: 0.8402
EarlyStopping counter: 17 out of 25

Epoch 46/99
----------
train Loss: 0.7569 LRAP: 0.8097 NDCG: 0.8125
val Loss: 0.8833 LRAP: 0.8293 NDCG: 0.8406
EarlyStopping counter: 18 out of 25

Epoch 47/99
----------
train Loss: 0.7566 LRAP: 0.8119 NDCG: 0.8129
val Loss: 0.8815 LRAP: 0.8330 NDCG: 0.8500
EarlyStopping counter: 19 out of 25

Epoch 48/99
----------
train Loss: 0.7574 LRAP: 0.8096 NDCG: 0.8090
val Loss: 0.8840 LRAP: 0.8279 NDCG: 0.8448
EarlyStopping counter: 20 out of 25

Epoch 49/99
----------
train Loss: 0.7563 LRAP: 0.8140 NDCG: 0.8136
val Loss: 0.8842 LRAP: 0.8279 NDCG: 0.8410
EarlyStopping counter: 21 out of 25

Epoch 50/99
----------
train Loss: 0.7560 LRAP: 0.8114 NDCG: 0.8111
val Loss: 0.8839 LRAP: 0.8284 NDCG: 0.8430
EarlyStopping counter: 22 out of 25

Epoch 51/99
----------
train Loss: 0.7552 LRAP: 0.8140 NDCG: 0.8133
val Loss: 0.8848 LRAP: 0.8310 NDCG: 0.8446
EarlyStopping counter: 23 out of 25

Epoch 52/99
----------
train Loss: 0.7566 LRAP: 0.8076 NDCG: 0.8053
val Loss: 0.8859 LRAP: 0.8327 NDCG: 0.8427
EarlyStopping counter: 24 out of 25

Epoch 53/99
----------
train Loss: 0.7532 LRAP: 0.8104 NDCG: 0.8100
val Loss: 0.8827 LRAP: 0.8299 NDCG: 0.8461
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 6m 30s
Best val loss: 0.881398, best LRAP score: 0.9616

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7269 LRAP: 0.2457 NDCG: 0.5896
val Loss: 1.2582 LRAP: 0.5761 NDCG: 0.7231
Validation loss decreased (0.000000 --> 1.258194).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2452 LRAP: 0.5725 NDCG: 0.7206
val Loss: 1.1438 LRAP: 0.6066 NDCG: 0.7387
Validation loss decreased (1.258194 --> 1.143838).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1483 LRAP: 0.6180 NDCG: 0.7454
val Loss: 1.1209 LRAP: 0.6001 NDCG: 0.7379
Validation loss decreased (1.143838 --> 1.120884).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0928 LRAP: 0.6448 NDCG: 0.7622
val Loss: 1.0390 LRAP: 0.6971 NDCG: 0.7899
Validation loss decreased (1.120884 --> 1.039025).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0545 LRAP: 0.6652 NDCG: 0.7790
val Loss: 1.0299 LRAP: 0.6771 NDCG: 0.7890
Validation loss decreased (1.039025 --> 1.029855).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0304 LRAP: 0.6591 NDCG: 0.7805
val Loss: 0.9991 LRAP: 0.7102 NDCG: 0.8045
Validation loss decreased (1.029855 --> 0.999083).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9988 LRAP: 0.6792 NDCG: 0.7934
val Loss: 0.9762 LRAP: 0.6731 NDCG: 0.7871
Validation loss decreased (0.999083 --> 0.976218).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9717 LRAP: 0.6855 NDCG: 0.7994
val Loss: 0.9574 LRAP: 0.6700 NDCG: 0.8071
Validation loss decreased (0.976218 --> 0.957367).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9580 LRAP: 0.6931 NDCG: 0.8085
val Loss: 0.9367 LRAP: 0.7220 NDCG: 0.8182
Validation loss decreased (0.957367 --> 0.936674).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9349 LRAP: 0.7161 NDCG: 0.8197
val Loss: 0.9377 LRAP: 0.7194 NDCG: 0.8231
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9233 LRAP: 0.7190 NDCG: 0.8237
val Loss: 0.9320 LRAP: 0.7562 NDCG: 0.8372
Validation loss decreased (0.936674 --> 0.932035).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9104 LRAP: 0.7269 NDCG: 0.8266
val Loss: 0.9349 LRAP: 0.7622 NDCG: 0.8443
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.8960 LRAP: 0.7412 NDCG: 0.8364
val Loss: 0.9392 LRAP: 0.7782 NDCG: 0.8477
EarlyStopping counter: 2 out of 25

Epoch 13/99
----------
train Loss: 0.8891 LRAP: 0.7501 NDCG: 0.8383
val Loss: 0.9145 LRAP: 0.7745 NDCG: 0.8483
Validation loss decreased (0.932035 --> 0.914453).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8810 LRAP: 0.7471 NDCG: 0.8374
val Loss: 0.9367 LRAP: 0.7919 NDCG: 0.8625
EarlyStopping counter: 1 out of 25

Epoch 15/99
----------
train Loss: 0.8714 LRAP: 0.7538 NDCG: 0.8410
val Loss: 0.9090 LRAP: 0.7725 NDCG: 0.8538
Validation loss decreased (0.914453 --> 0.908976).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8673 LRAP: 0.7565 NDCG: 0.8370
val Loss: 0.9049 LRAP: 0.7808 NDCG: 0.8523
Validation loss decreased (0.908976 --> 0.904857).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8578 LRAP: 0.7587 NDCG: 0.8377
val Loss: 0.9060 LRAP: 0.7739 NDCG: 0.8518
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.8502 LRAP: 0.7606 NDCG: 0.8366
val Loss: 0.9183 LRAP: 0.7830 NDCG: 0.8487
EarlyStopping counter: 2 out of 25

Epoch 19/99
----------
train Loss: 0.8464 LRAP: 0.7654 NDCG: 0.8317
val Loss: 0.9023 LRAP: 0.7756 NDCG: 0.8485
Validation loss decreased (0.904857 --> 0.902310).  Saving model ...

Epoch 20/99
----------
train Loss: 0.8384 LRAP: 0.7639 NDCG: 0.8264
val Loss: 0.9019 LRAP: 0.7750 NDCG: 0.8428
Validation loss decreased (0.902310 --> 0.901911).  Saving model ...

Epoch 21/99
----------
train Loss: 0.8333 LRAP: 0.7621 NDCG: 0.8200
val Loss: 0.9045 LRAP: 0.7665 NDCG: 0.8443
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.8238 LRAP: 0.7677 NDCG: 0.8230
val Loss: 0.9045 LRAP: 0.7985 NDCG: 0.8597
EarlyStopping counter: 2 out of 25

Epoch 23/99
----------
train Loss: 0.8215 LRAP: 0.7765 NDCG: 0.8314
val Loss: 0.8919 LRAP: 0.8087 NDCG: 0.8552
Validation loss decreased (0.901911 --> 0.891852).  Saving model ...

Epoch 24/99
----------
train Loss: 0.8166 LRAP: 0.7734 NDCG: 0.8135
val Loss: 0.8977 LRAP: 0.8122 NDCG: 0.8608
EarlyStopping counter: 1 out of 25

Epoch 25/99
----------
train Loss: 0.8068 LRAP: 0.7825 NDCG: 0.8222
val Loss: 0.9078 LRAP: 0.8147 NDCG: 0.8585
EarlyStopping counter: 2 out of 25

Epoch 26/99
----------
train Loss: 0.8060 LRAP: 0.7797 NDCG: 0.8140
val Loss: 0.8989 LRAP: 0.7976 NDCG: 0.8412
EarlyStopping counter: 3 out of 25

Epoch 27/99
----------
train Loss: 0.8016 LRAP: 0.7799 NDCG: 0.8058
val Loss: 0.9073 LRAP: 0.7908 NDCG: 0.7913
EarlyStopping counter: 4 out of 25

Epoch 28/99
----------
train Loss: 0.7978 LRAP: 0.7845 NDCG: 0.8165
val Loss: 0.8926 LRAP: 0.8139 NDCG: 0.8497
EarlyStopping counter: 5 out of 25

Epoch 29/99
----------
train Loss: 0.7784 LRAP: 0.7912 NDCG: 0.8188
val Loss: 0.8877 LRAP: 0.8147 NDCG: 0.8364
Validation loss decreased (0.891852 --> 0.887677).  Saving model ...

Epoch 30/99
----------
train Loss: 0.7662 LRAP: 0.7961 NDCG: 0.8103
val Loss: 0.8828 LRAP: 0.8287 NDCG: 0.8466
Validation loss decreased (0.887677 --> 0.882848).  Saving model ...

Epoch 31/99
----------
train Loss: 0.7632 LRAP: 0.8012 NDCG: 0.8167
val Loss: 0.8825 LRAP: 0.8310 NDCG: 0.8441
Validation loss decreased (0.882848 --> 0.882520).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7605 LRAP: 0.8056 NDCG: 0.8145
val Loss: 0.8846 LRAP: 0.8310 NDCG: 0.8495
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.7606 LRAP: 0.8054 NDCG: 0.8150
val Loss: 0.8835 LRAP: 0.8236 NDCG: 0.8382
EarlyStopping counter: 2 out of 25

Epoch 34/99
----------
train Loss: 0.7569 LRAP: 0.8091 NDCG: 0.8114
val Loss: 0.8834 LRAP: 0.8190 NDCG: 0.8353
EarlyStopping counter: 3 out of 25

Epoch 35/99
----------
train Loss: 0.7542 LRAP: 0.8100 NDCG: 0.8138
val Loss: 0.8861 LRAP: 0.8304 NDCG: 0.8446
EarlyStopping counter: 4 out of 25

Epoch 36/99
----------
train Loss: 0.7510 LRAP: 0.8090 NDCG: 0.8126
val Loss: 0.8878 LRAP: 0.8324 NDCG: 0.8378
EarlyStopping counter: 5 out of 25

Epoch 37/99
----------
train Loss: 0.7466 LRAP: 0.8162 NDCG: 0.8182
val Loss: 0.8860 LRAP: 0.8299 NDCG: 0.8404
EarlyStopping counter: 6 out of 25

Epoch 38/99
----------
train Loss: 0.7467 LRAP: 0.8125 NDCG: 0.8172
val Loss: 0.8819 LRAP: 0.8350 NDCG: 0.8486
Validation loss decreased (0.882520 --> 0.881899).  Saving model ...

Epoch 39/99
----------
train Loss: 0.7466 LRAP: 0.8136 NDCG: 0.8158
val Loss: 0.8867 LRAP: 0.8259 NDCG: 0.8336
EarlyStopping counter: 1 out of 25

Epoch 40/99
----------
train Loss: 0.7448 LRAP: 0.8112 NDCG: 0.8130
val Loss: 0.8841 LRAP: 0.8296 NDCG: 0.8430
EarlyStopping counter: 2 out of 25

Epoch 41/99
----------
train Loss: 0.7437 LRAP: 0.8123 NDCG: 0.8171
val Loss: 0.8841 LRAP: 0.8330 NDCG: 0.8439
EarlyStopping counter: 3 out of 25

Epoch 42/99
----------
train Loss: 0.7428 LRAP: 0.8153 NDCG: 0.8182
val Loss: 0.8850 LRAP: 0.8356 NDCG: 0.8450
EarlyStopping counter: 4 out of 25

Epoch 43/99
----------
train Loss: 0.7426 LRAP: 0.8174 NDCG: 0.8187
val Loss: 0.8825 LRAP: 0.8390 NDCG: 0.8506
EarlyStopping counter: 5 out of 25

Epoch 44/99
----------
train Loss: 0.7406 LRAP: 0.8147 NDCG: 0.8138
val Loss: 0.8842 LRAP: 0.8364 NDCG: 0.8496
EarlyStopping counter: 6 out of 25

Epoch 45/99
----------
train Loss: 0.7412 LRAP: 0.8143 NDCG: 0.8192
val Loss: 0.8844 LRAP: 0.8379 NDCG: 0.8512
EarlyStopping counter: 7 out of 25

Epoch 46/99
----------
train Loss: 0.7408 LRAP: 0.8167 NDCG: 0.8200
val Loss: 0.8832 LRAP: 0.8379 NDCG: 0.8501
EarlyStopping counter: 8 out of 25

Epoch 47/99
----------
train Loss: 0.7402 LRAP: 0.8150 NDCG: 0.8156
val Loss: 0.8850 LRAP: 0.8339 NDCG: 0.8468
EarlyStopping counter: 9 out of 25

Epoch 48/99
----------
train Loss: 0.7412 LRAP: 0.8172 NDCG: 0.8187
val Loss: 0.8834 LRAP: 0.8319 NDCG: 0.8445
EarlyStopping counter: 10 out of 25

Epoch 49/99
----------
train Loss: 0.7399 LRAP: 0.8157 NDCG: 0.8169
val Loss: 0.8827 LRAP: 0.8350 NDCG: 0.8449
EarlyStopping counter: 11 out of 25

Epoch 50/99
----------
train Loss: 0.7391 LRAP: 0.8169 NDCG: 0.8207
val Loss: 0.8827 LRAP: 0.8333 NDCG: 0.8463
EarlyStopping counter: 12 out of 25

Epoch 51/99
----------
train Loss: 0.7396 LRAP: 0.8153 NDCG: 0.8156
val Loss: 0.8850 LRAP: 0.8321 NDCG: 0.8430
EarlyStopping counter: 13 out of 25

Epoch 52/99
----------
train Loss: 0.7411 LRAP: 0.8153 NDCG: 0.8175
val Loss: 0.8845 LRAP: 0.8339 NDCG: 0.8448
EarlyStopping counter: 14 out of 25

Epoch 53/99
----------
train Loss: 0.7398 LRAP: 0.8164 NDCG: 0.8211
val Loss: 0.8847 LRAP: 0.8384 NDCG: 0.8507
EarlyStopping counter: 15 out of 25

Epoch 54/99
----------
train Loss: 0.7394 LRAP: 0.8167 NDCG: 0.8210
val Loss: 0.8837 LRAP: 0.8376 NDCG: 0.8514
EarlyStopping counter: 16 out of 25

Epoch 55/99
----------
train Loss: 0.7400 LRAP: 0.8159 NDCG: 0.8207
val Loss: 0.8845 LRAP: 0.8327 NDCG: 0.8440
EarlyStopping counter: 17 out of 25

Epoch 56/99
----------
train Loss: 0.7391 LRAP: 0.8184 NDCG: 0.8165
val Loss: 0.8853 LRAP: 0.8350 NDCG: 0.8466
EarlyStopping counter: 18 out of 25

Epoch 57/99
----------
train Loss: 0.7413 LRAP: 0.8154 NDCG: 0.8184
val Loss: 0.8828 LRAP: 0.8344 NDCG: 0.8475
EarlyStopping counter: 19 out of 25

Epoch 58/99
----------
train Loss: 0.7386 LRAP: 0.8175 NDCG: 0.8156
val Loss: 0.8849 LRAP: 0.8356 NDCG: 0.8460
EarlyStopping counter: 20 out of 25

Epoch 59/99
----------
train Loss: 0.7399 LRAP: 0.8155 NDCG: 0.8153
val Loss: 0.8873 LRAP: 0.8307 NDCG: 0.8403
EarlyStopping counter: 21 out of 25

Epoch 60/99
----------
train Loss: 0.7408 LRAP: 0.8155 NDCG: 0.8209
val Loss: 0.8839 LRAP: 0.8353 NDCG: 0.8474
EarlyStopping counter: 22 out of 25

Epoch 61/99
----------
train Loss: 0.7401 LRAP: 0.8143 NDCG: 0.8183
val Loss: 0.8835 LRAP: 0.8319 NDCG: 0.8443
EarlyStopping counter: 23 out of 25

Epoch 62/99
----------
train Loss: 0.7401 LRAP: 0.8156 NDCG: 0.8179
val Loss: 0.8842 LRAP: 0.8356 NDCG: 0.8474
EarlyStopping counter: 24 out of 25

Epoch 63/99
----------
train Loss: 0.7404 LRAP: 0.8149 NDCG: 0.8117
val Loss: 0.8835 LRAP: 0.8364 NDCG: 0.8462
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 9m 47s
Best val loss: 0.881899, best LRAP score: 0.9627

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.8788 LRAP: 0.1715 NDCG: 0.5584
val Loss: 2.3093 LRAP: 0.0871 NDCG: 0.4588
Validation loss decreased (0.000000 --> 2.309335).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2890 LRAP: 0.6253 NDCG: 0.7158
val Loss: 1.1844 LRAP: 0.6406 NDCG: 0.7274
Validation loss decreased (2.309335 --> 1.184411).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1978 LRAP: 0.6553 NDCG: 0.7274
val Loss: 1.2306 LRAP: 0.5846 NDCG: 0.7023
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.1482 LRAP: 0.6620 NDCG: 0.7385
val Loss: 1.1997 LRAP: 0.6297 NDCG: 0.7351
EarlyStopping counter: 2 out of 25

Epoch 4/99
----------
train Loss: 1.1148 LRAP: 0.6674 NDCG: 0.7491
val Loss: 1.1259 LRAP: 0.6138 NDCG: 0.7359
Validation loss decreased (1.184411 --> 1.125916).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0942 LRAP: 0.6734 NDCG: 0.7595
val Loss: 1.2311 LRAP: 0.6306 NDCG: 0.7394
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.0749 LRAP: 0.6717 NDCG: 0.7641
val Loss: 1.1196 LRAP: 0.7202 NDCG: 0.7890
Validation loss decreased (1.125916 --> 1.119613).  Saving model ...

Epoch 7/99
----------
train Loss: 1.0645 LRAP: 0.6742 NDCG: 0.7705
val Loss: 1.1008 LRAP: 0.6983 NDCG: 0.7752
Validation loss decreased (1.119613 --> 1.100825).  Saving model ...

Epoch 8/99
----------
train Loss: 1.0457 LRAP: 0.6842 NDCG: 0.7760
val Loss: 1.0361 LRAP: 0.7065 NDCG: 0.7896
Validation loss decreased (1.100825 --> 1.036076).  Saving model ...

Epoch 9/99
----------
train Loss: 1.0417 LRAP: 0.6752 NDCG: 0.7771
val Loss: 1.2916 LRAP: 0.4667 NDCG: 0.7120
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 1.0333 LRAP: 0.6815 NDCG: 0.7815
val Loss: 1.1006 LRAP: 0.7154 NDCG: 0.7956
EarlyStopping counter: 2 out of 25

Epoch 11/99
----------
train Loss: 1.0153 LRAP: 0.6970 NDCG: 0.7877
val Loss: 1.0992 LRAP: 0.6694 NDCG: 0.7747
EarlyStopping counter: 3 out of 25

Epoch 12/99
----------
train Loss: 1.0076 LRAP: 0.6825 NDCG: 0.7860
val Loss: 1.0192 LRAP: 0.5669 NDCG: 0.7551
Validation loss decreased (1.036076 --> 1.019199).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9901 LRAP: 0.6968 NDCG: 0.7945
val Loss: 1.1283 LRAP: 0.5998 NDCG: 0.7600
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.9810 LRAP: 0.6962 NDCG: 0.7925
val Loss: 0.9917 LRAP: 0.6420 NDCG: 0.7833
Validation loss decreased (1.019199 --> 0.991737).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9740 LRAP: 0.6971 NDCG: 0.7919
val Loss: 1.0836 LRAP: 0.7225 NDCG: 0.8014
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.9625 LRAP: 0.7023 NDCG: 0.7900
val Loss: 0.9660 LRAP: 0.7245 NDCG: 0.8110
Validation loss decreased (0.991737 --> 0.966022).  Saving model ...

Epoch 17/99
----------
train Loss: 0.9593 LRAP: 0.6987 NDCG: 0.7926
val Loss: 0.9738 LRAP: 0.7322 NDCG: 0.8072
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.9516 LRAP: 0.7064 NDCG: 0.7873
val Loss: 1.0122 LRAP: 0.7228 NDCG: 0.8041
EarlyStopping counter: 2 out of 25

Epoch 19/99
----------
train Loss: 0.9381 LRAP: 0.7095 NDCG: 0.7891
val Loss: 1.1746 LRAP: 0.5241 NDCG: 0.7374
EarlyStopping counter: 3 out of 25

Epoch 20/99
----------
train Loss: 0.9388 LRAP: 0.7055 NDCG: 0.7892
val Loss: 0.9869 LRAP: 0.7057 NDCG: 0.7906
EarlyStopping counter: 4 out of 25

Epoch 21/99
----------
train Loss: 0.9331 LRAP: 0.7098 NDCG: 0.7854
val Loss: 0.9911 LRAP: 0.7259 NDCG: 0.7868
EarlyStopping counter: 5 out of 25

Epoch 22/99
----------
train Loss: 0.9135 LRAP: 0.7263 NDCG: 0.7946
val Loss: 0.9365 LRAP: 0.7505 NDCG: 0.8281
Validation loss decreased (0.966022 --> 0.936524).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8995 LRAP: 0.7236 NDCG: 0.7928
val Loss: 0.9344 LRAP: 0.7556 NDCG: 0.8322
Validation loss decreased (0.936524 --> 0.934420).  Saving model ...

Epoch 24/99
----------
train Loss: 0.8972 LRAP: 0.7274 NDCG: 0.7892
val Loss: 0.9302 LRAP: 0.7456 NDCG: 0.8192
Validation loss decreased (0.934420 --> 0.930226).  Saving model ...

Epoch 25/99
----------
train Loss: 0.8949 LRAP: 0.7300 NDCG: 0.7894
val Loss: 0.9301 LRAP: 0.7525 NDCG: 0.8222
Validation loss decreased (0.930226 --> 0.930053).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8933 LRAP: 0.7276 NDCG: 0.7893
val Loss: 0.9278 LRAP: 0.7536 NDCG: 0.8278
Validation loss decreased (0.930053 --> 0.927771).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8880 LRAP: 0.7263 NDCG: 0.7847
val Loss: 0.9298 LRAP: 0.7397 NDCG: 0.8147
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.8858 LRAP: 0.7325 NDCG: 0.7899
val Loss: 0.9258 LRAP: 0.7593 NDCG: 0.8301
Validation loss decreased (0.927771 --> 0.925768).  Saving model ...

Epoch 29/99
----------
train Loss: 0.8838 LRAP: 0.7294 NDCG: 0.7924
val Loss: 0.9274 LRAP: 0.7659 NDCG: 0.8391
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.8838 LRAP: 0.7277 NDCG: 0.7896
val Loss: 0.9205 LRAP: 0.7645 NDCG: 0.8341
Validation loss decreased (0.925768 --> 0.920532).  Saving model ...

Epoch 31/99
----------
train Loss: 0.8807 LRAP: 0.7285 NDCG: 0.7874
val Loss: 0.9223 LRAP: 0.7599 NDCG: 0.8227
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.8791 LRAP: 0.7294 NDCG: 0.7907
val Loss: 0.9220 LRAP: 0.7559 NDCG: 0.8270
EarlyStopping counter: 2 out of 25

Epoch 33/99
----------
train Loss: 0.8719 LRAP: 0.7372 NDCG: 0.7936
val Loss: 0.9190 LRAP: 0.7611 NDCG: 0.8292
Validation loss decreased (0.920532 --> 0.918994).  Saving model ...

Epoch 34/99
----------
train Loss: 0.8746 LRAP: 0.7305 NDCG: 0.7917
val Loss: 0.9197 LRAP: 0.7648 NDCG: 0.8331
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.8697 LRAP: 0.7381 NDCG: 0.7996
val Loss: 0.9171 LRAP: 0.7699 NDCG: 0.8355
Validation loss decreased (0.918994 --> 0.917083).  Saving model ...

Epoch 36/99
----------
train Loss: 0.8720 LRAP: 0.7315 NDCG: 0.7993
val Loss: 0.9117 LRAP: 0.7676 NDCG: 0.8354
Validation loss decreased (0.917083 --> 0.911714).  Saving model ...

Epoch 37/99
----------
train Loss: 0.8626 LRAP: 0.7391 NDCG: 0.7913
val Loss: 0.9175 LRAP: 0.7688 NDCG: 0.8403
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.8651 LRAP: 0.7403 NDCG: 0.8013
val Loss: 0.9170 LRAP: 0.7519 NDCG: 0.8185
EarlyStopping counter: 2 out of 25

Epoch 39/99
----------
train Loss: 0.8603 LRAP: 0.7379 NDCG: 0.7944
val Loss: 0.9151 LRAP: 0.7711 NDCG: 0.8315
EarlyStopping counter: 3 out of 25

Epoch 40/99
----------
train Loss: 0.8589 LRAP: 0.7387 NDCG: 0.7963
val Loss: 0.9092 LRAP: 0.7636 NDCG: 0.8294
Validation loss decreased (0.911714 --> 0.909157).  Saving model ...

Epoch 41/99
----------
train Loss: 0.8579 LRAP: 0.7398 NDCG: 0.7951
val Loss: 0.9147 LRAP: 0.7633 NDCG: 0.8200
EarlyStopping counter: 1 out of 25

Epoch 42/99
----------
train Loss: 0.8546 LRAP: 0.7399 NDCG: 0.7934
val Loss: 0.9089 LRAP: 0.7688 NDCG: 0.8219
Validation loss decreased (0.909157 --> 0.908930).  Saving model ...

Epoch 43/99
----------
train Loss: 0.8523 LRAP: 0.7423 NDCG: 0.7937
val Loss: 0.9036 LRAP: 0.7708 NDCG: 0.8396
Validation loss decreased (0.908930 --> 0.903643).  Saving model ...

Epoch 44/99
----------
train Loss: 0.8507 LRAP: 0.7407 NDCG: 0.7958
val Loss: 0.9047 LRAP: 0.7725 NDCG: 0.8396
EarlyStopping counter: 1 out of 25

Epoch 45/99
----------
train Loss: 0.8485 LRAP: 0.7480 NDCG: 0.7984
val Loss: 0.9045 LRAP: 0.7599 NDCG: 0.8320
EarlyStopping counter: 2 out of 25

Epoch 46/99
----------
train Loss: 0.8452 LRAP: 0.7474 NDCG: 0.7980
val Loss: 0.9111 LRAP: 0.7525 NDCG: 0.8108
EarlyStopping counter: 3 out of 25

Epoch 47/99
----------
train Loss: 0.8433 LRAP: 0.7450 NDCG: 0.7904
val Loss: 0.9077 LRAP: 0.7499 NDCG: 0.8065
EarlyStopping counter: 4 out of 25

Epoch 48/99
----------
train Loss: 0.8380 LRAP: 0.7480 NDCG: 0.7926
val Loss: 0.9079 LRAP: 0.7596 NDCG: 0.8249
EarlyStopping counter: 5 out of 25

Epoch 49/99
----------
train Loss: 0.8350 LRAP: 0.7508 NDCG: 0.7921
val Loss: 0.8959 LRAP: 0.7708 NDCG: 0.8274
Validation loss decreased (0.903643 --> 0.895902).  Saving model ...

Epoch 50/99
----------
train Loss: 0.8297 LRAP: 0.7491 NDCG: 0.7910
val Loss: 0.8958 LRAP: 0.7733 NDCG: 0.8280
Validation loss decreased (0.895902 --> 0.895835).  Saving model ...

Epoch 51/99
----------
train Loss: 0.8291 LRAP: 0.7492 NDCG: 0.7920
val Loss: 0.8944 LRAP: 0.7688 NDCG: 0.8236
Validation loss decreased (0.895835 --> 0.894413).  Saving model ...

Epoch 52/99
----------
train Loss: 0.8261 LRAP: 0.7546 NDCG: 0.7881
val Loss: 0.8938 LRAP: 0.7779 NDCG: 0.8296
Validation loss decreased (0.894413 --> 0.893767).  Saving model ...

Epoch 53/99
----------
train Loss: 0.8258 LRAP: 0.7562 NDCG: 0.7955
val Loss: 0.8966 LRAP: 0.7782 NDCG: 0.8300
EarlyStopping counter: 1 out of 25

Epoch 54/99
----------
train Loss: 0.8277 LRAP: 0.7541 NDCG: 0.7931
val Loss: 0.8954 LRAP: 0.7785 NDCG: 0.8324
EarlyStopping counter: 2 out of 25

Epoch 55/99
----------
train Loss: 0.8278 LRAP: 0.7564 NDCG: 0.7982
val Loss: 0.8961 LRAP: 0.7793 NDCG: 0.8312
EarlyStopping counter: 3 out of 25

Epoch 56/99
----------
train Loss: 0.8264 LRAP: 0.7548 NDCG: 0.7938
val Loss: 0.8933 LRAP: 0.7793 NDCG: 0.8319
Validation loss decreased (0.893767 --> 0.893342).  Saving model ...

Epoch 57/99
----------
train Loss: 0.8254 LRAP: 0.7540 NDCG: 0.7974
val Loss: 0.8937 LRAP: 0.7776 NDCG: 0.8307
EarlyStopping counter: 1 out of 25

Epoch 58/99
----------
train Loss: 0.8248 LRAP: 0.7538 NDCG: 0.7941
val Loss: 0.8935 LRAP: 0.7822 NDCG: 0.8305
EarlyStopping counter: 2 out of 25

Epoch 59/99
----------
train Loss: 0.8225 LRAP: 0.7575 NDCG: 0.7964
val Loss: 0.8923 LRAP: 0.7822 NDCG: 0.8305
Validation loss decreased (0.893342 --> 0.892256).  Saving model ...

Epoch 60/99
----------
train Loss: 0.8241 LRAP: 0.7583 NDCG: 0.7958
val Loss: 0.8914 LRAP: 0.7799 NDCG: 0.8343
Validation loss decreased (0.892256 --> 0.891437).  Saving model ...

Epoch 61/99
----------
train Loss: 0.8222 LRAP: 0.7566 NDCG: 0.7968
val Loss: 0.8936 LRAP: 0.7822 NDCG: 0.8293
EarlyStopping counter: 1 out of 25

Epoch 62/99
----------
train Loss: 0.8231 LRAP: 0.7577 NDCG: 0.7926
val Loss: 0.8910 LRAP: 0.7830 NDCG: 0.8307
Validation loss decreased (0.891437 --> 0.890977).  Saving model ...

Epoch 63/99
----------
train Loss: 0.8208 LRAP: 0.7616 NDCG: 0.7999
val Loss: 0.8921 LRAP: 0.7859 NDCG: 0.8384
EarlyStopping counter: 1 out of 25

Epoch 64/99
----------
train Loss: 0.8197 LRAP: 0.7599 NDCG: 0.7969
val Loss: 0.8918 LRAP: 0.7782 NDCG: 0.8292
EarlyStopping counter: 2 out of 25

Epoch 65/99
----------
train Loss: 0.8211 LRAP: 0.7614 NDCG: 0.7966
val Loss: 0.8913 LRAP: 0.7785 NDCG: 0.8272
EarlyStopping counter: 3 out of 25

Epoch 66/99
----------
train Loss: 0.8216 LRAP: 0.7613 NDCG: 0.8003
val Loss: 0.8926 LRAP: 0.7779 NDCG: 0.8272
EarlyStopping counter: 4 out of 25

Epoch 67/99
----------
train Loss: 0.8186 LRAP: 0.7598 NDCG: 0.7984
val Loss: 0.8918 LRAP: 0.7819 NDCG: 0.8278
EarlyStopping counter: 5 out of 25

Epoch 68/99
----------
train Loss: 0.8165 LRAP: 0.7623 NDCG: 0.7989
val Loss: 0.8921 LRAP: 0.7816 NDCG: 0.8295
EarlyStopping counter: 6 out of 25

Epoch 69/99
----------
train Loss: 0.8166 LRAP: 0.7567 NDCG: 0.7953
val Loss: 0.8904 LRAP: 0.7816 NDCG: 0.8325
Validation loss decreased (0.890977 --> 0.890431).  Saving model ...

Epoch 70/99
----------
train Loss: 0.8172 LRAP: 0.7617 NDCG: 0.7944
val Loss: 0.8916 LRAP: 0.7816 NDCG: 0.8290
EarlyStopping counter: 1 out of 25

Epoch 71/99
----------
train Loss: 0.8188 LRAP: 0.7606 NDCG: 0.7959
val Loss: 0.8923 LRAP: 0.7850 NDCG: 0.8343
EarlyStopping counter: 2 out of 25

Epoch 72/99
----------
train Loss: 0.8151 LRAP: 0.7562 NDCG: 0.7982
val Loss: 0.8924 LRAP: 0.7805 NDCG: 0.8244
EarlyStopping counter: 3 out of 25

Epoch 73/99
----------
train Loss: 0.8149 LRAP: 0.7602 NDCG: 0.7986
val Loss: 0.8893 LRAP: 0.7810 NDCG: 0.8349
Validation loss decreased (0.890431 --> 0.889336).  Saving model ...

Epoch 74/99
----------
train Loss: 0.8158 LRAP: 0.7608 NDCG: 0.8009
val Loss: 0.8914 LRAP: 0.7816 NDCG: 0.8315
EarlyStopping counter: 1 out of 25

Epoch 75/99
----------
train Loss: 0.8149 LRAP: 0.7582 NDCG: 0.7964
val Loss: 0.8912 LRAP: 0.7785 NDCG: 0.8259
EarlyStopping counter: 2 out of 25

Epoch 76/99
----------
train Loss: 0.8173 LRAP: 0.7551 NDCG: 0.7952
val Loss: 0.8909 LRAP: 0.7793 NDCG: 0.8297
EarlyStopping counter: 3 out of 25

Epoch 77/99
----------
train Loss: 0.8176 LRAP: 0.7604 NDCG: 0.7987
val Loss: 0.8893 LRAP: 0.7822 NDCG: 0.8326
Validation loss decreased (0.889336 --> 0.889317).  Saving model ...

Epoch 78/99
----------
train Loss: 0.8179 LRAP: 0.7587 NDCG: 0.7955
val Loss: 0.8929 LRAP: 0.7828 NDCG: 0.8289
EarlyStopping counter: 1 out of 25

Epoch 79/99
----------
train Loss: 0.8169 LRAP: 0.7583 NDCG: 0.7957
val Loss: 0.8901 LRAP: 0.7819 NDCG: 0.8300
EarlyStopping counter: 2 out of 25

Epoch 80/99
----------
train Loss: 0.8151 LRAP: 0.7598 NDCG: 0.7965
val Loss: 0.8916 LRAP: 0.7793 NDCG: 0.8277
EarlyStopping counter: 3 out of 25

Epoch 81/99
----------
train Loss: 0.8140 LRAP: 0.7579 NDCG: 0.7975
val Loss: 0.8898 LRAP: 0.7813 NDCG: 0.8293
EarlyStopping counter: 4 out of 25

Epoch 82/99
----------
train Loss: 0.8146 LRAP: 0.7608 NDCG: 0.7979
val Loss: 0.8909 LRAP: 0.7788 NDCG: 0.8250
EarlyStopping counter: 5 out of 25

Epoch 83/99
----------
train Loss: 0.8142 LRAP: 0.7603 NDCG: 0.7950
val Loss: 0.8900 LRAP: 0.7822 NDCG: 0.8330
EarlyStopping counter: 6 out of 25

Epoch 84/99
----------
train Loss: 0.8162 LRAP: 0.7578 NDCG: 0.7945
val Loss: 0.8913 LRAP: 0.7788 NDCG: 0.8265
EarlyStopping counter: 7 out of 25

Epoch 85/99
----------
train Loss: 0.8157 LRAP: 0.7601 NDCG: 0.7971
val Loss: 0.8904 LRAP: 0.7799 NDCG: 0.8283
EarlyStopping counter: 8 out of 25

Epoch 86/99
----------
train Loss: 0.8142 LRAP: 0.7637 NDCG: 0.8028
val Loss: 0.8899 LRAP: 0.7850 NDCG: 0.8351
EarlyStopping counter: 9 out of 25

Epoch 87/99
----------
train Loss: 0.8145 LRAP: 0.7649 NDCG: 0.8005
val Loss: 0.8901 LRAP: 0.7799 NDCG: 0.8275
EarlyStopping counter: 10 out of 25

Epoch 88/99
----------
train Loss: 0.8126 LRAP: 0.7624 NDCG: 0.7991
val Loss: 0.8909 LRAP: 0.7833 NDCG: 0.8347
EarlyStopping counter: 11 out of 25

Epoch 89/99
----------
train Loss: 0.8155 LRAP: 0.7631 NDCG: 0.8013
val Loss: 0.8922 LRAP: 0.7796 NDCG: 0.8250
EarlyStopping counter: 12 out of 25

Epoch 90/99
----------
train Loss: 0.8159 LRAP: 0.7607 NDCG: 0.7985
val Loss: 0.8907 LRAP: 0.7856 NDCG: 0.8337
EarlyStopping counter: 13 out of 25

Epoch 91/99
----------
train Loss: 0.8145 LRAP: 0.7595 NDCG: 0.7965
val Loss: 0.8921 LRAP: 0.7845 NDCG: 0.8344
EarlyStopping counter: 14 out of 25

Epoch 92/99
----------
train Loss: 0.8144 LRAP: 0.7611 NDCG: 0.7986
val Loss: 0.8907 LRAP: 0.7810 NDCG: 0.8284
EarlyStopping counter: 15 out of 25

Epoch 93/99
----------
train Loss: 0.8136 LRAP: 0.7648 NDCG: 0.7971
val Loss: 0.8904 LRAP: 0.7825 NDCG: 0.8306
EarlyStopping counter: 16 out of 25

Epoch 94/99
----------
train Loss: 0.8152 LRAP: 0.7587 NDCG: 0.7950
val Loss: 0.8885 LRAP: 0.7842 NDCG: 0.8372
Validation loss decreased (0.889317 --> 0.888498).  Saving model ...

Epoch 95/99
----------
train Loss: 0.8161 LRAP: 0.7581 NDCG: 0.7962
val Loss: 0.8899 LRAP: 0.7850 NDCG: 0.8355
EarlyStopping counter: 1 out of 25

Epoch 96/99
----------
train Loss: 0.8155 LRAP: 0.7599 NDCG: 0.7991
val Loss: 0.8904 LRAP: 0.7788 NDCG: 0.8252
EarlyStopping counter: 2 out of 25

Epoch 97/99
----------
train Loss: 0.8151 LRAP: 0.7611 NDCG: 0.7990
val Loss: 0.8907 LRAP: 0.7816 NDCG: 0.8302
EarlyStopping counter: 3 out of 25

Epoch 98/99
----------
train Loss: 0.8149 LRAP: 0.7606 NDCG: 0.7977
val Loss: 0.8911 LRAP: 0.7805 NDCG: 0.8261
EarlyStopping counter: 4 out of 25

Epoch 99/99
----------
train Loss: 0.8136 LRAP: 0.7603 NDCG: 0.7953
val Loss: 0.8903 LRAP: 0.7788 NDCG: 0.8260
EarlyStopping counter: 5 out of 25

Training complete in 14m 38s
Best val loss: 0.888498, best LRAP score: 0.9616

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7803 LRAP: 0.2104 NDCG: 0.5785
val Loss: 1.4512 LRAP: 0.2426 NDCG: 0.6243
Validation loss decreased (0.000000 --> 1.451151).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3166 LRAP: 0.5825 NDCG: 0.6980
val Loss: 1.5384 LRAP: 0.3754 NDCG: 0.6209
EarlyStopping counter: 1 out of 25

Epoch 2/99
----------
train Loss: 1.2453 LRAP: 0.6033 NDCG: 0.7159
val Loss: 1.7621 LRAP: 0.1399 NDCG: 0.5998
EarlyStopping counter: 2 out of 25

Epoch 3/99
----------
train Loss: 1.2156 LRAP: 0.6119 NDCG: 0.7276
val Loss: 1.3468 LRAP: 0.5946 NDCG: 0.7111
Validation loss decreased (1.451151 --> 1.346797).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1917 LRAP: 0.6109 NDCG: 0.7355
val Loss: 1.2098 LRAP: 0.5293 NDCG: 0.7278
Validation loss decreased (1.346797 --> 1.209754).  Saving model ...

Epoch 5/99
----------
train Loss: 1.1725 LRAP: 0.6149 NDCG: 0.7401
val Loss: 1.1782 LRAP: 0.6552 NDCG: 0.7557
Validation loss decreased (1.209754 --> 1.178169).  Saving model ...

Epoch 6/99
----------
train Loss: 1.1557 LRAP: 0.6291 NDCG: 0.7474
val Loss: 1.2933 LRAP: 0.4319 NDCG: 0.6862
EarlyStopping counter: 1 out of 25

Epoch 7/99
----------
train Loss: 1.1421 LRAP: 0.6229 NDCG: 0.7499
val Loss: 1.1253 LRAP: 0.6329 NDCG: 0.7546
Validation loss decreased (1.178169 --> 1.125277).  Saving model ...

Epoch 8/99
----------
train Loss: 1.1346 LRAP: 0.6269 NDCG: 0.7545
val Loss: 1.1752 LRAP: 0.7040 NDCG: 0.7895
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 1.1290 LRAP: 0.6353 NDCG: 0.7586
val Loss: 1.1567 LRAP: 0.5615 NDCG: 0.7340
EarlyStopping counter: 2 out of 25

Epoch 10/99
----------
train Loss: 1.1141 LRAP: 0.6474 NDCG: 0.7632
val Loss: 1.1557 LRAP: 0.7011 NDCG: 0.7847
EarlyStopping counter: 3 out of 25

Epoch 11/99
----------
train Loss: 1.1096 LRAP: 0.6481 NDCG: 0.7655
val Loss: 1.3743 LRAP: 0.6771 NDCG: 0.7666
EarlyStopping counter: 4 out of 25

Epoch 12/99
----------
train Loss: 1.0993 LRAP: 0.6601 NDCG: 0.7696
val Loss: 1.1090 LRAP: 0.7205 NDCG: 0.7964
Validation loss decreased (1.125277 --> 1.109006).  Saving model ...

Epoch 13/99
----------
train Loss: 1.0898 LRAP: 0.6583 NDCG: 0.7724
val Loss: 1.2974 LRAP: 0.7160 NDCG: 0.7776
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 1.0834 LRAP: 0.6602 NDCG: 0.7729
val Loss: 1.0761 LRAP: 0.5755 NDCG: 0.7505
Validation loss decreased (1.109006 --> 1.076095).  Saving model ...

Epoch 15/99
----------
train Loss: 1.0675 LRAP: 0.6627 NDCG: 0.7775
val Loss: 1.0784 LRAP: 0.7337 NDCG: 0.8115
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 1.0675 LRAP: 0.6600 NDCG: 0.7769
val Loss: 1.0649 LRAP: 0.6800 NDCG: 0.7920
Validation loss decreased (1.076095 --> 1.064858).  Saving model ...

Epoch 17/99
----------
train Loss: 1.0577 LRAP: 0.6651 NDCG: 0.7776
val Loss: 1.0464 LRAP: 0.6968 NDCG: 0.7964
Validation loss decreased (1.064858 --> 1.046389).  Saving model ...

Epoch 18/99
----------
train Loss: 1.0471 LRAP: 0.6715 NDCG: 0.7804
val Loss: 1.0912 LRAP: 0.7237 NDCG: 0.8038
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 1.0386 LRAP: 0.6667 NDCG: 0.7820
val Loss: 1.2786 LRAP: 0.4031 NDCG: 0.6828
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 1.0360 LRAP: 0.6664 NDCG: 0.7813
val Loss: 1.0743 LRAP: 0.6903 NDCG: 0.7939
EarlyStopping counter: 3 out of 25

Epoch 21/99
----------
train Loss: 1.0264 LRAP: 0.6787 NDCG: 0.7825
val Loss: 1.0398 LRAP: 0.6874 NDCG: 0.7892
Validation loss decreased (1.046389 --> 1.039804).  Saving model ...

Epoch 22/99
----------
train Loss: 1.0197 LRAP: 0.6801 NDCG: 0.7824
val Loss: 1.0646 LRAP: 0.6808 NDCG: 0.7810
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 1.0130 LRAP: 0.6854 NDCG: 0.7861
val Loss: 1.0304 LRAP: 0.7034 NDCG: 0.8076
Validation loss decreased (1.039804 --> 1.030355).  Saving model ...

Epoch 24/99
----------
train Loss: 1.0049 LRAP: 0.6866 NDCG: 0.7842
val Loss: 1.0132 LRAP: 0.7242 NDCG: 0.8084
Validation loss decreased (1.030355 --> 1.013185).  Saving model ...

Epoch 25/99
----------
train Loss: 0.9968 LRAP: 0.6904 NDCG: 0.7848
val Loss: 1.1204 LRAP: 0.7462 NDCG: 0.8184
EarlyStopping counter: 1 out of 25

Epoch 26/99
----------
train Loss: 0.9930 LRAP: 0.6860 NDCG: 0.7816
val Loss: 1.0769 LRAP: 0.7371 NDCG: 0.8079
EarlyStopping counter: 2 out of 25

Epoch 27/99
----------
train Loss: 0.9868 LRAP: 0.6953 NDCG: 0.7812
val Loss: 1.3184 LRAP: 0.5318 NDCG: 0.6779
EarlyStopping counter: 3 out of 25

Epoch 28/99
----------
train Loss: 0.9861 LRAP: 0.6901 NDCG: 0.7759
val Loss: 1.0337 LRAP: 0.7596 NDCG: 0.8223
EarlyStopping counter: 4 out of 25

Epoch 29/99
----------
train Loss: 0.9854 LRAP: 0.6948 NDCG: 0.7790
val Loss: 1.0208 LRAP: 0.6617 NDCG: 0.7619
EarlyStopping counter: 5 out of 25

Epoch 30/99
----------
train Loss: 0.9614 LRAP: 0.7025 NDCG: 0.7845
val Loss: 0.9667 LRAP: 0.7548 NDCG: 0.8163
Validation loss decreased (1.013185 --> 0.966687).  Saving model ...

Epoch 31/99
----------
train Loss: 0.9493 LRAP: 0.7042 NDCG: 0.7821
val Loss: 0.9637 LRAP: 0.7476 NDCG: 0.8117
Validation loss decreased (0.966687 --> 0.963723).  Saving model ...

Epoch 32/99
----------
train Loss: 0.9453 LRAP: 0.7110 NDCG: 0.7812
val Loss: 0.9600 LRAP: 0.7482 NDCG: 0.8159
Validation loss decreased (0.963723 --> 0.960037).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9422 LRAP: 0.7146 NDCG: 0.7842
val Loss: 0.9551 LRAP: 0.7591 NDCG: 0.8184
Validation loss decreased (0.960037 --> 0.955121).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9359 LRAP: 0.7130 NDCG: 0.7843
val Loss: 0.9546 LRAP: 0.7536 NDCG: 0.8086
Validation loss decreased (0.955121 --> 0.954578).  Saving model ...

Epoch 35/99
----------
train Loss: 0.9372 LRAP: 0.7174 NDCG: 0.7828
val Loss: 0.9570 LRAP: 0.7611 NDCG: 0.8128
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.9360 LRAP: 0.7158 NDCG: 0.7809
val Loss: 0.9530 LRAP: 0.7579 NDCG: 0.8072
Validation loss decreased (0.954578 --> 0.953034).  Saving model ...

Epoch 37/99
----------
train Loss: 0.9355 LRAP: 0.7202 NDCG: 0.7858
val Loss: 0.9596 LRAP: 0.7562 NDCG: 0.8086
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.9320 LRAP: 0.7198 NDCG: 0.7821
val Loss: 0.9558 LRAP: 0.7593 NDCG: 0.8132
EarlyStopping counter: 2 out of 25

Epoch 39/99
----------
train Loss: 0.9283 LRAP: 0.7176 NDCG: 0.7831
val Loss: 0.9584 LRAP: 0.7491 NDCG: 0.8084
EarlyStopping counter: 3 out of 25

Epoch 40/99
----------
train Loss: 0.9284 LRAP: 0.7179 NDCG: 0.7805
val Loss: 0.9568 LRAP: 0.7539 NDCG: 0.8118
EarlyStopping counter: 4 out of 25

Epoch 41/99
----------
train Loss: 0.9245 LRAP: 0.7248 NDCG: 0.7863
val Loss: 0.9502 LRAP: 0.7596 NDCG: 0.8164
Validation loss decreased (0.953034 --> 0.950202).  Saving model ...

Epoch 42/99
----------
train Loss: 0.9229 LRAP: 0.7245 NDCG: 0.7857
val Loss: 0.9466 LRAP: 0.7571 NDCG: 0.8126
Validation loss decreased (0.950202 --> 0.946629).  Saving model ...

Epoch 43/99
----------
train Loss: 0.9227 LRAP: 0.7222 NDCG: 0.7858
val Loss: 0.9471 LRAP: 0.7531 NDCG: 0.8115
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.9202 LRAP: 0.7209 NDCG: 0.7799
val Loss: 0.9490 LRAP: 0.7568 NDCG: 0.8142
EarlyStopping counter: 2 out of 25

Epoch 45/99
----------
train Loss: 0.9168 LRAP: 0.7305 NDCG: 0.7870
val Loss: 0.9427 LRAP: 0.7619 NDCG: 0.8165
Validation loss decreased (0.946629 --> 0.942672).  Saving model ...

Epoch 46/99
----------
train Loss: 0.9185 LRAP: 0.7279 NDCG: 0.7838
val Loss: 0.9481 LRAP: 0.7502 NDCG: 0.8024
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.9185 LRAP: 0.7310 NDCG: 0.7864
val Loss: 0.9473 LRAP: 0.7596 NDCG: 0.8104
EarlyStopping counter: 2 out of 25

Epoch 48/99
----------
train Loss: 0.9152 LRAP: 0.7296 NDCG: 0.7822
val Loss: 0.9519 LRAP: 0.7485 NDCG: 0.8095
EarlyStopping counter: 3 out of 25

Epoch 49/99
----------
train Loss: 0.9136 LRAP: 0.7264 NDCG: 0.7863
val Loss: 0.9449 LRAP: 0.7616 NDCG: 0.8183
EarlyStopping counter: 4 out of 25

Epoch 50/99
----------
train Loss: 0.9105 LRAP: 0.7334 NDCG: 0.7948
val Loss: 0.9438 LRAP: 0.7633 NDCG: 0.8128
EarlyStopping counter: 5 out of 25

Epoch 51/99
----------
train Loss: 0.9030 LRAP: 0.7332 NDCG: 0.7879
val Loss: 0.9369 LRAP: 0.7659 NDCG: 0.8140
Validation loss decreased (0.942672 --> 0.936857).  Saving model ...

Epoch 52/99
----------
train Loss: 0.9016 LRAP: 0.7376 NDCG: 0.7899
val Loss: 0.9373 LRAP: 0.7668 NDCG: 0.8178
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.9012 LRAP: 0.7321 NDCG: 0.7895
val Loss: 0.9368 LRAP: 0.7691 NDCG: 0.8181
Validation loss decreased (0.936857 --> 0.936775).  Saving model ...

Epoch 54/99
----------
train Loss: 0.8995 LRAP: 0.7328 NDCG: 0.7898
val Loss: 0.9376 LRAP: 0.7645 NDCG: 0.8143
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.8976 LRAP: 0.7354 NDCG: 0.7912
val Loss: 0.9366 LRAP: 0.7696 NDCG: 0.8197
Validation loss decreased (0.936775 --> 0.936617).  Saving model ...

Epoch 56/99
----------
train Loss: 0.8980 LRAP: 0.7353 NDCG: 0.7889
val Loss: 0.9364 LRAP: 0.7713 NDCG: 0.8191
Validation loss decreased (0.936617 --> 0.936436).  Saving model ...

Epoch 57/99
----------
train Loss: 0.8971 LRAP: 0.7364 NDCG: 0.7923
val Loss: 0.9362 LRAP: 0.7673 NDCG: 0.8151
Validation loss decreased (0.936436 --> 0.936153).  Saving model ...

Epoch 58/99
----------
train Loss: 0.8963 LRAP: 0.7346 NDCG: 0.7891
val Loss: 0.9354 LRAP: 0.7705 NDCG: 0.8186
Validation loss decreased (0.936153 --> 0.935428).  Saving model ...

Epoch 59/99
----------
train Loss: 0.8956 LRAP: 0.7380 NDCG: 0.7882
val Loss: 0.9364 LRAP: 0.7728 NDCG: 0.8186
EarlyStopping counter: 1 out of 25

Epoch 60/99
----------
train Loss: 0.8935 LRAP: 0.7350 NDCG: 0.7883
val Loss: 0.9354 LRAP: 0.7765 NDCG: 0.8209
Validation loss decreased (0.935428 --> 0.935421).  Saving model ...

Epoch 61/99
----------
train Loss: 0.8941 LRAP: 0.7370 NDCG: 0.7883
val Loss: 0.9341 LRAP: 0.7671 NDCG: 0.8146
Validation loss decreased (0.935421 --> 0.934135).  Saving model ...

Epoch 62/99
----------
train Loss: 0.8967 LRAP: 0.7384 NDCG: 0.7879
val Loss: 0.9344 LRAP: 0.7708 NDCG: 0.8132
EarlyStopping counter: 1 out of 25

Epoch 63/99
----------
train Loss: 0.8937 LRAP: 0.7388 NDCG: 0.7885
val Loss: 0.9351 LRAP: 0.7728 NDCG: 0.8185
EarlyStopping counter: 2 out of 25

Epoch 64/99
----------
train Loss: 0.8936 LRAP: 0.7416 NDCG: 0.7923
val Loss: 0.9336 LRAP: 0.7711 NDCG: 0.8173
Validation loss decreased (0.934135 --> 0.933577).  Saving model ...

Epoch 65/99
----------
train Loss: 0.8910 LRAP: 0.7366 NDCG: 0.7878
val Loss: 0.9338 LRAP: 0.7711 NDCG: 0.8170
EarlyStopping counter: 1 out of 25

Epoch 66/99
----------
train Loss: 0.8934 LRAP: 0.7362 NDCG: 0.7883
val Loss: 0.9338 LRAP: 0.7702 NDCG: 0.8168
EarlyStopping counter: 2 out of 25

Epoch 67/99
----------
train Loss: 0.8939 LRAP: 0.7379 NDCG: 0.7854
val Loss: 0.9324 LRAP: 0.7705 NDCG: 0.8197
Validation loss decreased (0.933577 --> 0.932419).  Saving model ...

Epoch 68/99
----------
train Loss: 0.8941 LRAP: 0.7404 NDCG: 0.7923
val Loss: 0.9348 LRAP: 0.7725 NDCG: 0.8208
EarlyStopping counter: 1 out of 25

Epoch 69/99
----------
train Loss: 0.8915 LRAP: 0.7424 NDCG: 0.7936
val Loss: 0.9327 LRAP: 0.7699 NDCG: 0.8154
EarlyStopping counter: 2 out of 25

Epoch 70/99
----------
train Loss: 0.8921 LRAP: 0.7400 NDCG: 0.7910
val Loss: 0.9359 LRAP: 0.7676 NDCG: 0.8173
EarlyStopping counter: 3 out of 25

Epoch 71/99
----------
train Loss: 0.8931 LRAP: 0.7403 NDCG: 0.7914
val Loss: 0.9364 LRAP: 0.7708 NDCG: 0.8206
EarlyStopping counter: 4 out of 25

Epoch 72/99
----------
train Loss: 0.8896 LRAP: 0.7432 NDCG: 0.7911
val Loss: 0.9335 LRAP: 0.7699 NDCG: 0.8148
EarlyStopping counter: 5 out of 25

Epoch 73/99
----------
train Loss: 0.8894 LRAP: 0.7407 NDCG: 0.7907
val Loss: 0.9342 LRAP: 0.7696 NDCG: 0.8157
EarlyStopping counter: 6 out of 25

Epoch 74/99
----------
train Loss: 0.8869 LRAP: 0.7373 NDCG: 0.7877
val Loss: 0.9332 LRAP: 0.7733 NDCG: 0.8183
EarlyStopping counter: 7 out of 25

Epoch 75/99
----------
train Loss: 0.8889 LRAP: 0.7394 NDCG: 0.7868
val Loss: 0.9341 LRAP: 0.7696 NDCG: 0.8158
EarlyStopping counter: 8 out of 25

Epoch 76/99
----------
train Loss: 0.8870 LRAP: 0.7383 NDCG: 0.7890
val Loss: 0.9328 LRAP: 0.7713 NDCG: 0.8177
EarlyStopping counter: 9 out of 25

Epoch 77/99
----------
train Loss: 0.8874 LRAP: 0.7430 NDCG: 0.7923
val Loss: 0.9320 LRAP: 0.7713 NDCG: 0.8183
Validation loss decreased (0.932419 --> 0.932033).  Saving model ...

Epoch 78/99
----------
train Loss: 0.8899 LRAP: 0.7405 NDCG: 0.7874
val Loss: 0.9331 LRAP: 0.7685 NDCG: 0.8146
EarlyStopping counter: 1 out of 25

Epoch 79/99
----------
train Loss: 0.8878 LRAP: 0.7390 NDCG: 0.7891
val Loss: 0.9323 LRAP: 0.7731 NDCG: 0.8162
EarlyStopping counter: 2 out of 25

Epoch 80/99
----------
train Loss: 0.8896 LRAP: 0.7424 NDCG: 0.7895
val Loss: 0.9320 LRAP: 0.7688 NDCG: 0.8150
Validation loss decreased (0.932033 --> 0.931969).  Saving model ...

Epoch 81/99
----------
train Loss: 0.8860 LRAP: 0.7425 NDCG: 0.7923
val Loss: 0.9346 LRAP: 0.7773 NDCG: 0.8230
EarlyStopping counter: 1 out of 25

Epoch 82/99
----------
train Loss: 0.8876 LRAP: 0.7411 NDCG: 0.7915
val Loss: 0.9331 LRAP: 0.7725 NDCG: 0.8198
EarlyStopping counter: 2 out of 25

Epoch 83/99
----------
train Loss: 0.8894 LRAP: 0.7409 NDCG: 0.7912
val Loss: 0.9333 LRAP: 0.7713 NDCG: 0.8162
EarlyStopping counter: 3 out of 25

Epoch 84/99
----------
train Loss: 0.8882 LRAP: 0.7413 NDCG: 0.7905
val Loss: 0.9326 LRAP: 0.7713 NDCG: 0.8179
EarlyStopping counter: 4 out of 25

Epoch 85/99
----------
train Loss: 0.8865 LRAP: 0.7421 NDCG: 0.7917
val Loss: 0.9332 LRAP: 0.7699 NDCG: 0.8192
EarlyStopping counter: 5 out of 25

Epoch 86/99
----------
train Loss: 0.8891 LRAP: 0.7415 NDCG: 0.7918
val Loss: 0.9328 LRAP: 0.7731 NDCG: 0.8174
EarlyStopping counter: 6 out of 25

Epoch 87/99
----------
train Loss: 0.8887 LRAP: 0.7385 NDCG: 0.7907
val Loss: 0.9318 LRAP: 0.7702 NDCG: 0.8158
Validation loss decreased (0.931969 --> 0.931775).  Saving model ...

Epoch 88/99
----------
train Loss: 0.8862 LRAP: 0.7433 NDCG: 0.7923
val Loss: 0.9322 LRAP: 0.7702 NDCG: 0.8163
EarlyStopping counter: 1 out of 25

Epoch 89/99
----------
train Loss: 0.8870 LRAP: 0.7428 NDCG: 0.7914
val Loss: 0.9329 LRAP: 0.7728 NDCG: 0.8202
EarlyStopping counter: 2 out of 25

Epoch 90/99
----------
train Loss: 0.8858 LRAP: 0.7446 NDCG: 0.7927
val Loss: 0.9328 LRAP: 0.7711 NDCG: 0.8180
EarlyStopping counter: 3 out of 25

Epoch 91/99
----------
train Loss: 0.8859 LRAP: 0.7402 NDCG: 0.7888
val Loss: 0.9327 LRAP: 0.7716 NDCG: 0.8191
EarlyStopping counter: 4 out of 25

Epoch 92/99
----------
train Loss: 0.8873 LRAP: 0.7436 NDCG: 0.7915
val Loss: 0.9336 LRAP: 0.7693 NDCG: 0.8153
EarlyStopping counter: 5 out of 25

Epoch 93/99
----------
train Loss: 0.8881 LRAP: 0.7416 NDCG: 0.7921
val Loss: 0.9318 LRAP: 0.7713 NDCG: 0.8176
EarlyStopping counter: 6 out of 25

Epoch 94/99
----------
train Loss: 0.8880 LRAP: 0.7414 NDCG: 0.7915
val Loss: 0.9337 LRAP: 0.7679 NDCG: 0.8151
EarlyStopping counter: 7 out of 25

Epoch 95/99
----------
train Loss: 0.8890 LRAP: 0.7420 NDCG: 0.7922
val Loss: 0.9328 LRAP: 0.7748 NDCG: 0.8206
EarlyStopping counter: 8 out of 25

Epoch 96/99
----------
train Loss: 0.8905 LRAP: 0.7436 NDCG: 0.7903
val Loss: 0.9331 LRAP: 0.7753 NDCG: 0.8207
EarlyStopping counter: 9 out of 25

Epoch 97/99
----------
train Loss: 0.8872 LRAP: 0.7410 NDCG: 0.7919
val Loss: 0.9327 LRAP: 0.7676 NDCG: 0.8150
EarlyStopping counter: 10 out of 25

Epoch 98/99
----------
train Loss: 0.8890 LRAP: 0.7398 NDCG: 0.7904
val Loss: 0.9330 LRAP: 0.7750 NDCG: 0.8234
EarlyStopping counter: 11 out of 25

Epoch 99/99
----------
train Loss: 0.8857 LRAP: 0.7427 NDCG: 0.7934
val Loss: 0.9321 LRAP: 0.7725 NDCG: 0.8188
EarlyStopping counter: 12 out of 25

Training complete in 11m 6s
Best val loss: 0.931775, best LRAP score: 0.9548

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 7/10

All random seeds set to: 426
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7384 LRAP: 0.2017 NDCG: 0.5766
val Loss: 1.2769 LRAP: 0.5478 NDCG: 0.6873
Validation loss decreased (0.000000 --> 1.276899).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2138 LRAP: 0.6124 NDCG: 0.7188
val Loss: 1.1189 LRAP: 0.6457 NDCG: 0.7323
Validation loss decreased (1.276899 --> 1.118910).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1176 LRAP: 0.6682 NDCG: 0.7512
val Loss: 1.0874 LRAP: 0.6389 NDCG: 0.7415
Validation loss decreased (1.118910 --> 1.087361).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0681 LRAP: 0.6820 NDCG: 0.7638
val Loss: 1.0569 LRAP: 0.6843 NDCG: 0.7588
Validation loss decreased (1.087361 --> 1.056884).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0410 LRAP: 0.6963 NDCG: 0.7787
val Loss: 1.0363 LRAP: 0.7068 NDCG: 0.7849
Validation loss decreased (1.056884 --> 1.036326).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0183 LRAP: 0.6968 NDCG: 0.7878
val Loss: 1.0006 LRAP: 0.7182 NDCG: 0.8063
Validation loss decreased (1.036326 --> 1.000639).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9866 LRAP: 0.6983 NDCG: 0.7936
val Loss: 0.9977 LRAP: 0.7282 NDCG: 0.8110
Validation loss decreased (1.000639 --> 0.997734).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9715 LRAP: 0.6923 NDCG: 0.7999
val Loss: 1.0083 LRAP: 0.6977 NDCG: 0.7992
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 0.9530 LRAP: 0.6995 NDCG: 0.8051
val Loss: 0.9871 LRAP: 0.7137 NDCG: 0.8114
Validation loss decreased (0.997734 --> 0.987068).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9359 LRAP: 0.7028 NDCG: 0.8099
val Loss: 0.9621 LRAP: 0.7014 NDCG: 0.8144
Validation loss decreased (0.987068 --> 0.962079).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9211 LRAP: 0.7186 NDCG: 0.8210
val Loss: 0.9452 LRAP: 0.7528 NDCG: 0.8374
Validation loss decreased (0.962079 --> 0.945248).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9087 LRAP: 0.7228 NDCG: 0.8252
val Loss: 0.9478 LRAP: 0.7197 NDCG: 0.8259
EarlyStopping counter: 1 out of 25

Epoch 12/99
----------
train Loss: 0.8916 LRAP: 0.7398 NDCG: 0.8347
val Loss: 0.9499 LRAP: 0.7616 NDCG: 0.8398
EarlyStopping counter: 2 out of 25

Epoch 13/99
----------
train Loss: 0.8877 LRAP: 0.7308 NDCG: 0.8321
val Loss: 0.9278 LRAP: 0.7628 NDCG: 0.8423
Validation loss decreased (0.945248 --> 0.927770).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8796 LRAP: 0.7426 NDCG: 0.8369
val Loss: 0.9368 LRAP: 0.7605 NDCG: 0.8475
EarlyStopping counter: 1 out of 25

Epoch 15/99
----------
train Loss: 0.8703 LRAP: 0.7321 NDCG: 0.8349
val Loss: 0.9299 LRAP: 0.7673 NDCG: 0.8478
EarlyStopping counter: 2 out of 25

Epoch 16/99
----------
train Loss: 0.8645 LRAP: 0.7514 NDCG: 0.8405
val Loss: 0.9149 LRAP: 0.7830 NDCG: 0.8556
Validation loss decreased (0.927770 --> 0.914898).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8588 LRAP: 0.7528 NDCG: 0.8402
val Loss: 0.9348 LRAP: 0.7925 NDCG: 0.8582
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.8542 LRAP: 0.7486 NDCG: 0.8334
val Loss: 0.9265 LRAP: 0.7856 NDCG: 0.8449
EarlyStopping counter: 2 out of 25

Epoch 19/99
----------
train Loss: 0.8464 LRAP: 0.7520 NDCG: 0.8274
val Loss: 0.9215 LRAP: 0.7913 NDCG: 0.8563
EarlyStopping counter: 3 out of 25

Epoch 20/99
----------
train Loss: 0.8384 LRAP: 0.7627 NDCG: 0.8353
val Loss: 0.9245 LRAP: 0.7839 NDCG: 0.8516
EarlyStopping counter: 4 out of 25

Epoch 21/99
----------
train Loss: 0.8304 LRAP: 0.7646 NDCG: 0.8387
val Loss: 0.9176 LRAP: 0.7885 NDCG: 0.8565
EarlyStopping counter: 5 out of 25

Epoch 22/99
----------
train Loss: 0.8120 LRAP: 0.7739 NDCG: 0.8424
val Loss: 0.8967 LRAP: 0.7893 NDCG: 0.8536
Validation loss decreased (0.914898 --> 0.896745).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8027 LRAP: 0.7797 NDCG: 0.8402
val Loss: 0.8977 LRAP: 0.8122 NDCG: 0.8619
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8014 LRAP: 0.7794 NDCG: 0.8355
val Loss: 0.8963 LRAP: 0.7930 NDCG: 0.8520
Validation loss decreased (0.896745 --> 0.896260).  Saving model ...

Epoch 25/99
----------
train Loss: 0.7989 LRAP: 0.7855 NDCG: 0.8423
val Loss: 0.8966 LRAP: 0.8002 NDCG: 0.8552
EarlyStopping counter: 1 out of 25

Epoch 26/99
----------
train Loss: 0.7944 LRAP: 0.7849 NDCG: 0.8360
val Loss: 0.8953 LRAP: 0.8056 NDCG: 0.8598
Validation loss decreased (0.896260 --> 0.895286).  Saving model ...

Epoch 27/99
----------
train Loss: 0.7945 LRAP: 0.7830 NDCG: 0.8421
val Loss: 0.9001 LRAP: 0.8167 NDCG: 0.8594
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.7884 LRAP: 0.7858 NDCG: 0.8341
val Loss: 0.8989 LRAP: 0.8110 NDCG: 0.8545
EarlyStopping counter: 2 out of 25

Epoch 29/99
----------
train Loss: 0.7867 LRAP: 0.7914 NDCG: 0.8355
val Loss: 0.9007 LRAP: 0.8179 NDCG: 0.8591
EarlyStopping counter: 3 out of 25

Epoch 30/99
----------
train Loss: 0.7840 LRAP: 0.7918 NDCG: 0.8318
val Loss: 0.9003 LRAP: 0.8264 NDCG: 0.8567
EarlyStopping counter: 4 out of 25

Epoch 31/99
----------
train Loss: 0.7798 LRAP: 0.7951 NDCG: 0.8361
val Loss: 0.8938 LRAP: 0.8253 NDCG: 0.8632
Validation loss decreased (0.895286 --> 0.893765).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7824 LRAP: 0.7884 NDCG: 0.8329
val Loss: 0.8941 LRAP: 0.8096 NDCG: 0.8556
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.7776 LRAP: 0.7985 NDCG: 0.8335
val Loss: 0.8900 LRAP: 0.8159 NDCG: 0.8566
Validation loss decreased (0.893765 --> 0.889964).  Saving model ...

Epoch 34/99
----------
train Loss: 0.7763 LRAP: 0.7994 NDCG: 0.8379
val Loss: 0.8944 LRAP: 0.8316 NDCG: 0.8631
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.7743 LRAP: 0.7997 NDCG: 0.8290
val Loss: 0.8932 LRAP: 0.8230 NDCG: 0.8583
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.7717 LRAP: 0.8039 NDCG: 0.8396
val Loss: 0.8926 LRAP: 0.8310 NDCG: 0.8638
EarlyStopping counter: 3 out of 25

Epoch 37/99
----------
train Loss: 0.7699 LRAP: 0.8054 NDCG: 0.8363
val Loss: 0.8999 LRAP: 0.8307 NDCG: 0.8593
EarlyStopping counter: 4 out of 25

Epoch 38/99
----------
train Loss: 0.7676 LRAP: 0.8033 NDCG: 0.8375
val Loss: 0.8914 LRAP: 0.8287 NDCG: 0.8593
EarlyStopping counter: 5 out of 25

Epoch 39/99
----------
train Loss: 0.7588 LRAP: 0.8058 NDCG: 0.8376
val Loss: 0.8887 LRAP: 0.8321 NDCG: 0.8645
Validation loss decreased (0.889964 --> 0.888664).  Saving model ...

Epoch 40/99
----------
train Loss: 0.7580 LRAP: 0.8098 NDCG: 0.8423
val Loss: 0.8902 LRAP: 0.8299 NDCG: 0.8595
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.7567 LRAP: 0.8070 NDCG: 0.8362
val Loss: 0.8921 LRAP: 0.8304 NDCG: 0.8596
EarlyStopping counter: 2 out of 25

Epoch 42/99
----------
train Loss: 0.7581 LRAP: 0.8102 NDCG: 0.8376
val Loss: 0.8900 LRAP: 0.8290 NDCG: 0.8577
EarlyStopping counter: 3 out of 25

Epoch 43/99
----------
train Loss: 0.7558 LRAP: 0.8049 NDCG: 0.8337
val Loss: 0.8901 LRAP: 0.8341 NDCG: 0.8621
EarlyStopping counter: 4 out of 25

Epoch 44/99
----------
train Loss: 0.7549 LRAP: 0.8107 NDCG: 0.8399
val Loss: 0.8890 LRAP: 0.8327 NDCG: 0.8595
EarlyStopping counter: 5 out of 25

Epoch 45/99
----------
train Loss: 0.7540 LRAP: 0.8153 NDCG: 0.8396
val Loss: 0.8886 LRAP: 0.8367 NDCG: 0.8628
Validation loss decreased (0.888664 --> 0.888634).  Saving model ...

Epoch 46/99
----------
train Loss: 0.7543 LRAP: 0.8140 NDCG: 0.8395
val Loss: 0.8875 LRAP: 0.8367 NDCG: 0.8656
Validation loss decreased (0.888634 --> 0.887541).  Saving model ...

Epoch 47/99
----------
train Loss: 0.7528 LRAP: 0.8117 NDCG: 0.8412
val Loss: 0.8907 LRAP: 0.8330 NDCG: 0.8597
EarlyStopping counter: 1 out of 25

Epoch 48/99
----------
train Loss: 0.7530 LRAP: 0.8152 NDCG: 0.8397
val Loss: 0.8869 LRAP: 0.8341 NDCG: 0.8633
Validation loss decreased (0.887541 --> 0.886894).  Saving model ...

Epoch 49/99
----------
train Loss: 0.7541 LRAP: 0.8120 NDCG: 0.8389
val Loss: 0.8903 LRAP: 0.8353 NDCG: 0.8632
EarlyStopping counter: 1 out of 25

Epoch 50/99
----------
train Loss: 0.7530 LRAP: 0.8114 NDCG: 0.8354
val Loss: 0.8895 LRAP: 0.8284 NDCG: 0.8575
EarlyStopping counter: 2 out of 25

Epoch 51/99
----------
train Loss: 0.7525 LRAP: 0.8129 NDCG: 0.8364
val Loss: 0.8868 LRAP: 0.8336 NDCG: 0.8640
Validation loss decreased (0.886894 --> 0.886804).  Saving model ...

Epoch 52/99
----------
train Loss: 0.7530 LRAP: 0.8095 NDCG: 0.8350
val Loss: 0.8891 LRAP: 0.8327 NDCG: 0.8608
EarlyStopping counter: 1 out of 25

Epoch 53/99
----------
train Loss: 0.7519 LRAP: 0.8144 NDCG: 0.8362
val Loss: 0.8890 LRAP: 0.8336 NDCG: 0.8631
EarlyStopping counter: 2 out of 25

Epoch 54/99
----------
train Loss: 0.7536 LRAP: 0.8121 NDCG: 0.8362
val Loss: 0.8890 LRAP: 0.8350 NDCG: 0.8622
EarlyStopping counter: 3 out of 25

Epoch 55/99
----------
train Loss: 0.7529 LRAP: 0.8146 NDCG: 0.8394
val Loss: 0.8896 LRAP: 0.8350 NDCG: 0.8616
EarlyStopping counter: 4 out of 25

Epoch 56/99
----------
train Loss: 0.7530 LRAP: 0.8093 NDCG: 0.8367
val Loss: 0.8869 LRAP: 0.8324 NDCG: 0.8612
EarlyStopping counter: 5 out of 25

Epoch 57/99
----------
train Loss: 0.7514 LRAP: 0.8134 NDCG: 0.8387
val Loss: 0.8876 LRAP: 0.8344 NDCG: 0.8631
EarlyStopping counter: 6 out of 25

Epoch 58/99
----------
train Loss: 0.7526 LRAP: 0.8165 NDCG: 0.8378
val Loss: 0.8898 LRAP: 0.8333 NDCG: 0.8595
EarlyStopping counter: 7 out of 25

Epoch 59/99
----------
train Loss: 0.7537 LRAP: 0.8108 NDCG: 0.8373
val Loss: 0.8904 LRAP: 0.8299 NDCG: 0.8588
EarlyStopping counter: 8 out of 25

Epoch 60/99
----------
train Loss: 0.7518 LRAP: 0.8111 NDCG: 0.8362
val Loss: 0.8896 LRAP: 0.8336 NDCG: 0.8605
EarlyStopping counter: 9 out of 25

Epoch 61/99
----------
train Loss: 0.7503 LRAP: 0.8172 NDCG: 0.8379
val Loss: 0.8888 LRAP: 0.8316 NDCG: 0.8608
EarlyStopping counter: 10 out of 25

Epoch 62/99
----------
train Loss: 0.7509 LRAP: 0.8138 NDCG: 0.8415
val Loss: 0.8908 LRAP: 0.8336 NDCG: 0.8600
EarlyStopping counter: 11 out of 25

Epoch 63/99
----------
train Loss: 0.7521 LRAP: 0.8106 NDCG: 0.8410
val Loss: 0.8901 LRAP: 0.8344 NDCG: 0.8607
EarlyStopping counter: 12 out of 25

Epoch 64/99
----------
train Loss: 0.7521 LRAP: 0.8134 NDCG: 0.8360
val Loss: 0.8905 LRAP: 0.8330 NDCG: 0.8600
EarlyStopping counter: 13 out of 25

Epoch 65/99
----------
train Loss: 0.7519 LRAP: 0.8129 NDCG: 0.8386
val Loss: 0.8887 LRAP: 0.8341 NDCG: 0.8627
EarlyStopping counter: 14 out of 25

Epoch 66/99
----------
train Loss: 0.7522 LRAP: 0.8158 NDCG: 0.8351
val Loss: 0.8881 LRAP: 0.8324 NDCG: 0.8614
EarlyStopping counter: 15 out of 25

Epoch 67/99
----------
train Loss: 0.7495 LRAP: 0.8142 NDCG: 0.8394
val Loss: 0.8863 LRAP: 0.8344 NDCG: 0.8656
Validation loss decreased (0.886804 --> 0.886274).  Saving model ...

Epoch 68/99
----------
train Loss: 0.7512 LRAP: 0.8143 NDCG: 0.8374
val Loss: 0.8880 LRAP: 0.8316 NDCG: 0.8625
EarlyStopping counter: 1 out of 25

Epoch 69/99
----------
train Loss: 0.7521 LRAP: 0.8104 NDCG: 0.8332
val Loss: 0.8903 LRAP: 0.8333 NDCG: 0.8599
EarlyStopping counter: 2 out of 25

Epoch 70/99
----------
train Loss: 0.7500 LRAP: 0.8136 NDCG: 0.8353
val Loss: 0.8895 LRAP: 0.8333 NDCG: 0.8617
EarlyStopping counter: 3 out of 25

Epoch 71/99
----------
train Loss: 0.7504 LRAP: 0.8159 NDCG: 0.8404
val Loss: 0.8870 LRAP: 0.8353 NDCG: 0.8665
EarlyStopping counter: 4 out of 25

Epoch 72/99
----------
train Loss: 0.7527 LRAP: 0.8095 NDCG: 0.8329
val Loss: 0.8871 LRAP: 0.8313 NDCG: 0.8621
EarlyStopping counter: 5 out of 25

Epoch 73/99
----------
train Loss: 0.7500 LRAP: 0.8173 NDCG: 0.8415
val Loss: 0.8880 LRAP: 0.8324 NDCG: 0.8602
EarlyStopping counter: 6 out of 25

Epoch 74/99
----------
train Loss: 0.7514 LRAP: 0.8153 NDCG: 0.8390
val Loss: 0.8877 LRAP: 0.8336 NDCG: 0.8620
EarlyStopping counter: 7 out of 25

Epoch 75/99
----------
train Loss: 0.7526 LRAP: 0.8144 NDCG: 0.8406
val Loss: 0.8897 LRAP: 0.8276 NDCG: 0.8571
EarlyStopping counter: 8 out of 25

Epoch 76/99
----------
train Loss: 0.7515 LRAP: 0.8137 NDCG: 0.8345
val Loss: 0.8885 LRAP: 0.8341 NDCG: 0.8616
EarlyStopping counter: 9 out of 25

Epoch 77/99
----------
train Loss: 0.7541 LRAP: 0.8145 NDCG: 0.8389
val Loss: 0.8898 LRAP: 0.8313 NDCG: 0.8591
EarlyStopping counter: 10 out of 25

Epoch 78/99
----------
train Loss: 0.7510 LRAP: 0.8136 NDCG: 0.8397
val Loss: 0.8918 LRAP: 0.8330 NDCG: 0.8597
EarlyStopping counter: 11 out of 25

Epoch 79/99
----------
train Loss: 0.7497 LRAP: 0.8179 NDCG: 0.8399
val Loss: 0.8888 LRAP: 0.8330 NDCG: 0.8605
EarlyStopping counter: 12 out of 25

Epoch 80/99
----------
train Loss: 0.7513 LRAP: 0.8125 NDCG: 0.8356
val Loss: 0.8900 LRAP: 0.8361 NDCG: 0.8633
EarlyStopping counter: 13 out of 25

Epoch 81/99
----------
train Loss: 0.7520 LRAP: 0.8135 NDCG: 0.8412
val Loss: 0.8877 LRAP: 0.8304 NDCG: 0.8615
EarlyStopping counter: 14 out of 25

Epoch 82/99
----------
train Loss: 0.7510 LRAP: 0.8138 NDCG: 0.8363
val Loss: 0.8897 LRAP: 0.8324 NDCG: 0.8595
EarlyStopping counter: 15 out of 25

Epoch 83/99
----------
train Loss: 0.7505 LRAP: 0.8161 NDCG: 0.8387
val Loss: 0.8882 LRAP: 0.8321 NDCG: 0.8595
EarlyStopping counter: 16 out of 25

Epoch 84/99
----------
train Loss: 0.7510 LRAP: 0.8153 NDCG: 0.8374
val Loss: 0.8888 LRAP: 0.8327 NDCG: 0.8604
EarlyStopping counter: 17 out of 25

Epoch 85/99
----------
train Loss: 0.7511 LRAP: 0.8128 NDCG: 0.8345
val Loss: 0.8875 LRAP: 0.8359 NDCG: 0.8644
EarlyStopping counter: 18 out of 25

Epoch 86/99
----------
train Loss: 0.7504 LRAP: 0.8161 NDCG: 0.8408
val Loss: 0.8899 LRAP: 0.8344 NDCG: 0.8617
EarlyStopping counter: 19 out of 25

Epoch 87/99
----------
train Loss: 0.7505 LRAP: 0.8137 NDCG: 0.8388
val Loss: 0.8889 LRAP: 0.8293 NDCG: 0.8586
EarlyStopping counter: 20 out of 25

Epoch 88/99
----------
train Loss: 0.7510 LRAP: 0.8115 NDCG: 0.8401
val Loss: 0.8891 LRAP: 0.8341 NDCG: 0.8640
EarlyStopping counter: 21 out of 25

Epoch 89/99
----------
train Loss: 0.7500 LRAP: 0.8166 NDCG: 0.8412
val Loss: 0.8921 LRAP: 0.8347 NDCG: 0.8607
EarlyStopping counter: 22 out of 25

Epoch 90/99
----------
train Loss: 0.7506 LRAP: 0.8148 NDCG: 0.8367
val Loss: 0.8910 LRAP: 0.8367 NDCG: 0.8622
EarlyStopping counter: 23 out of 25

Epoch 91/99
----------
train Loss: 0.7520 LRAP: 0.8103 NDCG: 0.8374
val Loss: 0.8884 LRAP: 0.8339 NDCG: 0.8635
EarlyStopping counter: 24 out of 25

Epoch 92/99
----------
train Loss: 0.7527 LRAP: 0.8101 NDCG: 0.8349
val Loss: 0.8901 LRAP: 0.8330 NDCG: 0.8614
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 12m 45s
Best val loss: 0.886274, best LRAP score: 0.9614

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7602 LRAP: 0.1751 NDCG: 0.5670
val Loss: 1.4190 LRAP: 0.3785 NDCG: 0.6328
Validation loss decreased (0.000000 --> 1.418955).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2517 LRAP: 0.5609 NDCG: 0.7114
val Loss: 1.1701 LRAP: 0.6520 NDCG: 0.7577
Validation loss decreased (1.418955 --> 1.170134).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1464 LRAP: 0.6296 NDCG: 0.7475
val Loss: 1.0804 LRAP: 0.6554 NDCG: 0.7506
Validation loss decreased (1.170134 --> 1.080367).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0973 LRAP: 0.6530 NDCG: 0.7646
val Loss: 1.0759 LRAP: 0.6780 NDCG: 0.7791
Validation loss decreased (1.080367 --> 1.075904).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0543 LRAP: 0.6743 NDCG: 0.7818
val Loss: 1.0328 LRAP: 0.6857 NDCG: 0.7814
Validation loss decreased (1.075904 --> 1.032753).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0266 LRAP: 0.6758 NDCG: 0.7877
val Loss: 1.0311 LRAP: 0.7274 NDCG: 0.8121
Validation loss decreased (1.032753 --> 1.031075).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9912 LRAP: 0.6910 NDCG: 0.8013
val Loss: 0.9803 LRAP: 0.7023 NDCG: 0.8094
Validation loss decreased (1.031075 --> 0.980328).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9686 LRAP: 0.6997 NDCG: 0.8093
val Loss: 0.9906 LRAP: 0.7228 NDCG: 0.8167
EarlyStopping counter: 1 out of 25

Epoch 8/99
----------
train Loss: 0.9486 LRAP: 0.7060 NDCG: 0.8151
val Loss: 0.9860 LRAP: 0.7382 NDCG: 0.8282
EarlyStopping counter: 2 out of 25

Epoch 9/99
----------
train Loss: 0.9289 LRAP: 0.7157 NDCG: 0.8217
val Loss: 0.9601 LRAP: 0.7505 NDCG: 0.8403
Validation loss decreased (0.980328 --> 0.960076).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9230 LRAP: 0.7343 NDCG: 0.8296
val Loss: 0.9496 LRAP: 0.7514 NDCG: 0.8393
Validation loss decreased (0.960076 --> 0.949616).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9088 LRAP: 0.7374 NDCG: 0.8330
val Loss: 0.9437 LRAP: 0.7711 NDCG: 0.8508
Validation loss decreased (0.949616 --> 0.943722).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8990 LRAP: 0.7361 NDCG: 0.8346
val Loss: 0.9397 LRAP: 0.7442 NDCG: 0.8365
Validation loss decreased (0.943722 --> 0.939710).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8852 LRAP: 0.7378 NDCG: 0.8370
val Loss: 0.9448 LRAP: 0.7565 NDCG: 0.8376
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.8793 LRAP: 0.7436 NDCG: 0.8364
val Loss: 0.9302 LRAP: 0.7579 NDCG: 0.8451
Validation loss decreased (0.939710 --> 0.930209).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8745 LRAP: 0.7384 NDCG: 0.8346
val Loss: 0.9403 LRAP: 0.7593 NDCG: 0.8420
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8654 LRAP: 0.7515 NDCG: 0.8340
val Loss: 0.9247 LRAP: 0.7688 NDCG: 0.8492
Validation loss decreased (0.930209 --> 0.924658).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8549 LRAP: 0.7526 NDCG: 0.8360
val Loss: 0.9281 LRAP: 0.7916 NDCG: 0.8516
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.8468 LRAP: 0.7603 NDCG: 0.8296
val Loss: 0.9109 LRAP: 0.7962 NDCG: 0.8494
Validation loss decreased (0.924658 --> 0.910882).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8398 LRAP: 0.7645 NDCG: 0.8288
val Loss: 0.9186 LRAP: 0.8067 NDCG: 0.8546
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8404 LRAP: 0.7639 NDCG: 0.8280
val Loss: 0.9265 LRAP: 0.7922 NDCG: 0.8545
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 0.8257 LRAP: 0.7684 NDCG: 0.8216
val Loss: 0.9239 LRAP: 0.7651 NDCG: 0.8032
EarlyStopping counter: 3 out of 25

Epoch 22/99
----------
train Loss: 0.8263 LRAP: 0.7727 NDCG: 0.8254
val Loss: 0.9166 LRAP: 0.8184 NDCG: 0.8630
EarlyStopping counter: 4 out of 25

Epoch 23/99
----------
train Loss: 0.8195 LRAP: 0.7759 NDCG: 0.8242
val Loss: 0.9137 LRAP: 0.8079 NDCG: 0.8421
EarlyStopping counter: 5 out of 25

Epoch 24/99
----------
train Loss: 0.7974 LRAP: 0.7839 NDCG: 0.8194
val Loss: 0.8950 LRAP: 0.8159 NDCG: 0.8435
Validation loss decreased (0.910882 --> 0.895050).  Saving model ...

Epoch 25/99
----------
train Loss: 0.7892 LRAP: 0.7970 NDCG: 0.8226
val Loss: 0.8931 LRAP: 0.8159 NDCG: 0.8383
Validation loss decreased (0.895050 --> 0.893137).  Saving model ...

Epoch 26/99
----------
train Loss: 0.7832 LRAP: 0.7956 NDCG: 0.8192
val Loss: 0.8910 LRAP: 0.8227 NDCG: 0.8409
Validation loss decreased (0.893137 --> 0.891026).  Saving model ...

Epoch 27/99
----------
train Loss: 0.7812 LRAP: 0.7992 NDCG: 0.8201
val Loss: 0.8898 LRAP: 0.8270 NDCG: 0.8578
Validation loss decreased (0.891026 --> 0.889777).  Saving model ...

Epoch 28/99
----------
train Loss: 0.7796 LRAP: 0.8010 NDCG: 0.8268
val Loss: 0.8896 LRAP: 0.8227 NDCG: 0.8526
Validation loss decreased (0.889777 --> 0.889574).  Saving model ...

Epoch 29/99
----------
train Loss: 0.7753 LRAP: 0.8030 NDCG: 0.8216
val Loss: 0.8886 LRAP: 0.8204 NDCG: 0.8487
Validation loss decreased (0.889574 --> 0.888633).  Saving model ...

Epoch 30/99
----------
train Loss: 0.7737 LRAP: 0.8033 NDCG: 0.8225
val Loss: 0.8889 LRAP: 0.8267 NDCG: 0.8498
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.7708 LRAP: 0.8038 NDCG: 0.8188
val Loss: 0.8913 LRAP: 0.8210 NDCG: 0.8500
EarlyStopping counter: 2 out of 25

Epoch 32/99
----------
train Loss: 0.7697 LRAP: 0.8045 NDCG: 0.8233
val Loss: 0.8943 LRAP: 0.8279 NDCG: 0.8569
EarlyStopping counter: 3 out of 25

Epoch 33/99
----------
train Loss: 0.7678 LRAP: 0.8081 NDCG: 0.8252
val Loss: 0.8875 LRAP: 0.8259 NDCG: 0.8554
Validation loss decreased (0.888633 --> 0.887471).  Saving model ...

Epoch 34/99
----------
train Loss: 0.7655 LRAP: 0.8106 NDCG: 0.8279
val Loss: 0.8897 LRAP: 0.8367 NDCG: 0.8634
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.7645 LRAP: 0.8084 NDCG: 0.8279
val Loss: 0.8928 LRAP: 0.8361 NDCG: 0.8567
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.7622 LRAP: 0.8084 NDCG: 0.8233
val Loss: 0.8959 LRAP: 0.8370 NDCG: 0.8579
EarlyStopping counter: 3 out of 25

Epoch 37/99
----------
train Loss: 0.7619 LRAP: 0.8152 NDCG: 0.8326
val Loss: 0.8923 LRAP: 0.8410 NDCG: 0.8587
EarlyStopping counter: 4 out of 25

Epoch 38/99
----------
train Loss: 0.7586 LRAP: 0.8128 NDCG: 0.8295
val Loss: 0.8882 LRAP: 0.8367 NDCG: 0.8543
EarlyStopping counter: 5 out of 25

Epoch 39/99
----------
train Loss: 0.7534 LRAP: 0.8166 NDCG: 0.8243
val Loss: 0.8870 LRAP: 0.8393 NDCG: 0.8590
Validation loss decreased (0.887471 --> 0.886979).  Saving model ...

Epoch 40/99
----------
train Loss: 0.7515 LRAP: 0.8162 NDCG: 0.8217
val Loss: 0.8876 LRAP: 0.8307 NDCG: 0.8480
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.7500 LRAP: 0.8173 NDCG: 0.8278
val Loss: 0.8865 LRAP: 0.8404 NDCG: 0.8587
Validation loss decreased (0.886979 --> 0.886545).  Saving model ...

Epoch 42/99
----------
train Loss: 0.7516 LRAP: 0.8134 NDCG: 0.8201
val Loss: 0.8889 LRAP: 0.8424 NDCG: 0.8593
EarlyStopping counter: 1 out of 25

Epoch 43/99
----------
train Loss: 0.7496 LRAP: 0.8178 NDCG: 0.8238
val Loss: 0.8861 LRAP: 0.8390 NDCG: 0.8562
Validation loss decreased (0.886545 --> 0.886086).  Saving model ...

Epoch 44/99
----------
train Loss: 0.7477 LRAP: 0.8217 NDCG: 0.8284
val Loss: 0.8872 LRAP: 0.8416 NDCG: 0.8588
EarlyStopping counter: 1 out of 25

Epoch 45/99
----------
train Loss: 0.7481 LRAP: 0.8217 NDCG: 0.8264
val Loss: 0.8874 LRAP: 0.8418 NDCG: 0.8597
EarlyStopping counter: 2 out of 25

Epoch 46/99
----------
train Loss: 0.7476 LRAP: 0.8198 NDCG: 0.8250
val Loss: 0.8871 LRAP: 0.8407 NDCG: 0.8554
EarlyStopping counter: 3 out of 25

Epoch 47/99
----------
train Loss: 0.7461 LRAP: 0.8229 NDCG: 0.8285
val Loss: 0.8864 LRAP: 0.8447 NDCG: 0.8577
EarlyStopping counter: 4 out of 25

Epoch 48/99
----------
train Loss: 0.7454 LRAP: 0.8275 NDCG: 0.8315
val Loss: 0.8855 LRAP: 0.8444 NDCG: 0.8633
Validation loss decreased (0.886086 --> 0.885506).  Saving model ...

Epoch 49/99
----------
train Loss: 0.7471 LRAP: 0.8227 NDCG: 0.8282
val Loss: 0.8895 LRAP: 0.8416 NDCG: 0.8551
EarlyStopping counter: 1 out of 25

Epoch 50/99
----------
train Loss: 0.7456 LRAP: 0.8203 NDCG: 0.8278
val Loss: 0.8881 LRAP: 0.8441 NDCG: 0.8590
EarlyStopping counter: 2 out of 25

Epoch 51/99
----------
train Loss: 0.7434 LRAP: 0.8254 NDCG: 0.8308
val Loss: 0.8863 LRAP: 0.8453 NDCG: 0.8605
EarlyStopping counter: 3 out of 25

Epoch 52/99
----------
train Loss: 0.7442 LRAP: 0.8249 NDCG: 0.8309
val Loss: 0.8856 LRAP: 0.8467 NDCG: 0.8636
EarlyStopping counter: 4 out of 25

Epoch 53/99
----------
train Loss: 0.7435 LRAP: 0.8230 NDCG: 0.8274
val Loss: 0.8863 LRAP: 0.8467 NDCG: 0.8595
EarlyStopping counter: 5 out of 25

Epoch 54/99
----------
train Loss: 0.7430 LRAP: 0.8235 NDCG: 0.8268
val Loss: 0.8898 LRAP: 0.8427 NDCG: 0.8559
EarlyStopping counter: 6 out of 25

Epoch 55/99
----------
train Loss: 0.7404 LRAP: 0.8230 NDCG: 0.8279
val Loss: 0.8905 LRAP: 0.8438 NDCG: 0.8551
EarlyStopping counter: 7 out of 25

Epoch 56/99
----------
train Loss: 0.7431 LRAP: 0.8264 NDCG: 0.8310
val Loss: 0.8874 LRAP: 0.8433 NDCG: 0.8588
EarlyStopping counter: 8 out of 25

Epoch 57/99
----------
train Loss: 0.7421 LRAP: 0.8284 NDCG: 0.8356
val Loss: 0.8865 LRAP: 0.8436 NDCG: 0.8583
EarlyStopping counter: 9 out of 25

Epoch 58/99
----------
train Loss: 0.7417 LRAP: 0.8282 NDCG: 0.8330
val Loss: 0.8856 LRAP: 0.8464 NDCG: 0.8620
EarlyStopping counter: 10 out of 25

Epoch 59/99
----------
train Loss: 0.7418 LRAP: 0.8314 NDCG: 0.8353
val Loss: 0.8874 LRAP: 0.8464 NDCG: 0.8604
EarlyStopping counter: 11 out of 25

Epoch 60/99
----------
train Loss: 0.7407 LRAP: 0.8292 NDCG: 0.8335
val Loss: 0.8865 LRAP: 0.8450 NDCG: 0.8608
EarlyStopping counter: 12 out of 25

Epoch 61/99
----------
train Loss: 0.7408 LRAP: 0.8293 NDCG: 0.8363
val Loss: 0.8877 LRAP: 0.8444 NDCG: 0.8572
EarlyStopping counter: 13 out of 25

Epoch 62/99
----------
train Loss: 0.7416 LRAP: 0.8252 NDCG: 0.8278
val Loss: 0.8861 LRAP: 0.8464 NDCG: 0.8594
EarlyStopping counter: 14 out of 25

Epoch 63/99
----------
train Loss: 0.7417 LRAP: 0.8248 NDCG: 0.8313
val Loss: 0.8862 LRAP: 0.8473 NDCG: 0.8632
EarlyStopping counter: 15 out of 25

Epoch 64/99
----------
train Loss: 0.7411 LRAP: 0.8241 NDCG: 0.8305
val Loss: 0.8870 LRAP: 0.8456 NDCG: 0.8609
EarlyStopping counter: 16 out of 25

Epoch 65/99
----------
train Loss: 0.7421 LRAP: 0.8274 NDCG: 0.8305
val Loss: 0.8869 LRAP: 0.8450 NDCG: 0.8589
EarlyStopping counter: 17 out of 25

Epoch 66/99
----------
train Loss: 0.7422 LRAP: 0.8259 NDCG: 0.8337
val Loss: 0.8869 LRAP: 0.8456 NDCG: 0.8585
EarlyStopping counter: 18 out of 25

Epoch 67/99
----------
train Loss: 0.7415 LRAP: 0.8274 NDCG: 0.8289
val Loss: 0.8869 LRAP: 0.8444 NDCG: 0.8600
EarlyStopping counter: 19 out of 25

Epoch 68/99
----------
train Loss: 0.7429 LRAP: 0.8249 NDCG: 0.8283
val Loss: 0.8864 LRAP: 0.8478 NDCG: 0.8639
EarlyStopping counter: 20 out of 25

Epoch 69/99
----------
train Loss: 0.7428 LRAP: 0.8235 NDCG: 0.8252
val Loss: 0.8860 LRAP: 0.8476 NDCG: 0.8621
EarlyStopping counter: 21 out of 25

Epoch 70/99
----------
train Loss: 0.7408 LRAP: 0.8279 NDCG: 0.8319
val Loss: 0.8876 LRAP: 0.8456 NDCG: 0.8610
EarlyStopping counter: 22 out of 25

Epoch 71/99
----------
train Loss: 0.7419 LRAP: 0.8262 NDCG: 0.8309
val Loss: 0.8860 LRAP: 0.8473 NDCG: 0.8593
EarlyStopping counter: 23 out of 25

Epoch 72/99
----------
train Loss: 0.7409 LRAP: 0.8271 NDCG: 0.8330
val Loss: 0.8856 LRAP: 0.8444 NDCG: 0.8602
EarlyStopping counter: 24 out of 25

Epoch 73/99
----------
train Loss: 0.7411 LRAP: 0.8263 NDCG: 0.8303
val Loss: 0.8865 LRAP: 0.8453 NDCG: 0.8598
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 11m 4s
Best val loss: 0.885506, best LRAP score: 0.9633

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.8466 LRAP: 0.1409 NDCG: 0.5560
val Loss: 1.4275 LRAP: 0.5638 NDCG: 0.6676
Validation loss decreased (0.000000 --> 1.427506).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3064 LRAP: 0.6124 NDCG: 0.7017
val Loss: 1.6035 LRAP: 0.4902 NDCG: 0.6631
EarlyStopping counter: 1 out of 25

Epoch 2/99
----------
train Loss: 1.1907 LRAP: 0.6587 NDCG: 0.7180
val Loss: 1.6732 LRAP: 0.2092 NDCG: 0.5849
EarlyStopping counter: 2 out of 25

Epoch 3/99
----------
train Loss: 1.1414 LRAP: 0.6638 NDCG: 0.7302
val Loss: 1.3573 LRAP: 0.4685 NDCG: 0.6548
Validation loss decreased (1.427506 --> 1.357319).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1014 LRAP: 0.6667 NDCG: 0.7416
val Loss: 1.1298 LRAP: 0.6985 NDCG: 0.7515
Validation loss decreased (1.357319 --> 1.129780).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0840 LRAP: 0.6782 NDCG: 0.7484
val Loss: 1.1586 LRAP: 0.7088 NDCG: 0.7750
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.0661 LRAP: 0.6747 NDCG: 0.7548
val Loss: 1.1306 LRAP: 0.6994 NDCG: 0.7572
EarlyStopping counter: 2 out of 25

Epoch 7/99
----------
train Loss: 1.0516 LRAP: 0.6828 NDCG: 0.7632
val Loss: 1.0662 LRAP: 0.6603 NDCG: 0.7485
Validation loss decreased (1.129780 --> 1.066160).  Saving model ...

Epoch 8/99
----------
train Loss: 1.0433 LRAP: 0.6827 NDCG: 0.7628
val Loss: 1.2402 LRAP: 0.4665 NDCG: 0.6912
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 1.0296 LRAP: 0.6868 NDCG: 0.7691
val Loss: 1.2343 LRAP: 0.5284 NDCG: 0.7088
EarlyStopping counter: 2 out of 25

Epoch 10/99
----------
train Loss: 1.0201 LRAP: 0.6912 NDCG: 0.7712
val Loss: 1.0521 LRAP: 0.6940 NDCG: 0.7776
Validation loss decreased (1.066160 --> 1.052125).  Saving model ...

Epoch 11/99
----------
train Loss: 1.0114 LRAP: 0.6971 NDCG: 0.7792
val Loss: 1.0197 LRAP: 0.7114 NDCG: 0.7933
Validation loss decreased (1.052125 --> 1.019699).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9983 LRAP: 0.6883 NDCG: 0.7824
val Loss: 1.0244 LRAP: 0.6900 NDCG: 0.7879
EarlyStopping counter: 1 out of 25

Epoch 13/99
----------
train Loss: 0.9874 LRAP: 0.6840 NDCG: 0.7833
val Loss: 1.0173 LRAP: 0.7265 NDCG: 0.8065
Validation loss decreased (1.019699 --> 1.017294).  Saving model ...

Epoch 14/99
----------
train Loss: 0.9695 LRAP: 0.6913 NDCG: 0.7907
val Loss: 0.9895 LRAP: 0.7274 NDCG: 0.8141
Validation loss decreased (1.017294 --> 0.989480).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9603 LRAP: 0.6937 NDCG: 0.7937
val Loss: 1.0052 LRAP: 0.7471 NDCG: 0.8188
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.9575 LRAP: 0.6930 NDCG: 0.7904
val Loss: 1.0462 LRAP: 0.6514 NDCG: 0.7598
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 0.9406 LRAP: 0.7030 NDCG: 0.7960
val Loss: 0.9621 LRAP: 0.7328 NDCG: 0.8171
Validation loss decreased (0.989480 --> 0.962081).  Saving model ...

Epoch 18/99
----------
train Loss: 0.9374 LRAP: 0.7083 NDCG: 0.7982
val Loss: 0.9790 LRAP: 0.7114 NDCG: 0.8027
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.9357 LRAP: 0.6947 NDCG: 0.7944
val Loss: 0.9581 LRAP: 0.7362 NDCG: 0.8169
Validation loss decreased (0.962081 --> 0.958055).  Saving model ...

Epoch 20/99
----------
train Loss: 0.9218 LRAP: 0.7059 NDCG: 0.7959
val Loss: 0.9481 LRAP: 0.7362 NDCG: 0.8240
Validation loss decreased (0.958055 --> 0.948107).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9171 LRAP: 0.7088 NDCG: 0.7961
val Loss: 0.9526 LRAP: 0.7459 NDCG: 0.8227
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.9179 LRAP: 0.7031 NDCG: 0.7879
val Loss: 0.9570 LRAP: 0.7094 NDCG: 0.7886
EarlyStopping counter: 2 out of 25

Epoch 23/99
----------
train Loss: 0.9055 LRAP: 0.7098 NDCG: 0.7879
val Loss: 0.9465 LRAP: 0.7248 NDCG: 0.8030
Validation loss decreased (0.948107 --> 0.946477).  Saving model ...

Epoch 24/99
----------
train Loss: 0.9035 LRAP: 0.7082 NDCG: 0.7786
val Loss: 0.9519 LRAP: 0.7502 NDCG: 0.8138
EarlyStopping counter: 1 out of 25

Epoch 25/99
----------
train Loss: 0.8988 LRAP: 0.7106 NDCG: 0.7819
val Loss: 0.9611 LRAP: 0.6846 NDCG: 0.7747
EarlyStopping counter: 2 out of 25

Epoch 26/99
----------
train Loss: 0.8880 LRAP: 0.7210 NDCG: 0.7824
val Loss: 0.9409 LRAP: 0.7662 NDCG: 0.8379
Validation loss decreased (0.946477 --> 0.940852).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8907 LRAP: 0.7159 NDCG: 0.7761
val Loss: 0.9406 LRAP: 0.7279 NDCG: 0.8054
Validation loss decreased (0.940852 --> 0.940600).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8809 LRAP: 0.7229 NDCG: 0.7788
val Loss: 0.9579 LRAP: 0.7411 NDCG: 0.7974
EarlyStopping counter: 1 out of 25

Epoch 29/99
----------
train Loss: 0.8779 LRAP: 0.7197 NDCG: 0.7708
val Loss: 0.9364 LRAP: 0.7554 NDCG: 0.8294
Validation loss decreased (0.940600 --> 0.936438).  Saving model ...

Epoch 30/99
----------
train Loss: 0.8745 LRAP: 0.7161 NDCG: 0.7643
val Loss: 0.9393 LRAP: 0.7185 NDCG: 0.7965
EarlyStopping counter: 1 out of 25

Epoch 31/99
----------
train Loss: 0.8744 LRAP: 0.7211 NDCG: 0.7735
val Loss: 0.9217 LRAP: 0.7496 NDCG: 0.7937
Validation loss decreased (0.936438 --> 0.921667).  Saving model ...

Epoch 32/99
----------
train Loss: 0.8629 LRAP: 0.7201 NDCG: 0.7661
val Loss: 0.9445 LRAP: 0.7448 NDCG: 0.7953
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.8533 LRAP: 0.7269 NDCG: 0.7616
val Loss: 0.9013 LRAP: 0.7474 NDCG: 0.7898
Validation loss decreased (0.921667 --> 0.901271).  Saving model ...

Epoch 34/99
----------
train Loss: 0.8575 LRAP: 0.7214 NDCG: 0.7643
val Loss: 0.9057 LRAP: 0.7536 NDCG: 0.8223
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.8459 LRAP: 0.7345 NDCG: 0.7683
val Loss: 0.9277 LRAP: 0.7494 NDCG: 0.7866
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.8453 LRAP: 0.7291 NDCG: 0.7633
val Loss: 0.8982 LRAP: 0.7505 NDCG: 0.7848
Validation loss decreased (0.901271 --> 0.898214).  Saving model ...

Epoch 37/99
----------
train Loss: 0.8390 LRAP: 0.7389 NDCG: 0.7699
val Loss: 0.9084 LRAP: 0.7745 NDCG: 0.8090
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.8340 LRAP: 0.7403 NDCG: 0.7645
val Loss: 0.9174 LRAP: 0.7462 NDCG: 0.7687
EarlyStopping counter: 2 out of 25

Epoch 39/99
----------
train Loss: 0.8313 LRAP: 0.7431 NDCG: 0.7595
val Loss: 0.9097 LRAP: 0.7514 NDCG: 0.8235
EarlyStopping counter: 3 out of 25

Epoch 40/99
----------
train Loss: 0.8299 LRAP: 0.7409 NDCG: 0.7723
val Loss: 0.9144 LRAP: 0.7742 NDCG: 0.8223
EarlyStopping counter: 4 out of 25

Epoch 41/99
----------
train Loss: 0.8234 LRAP: 0.7446 NDCG: 0.7541
val Loss: 0.9327 LRAP: 0.6811 NDCG: 0.7093
EarlyStopping counter: 5 out of 25

Epoch 42/99
----------
train Loss: 0.8025 LRAP: 0.7498 NDCG: 0.7576
val Loss: 0.8790 LRAP: 0.7750 NDCG: 0.8162
Validation loss decreased (0.898214 --> 0.879019).  Saving model ...

Epoch 43/99
----------
train Loss: 0.7917 LRAP: 0.7539 NDCG: 0.7622
val Loss: 0.8821 LRAP: 0.7848 NDCG: 0.7963
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.7866 LRAP: 0.7641 NDCG: 0.7605
val Loss: 0.8816 LRAP: 0.7813 NDCG: 0.8020
EarlyStopping counter: 2 out of 25

Epoch 45/99
----------
train Loss: 0.7879 LRAP: 0.7655 NDCG: 0.7711
val Loss: 0.8828 LRAP: 0.7890 NDCG: 0.8019
EarlyStopping counter: 3 out of 25

Epoch 46/99
----------
train Loss: 0.7845 LRAP: 0.7689 NDCG: 0.7689
val Loss: 0.8818 LRAP: 0.7890 NDCG: 0.8034
EarlyStopping counter: 4 out of 25

Epoch 47/99
----------
train Loss: 0.7807 LRAP: 0.7681 NDCG: 0.7626
val Loss: 0.8834 LRAP: 0.7813 NDCG: 0.7934
EarlyStopping counter: 5 out of 25

Epoch 48/99
----------
train Loss: 0.7751 LRAP: 0.7635 NDCG: 0.7510
val Loss: 0.8809 LRAP: 0.7845 NDCG: 0.7976
EarlyStopping counter: 6 out of 25

Epoch 49/99
----------
train Loss: 0.7761 LRAP: 0.7627 NDCG: 0.7531
val Loss: 0.8808 LRAP: 0.7908 NDCG: 0.8078
EarlyStopping counter: 7 out of 25

Epoch 50/99
----------
train Loss: 0.7743 LRAP: 0.7649 NDCG: 0.7553
val Loss: 0.8826 LRAP: 0.7873 NDCG: 0.7945
EarlyStopping counter: 8 out of 25

Epoch 51/99
----------
train Loss: 0.7735 LRAP: 0.7657 NDCG: 0.7639
val Loss: 0.8817 LRAP: 0.7888 NDCG: 0.7905
EarlyStopping counter: 9 out of 25

Epoch 52/99
----------
train Loss: 0.7731 LRAP: 0.7682 NDCG: 0.7648
val Loss: 0.8797 LRAP: 0.7925 NDCG: 0.8066
EarlyStopping counter: 10 out of 25

Epoch 53/99
----------
train Loss: 0.7729 LRAP: 0.7679 NDCG: 0.7658
val Loss: 0.8809 LRAP: 0.7868 NDCG: 0.7942
EarlyStopping counter: 11 out of 25

Epoch 54/99
----------
train Loss: 0.7715 LRAP: 0.7681 NDCG: 0.7620
val Loss: 0.8814 LRAP: 0.7936 NDCG: 0.8111
EarlyStopping counter: 12 out of 25

Epoch 55/99
----------
train Loss: 0.7756 LRAP: 0.7684 NDCG: 0.7665
val Loss: 0.8813 LRAP: 0.7953 NDCG: 0.8093
EarlyStopping counter: 13 out of 25

Epoch 56/99
----------
train Loss: 0.7714 LRAP: 0.7723 NDCG: 0.7595
val Loss: 0.8819 LRAP: 0.7942 NDCG: 0.8049
EarlyStopping counter: 14 out of 25

Epoch 57/99
----------
train Loss: 0.7715 LRAP: 0.7718 NDCG: 0.7645
val Loss: 0.8785 LRAP: 0.7910 NDCG: 0.8036
Validation loss decreased (0.879019 --> 0.878481).  Saving model ...

Epoch 58/99
----------
train Loss: 0.7713 LRAP: 0.7707 NDCG: 0.7642
val Loss: 0.8815 LRAP: 0.7999 NDCG: 0.8167
EarlyStopping counter: 1 out of 25

Epoch 59/99
----------
train Loss: 0.7718 LRAP: 0.7715 NDCG: 0.7630
val Loss: 0.8799 LRAP: 0.7902 NDCG: 0.8000
EarlyStopping counter: 2 out of 25

Epoch 60/99
----------
train Loss: 0.7727 LRAP: 0.7727 NDCG: 0.7595
val Loss: 0.8798 LRAP: 0.7950 NDCG: 0.8119
EarlyStopping counter: 3 out of 25

Epoch 61/99
----------
train Loss: 0.7704 LRAP: 0.7709 NDCG: 0.7602
val Loss: 0.8816 LRAP: 0.7979 NDCG: 0.8128
EarlyStopping counter: 4 out of 25

Epoch 62/99
----------
train Loss: 0.7713 LRAP: 0.7708 NDCG: 0.7643
val Loss: 0.8805 LRAP: 0.7959 NDCG: 0.8093
EarlyStopping counter: 5 out of 25

Epoch 63/99
----------
train Loss: 0.7678 LRAP: 0.7700 NDCG: 0.7675
val Loss: 0.8816 LRAP: 0.7916 NDCG: 0.7960
EarlyStopping counter: 6 out of 25

Epoch 64/99
----------
train Loss: 0.7689 LRAP: 0.7714 NDCG: 0.7614
val Loss: 0.8825 LRAP: 0.7953 NDCG: 0.8037
EarlyStopping counter: 7 out of 25

Epoch 65/99
----------
train Loss: 0.7702 LRAP: 0.7731 NDCG: 0.7653
val Loss: 0.8809 LRAP: 0.7913 NDCG: 0.7977
EarlyStopping counter: 8 out of 25

Epoch 66/99
----------
train Loss: 0.7704 LRAP: 0.7714 NDCG: 0.7613
val Loss: 0.8801 LRAP: 0.7993 NDCG: 0.8174
EarlyStopping counter: 9 out of 25

Epoch 67/99
----------
train Loss: 0.7712 LRAP: 0.7723 NDCG: 0.7657
val Loss: 0.8823 LRAP: 0.7922 NDCG: 0.7981
EarlyStopping counter: 10 out of 25

Epoch 68/99
----------
train Loss: 0.7715 LRAP: 0.7699 NDCG: 0.7634
val Loss: 0.8809 LRAP: 0.7890 NDCG: 0.7956
EarlyStopping counter: 11 out of 25

Epoch 69/99
----------
train Loss: 0.7722 LRAP: 0.7691 NDCG: 0.7634
val Loss: 0.8805 LRAP: 0.7916 NDCG: 0.8047
EarlyStopping counter: 12 out of 25

Epoch 70/99
----------
train Loss: 0.7688 LRAP: 0.7724 NDCG: 0.7640
val Loss: 0.8815 LRAP: 0.7879 NDCG: 0.7941
EarlyStopping counter: 13 out of 25

Epoch 71/99
----------
train Loss: 0.7701 LRAP: 0.7706 NDCG: 0.7630
val Loss: 0.8805 LRAP: 0.7916 NDCG: 0.8006
EarlyStopping counter: 14 out of 25

Epoch 72/99
----------
train Loss: 0.7680 LRAP: 0.7687 NDCG: 0.7653
val Loss: 0.8811 LRAP: 0.7959 NDCG: 0.8120
EarlyStopping counter: 15 out of 25

Epoch 73/99
----------
train Loss: 0.7702 LRAP: 0.7696 NDCG: 0.7611
val Loss: 0.8824 LRAP: 0.7947 NDCG: 0.8057
EarlyStopping counter: 16 out of 25

Epoch 74/99
----------
train Loss: 0.7701 LRAP: 0.7682 NDCG: 0.7657
val Loss: 0.8801 LRAP: 0.7956 NDCG: 0.8128
EarlyStopping counter: 17 out of 25

Epoch 75/99
----------
train Loss: 0.7681 LRAP: 0.7702 NDCG: 0.7626
val Loss: 0.8816 LRAP: 0.7899 NDCG: 0.7959
EarlyStopping counter: 18 out of 25

Epoch 76/99
----------
train Loss: 0.7704 LRAP: 0.7707 NDCG: 0.7623
val Loss: 0.8815 LRAP: 0.7902 NDCG: 0.7945
EarlyStopping counter: 19 out of 25

Epoch 77/99
----------
train Loss: 0.7705 LRAP: 0.7679 NDCG: 0.7617
val Loss: 0.8835 LRAP: 0.7925 NDCG: 0.7953
EarlyStopping counter: 20 out of 25

Epoch 78/99
----------
train Loss: 0.7685 LRAP: 0.7721 NDCG: 0.7617
val Loss: 0.8803 LRAP: 0.7962 NDCG: 0.8085
EarlyStopping counter: 21 out of 25

Epoch 79/99
----------
train Loss: 0.7700 LRAP: 0.7692 NDCG: 0.7664
val Loss: 0.8810 LRAP: 0.7922 NDCG: 0.8035
EarlyStopping counter: 22 out of 25

Epoch 80/99
----------
train Loss: 0.7710 LRAP: 0.7701 NDCG: 0.7622
val Loss: 0.8824 LRAP: 0.7927 NDCG: 0.8019
EarlyStopping counter: 23 out of 25

Epoch 81/99
----------
train Loss: 0.7697 LRAP: 0.7714 NDCG: 0.7648
val Loss: 0.8832 LRAP: 0.7908 NDCG: 0.7978
EarlyStopping counter: 24 out of 25

Epoch 82/99
----------
train Loss: 0.7696 LRAP: 0.7712 NDCG: 0.7601
val Loss: 0.8815 LRAP: 0.7936 NDCG: 0.7996
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 12m 2s
Best val loss: 0.878481, best LRAP score: 0.9620

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7281 LRAP: 0.2359 NDCG: 0.5672
val Loss: 1.7048 LRAP: 0.2949 NDCG: 0.6098
Validation loss decreased (0.000000 --> 1.704832).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3019 LRAP: 0.5865 NDCG: 0.6909
val Loss: 1.4987 LRAP: 0.4208 NDCG: 0.6731
Validation loss decreased (1.704832 --> 1.498678).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2440 LRAP: 0.6056 NDCG: 0.7055
val Loss: 1.8877 LRAP: 0.6415 NDCG: 0.7153
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.2208 LRAP: 0.6230 NDCG: 0.7192
val Loss: 1.7060 LRAP: 0.6566 NDCG: 0.7131
EarlyStopping counter: 2 out of 25

Epoch 4/99
----------
train Loss: 1.1961 LRAP: 0.6322 NDCG: 0.7252
val Loss: 1.1703 LRAP: 0.6492 NDCG: 0.7330
Validation loss decreased (1.498678 --> 1.170261).  Saving model ...

Epoch 5/99
----------
train Loss: 1.1772 LRAP: 0.6294 NDCG: 0.7296
val Loss: 1.2494 LRAP: 0.6594 NDCG: 0.7425
EarlyStopping counter: 1 out of 25

Epoch 6/99
----------
train Loss: 1.1582 LRAP: 0.6385 NDCG: 0.7386
val Loss: 1.2678 LRAP: 0.6492 NDCG: 0.7404
EarlyStopping counter: 2 out of 25

Epoch 7/99
----------
train Loss: 1.1419 LRAP: 0.6359 NDCG: 0.7431
val Loss: 1.5029 LRAP: 0.3925 NDCG: 0.6373
EarlyStopping counter: 3 out of 25

Epoch 8/99
----------
train Loss: 1.1319 LRAP: 0.6369 NDCG: 0.7471
val Loss: 1.1602 LRAP: 0.5073 NDCG: 0.7066
Validation loss decreased (1.170261 --> 1.160163).  Saving model ...

Epoch 9/99
----------
train Loss: 1.1206 LRAP: 0.6392 NDCG: 0.7530
val Loss: 1.1337 LRAP: 0.6429 NDCG: 0.7564
Validation loss decreased (1.160163 --> 1.133705).  Saving model ...

Epoch 10/99
----------
train Loss: 1.1044 LRAP: 0.6487 NDCG: 0.7582
val Loss: 1.1484 LRAP: 0.6129 NDCG: 0.7471
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 1.0998 LRAP: 0.6477 NDCG: 0.7602
val Loss: 1.1768 LRAP: 0.5995 NDCG: 0.7486
EarlyStopping counter: 2 out of 25

Epoch 12/99
----------
train Loss: 1.0944 LRAP: 0.6341 NDCG: 0.7611
val Loss: 1.3163 LRAP: 0.4693 NDCG: 0.7063
EarlyStopping counter: 3 out of 25

Epoch 13/99
----------
train Loss: 1.0798 LRAP: 0.6588 NDCG: 0.7670
val Loss: 1.8574 LRAP: 0.2783 NDCG: 0.5939
EarlyStopping counter: 4 out of 25

Epoch 14/99
----------
train Loss: 1.0696 LRAP: 0.6616 NDCG: 0.7714
val Loss: 1.1013 LRAP: 0.6908 NDCG: 0.7831
Validation loss decreased (1.133705 --> 1.101302).  Saving model ...

Epoch 15/99
----------
train Loss: 1.0731 LRAP: 0.6625 NDCG: 0.7714
val Loss: 1.1178 LRAP: 0.5053 NDCG: 0.7348
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 1.0588 LRAP: 0.6586 NDCG: 0.7731
val Loss: 1.2074 LRAP: 0.4345 NDCG: 0.6970
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 1.0451 LRAP: 0.6563 NDCG: 0.7664
val Loss: 1.1577 LRAP: 0.5021 NDCG: 0.7174
EarlyStopping counter: 3 out of 25

Epoch 18/99
----------
train Loss: 1.0453 LRAP: 0.6606 NDCG: 0.7731
val Loss: 1.3171 LRAP: 0.6377 NDCG: 0.7582
EarlyStopping counter: 4 out of 25

Epoch 19/99
----------
train Loss: 1.0356 LRAP: 0.6551 NDCG: 0.7707
val Loss: 1.0559 LRAP: 0.6991 NDCG: 0.7862
Validation loss decreased (1.101302 --> 1.055876).  Saving model ...

Epoch 20/99
----------
train Loss: 1.0340 LRAP: 0.6680 NDCG: 0.7738
val Loss: 1.1294 LRAP: 0.6138 NDCG: 0.7638
EarlyStopping counter: 1 out of 25

Epoch 21/99
----------
train Loss: 1.0234 LRAP: 0.6666 NDCG: 0.7744
val Loss: 1.0450 LRAP: 0.7074 NDCG: 0.7973
Validation loss decreased (1.055876 --> 1.045047).  Saving model ...

Epoch 22/99
----------
train Loss: 1.0170 LRAP: 0.6785 NDCG: 0.7784
val Loss: 1.1088 LRAP: 0.6052 NDCG: 0.7583
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 1.0091 LRAP: 0.6724 NDCG: 0.7763
val Loss: 1.0535 LRAP: 0.7083 NDCG: 0.7940
EarlyStopping counter: 2 out of 25

Epoch 24/99
----------
train Loss: 1.0027 LRAP: 0.6778 NDCG: 0.7762
val Loss: 1.0538 LRAP: 0.7151 NDCG: 0.8020
EarlyStopping counter: 3 out of 25

Epoch 25/99
----------
train Loss: 0.9979 LRAP: 0.6711 NDCG: 0.7765
val Loss: 1.0804 LRAP: 0.6494 NDCG: 0.7680
EarlyStopping counter: 4 out of 25

Epoch 26/99
----------
train Loss: 0.9925 LRAP: 0.6748 NDCG: 0.7750
val Loss: 1.0458 LRAP: 0.6749 NDCG: 0.7785
EarlyStopping counter: 5 out of 25

Epoch 27/99
----------
train Loss: 0.9670 LRAP: 0.6934 NDCG: 0.7808
val Loss: 0.9956 LRAP: 0.7248 NDCG: 0.8040
Validation loss decreased (1.045047 --> 0.995633).  Saving model ...

Epoch 28/99
----------
train Loss: 0.9579 LRAP: 0.6915 NDCG: 0.7797
val Loss: 0.9897 LRAP: 0.7257 NDCG: 0.8037
Validation loss decreased (0.995633 --> 0.989726).  Saving model ...

Epoch 29/99
----------
train Loss: 0.9540 LRAP: 0.6893 NDCG: 0.7814
val Loss: 0.9936 LRAP: 0.7205 NDCG: 0.7993
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.9545 LRAP: 0.6989 NDCG: 0.7814
val Loss: 0.9850 LRAP: 0.7377 NDCG: 0.8133
Validation loss decreased (0.989726 --> 0.985006).  Saving model ...

Epoch 31/99
----------
train Loss: 0.9516 LRAP: 0.6929 NDCG: 0.7803
val Loss: 0.9869 LRAP: 0.7248 NDCG: 0.8014
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.9478 LRAP: 0.6980 NDCG: 0.7800
val Loss: 0.9881 LRAP: 0.7402 NDCG: 0.8106
EarlyStopping counter: 2 out of 25

Epoch 33/99
----------
train Loss: 0.9419 LRAP: 0.6981 NDCG: 0.7829
val Loss: 0.9881 LRAP: 0.7345 NDCG: 0.7997
EarlyStopping counter: 3 out of 25

Epoch 34/99
----------
train Loss: 0.9459 LRAP: 0.7007 NDCG: 0.7860
val Loss: 0.9836 LRAP: 0.7271 NDCG: 0.8113
Validation loss decreased (0.985006 --> 0.983645).  Saving model ...

Epoch 35/99
----------
train Loss: 0.9413 LRAP: 0.7035 NDCG: 0.7864
val Loss: 0.9846 LRAP: 0.7385 NDCG: 0.8130
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.9412 LRAP: 0.7017 NDCG: 0.7860
val Loss: 0.9787 LRAP: 0.7408 NDCG: 0.8155
Validation loss decreased (0.983645 --> 0.978671).  Saving model ...

Epoch 37/99
----------
train Loss: 0.9375 LRAP: 0.7002 NDCG: 0.7841
val Loss: 0.9785 LRAP: 0.7405 NDCG: 0.8073
Validation loss decreased (0.978671 --> 0.978545).  Saving model ...

Epoch 38/99
----------
train Loss: 0.9345 LRAP: 0.7102 NDCG: 0.7850
val Loss: 0.9766 LRAP: 0.7354 NDCG: 0.8097
Validation loss decreased (0.978545 --> 0.976626).  Saving model ...

Epoch 39/99
----------
train Loss: 0.9353 LRAP: 0.7068 NDCG: 0.7849
val Loss: 0.9758 LRAP: 0.7397 NDCG: 0.8077
Validation loss decreased (0.976626 --> 0.975780).  Saving model ...

Epoch 40/99
----------
train Loss: 0.9337 LRAP: 0.7082 NDCG: 0.7858
val Loss: 0.9841 LRAP: 0.7302 NDCG: 0.8029
EarlyStopping counter: 1 out of 25

Epoch 41/99
----------
train Loss: 0.9281 LRAP: 0.7091 NDCG: 0.7873
val Loss: 0.9814 LRAP: 0.7357 NDCG: 0.8104
EarlyStopping counter: 2 out of 25

Epoch 42/99
----------
train Loss: 0.9330 LRAP: 0.7060 NDCG: 0.7867
val Loss: 0.9826 LRAP: 0.7419 NDCG: 0.8147
EarlyStopping counter: 3 out of 25

Epoch 43/99
----------
train Loss: 0.9293 LRAP: 0.7145 NDCG: 0.7901
val Loss: 0.9752 LRAP: 0.7525 NDCG: 0.8199
Validation loss decreased (0.975780 --> 0.975196).  Saving model ...

Epoch 44/99
----------
train Loss: 0.9299 LRAP: 0.7121 NDCG: 0.7867
val Loss: 0.9761 LRAP: 0.7471 NDCG: 0.8152
EarlyStopping counter: 1 out of 25

Epoch 45/99
----------
train Loss: 0.9239 LRAP: 0.7142 NDCG: 0.7896
val Loss: 0.9673 LRAP: 0.7436 NDCG: 0.8199
Validation loss decreased (0.975196 --> 0.967348).  Saving model ...

Epoch 46/99
----------
train Loss: 0.9269 LRAP: 0.7180 NDCG: 0.7907
val Loss: 0.9749 LRAP: 0.7459 NDCG: 0.8151
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.9244 LRAP: 0.7186 NDCG: 0.7911
val Loss: 0.9683 LRAP: 0.7593 NDCG: 0.8235
EarlyStopping counter: 2 out of 25

Epoch 48/99
----------
train Loss: 0.9228 LRAP: 0.7131 NDCG: 0.7854
val Loss: 0.9683 LRAP: 0.7522 NDCG: 0.8147
EarlyStopping counter: 3 out of 25

Epoch 49/99
----------
train Loss: 0.9203 LRAP: 0.7132 NDCG: 0.7900
val Loss: 0.9736 LRAP: 0.7488 NDCG: 0.8169
EarlyStopping counter: 4 out of 25

Epoch 50/99
----------
train Loss: 0.9228 LRAP: 0.7214 NDCG: 0.7898
val Loss: 0.9719 LRAP: 0.7585 NDCG: 0.8219
EarlyStopping counter: 5 out of 25

Epoch 51/99
----------
train Loss: 0.9109 LRAP: 0.7223 NDCG: 0.7907
val Loss: 0.9627 LRAP: 0.7556 NDCG: 0.8159
Validation loss decreased (0.967348 --> 0.962732).  Saving model ...

Epoch 52/99
----------
train Loss: 0.9103 LRAP: 0.7247 NDCG: 0.7883
val Loss: 0.9625 LRAP: 0.7559 NDCG: 0.8173
Validation loss decreased (0.962732 --> 0.962486).  Saving model ...

Epoch 53/99
----------
train Loss: 0.9071 LRAP: 0.7255 NDCG: 0.7909
val Loss: 0.9609 LRAP: 0.7559 NDCG: 0.8183
Validation loss decreased (0.962486 --> 0.960931).  Saving model ...

Epoch 54/99
----------
train Loss: 0.9092 LRAP: 0.7266 NDCG: 0.7901
val Loss: 0.9631 LRAP: 0.7531 NDCG: 0.8118
EarlyStopping counter: 1 out of 25

Epoch 55/99
----------
train Loss: 0.9046 LRAP: 0.7222 NDCG: 0.7907
val Loss: 0.9628 LRAP: 0.7511 NDCG: 0.8122
EarlyStopping counter: 2 out of 25

Epoch 56/99
----------
train Loss: 0.9057 LRAP: 0.7268 NDCG: 0.7918
val Loss: 0.9601 LRAP: 0.7588 NDCG: 0.8187
Validation loss decreased (0.960931 --> 0.960053).  Saving model ...

Epoch 57/99
----------
train Loss: 0.9057 LRAP: 0.7217 NDCG: 0.7886
val Loss: 0.9603 LRAP: 0.7582 NDCG: 0.8159
EarlyStopping counter: 1 out of 25

Epoch 58/99
----------
train Loss: 0.9049 LRAP: 0.7276 NDCG: 0.7897
val Loss: 0.9612 LRAP: 0.7562 NDCG: 0.8150
EarlyStopping counter: 2 out of 25

Epoch 59/99
----------
train Loss: 0.9056 LRAP: 0.7268 NDCG: 0.7905
val Loss: 0.9593 LRAP: 0.7548 NDCG: 0.8158
Validation loss decreased (0.960053 --> 0.959325).  Saving model ...

Epoch 60/99
----------
train Loss: 0.9048 LRAP: 0.7285 NDCG: 0.7925
val Loss: 0.9617 LRAP: 0.7585 NDCG: 0.8168
EarlyStopping counter: 1 out of 25

Epoch 61/99
----------
train Loss: 0.9036 LRAP: 0.7285 NDCG: 0.7918
val Loss: 0.9588 LRAP: 0.7556 NDCG: 0.8137
Validation loss decreased (0.959325 --> 0.958806).  Saving model ...

Epoch 62/99
----------
train Loss: 0.9014 LRAP: 0.7298 NDCG: 0.7907
val Loss: 0.9620 LRAP: 0.7576 NDCG: 0.8171
EarlyStopping counter: 1 out of 25

Epoch 63/99
----------
train Loss: 0.9024 LRAP: 0.7290 NDCG: 0.7928
val Loss: 0.9593 LRAP: 0.7602 NDCG: 0.8169
EarlyStopping counter: 2 out of 25

Epoch 64/99
----------
train Loss: 0.9055 LRAP: 0.7296 NDCG: 0.7941
val Loss: 0.9585 LRAP: 0.7576 NDCG: 0.8155
Validation loss decreased (0.958806 --> 0.958514).  Saving model ...

Epoch 65/99
----------
train Loss: 0.9033 LRAP: 0.7326 NDCG: 0.7938
val Loss: 0.9572 LRAP: 0.7596 NDCG: 0.8152
Validation loss decreased (0.958514 --> 0.957244).  Saving model ...

Epoch 66/99
----------
train Loss: 0.9014 LRAP: 0.7317 NDCG: 0.7933
val Loss: 0.9569 LRAP: 0.7591 NDCG: 0.8174
Validation loss decreased (0.957244 --> 0.956867).  Saving model ...

Epoch 67/99
----------
train Loss: 0.8996 LRAP: 0.7315 NDCG: 0.7907
val Loss: 0.9572 LRAP: 0.7608 NDCG: 0.8172
EarlyStopping counter: 1 out of 25

Epoch 68/99
----------
train Loss: 0.9015 LRAP: 0.7307 NDCG: 0.7918
val Loss: 0.9577 LRAP: 0.7602 NDCG: 0.8161
EarlyStopping counter: 2 out of 25

Epoch 69/99
----------
train Loss: 0.8984 LRAP: 0.7331 NDCG: 0.7933
val Loss: 0.9566 LRAP: 0.7562 NDCG: 0.8113
Validation loss decreased (0.956867 --> 0.956621).  Saving model ...

Epoch 70/99
----------
train Loss: 0.9002 LRAP: 0.7282 NDCG: 0.7917
val Loss: 0.9584 LRAP: 0.7625 NDCG: 0.8207
EarlyStopping counter: 1 out of 25

Epoch 71/99
----------
train Loss: 0.8987 LRAP: 0.7327 NDCG: 0.7917
val Loss: 0.9584 LRAP: 0.7602 NDCG: 0.8194
EarlyStopping counter: 2 out of 25

Epoch 72/99
----------
train Loss: 0.8998 LRAP: 0.7271 NDCG: 0.7933
val Loss: 0.9568 LRAP: 0.7585 NDCG: 0.8101
EarlyStopping counter: 3 out of 25

Epoch 73/99
----------
train Loss: 0.8988 LRAP: 0.7305 NDCG: 0.7937
val Loss: 0.9556 LRAP: 0.7602 NDCG: 0.8141
Validation loss decreased (0.956621 --> 0.955626).  Saving model ...

Epoch 74/99
----------
train Loss: 0.8999 LRAP: 0.7293 NDCG: 0.7934
val Loss: 0.9608 LRAP: 0.7585 NDCG: 0.8112
EarlyStopping counter: 1 out of 25

Epoch 75/99
----------
train Loss: 0.8994 LRAP: 0.7306 NDCG: 0.7918
val Loss: 0.9551 LRAP: 0.7633 NDCG: 0.8181
Validation loss decreased (0.955626 --> 0.955087).  Saving model ...

Epoch 76/99
----------
train Loss: 0.8990 LRAP: 0.7368 NDCG: 0.7940
val Loss: 0.9547 LRAP: 0.7585 NDCG: 0.8102
Validation loss decreased (0.955087 --> 0.954714).  Saving model ...

Epoch 77/99
----------
train Loss: 0.8974 LRAP: 0.7337 NDCG: 0.7969
val Loss: 0.9556 LRAP: 0.7585 NDCG: 0.8121
EarlyStopping counter: 1 out of 25

Epoch 78/99
----------
train Loss: 0.8972 LRAP: 0.7326 NDCG: 0.7943
val Loss: 0.9573 LRAP: 0.7576 NDCG: 0.8180
EarlyStopping counter: 2 out of 25

Epoch 79/99
----------
train Loss: 0.8957 LRAP: 0.7288 NDCG: 0.7907
val Loss: 0.9571 LRAP: 0.7622 NDCG: 0.8153
EarlyStopping counter: 3 out of 25

Epoch 80/99
----------
train Loss: 0.8967 LRAP: 0.7339 NDCG: 0.7941
val Loss: 0.9554 LRAP: 0.7605 NDCG: 0.8168
EarlyStopping counter: 4 out of 25

Epoch 81/99
----------
train Loss: 0.8966 LRAP: 0.7304 NDCG: 0.7907
val Loss: 0.9583 LRAP: 0.7608 NDCG: 0.8217
EarlyStopping counter: 5 out of 25

Epoch 82/99
----------
train Loss: 0.8937 LRAP: 0.7330 NDCG: 0.7962
val Loss: 0.9557 LRAP: 0.7639 NDCG: 0.8170
EarlyStopping counter: 6 out of 25

Epoch 83/99
----------
train Loss: 0.8941 LRAP: 0.7340 NDCG: 0.7926
val Loss: 0.9550 LRAP: 0.7628 NDCG: 0.8178
EarlyStopping counter: 7 out of 25

Epoch 84/99
----------
train Loss: 0.8963 LRAP: 0.7310 NDCG: 0.7922
val Loss: 0.9556 LRAP: 0.7648 NDCG: 0.8196
EarlyStopping counter: 8 out of 25

Epoch 85/99
----------
train Loss: 0.8945 LRAP: 0.7328 NDCG: 0.7921
val Loss: 0.9539 LRAP: 0.7608 NDCG: 0.8173
Validation loss decreased (0.954714 --> 0.953916).  Saving model ...

Epoch 86/99
----------
train Loss: 0.8925 LRAP: 0.7355 NDCG: 0.7924
val Loss: 0.9551 LRAP: 0.7616 NDCG: 0.8133
EarlyStopping counter: 1 out of 25

Epoch 87/99
----------
train Loss: 0.8957 LRAP: 0.7320 NDCG: 0.7919
val Loss: 0.9551 LRAP: 0.7619 NDCG: 0.8162
EarlyStopping counter: 2 out of 25

Epoch 88/99
----------
train Loss: 0.8955 LRAP: 0.7350 NDCG: 0.7920
val Loss: 0.9541 LRAP: 0.7596 NDCG: 0.8149
EarlyStopping counter: 3 out of 25

Epoch 89/99
----------
train Loss: 0.8906 LRAP: 0.7335 NDCG: 0.7927
val Loss: 0.9552 LRAP: 0.7616 NDCG: 0.8162
EarlyStopping counter: 4 out of 25

Epoch 90/99
----------
train Loss: 0.8917 LRAP: 0.7326 NDCG: 0.7954
val Loss: 0.9552 LRAP: 0.7613 NDCG: 0.8144
EarlyStopping counter: 5 out of 25

Epoch 91/99
----------
train Loss: 0.8918 LRAP: 0.7339 NDCG: 0.7939
val Loss: 0.9538 LRAP: 0.7602 NDCG: 0.8154
Validation loss decreased (0.953916 --> 0.953799).  Saving model ...

Epoch 92/99
----------
train Loss: 0.8943 LRAP: 0.7314 NDCG: 0.7942
val Loss: 0.9554 LRAP: 0.7628 NDCG: 0.8131
EarlyStopping counter: 1 out of 25

Epoch 93/99
----------
train Loss: 0.8942 LRAP: 0.7368 NDCG: 0.7929
val Loss: 0.9551 LRAP: 0.7628 NDCG: 0.8147
EarlyStopping counter: 2 out of 25

Epoch 94/99
----------
train Loss: 0.8918 LRAP: 0.7360 NDCG: 0.7955
val Loss: 0.9539 LRAP: 0.7613 NDCG: 0.8149
EarlyStopping counter: 3 out of 25

Epoch 95/99
----------
train Loss: 0.8916 LRAP: 0.7343 NDCG: 0.7957
val Loss: 0.9550 LRAP: 0.7639 NDCG: 0.8161
EarlyStopping counter: 4 out of 25

Epoch 96/99
----------
train Loss: 0.8931 LRAP: 0.7312 NDCG: 0.7918
val Loss: 0.9548 LRAP: 0.7608 NDCG: 0.8162
EarlyStopping counter: 5 out of 25

Epoch 97/99
----------
train Loss: 0.8944 LRAP: 0.7330 NDCG: 0.7946
val Loss: 0.9543 LRAP: 0.7599 NDCG: 0.8155
EarlyStopping counter: 6 out of 25

Epoch 98/99
----------
train Loss: 0.8918 LRAP: 0.7331 NDCG: 0.7923
val Loss: 0.9549 LRAP: 0.7628 NDCG: 0.8192
EarlyStopping counter: 7 out of 25

Epoch 99/99
----------
train Loss: 0.8937 LRAP: 0.7323 NDCG: 0.7920
val Loss: 0.9535 LRAP: 0.7625 NDCG: 0.8165
Validation loss decreased (0.953799 --> 0.953546).  Saving model ...

Training complete in 14m 36s
Best val loss: 0.953546, best LRAP score: 0.9514

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 8/10

All random seeds set to: 427
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7604 LRAP: 0.1833 NDCG: 0.5625
val Loss: 1.3577 LRAP: 0.5176 NDCG: 0.6701
Validation loss decreased (0.000000 --> 1.357734).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2814 LRAP: 0.5358 NDCG: 0.6897
val Loss: 1.1707 LRAP: 0.5704 NDCG: 0.7025
Validation loss decreased (1.357734 --> 1.170709).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1534 LRAP: 0.6362 NDCG: 0.7356
val Loss: 1.0845 LRAP: 0.6671 NDCG: 0.7539
Validation loss decreased (1.170709 --> 1.084531).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0755 LRAP: 0.6598 NDCG: 0.7608
val Loss: 1.0972 LRAP: 0.6175 NDCG: 0.7283
EarlyStopping counter: 1 out of 25

Epoch 4/99
----------
train Loss: 1.0362 LRAP: 0.6743 NDCG: 0.7765
val Loss: 1.0366 LRAP: 0.6914 NDCG: 0.7846
Validation loss decreased (1.084531 --> 1.036590).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0014 LRAP: 0.6832 NDCG: 0.7895
val Loss: 1.0190 LRAP: 0.6968 NDCG: 0.8006
Validation loss decreased (1.036590 --> 1.018994).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9825 LRAP: 0.6909 NDCG: 0.7951
val Loss: 1.0170 LRAP: 0.6897 NDCG: 0.7907
Validation loss decreased (1.018994 --> 1.017010).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9628 LRAP: 0.6886 NDCG: 0.7975
val Loss: 0.9724 LRAP: 0.7154 NDCG: 0.8124
Validation loss decreased (1.017010 --> 0.972388).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9421 LRAP: 0.6975 NDCG: 0.8060
val Loss: 0.9767 LRAP: 0.7325 NDCG: 0.8146
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 0.9310 LRAP: 0.7107 NDCG: 0.8121
val Loss: 0.9773 LRAP: 0.6526 NDCG: 0.7919
EarlyStopping counter: 2 out of 25

Epoch 10/99
----------
train Loss: 0.9155 LRAP: 0.7150 NDCG: 0.8160
val Loss: 0.9564 LRAP: 0.7034 NDCG: 0.8141
Validation loss decreased (0.972388 --> 0.956410).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9080 LRAP: 0.7120 NDCG: 0.8188
val Loss: 0.9495 LRAP: 0.7802 NDCG: 0.8464
Validation loss decreased (0.956410 --> 0.949517).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8971 LRAP: 0.7194 NDCG: 0.8217
val Loss: 0.9432 LRAP: 0.7645 NDCG: 0.8364
Validation loss decreased (0.949517 --> 0.943189).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8881 LRAP: 0.7239 NDCG: 0.8221
val Loss: 0.9353 LRAP: 0.7582 NDCG: 0.8305
Validation loss decreased (0.943189 --> 0.935266).  Saving model ...

Epoch 14/99
----------
train Loss: 0.8770 LRAP: 0.7291 NDCG: 0.8228
val Loss: 0.9328 LRAP: 0.7722 NDCG: 0.8404
Validation loss decreased (0.935266 --> 0.932844).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8719 LRAP: 0.7359 NDCG: 0.8210
val Loss: 0.9342 LRAP: 0.7693 NDCG: 0.8435
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8607 LRAP: 0.7361 NDCG: 0.8200
val Loss: 0.9390 LRAP: 0.7665 NDCG: 0.8246
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 0.8615 LRAP: 0.7365 NDCG: 0.8154
val Loss: 0.9303 LRAP: 0.7836 NDCG: 0.8439
Validation loss decreased (0.932844 --> 0.930256).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8491 LRAP: 0.7408 NDCG: 0.8123
val Loss: 0.9177 LRAP: 0.7999 NDCG: 0.8352
Validation loss decreased (0.930256 --> 0.917704).  Saving model ...

Epoch 19/99
----------
train Loss: 0.8437 LRAP: 0.7502 NDCG: 0.8114
val Loss: 0.9179 LRAP: 0.7753 NDCG: 0.8334
EarlyStopping counter: 1 out of 25

Epoch 20/99
----------
train Loss: 0.8367 LRAP: 0.7479 NDCG: 0.8102
val Loss: 0.9183 LRAP: 0.7922 NDCG: 0.8392
EarlyStopping counter: 2 out of 25

Epoch 21/99
----------
train Loss: 0.8315 LRAP: 0.7474 NDCG: 0.8062
val Loss: 0.9152 LRAP: 0.7927 NDCG: 0.8326
Validation loss decreased (0.917704 --> 0.915243).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8337 LRAP: 0.7474 NDCG: 0.7975
val Loss: 0.9101 LRAP: 0.7679 NDCG: 0.8191
Validation loss decreased (0.915243 --> 0.910066).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8252 LRAP: 0.7552 NDCG: 0.8019
val Loss: 0.9256 LRAP: 0.7722 NDCG: 0.8407
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8226 LRAP: 0.7463 NDCG: 0.7800
val Loss: 0.9150 LRAP: 0.7950 NDCG: 0.8283
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.8131 LRAP: 0.7542 NDCG: 0.7873
val Loss: 0.9086 LRAP: 0.7705 NDCG: 0.8178
Validation loss decreased (0.910066 --> 0.908567).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8019 LRAP: 0.7641 NDCG: 0.7927
val Loss: 0.9173 LRAP: 0.7556 NDCG: 0.7881
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.8014 LRAP: 0.7639 NDCG: 0.7923
val Loss: 0.9064 LRAP: 0.8076 NDCG: 0.8429
Validation loss decreased (0.908567 --> 0.906372).  Saving model ...

Epoch 28/99
----------
train Loss: 0.7962 LRAP: 0.7685 NDCG: 0.7936
val Loss: 0.8990 LRAP: 0.8087 NDCG: 0.8376
Validation loss decreased (0.906372 --> 0.898953).  Saving model ...

Epoch 29/99
----------
train Loss: 0.7940 LRAP: 0.7687 NDCG: 0.7842
val Loss: 0.9009 LRAP: 0.7976 NDCG: 0.8230
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.7871 LRAP: 0.7718 NDCG: 0.7823
val Loss: 0.9028 LRAP: 0.7999 NDCG: 0.8170
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.7874 LRAP: 0.7746 NDCG: 0.7910
val Loss: 0.8967 LRAP: 0.7845 NDCG: 0.8197
Validation loss decreased (0.898953 --> 0.896673).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7810 LRAP: 0.7766 NDCG: 0.7868
val Loss: 0.8987 LRAP: 0.8062 NDCG: 0.8149
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.7758 LRAP: 0.7773 NDCG: 0.7818
val Loss: 0.9016 LRAP: 0.8156 NDCG: 0.8279
EarlyStopping counter: 2 out of 25

Epoch 34/99
----------
train Loss: 0.7780 LRAP: 0.7793 NDCG: 0.7809
val Loss: 0.8824 LRAP: 0.8119 NDCG: 0.8392
Validation loss decreased (0.896673 --> 0.882393).  Saving model ...

Epoch 35/99
----------
train Loss: 0.7664 LRAP: 0.7812 NDCG: 0.7862
val Loss: 0.8976 LRAP: 0.8030 NDCG: 0.8309
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.7648 LRAP: 0.7858 NDCG: 0.7856
val Loss: 0.8910 LRAP: 0.8039 NDCG: 0.8078
EarlyStopping counter: 2 out of 25

Epoch 37/99
----------
train Loss: 0.7613 LRAP: 0.7824 NDCG: 0.7873
val Loss: 0.8901 LRAP: 0.8179 NDCG: 0.8235
EarlyStopping counter: 3 out of 25

Epoch 38/99
----------
train Loss: 0.7610 LRAP: 0.7878 NDCG: 0.7893
val Loss: 0.8955 LRAP: 0.8119 NDCG: 0.8108
EarlyStopping counter: 4 out of 25

Epoch 39/99
----------
train Loss: 0.7555 LRAP: 0.7966 NDCG: 0.7907
val Loss: 0.9083 LRAP: 0.8147 NDCG: 0.8073
EarlyStopping counter: 5 out of 25

Epoch 40/99
----------
train Loss: 0.7411 LRAP: 0.7978 NDCG: 0.7795
val Loss: 0.8847 LRAP: 0.8299 NDCG: 0.8302
EarlyStopping counter: 6 out of 25

Epoch 41/99
----------
train Loss: 0.7326 LRAP: 0.8068 NDCG: 0.7929
val Loss: 0.8852 LRAP: 0.8301 NDCG: 0.8287
EarlyStopping counter: 7 out of 25

Epoch 42/99
----------
train Loss: 0.7312 LRAP: 0.8052 NDCG: 0.7899
val Loss: 0.8831 LRAP: 0.8279 NDCG: 0.8319
EarlyStopping counter: 8 out of 25

Epoch 43/99
----------
train Loss: 0.7274 LRAP: 0.8087 NDCG: 0.7949
val Loss: 0.8795 LRAP: 0.8361 NDCG: 0.8404
Validation loss decreased (0.882393 --> 0.879466).  Saving model ...

Epoch 44/99
----------
train Loss: 0.7271 LRAP: 0.8121 NDCG: 0.8048
val Loss: 0.8798 LRAP: 0.8367 NDCG: 0.8469
EarlyStopping counter: 1 out of 25

Epoch 45/99
----------
train Loss: 0.7254 LRAP: 0.8152 NDCG: 0.8007
val Loss: 0.8805 LRAP: 0.8404 NDCG: 0.8419
EarlyStopping counter: 2 out of 25

Epoch 46/99
----------
train Loss: 0.7239 LRAP: 0.8144 NDCG: 0.8004
val Loss: 0.8837 LRAP: 0.8396 NDCG: 0.8386
EarlyStopping counter: 3 out of 25

Epoch 47/99
----------
train Loss: 0.7248 LRAP: 0.8177 NDCG: 0.8050
val Loss: 0.8817 LRAP: 0.8330 NDCG: 0.8352
EarlyStopping counter: 4 out of 25

Epoch 48/99
----------
train Loss: 0.7212 LRAP: 0.8145 NDCG: 0.7983
val Loss: 0.8826 LRAP: 0.8433 NDCG: 0.8526
EarlyStopping counter: 5 out of 25

Epoch 49/99
----------
train Loss: 0.7182 LRAP: 0.8183 NDCG: 0.8020
val Loss: 0.8827 LRAP: 0.8458 NDCG: 0.8503
EarlyStopping counter: 6 out of 25

Epoch 50/99
----------
train Loss: 0.7159 LRAP: 0.8153 NDCG: 0.8000
val Loss: 0.8853 LRAP: 0.8433 NDCG: 0.8452
EarlyStopping counter: 7 out of 25

Epoch 51/99
----------
train Loss: 0.7161 LRAP: 0.8161 NDCG: 0.7973
val Loss: 0.8839 LRAP: 0.8376 NDCG: 0.8390
EarlyStopping counter: 8 out of 25

Epoch 52/99
----------
train Loss: 0.7143 LRAP: 0.8202 NDCG: 0.8006
val Loss: 0.8851 LRAP: 0.8401 NDCG: 0.8411
EarlyStopping counter: 9 out of 25

Epoch 53/99
----------
train Loss: 0.7157 LRAP: 0.8171 NDCG: 0.7969
val Loss: 0.8859 LRAP: 0.8396 NDCG: 0.8392
EarlyStopping counter: 10 out of 25

Epoch 54/99
----------
train Loss: 0.7139 LRAP: 0.8210 NDCG: 0.8057
val Loss: 0.8863 LRAP: 0.8381 NDCG: 0.8387
EarlyStopping counter: 11 out of 25

Epoch 55/99
----------
train Loss: 0.7159 LRAP: 0.8187 NDCG: 0.8028
val Loss: 0.8843 LRAP: 0.8376 NDCG: 0.8397
EarlyStopping counter: 12 out of 25

Epoch 56/99
----------
train Loss: 0.7145 LRAP: 0.8199 NDCG: 0.7986
val Loss: 0.8850 LRAP: 0.8407 NDCG: 0.8404
EarlyStopping counter: 13 out of 25

Epoch 57/99
----------
train Loss: 0.7141 LRAP: 0.8191 NDCG: 0.7969
val Loss: 0.8837 LRAP: 0.8399 NDCG: 0.8442
EarlyStopping counter: 14 out of 25

Epoch 58/99
----------
train Loss: 0.7129 LRAP: 0.8220 NDCG: 0.8006
val Loss: 0.8835 LRAP: 0.8447 NDCG: 0.8467
EarlyStopping counter: 15 out of 25

Epoch 59/99
----------
train Loss: 0.7139 LRAP: 0.8213 NDCG: 0.8037
val Loss: 0.8855 LRAP: 0.8387 NDCG: 0.8374
EarlyStopping counter: 16 out of 25

Epoch 60/99
----------
train Loss: 0.7143 LRAP: 0.8191 NDCG: 0.7962
val Loss: 0.8857 LRAP: 0.8427 NDCG: 0.8394
EarlyStopping counter: 17 out of 25

Epoch 61/99
----------
train Loss: 0.7150 LRAP: 0.8190 NDCG: 0.7962
val Loss: 0.8855 LRAP: 0.8399 NDCG: 0.8389
EarlyStopping counter: 18 out of 25

Epoch 62/99
----------
train Loss: 0.7146 LRAP: 0.8209 NDCG: 0.7997
val Loss: 0.8844 LRAP: 0.8418 NDCG: 0.8418
EarlyStopping counter: 19 out of 25

Epoch 63/99
----------
train Loss: 0.7140 LRAP: 0.8183 NDCG: 0.7994
val Loss: 0.8845 LRAP: 0.8418 NDCG: 0.8439
EarlyStopping counter: 20 out of 25

Epoch 64/99
----------
train Loss: 0.7120 LRAP: 0.8211 NDCG: 0.8046
val Loss: 0.8830 LRAP: 0.8441 NDCG: 0.8488
EarlyStopping counter: 21 out of 25

Epoch 65/99
----------
train Loss: 0.7128 LRAP: 0.8179 NDCG: 0.8020
val Loss: 0.8846 LRAP: 0.8379 NDCG: 0.8377
EarlyStopping counter: 22 out of 25

Epoch 66/99
----------
train Loss: 0.7130 LRAP: 0.8178 NDCG: 0.7971
val Loss: 0.8833 LRAP: 0.8418 NDCG: 0.8472
EarlyStopping counter: 23 out of 25

Epoch 67/99
----------
train Loss: 0.7139 LRAP: 0.8202 NDCG: 0.7982
val Loss: 0.8846 LRAP: 0.8438 NDCG: 0.8441
EarlyStopping counter: 24 out of 25

Epoch 68/99
----------
train Loss: 0.7134 LRAP: 0.8173 NDCG: 0.8018
val Loss: 0.8868 LRAP: 0.8381 NDCG: 0.8362
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 35s
Best val loss: 0.879466, best LRAP score: 0.9633

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.8694 LRAP: 0.1448 NDCG: 0.5568
val Loss: 1.3484 LRAP: 0.5701 NDCG: 0.7048
Validation loss decreased (0.000000 --> 1.348355).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2760 LRAP: 0.5945 NDCG: 0.7176
val Loss: 1.1411 LRAP: 0.6255 NDCG: 0.7439
Validation loss decreased (1.348355 --> 1.141088).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1416 LRAP: 0.6500 NDCG: 0.7516
val Loss: 1.1389 LRAP: 0.6255 NDCG: 0.7536
Validation loss decreased (1.141088 --> 1.138916).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0928 LRAP: 0.6740 NDCG: 0.7652
val Loss: 1.0617 LRAP: 0.6886 NDCG: 0.7828
Validation loss decreased (1.138916 --> 1.061731).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0532 LRAP: 0.6782 NDCG: 0.7764
val Loss: 1.0638 LRAP: 0.7005 NDCG: 0.7909
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.0184 LRAP: 0.6847 NDCG: 0.7868
val Loss: 1.0645 LRAP: 0.6631 NDCG: 0.7854
EarlyStopping counter: 2 out of 25

Epoch 6/99
----------
train Loss: 0.9991 LRAP: 0.6873 NDCG: 0.7945
val Loss: 1.0434 LRAP: 0.7080 NDCG: 0.8031
Validation loss decreased (1.061731 --> 1.043419).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9788 LRAP: 0.6938 NDCG: 0.7996
val Loss: 0.9910 LRAP: 0.6971 NDCG: 0.8027
Validation loss decreased (1.043419 --> 0.991011).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9504 LRAP: 0.7009 NDCG: 0.8090
val Loss: 0.9870 LRAP: 0.6863 NDCG: 0.8059
Validation loss decreased (0.991011 --> 0.986968).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9310 LRAP: 0.7085 NDCG: 0.8147
val Loss: 0.9697 LRAP: 0.7348 NDCG: 0.8201
Validation loss decreased (0.986968 --> 0.969674).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9284 LRAP: 0.7107 NDCG: 0.8172
val Loss: 0.9687 LRAP: 0.7265 NDCG: 0.8200
Validation loss decreased (0.969674 --> 0.968687).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9116 LRAP: 0.7167 NDCG: 0.8231
val Loss: 0.9649 LRAP: 0.6977 NDCG: 0.8137
Validation loss decreased (0.968687 --> 0.964861).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9030 LRAP: 0.7231 NDCG: 0.8281
val Loss: 0.9531 LRAP: 0.7528 NDCG: 0.8300
Validation loss decreased (0.964861 --> 0.953053).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8847 LRAP: 0.7324 NDCG: 0.8308
val Loss: 0.9617 LRAP: 0.7611 NDCG: 0.8317
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.8830 LRAP: 0.7485 NDCG: 0.8377
val Loss: 0.9401 LRAP: 0.7708 NDCG: 0.8440
Validation loss decreased (0.953053 --> 0.940101).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8726 LRAP: 0.7441 NDCG: 0.8372
val Loss: 0.9464 LRAP: 0.7619 NDCG: 0.8383
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.8695 LRAP: 0.7438 NDCG: 0.8327
val Loss: 0.9382 LRAP: 0.7651 NDCG: 0.8338
Validation loss decreased (0.940101 --> 0.938181).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8581 LRAP: 0.7625 NDCG: 0.8404
val Loss: 0.9250 LRAP: 0.7799 NDCG: 0.8467
Validation loss decreased (0.938181 --> 0.925019).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8531 LRAP: 0.7535 NDCG: 0.8353
val Loss: 0.9325 LRAP: 0.7673 NDCG: 0.8400
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.8462 LRAP: 0.7628 NDCG: 0.8324
val Loss: 0.9363 LRAP: 0.7888 NDCG: 0.8422
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 0.8400 LRAP: 0.7635 NDCG: 0.8291
val Loss: 0.9343 LRAP: 0.7987 NDCG: 0.8452
EarlyStopping counter: 3 out of 25

Epoch 21/99
----------
train Loss: 0.8304 LRAP: 0.7677 NDCG: 0.8245
val Loss: 0.9277 LRAP: 0.7959 NDCG: 0.8439
EarlyStopping counter: 4 out of 25

Epoch 22/99
----------
train Loss: 0.8285 LRAP: 0.7725 NDCG: 0.8210
val Loss: 0.9272 LRAP: 0.7708 NDCG: 0.8303
EarlyStopping counter: 5 out of 25

Epoch 23/99
----------
train Loss: 0.8076 LRAP: 0.7811 NDCG: 0.8255
val Loss: 0.9072 LRAP: 0.7890 NDCG: 0.8405
Validation loss decreased (0.925019 --> 0.907247).  Saving model ...

Epoch 24/99
----------
train Loss: 0.7978 LRAP: 0.7776 NDCG: 0.8248
val Loss: 0.9070 LRAP: 0.8019 NDCG: 0.8430
Validation loss decreased (0.907247 --> 0.907048).  Saving model ...

Epoch 25/99
----------
train Loss: 0.7951 LRAP: 0.7889 NDCG: 0.8262
val Loss: 0.9051 LRAP: 0.8007 NDCG: 0.8353
Validation loss decreased (0.907048 --> 0.905101).  Saving model ...

Epoch 26/99
----------
train Loss: 0.7917 LRAP: 0.7848 NDCG: 0.8124
val Loss: 0.9060 LRAP: 0.7993 NDCG: 0.8383
EarlyStopping counter: 1 out of 25

Epoch 27/99
----------
train Loss: 0.7896 LRAP: 0.7927 NDCG: 0.8241
val Loss: 0.9083 LRAP: 0.7993 NDCG: 0.8316
EarlyStopping counter: 2 out of 25

Epoch 28/99
----------
train Loss: 0.7887 LRAP: 0.7898 NDCG: 0.8173
val Loss: 0.9035 LRAP: 0.7990 NDCG: 0.8318
Validation loss decreased (0.905101 --> 0.903505).  Saving model ...

Epoch 29/99
----------
train Loss: 0.7869 LRAP: 0.7904 NDCG: 0.8142
val Loss: 0.9087 LRAP: 0.8053 NDCG: 0.8266
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.7842 LRAP: 0.7902 NDCG: 0.8106
val Loss: 0.9038 LRAP: 0.7888 NDCG: 0.8271
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.7836 LRAP: 0.7909 NDCG: 0.8172
val Loss: 0.9034 LRAP: 0.8093 NDCG: 0.8359
Validation loss decreased (0.903505 --> 0.903374).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7807 LRAP: 0.7907 NDCG: 0.8177
val Loss: 0.9067 LRAP: 0.8176 NDCG: 0.8359
EarlyStopping counter: 1 out of 25

Epoch 33/99
----------
train Loss: 0.7761 LRAP: 0.7963 NDCG: 0.8153
val Loss: 0.9084 LRAP: 0.8033 NDCG: 0.8314
EarlyStopping counter: 2 out of 25

Epoch 34/99
----------
train Loss: 0.7755 LRAP: 0.7978 NDCG: 0.8166
val Loss: 0.9065 LRAP: 0.8142 NDCG: 0.8376
EarlyStopping counter: 3 out of 25

Epoch 35/99
----------
train Loss: 0.7738 LRAP: 0.7975 NDCG: 0.8138
val Loss: 0.9080 LRAP: 0.8022 NDCG: 0.8246
EarlyStopping counter: 4 out of 25

Epoch 36/99
----------
train Loss: 0.7731 LRAP: 0.7959 NDCG: 0.8181
val Loss: 0.9116 LRAP: 0.8110 NDCG: 0.8327
EarlyStopping counter: 5 out of 25

Epoch 37/99
----------
train Loss: 0.7656 LRAP: 0.8014 NDCG: 0.8139
val Loss: 0.9066 LRAP: 0.8142 NDCG: 0.8357
EarlyStopping counter: 6 out of 25

Epoch 38/99
----------
train Loss: 0.7630 LRAP: 0.8057 NDCG: 0.8146
val Loss: 0.9076 LRAP: 0.8187 NDCG: 0.8384
EarlyStopping counter: 7 out of 25

Epoch 39/99
----------
train Loss: 0.7648 LRAP: 0.8027 NDCG: 0.8173
val Loss: 0.9071 LRAP: 0.8219 NDCG: 0.8379
EarlyStopping counter: 8 out of 25

Epoch 40/99
----------
train Loss: 0.7618 LRAP: 0.8046 NDCG: 0.8165
val Loss: 0.9066 LRAP: 0.8182 NDCG: 0.8335
EarlyStopping counter: 9 out of 25

Epoch 41/99
----------
train Loss: 0.7602 LRAP: 0.7980 NDCG: 0.8099
val Loss: 0.9057 LRAP: 0.8170 NDCG: 0.8351
EarlyStopping counter: 10 out of 25

Epoch 42/99
----------
train Loss: 0.7598 LRAP: 0.8052 NDCG: 0.8163
val Loss: 0.9074 LRAP: 0.8173 NDCG: 0.8315
EarlyStopping counter: 11 out of 25

Epoch 43/99
----------
train Loss: 0.7606 LRAP: 0.8030 NDCG: 0.8136
val Loss: 0.9060 LRAP: 0.8202 NDCG: 0.8353
EarlyStopping counter: 12 out of 25

Epoch 44/99
----------
train Loss: 0.7604 LRAP: 0.8040 NDCG: 0.8135
val Loss: 0.9044 LRAP: 0.8150 NDCG: 0.8319
EarlyStopping counter: 13 out of 25

Epoch 45/99
----------
train Loss: 0.7609 LRAP: 0.8036 NDCG: 0.8147
val Loss: 0.9049 LRAP: 0.8202 NDCG: 0.8359
EarlyStopping counter: 14 out of 25

Epoch 46/99
----------
train Loss: 0.7574 LRAP: 0.8046 NDCG: 0.8123
val Loss: 0.9054 LRAP: 0.8182 NDCG: 0.8361
EarlyStopping counter: 15 out of 25

Epoch 47/99
----------
train Loss: 0.7598 LRAP: 0.8055 NDCG: 0.8149
val Loss: 0.9082 LRAP: 0.8182 NDCG: 0.8336
EarlyStopping counter: 16 out of 25

Epoch 48/99
----------
train Loss: 0.7591 LRAP: 0.7997 NDCG: 0.8126
val Loss: 0.9078 LRAP: 0.8159 NDCG: 0.8312
EarlyStopping counter: 17 out of 25

Epoch 49/99
----------
train Loss: 0.7594 LRAP: 0.8022 NDCG: 0.8101
val Loss: 0.9072 LRAP: 0.8204 NDCG: 0.8361
EarlyStopping counter: 18 out of 25

Epoch 50/99
----------
train Loss: 0.7600 LRAP: 0.8022 NDCG: 0.8119
val Loss: 0.9067 LRAP: 0.8136 NDCG: 0.8298
EarlyStopping counter: 19 out of 25

Epoch 51/99
----------
train Loss: 0.7594 LRAP: 0.8005 NDCG: 0.8113
val Loss: 0.9072 LRAP: 0.8204 NDCG: 0.8353
EarlyStopping counter: 20 out of 25

Epoch 52/99
----------
train Loss: 0.7591 LRAP: 0.8005 NDCG: 0.8145
val Loss: 0.9078 LRAP: 0.8156 NDCG: 0.8294
EarlyStopping counter: 21 out of 25

Epoch 53/99
----------
train Loss: 0.7590 LRAP: 0.8005 NDCG: 0.8125
val Loss: 0.9065 LRAP: 0.8173 NDCG: 0.8340
EarlyStopping counter: 22 out of 25

Epoch 54/99
----------
train Loss: 0.7600 LRAP: 0.8017 NDCG: 0.8128
val Loss: 0.9070 LRAP: 0.8199 NDCG: 0.8346
EarlyStopping counter: 23 out of 25

Epoch 55/99
----------
train Loss: 0.7581 LRAP: 0.8017 NDCG: 0.8159
val Loss: 0.9091 LRAP: 0.8147 NDCG: 0.8276
EarlyStopping counter: 24 out of 25

Epoch 56/99
----------
train Loss: 0.7591 LRAP: 0.8016 NDCG: 0.8148
val Loss: 0.9070 LRAP: 0.8216 NDCG: 0.8377
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 7m 23s
Best val loss: 0.903374, best LRAP score: 0.9588

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7505 LRAP: 0.2312 NDCG: 0.5822
val Loss: 1.3987 LRAP: 0.6120 NDCG: 0.6863
Validation loss decreased (0.000000 --> 1.398663).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2232 LRAP: 0.6413 NDCG: 0.7191
val Loss: 2.2840 LRAP: 0.2552 NDCG: 0.4116
EarlyStopping counter: 1 out of 25

Epoch 2/99
----------
train Loss: 1.1585 LRAP: 0.6647 NDCG: 0.7421
val Loss: 1.3492 LRAP: 0.6900 NDCG: 0.7573
Validation loss decreased (1.398663 --> 1.349173).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1201 LRAP: 0.6745 NDCG: 0.7562
val Loss: 1.1661 LRAP: 0.6143 NDCG: 0.7458
Validation loss decreased (1.349173 --> 1.166121).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0957 LRAP: 0.6875 NDCG: 0.7653
val Loss: 1.1883 LRAP: 0.4910 NDCG: 0.7150
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.0834 LRAP: 0.6885 NDCG: 0.7748
val Loss: 1.0578 LRAP: 0.6971 NDCG: 0.7745
Validation loss decreased (1.166121 --> 1.057800).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0620 LRAP: 0.6937 NDCG: 0.7796
val Loss: 1.6581 LRAP: 0.3540 NDCG: 0.6195
EarlyStopping counter: 1 out of 25

Epoch 7/99
----------
train Loss: 1.0561 LRAP: 0.6942 NDCG: 0.7811
val Loss: 1.0956 LRAP: 0.6092 NDCG: 0.7472
EarlyStopping counter: 2 out of 25

Epoch 8/99
----------
train Loss: 1.0274 LRAP: 0.7005 NDCG: 0.7891
val Loss: 1.0764 LRAP: 0.7165 NDCG: 0.7969
EarlyStopping counter: 3 out of 25

Epoch 9/99
----------
train Loss: 1.0273 LRAP: 0.7046 NDCG: 0.7898
val Loss: 1.1884 LRAP: 0.5515 NDCG: 0.7335
EarlyStopping counter: 4 out of 25

Epoch 10/99
----------
train Loss: 1.0150 LRAP: 0.7022 NDCG: 0.7903
val Loss: 1.0718 LRAP: 0.7085 NDCG: 0.7816
EarlyStopping counter: 5 out of 25

Epoch 11/99
----------
train Loss: 0.9920 LRAP: 0.7152 NDCG: 0.8010
val Loss: 1.0164 LRAP: 0.7337 NDCG: 0.8067
Validation loss decreased (1.057800 --> 1.016439).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9765 LRAP: 0.7162 NDCG: 0.8040
val Loss: 1.0035 LRAP: 0.7305 NDCG: 0.8097
Validation loss decreased (1.016439 --> 1.003515).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9719 LRAP: 0.7119 NDCG: 0.8034
val Loss: 1.0156 LRAP: 0.7231 NDCG: 0.8078
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.9706 LRAP: 0.7156 NDCG: 0.8041
val Loss: 0.9925 LRAP: 0.7314 NDCG: 0.8119
Validation loss decreased (1.003515 --> 0.992476).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9699 LRAP: 0.7170 NDCG: 0.8052
val Loss: 0.9992 LRAP: 0.7297 NDCG: 0.8125
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.9672 LRAP: 0.7189 NDCG: 0.8059
val Loss: 0.9887 LRAP: 0.7317 NDCG: 0.8147
Validation loss decreased (0.992476 --> 0.988682).  Saving model ...

Epoch 17/99
----------
train Loss: 0.9579 LRAP: 0.7206 NDCG: 0.8105
val Loss: 0.9912 LRAP: 0.7397 NDCG: 0.8065
EarlyStopping counter: 1 out of 25

Epoch 18/99
----------
train Loss: 0.9560 LRAP: 0.7220 NDCG: 0.8106
val Loss: 0.9828 LRAP: 0.7391 NDCG: 0.8227
Validation loss decreased (0.988682 --> 0.982795).  Saving model ...

Epoch 19/99
----------
train Loss: 0.9480 LRAP: 0.7274 NDCG: 0.8130
val Loss: 0.9763 LRAP: 0.7411 NDCG: 0.8172
Validation loss decreased (0.982795 --> 0.976313).  Saving model ...

Epoch 20/99
----------
train Loss: 0.9397 LRAP: 0.7291 NDCG: 0.8159
val Loss: 0.9722 LRAP: 0.7436 NDCG: 0.8233
Validation loss decreased (0.976313 --> 0.972151).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9463 LRAP: 0.7230 NDCG: 0.8136
val Loss: 0.9880 LRAP: 0.7325 NDCG: 0.8153
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.9385 LRAP: 0.7257 NDCG: 0.8158
val Loss: 0.9694 LRAP: 0.7422 NDCG: 0.8195
Validation loss decreased (0.972151 --> 0.969434).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9372 LRAP: 0.7282 NDCG: 0.8177
val Loss: 0.9710 LRAP: 0.7471 NDCG: 0.8222
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.9293 LRAP: 0.7302 NDCG: 0.8194
val Loss: 0.9846 LRAP: 0.7431 NDCG: 0.8182
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.9279 LRAP: 0.7337 NDCG: 0.8199
val Loss: 0.9690 LRAP: 0.7357 NDCG: 0.8212
Validation loss decreased (0.969434 --> 0.969008).  Saving model ...

Epoch 26/99
----------
train Loss: 0.9214 LRAP: 0.7346 NDCG: 0.8230
val Loss: 0.9649 LRAP: 0.7482 NDCG: 0.8282
Validation loss decreased (0.969008 --> 0.964929).  Saving model ...

Epoch 27/99
----------
train Loss: 0.9224 LRAP: 0.7331 NDCG: 0.8214
val Loss: 0.9633 LRAP: 0.7351 NDCG: 0.8230
Validation loss decreased (0.964929 --> 0.963260).  Saving model ...

Epoch 28/99
----------
train Loss: 0.9156 LRAP: 0.7364 NDCG: 0.8244
val Loss: 0.9531 LRAP: 0.7565 NDCG: 0.8339
Validation loss decreased (0.963260 --> 0.953112).  Saving model ...

Epoch 29/99
----------
train Loss: 0.9180 LRAP: 0.7381 NDCG: 0.8247
val Loss: 0.9649 LRAP: 0.7548 NDCG: 0.8321
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.9135 LRAP: 0.7387 NDCG: 0.8260
val Loss: 0.9635 LRAP: 0.7608 NDCG: 0.8335
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.9094 LRAP: 0.7436 NDCG: 0.8278
val Loss: 0.9466 LRAP: 0.7531 NDCG: 0.8319
Validation loss decreased (0.953112 --> 0.946554).  Saving model ...

Epoch 32/99
----------
train Loss: 0.9066 LRAP: 0.7391 NDCG: 0.8286
val Loss: 0.9462 LRAP: 0.7608 NDCG: 0.8383
Validation loss decreased (0.946554 --> 0.946195).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9027 LRAP: 0.7416 NDCG: 0.8295
val Loss: 0.9486 LRAP: 0.7516 NDCG: 0.8340
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.8989 LRAP: 0.7421 NDCG: 0.8298
val Loss: 0.9402 LRAP: 0.7582 NDCG: 0.8392
Validation loss decreased (0.946195 --> 0.940206).  Saving model ...

Epoch 35/99
----------
train Loss: 0.8998 LRAP: 0.7457 NDCG: 0.8315
val Loss: 0.9392 LRAP: 0.7562 NDCG: 0.8363
Validation loss decreased (0.940206 --> 0.939152).  Saving model ...

Epoch 36/99
----------
train Loss: 0.8942 LRAP: 0.7450 NDCG: 0.8319
val Loss: 0.9369 LRAP: 0.7639 NDCG: 0.8406
Validation loss decreased (0.939152 --> 0.936947).  Saving model ...

Epoch 37/99
----------
train Loss: 0.8884 LRAP: 0.7475 NDCG: 0.8333
val Loss: 0.9430 LRAP: 0.7496 NDCG: 0.8336
EarlyStopping counter: 1 out of 25

Epoch 38/99
----------
train Loss: 0.8872 LRAP: 0.7542 NDCG: 0.8378
val Loss: 0.9419 LRAP: 0.7728 NDCG: 0.8443
EarlyStopping counter: 2 out of 25

Epoch 39/99
----------
train Loss: 0.8854 LRAP: 0.7520 NDCG: 0.8368
val Loss: 0.9384 LRAP: 0.7608 NDCG: 0.8407
EarlyStopping counter: 3 out of 25

Epoch 40/99
----------
train Loss: 0.8852 LRAP: 0.7540 NDCG: 0.8367
val Loss: 0.9498 LRAP: 0.7531 NDCG: 0.8331
EarlyStopping counter: 4 out of 25

Epoch 41/99
----------
train Loss: 0.8858 LRAP: 0.7583 NDCG: 0.8384
val Loss: 0.9441 LRAP: 0.7605 NDCG: 0.8366
EarlyStopping counter: 5 out of 25

Epoch 42/99
----------
train Loss: 0.8759 LRAP: 0.7544 NDCG: 0.8376
val Loss: 0.9259 LRAP: 0.7708 NDCG: 0.8441
Validation loss decreased (0.936947 --> 0.925913).  Saving model ...

Epoch 43/99
----------
train Loss: 0.8705 LRAP: 0.7630 NDCG: 0.8416
val Loss: 0.9281 LRAP: 0.7685 NDCG: 0.8426
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.8691 LRAP: 0.7594 NDCG: 0.8421
val Loss: 0.9311 LRAP: 0.7716 NDCG: 0.8438
EarlyStopping counter: 2 out of 25

Epoch 45/99
----------
train Loss: 0.8708 LRAP: 0.7619 NDCG: 0.8417
val Loss: 0.9270 LRAP: 0.7696 NDCG: 0.8427
EarlyStopping counter: 3 out of 25

Epoch 46/99
----------
train Loss: 0.8707 LRAP: 0.7616 NDCG: 0.8414
val Loss: 0.9260 LRAP: 0.7731 NDCG: 0.8439
EarlyStopping counter: 4 out of 25

Epoch 47/99
----------
train Loss: 0.8673 LRAP: 0.7627 NDCG: 0.8434
val Loss: 0.9244 LRAP: 0.7753 NDCG: 0.8468
Validation loss decreased (0.925913 --> 0.924433).  Saving model ...

Epoch 48/99
----------
train Loss: 0.8673 LRAP: 0.7644 NDCG: 0.8433
val Loss: 0.9245 LRAP: 0.7719 NDCG: 0.8456
EarlyStopping counter: 1 out of 25

Epoch 49/99
----------
train Loss: 0.8645 LRAP: 0.7620 NDCG: 0.8431
val Loss: 0.9217 LRAP: 0.7745 NDCG: 0.8460
Validation loss decreased (0.924433 --> 0.921728).  Saving model ...

Epoch 50/99
----------
train Loss: 0.8630 LRAP: 0.7641 NDCG: 0.8444
val Loss: 0.9250 LRAP: 0.7773 NDCG: 0.8469
EarlyStopping counter: 1 out of 25

Epoch 51/99
----------
train Loss: 0.8645 LRAP: 0.7655 NDCG: 0.8438
val Loss: 0.9242 LRAP: 0.7776 NDCG: 0.8477
EarlyStopping counter: 2 out of 25

Epoch 52/99
----------
train Loss: 0.8619 LRAP: 0.7644 NDCG: 0.8437
val Loss: 0.9211 LRAP: 0.7785 NDCG: 0.8478
Validation loss decreased (0.921728 --> 0.921053).  Saving model ...

Epoch 53/99
----------
train Loss: 0.8635 LRAP: 0.7656 NDCG: 0.8434
val Loss: 0.9241 LRAP: 0.7782 NDCG: 0.8473
EarlyStopping counter: 1 out of 25

Epoch 54/99
----------
train Loss: 0.8638 LRAP: 0.7666 NDCG: 0.8433
val Loss: 0.9232 LRAP: 0.7750 NDCG: 0.8466
EarlyStopping counter: 2 out of 25

Epoch 55/99
----------
train Loss: 0.8642 LRAP: 0.7664 NDCG: 0.8450
val Loss: 0.9237 LRAP: 0.7799 NDCG: 0.8489
EarlyStopping counter: 3 out of 25

Epoch 56/99
----------
train Loss: 0.8618 LRAP: 0.7651 NDCG: 0.8451
val Loss: 0.9238 LRAP: 0.7770 NDCG: 0.8497
EarlyStopping counter: 4 out of 25

Epoch 57/99
----------
train Loss: 0.8601 LRAP: 0.7676 NDCG: 0.8433
val Loss: 0.9257 LRAP: 0.7759 NDCG: 0.8468
EarlyStopping counter: 5 out of 25

Epoch 58/99
----------
train Loss: 0.8589 LRAP: 0.7698 NDCG: 0.8461
val Loss: 0.9221 LRAP: 0.7808 NDCG: 0.8476
EarlyStopping counter: 6 out of 25

Epoch 59/99
----------
train Loss: 0.8559 LRAP: 0.7670 NDCG: 0.8449
val Loss: 0.9218 LRAP: 0.7765 NDCG: 0.8463
EarlyStopping counter: 7 out of 25

Epoch 60/99
----------
train Loss: 0.8554 LRAP: 0.7703 NDCG: 0.8442
val Loss: 0.9226 LRAP: 0.7753 NDCG: 0.8471
EarlyStopping counter: 8 out of 25

Epoch 61/99
----------
train Loss: 0.8589 LRAP: 0.7667 NDCG: 0.8449
val Loss: 0.9208 LRAP: 0.7788 NDCG: 0.8484
Validation loss decreased (0.921053 --> 0.920789).  Saving model ...

Epoch 62/99
----------
train Loss: 0.8574 LRAP: 0.7676 NDCG: 0.8451
val Loss: 0.9209 LRAP: 0.7788 NDCG: 0.8476
EarlyStopping counter: 1 out of 25

Epoch 63/99
----------
train Loss: 0.8564 LRAP: 0.7698 NDCG: 0.8458
val Loss: 0.9221 LRAP: 0.7825 NDCG: 0.8489
EarlyStopping counter: 2 out of 25

Epoch 64/99
----------
train Loss: 0.8573 LRAP: 0.7663 NDCG: 0.8433
val Loss: 0.9213 LRAP: 0.7810 NDCG: 0.8479
EarlyStopping counter: 3 out of 25

Epoch 65/99
----------
train Loss: 0.8570 LRAP: 0.7715 NDCG: 0.8473
val Loss: 0.9203 LRAP: 0.7808 NDCG: 0.8483
Validation loss decreased (0.920789 --> 0.920257).  Saving model ...

Epoch 66/99
----------
train Loss: 0.8560 LRAP: 0.7650 NDCG: 0.8440
val Loss: 0.9222 LRAP: 0.7819 NDCG: 0.8485
EarlyStopping counter: 1 out of 25

Epoch 67/99
----------
train Loss: 0.8565 LRAP: 0.7704 NDCG: 0.8472
val Loss: 0.9215 LRAP: 0.7765 NDCG: 0.8475
EarlyStopping counter: 2 out of 25

Epoch 68/99
----------
train Loss: 0.8566 LRAP: 0.7694 NDCG: 0.8446
val Loss: 0.9214 LRAP: 0.7799 NDCG: 0.8480
EarlyStopping counter: 3 out of 25

Epoch 69/99
----------
train Loss: 0.8580 LRAP: 0.7677 NDCG: 0.8467
val Loss: 0.9215 LRAP: 0.7813 NDCG: 0.8480
EarlyStopping counter: 4 out of 25

Epoch 70/99
----------
train Loss: 0.8548 LRAP: 0.7706 NDCG: 0.8451
val Loss: 0.9195 LRAP: 0.7808 NDCG: 0.8493
Validation loss decreased (0.920257 --> 0.919542).  Saving model ...

Epoch 71/99
----------
train Loss: 0.8551 LRAP: 0.7678 NDCG: 0.8442
val Loss: 0.9210 LRAP: 0.7779 NDCG: 0.8476
EarlyStopping counter: 1 out of 25

Epoch 72/99
----------
train Loss: 0.8546 LRAP: 0.7690 NDCG: 0.8452
val Loss: 0.9222 LRAP: 0.7819 NDCG: 0.8490
EarlyStopping counter: 2 out of 25

Epoch 73/99
----------
train Loss: 0.8553 LRAP: 0.7689 NDCG: 0.8458
val Loss: 0.9207 LRAP: 0.7813 NDCG: 0.8487
EarlyStopping counter: 3 out of 25

Epoch 74/99
----------
train Loss: 0.8552 LRAP: 0.7683 NDCG: 0.8452
val Loss: 0.9212 LRAP: 0.7759 NDCG: 0.8469
EarlyStopping counter: 4 out of 25

Epoch 75/99
----------
train Loss: 0.8556 LRAP: 0.7668 NDCG: 0.8450
val Loss: 0.9207 LRAP: 0.7828 NDCG: 0.8496
EarlyStopping counter: 5 out of 25

Epoch 76/99
----------
train Loss: 0.8540 LRAP: 0.7703 NDCG: 0.8473
val Loss: 0.9226 LRAP: 0.7765 NDCG: 0.8467
EarlyStopping counter: 6 out of 25

Epoch 77/99
----------
train Loss: 0.8553 LRAP: 0.7686 NDCG: 0.8449
val Loss: 0.9210 LRAP: 0.7790 NDCG: 0.8485
EarlyStopping counter: 7 out of 25

Epoch 78/99
----------
train Loss: 0.8546 LRAP: 0.7682 NDCG: 0.8434
val Loss: 0.9206 LRAP: 0.7810 NDCG: 0.8483
EarlyStopping counter: 8 out of 25

Epoch 79/99
----------
train Loss: 0.8550 LRAP: 0.7670 NDCG: 0.8444
val Loss: 0.9218 LRAP: 0.7808 NDCG: 0.8486
EarlyStopping counter: 9 out of 25

Epoch 80/99
----------
train Loss: 0.8537 LRAP: 0.7688 NDCG: 0.8435
val Loss: 0.9212 LRAP: 0.7805 NDCG: 0.8486
EarlyStopping counter: 10 out of 25

Epoch 81/99
----------
train Loss: 0.8543 LRAP: 0.7679 NDCG: 0.8431
val Loss: 0.9202 LRAP: 0.7828 NDCG: 0.8496
EarlyStopping counter: 11 out of 25

Epoch 82/99
----------
train Loss: 0.8525 LRAP: 0.7728 NDCG: 0.8464
val Loss: 0.9208 LRAP: 0.7810 NDCG: 0.8492
EarlyStopping counter: 12 out of 25

Epoch 83/99
----------
train Loss: 0.8550 LRAP: 0.7729 NDCG: 0.8475
val Loss: 0.9205 LRAP: 0.7813 NDCG: 0.8482
EarlyStopping counter: 13 out of 25

Epoch 84/99
----------
train Loss: 0.8561 LRAP: 0.7671 NDCG: 0.8437
val Loss: 0.9212 LRAP: 0.7810 NDCG: 0.8501
EarlyStopping counter: 14 out of 25

Epoch 85/99
----------
train Loss: 0.8544 LRAP: 0.7696 NDCG: 0.8461
val Loss: 0.9212 LRAP: 0.7810 NDCG: 0.8489
EarlyStopping counter: 15 out of 25

Epoch 86/99
----------
train Loss: 0.8536 LRAP: 0.7686 NDCG: 0.8446
val Loss: 0.9204 LRAP: 0.7816 NDCG: 0.8489
EarlyStopping counter: 16 out of 25

Epoch 87/99
----------
train Loss: 0.8525 LRAP: 0.7678 NDCG: 0.8434
val Loss: 0.9203 LRAP: 0.7828 NDCG: 0.8496
EarlyStopping counter: 17 out of 25

Epoch 88/99
----------
train Loss: 0.8532 LRAP: 0.7712 NDCG: 0.8469
val Loss: 0.9204 LRAP: 0.7796 NDCG: 0.8486
EarlyStopping counter: 18 out of 25

Epoch 89/99
----------
train Loss: 0.8573 LRAP: 0.7687 NDCG: 0.8442
val Loss: 0.9214 LRAP: 0.7805 NDCG: 0.8486
EarlyStopping counter: 19 out of 25

Epoch 90/99
----------
train Loss: 0.8536 LRAP: 0.7698 NDCG: 0.8466
val Loss: 0.9214 LRAP: 0.7816 NDCG: 0.8489
EarlyStopping counter: 20 out of 25

Epoch 91/99
----------
train Loss: 0.8535 LRAP: 0.7713 NDCG: 0.8459
val Loss: 0.9206 LRAP: 0.7779 NDCG: 0.8480
EarlyStopping counter: 21 out of 25

Epoch 92/99
----------
train Loss: 0.8542 LRAP: 0.7719 NDCG: 0.8459
val Loss: 0.9200 LRAP: 0.7813 NDCG: 0.8489
EarlyStopping counter: 22 out of 25

Epoch 93/99
----------
train Loss: 0.8539 LRAP: 0.7670 NDCG: 0.8454
val Loss: 0.9213 LRAP: 0.7813 NDCG: 0.8493
EarlyStopping counter: 23 out of 25

Epoch 94/99
----------
train Loss: 0.8570 LRAP: 0.7699 NDCG: 0.8451
val Loss: 0.9204 LRAP: 0.7825 NDCG: 0.8491
EarlyStopping counter: 24 out of 25

Epoch 95/99
----------
train Loss: 0.8538 LRAP: 0.7743 NDCG: 0.8474
val Loss: 0.9205 LRAP: 0.7785 NDCG: 0.8481
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 10m 58s
Best val loss: 0.919542, best LRAP score: 0.9586

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.8553 LRAP: 0.1769 NDCG: 0.5638
val Loss: 3.2167 LRAP: 0.0243 NDCG: 0.2504
Validation loss decreased (0.000000 --> 3.216660).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3326 LRAP: 0.5842 NDCG: 0.6840
val Loss: 1.3627 LRAP: 0.6360 NDCG: 0.6911
Validation loss decreased (3.216660 --> 1.362715).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2630 LRAP: 0.6099 NDCG: 0.7004
val Loss: 2.0676 LRAP: 0.1661 NDCG: 0.5086
EarlyStopping counter: 1 out of 25

Epoch 3/99
----------
train Loss: 1.2229 LRAP: 0.6248 NDCG: 0.7136
val Loss: 1.3424 LRAP: 0.5789 NDCG: 0.6805
Validation loss decreased (1.362715 --> 1.342405).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1885 LRAP: 0.6196 NDCG: 0.7229
val Loss: 1.4481 LRAP: 0.3580 NDCG: 0.6158
EarlyStopping counter: 1 out of 25

Epoch 5/99
----------
train Loss: 1.1734 LRAP: 0.6217 NDCG: 0.7278
val Loss: 1.2507 LRAP: 0.6300 NDCG: 0.7249
Validation loss decreased (1.342405 --> 1.250702).  Saving model ...

Epoch 6/99
----------
train Loss: 1.1543 LRAP: 0.6291 NDCG: 0.7349
val Loss: 1.1659 LRAP: 0.6489 NDCG: 0.7397
Validation loss decreased (1.250702 --> 1.165949).  Saving model ...

Epoch 7/99
----------
train Loss: 1.1406 LRAP: 0.6307 NDCG: 0.7416
val Loss: 1.1443 LRAP: 0.6312 NDCG: 0.7337
Validation loss decreased (1.165949 --> 1.144337).  Saving model ...

Epoch 8/99
----------
train Loss: 1.1228 LRAP: 0.6332 NDCG: 0.7477
val Loss: 1.3163 LRAP: 0.5327 NDCG: 0.7245
EarlyStopping counter: 1 out of 25

Epoch 9/99
----------
train Loss: 1.1207 LRAP: 0.6316 NDCG: 0.7495
val Loss: 1.3742 LRAP: 0.6674 NDCG: 0.7633
EarlyStopping counter: 2 out of 25

Epoch 10/99
----------
train Loss: 1.1038 LRAP: 0.6408 NDCG: 0.7567
val Loss: 1.3800 LRAP: 0.4647 NDCG: 0.6819
EarlyStopping counter: 3 out of 25

Epoch 11/99
----------
train Loss: 1.1019 LRAP: 0.6421 NDCG: 0.7611
val Loss: 1.1609 LRAP: 0.4822 NDCG: 0.7123
EarlyStopping counter: 4 out of 25

Epoch 12/99
----------
train Loss: 1.0916 LRAP: 0.6477 NDCG: 0.7634
val Loss: 1.1010 LRAP: 0.6432 NDCG: 0.7656
Validation loss decreased (1.144337 --> 1.100952).  Saving model ...

Epoch 13/99
----------
train Loss: 1.0777 LRAP: 0.6537 NDCG: 0.7692
val Loss: 1.1028 LRAP: 0.6637 NDCG: 0.7758
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 1.0722 LRAP: 0.6451 NDCG: 0.7674
val Loss: 1.1300 LRAP: 0.5969 NDCG: 0.7543
EarlyStopping counter: 2 out of 25

Epoch 15/99
----------
train Loss: 1.0681 LRAP: 0.6500 NDCG: 0.7699
val Loss: 1.0712 LRAP: 0.6360 NDCG: 0.7730
Validation loss decreased (1.100952 --> 1.071200).  Saving model ...

Epoch 16/99
----------
train Loss: 1.0615 LRAP: 0.6444 NDCG: 0.7665
val Loss: 1.0712 LRAP: 0.5864 NDCG: 0.7523
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 1.0517 LRAP: 0.6497 NDCG: 0.7674
val Loss: 1.1200 LRAP: 0.6794 NDCG: 0.7743
EarlyStopping counter: 2 out of 25

Epoch 18/99
----------
train Loss: 1.0399 LRAP: 0.6598 NDCG: 0.7678
val Loss: 1.1000 LRAP: 0.6420 NDCG: 0.7624
EarlyStopping counter: 3 out of 25

Epoch 19/99
----------
train Loss: 1.0406 LRAP: 0.6601 NDCG: 0.7711
val Loss: 1.2439 LRAP: 0.6226 NDCG: 0.7333
EarlyStopping counter: 4 out of 25

Epoch 20/99
----------
train Loss: 1.0335 LRAP: 0.6671 NDCG: 0.7676
val Loss: 1.0426 LRAP: 0.6868 NDCG: 0.7861
Validation loss decreased (1.071200 --> 1.042568).  Saving model ...

Epoch 21/99
----------
train Loss: 1.0237 LRAP: 0.6618 NDCG: 0.7690
val Loss: 1.0522 LRAP: 0.6866 NDCG: 0.7908
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 1.0180 LRAP: 0.6639 NDCG: 0.7617
val Loss: 1.1547 LRAP: 0.5926 NDCG: 0.7655
EarlyStopping counter: 2 out of 25

Epoch 23/99
----------
train Loss: 1.0125 LRAP: 0.6623 NDCG: 0.7641
val Loss: 1.0556 LRAP: 0.6868 NDCG: 0.7751
EarlyStopping counter: 3 out of 25

Epoch 24/99
----------
train Loss: 1.0071 LRAP: 0.6649 NDCG: 0.7668
val Loss: 1.1007 LRAP: 0.6200 NDCG: 0.7498
EarlyStopping counter: 4 out of 25

Epoch 25/99
----------
train Loss: 0.9979 LRAP: 0.6686 NDCG: 0.7637
val Loss: 1.0587 LRAP: 0.4930 NDCG: 0.7054
EarlyStopping counter: 5 out of 25

Epoch 26/99
----------
train Loss: 0.9672 LRAP: 0.6792 NDCG: 0.7662
val Loss: 0.9948 LRAP: 0.7134 NDCG: 0.7927
Validation loss decreased (1.042568 --> 0.994758).  Saving model ...

Epoch 27/99
----------
train Loss: 0.9626 LRAP: 0.6872 NDCG: 0.7722
val Loss: 0.9902 LRAP: 0.7185 NDCG: 0.7981
Validation loss decreased (0.994758 --> 0.990186).  Saving model ...

Epoch 28/99
----------
train Loss: 0.9565 LRAP: 0.6879 NDCG: 0.7722
val Loss: 0.9883 LRAP: 0.7234 NDCG: 0.7983
Validation loss decreased (0.990186 --> 0.988289).  Saving model ...

Epoch 29/99
----------
train Loss: 0.9563 LRAP: 0.6882 NDCG: 0.7693
val Loss: 0.9918 LRAP: 0.7277 NDCG: 0.8046
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.9532 LRAP: 0.6903 NDCG: 0.7721
val Loss: 0.9929 LRAP: 0.7217 NDCG: 0.7954
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.9510 LRAP: 0.6907 NDCG: 0.7711
val Loss: 0.9949 LRAP: 0.7097 NDCG: 0.7840
EarlyStopping counter: 3 out of 25

Epoch 32/99
----------
train Loss: 0.9477 LRAP: 0.6903 NDCG: 0.7712
val Loss: 0.9849 LRAP: 0.7294 NDCG: 0.8044
Validation loss decreased (0.988289 --> 0.984918).  Saving model ...

Epoch 33/99
----------
train Loss: 0.9429 LRAP: 0.6946 NDCG: 0.7713
val Loss: 0.9843 LRAP: 0.7254 NDCG: 0.8056
Validation loss decreased (0.984918 --> 0.984269).  Saving model ...

Epoch 34/99
----------
train Loss: 0.9426 LRAP: 0.6955 NDCG: 0.7725
val Loss: 0.9851 LRAP: 0.7377 NDCG: 0.8044
EarlyStopping counter: 1 out of 25

Epoch 35/99
----------
train Loss: 0.9432 LRAP: 0.6991 NDCG: 0.7765
val Loss: 0.9977 LRAP: 0.7439 NDCG: 0.8138
EarlyStopping counter: 2 out of 25

Epoch 36/99
----------
train Loss: 0.9383 LRAP: 0.7040 NDCG: 0.7788
val Loss: 0.9824 LRAP: 0.7334 NDCG: 0.7960
Validation loss decreased (0.984269 --> 0.982350).  Saving model ...

Epoch 37/99
----------
train Loss: 0.9338 LRAP: 0.7016 NDCG: 0.7753
val Loss: 0.9800 LRAP: 0.7345 NDCG: 0.8039
Validation loss decreased (0.982350 --> 0.979996).  Saving model ...

Epoch 38/99
----------
train Loss: 0.9344 LRAP: 0.6992 NDCG: 0.7740
val Loss: 0.9773 LRAP: 0.7419 NDCG: 0.8043
Validation loss decreased (0.979996 --> 0.977329).  Saving model ...

Epoch 39/99
----------
train Loss: 0.9351 LRAP: 0.7025 NDCG: 0.7767
val Loss: 0.9863 LRAP: 0.7308 NDCG: 0.7963
EarlyStopping counter: 1 out of 25

Epoch 40/99
----------
train Loss: 0.9302 LRAP: 0.7055 NDCG: 0.7817
val Loss: 0.9792 LRAP: 0.7382 NDCG: 0.8102
EarlyStopping counter: 2 out of 25

Epoch 41/99
----------
train Loss: 0.9298 LRAP: 0.7080 NDCG: 0.7796
val Loss: 0.9819 LRAP: 0.7474 NDCG: 0.8123
EarlyStopping counter: 3 out of 25

Epoch 42/99
----------
train Loss: 0.9280 LRAP: 0.7113 NDCG: 0.7809
val Loss: 0.9753 LRAP: 0.7474 NDCG: 0.8162
Validation loss decreased (0.977329 --> 0.975293).  Saving model ...

Epoch 43/99
----------
train Loss: 0.9263 LRAP: 0.7094 NDCG: 0.7786
val Loss: 0.9824 LRAP: 0.7354 NDCG: 0.8029
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.9230 LRAP: 0.7099 NDCG: 0.7801
val Loss: 0.9769 LRAP: 0.7417 NDCG: 0.8081
EarlyStopping counter: 2 out of 25

Epoch 45/99
----------
train Loss: 0.9267 LRAP: 0.7122 NDCG: 0.7813
val Loss: 0.9711 LRAP: 0.7451 NDCG: 0.8079
Validation loss decreased (0.975293 --> 0.971136).  Saving model ...

Epoch 46/99
----------
train Loss: 0.9209 LRAP: 0.7099 NDCG: 0.7796
val Loss: 0.9749 LRAP: 0.7479 NDCG: 0.8090
EarlyStopping counter: 1 out of 25

Epoch 47/99
----------
train Loss: 0.9199 LRAP: 0.7107 NDCG: 0.7813
val Loss: 0.9720 LRAP: 0.7571 NDCG: 0.8191
EarlyStopping counter: 2 out of 25

Epoch 48/99
----------
train Loss: 0.9165 LRAP: 0.7192 NDCG: 0.7775
val Loss: 0.9662 LRAP: 0.7462 NDCG: 0.8045
Validation loss decreased (0.971136 --> 0.966241).  Saving model ...

Epoch 49/99
----------
train Loss: 0.9153 LRAP: 0.7142 NDCG: 0.7828
val Loss: 0.9674 LRAP: 0.7448 NDCG: 0.8007
EarlyStopping counter: 1 out of 25

Epoch 50/99
----------
train Loss: 0.9132 LRAP: 0.7167 NDCG: 0.7794
val Loss: 0.9630 LRAP: 0.7554 NDCG: 0.8120
Validation loss decreased (0.966241 --> 0.962956).  Saving model ...

Epoch 51/99
----------
train Loss: 0.9132 LRAP: 0.7210 NDCG: 0.7828
val Loss: 0.9663 LRAP: 0.7511 NDCG: 0.8048
EarlyStopping counter: 1 out of 25

Epoch 52/99
----------
train Loss: 0.9098 LRAP: 0.7159 NDCG: 0.7796
val Loss: 0.9705 LRAP: 0.7568 NDCG: 0.8159
EarlyStopping counter: 2 out of 25

Epoch 53/99
----------
train Loss: 0.9083 LRAP: 0.7181 NDCG: 0.7794
val Loss: 0.9656 LRAP: 0.7528 NDCG: 0.8086
EarlyStopping counter: 3 out of 25

Epoch 54/99
----------
train Loss: 0.9077 LRAP: 0.7254 NDCG: 0.7858
val Loss: 0.9686 LRAP: 0.7548 NDCG: 0.8097
EarlyStopping counter: 4 out of 25

Epoch 55/99
----------
train Loss: 0.9041 LRAP: 0.7213 NDCG: 0.7818
val Loss: 0.9628 LRAP: 0.7545 NDCG: 0.8030
Validation loss decreased (0.962956 --> 0.962777).  Saving model ...

Epoch 56/99
----------
train Loss: 0.9051 LRAP: 0.7258 NDCG: 0.7867
val Loss: 0.9635 LRAP: 0.7534 NDCG: 0.8080
EarlyStopping counter: 1 out of 25

Epoch 57/99
----------
train Loss: 0.9027 LRAP: 0.7237 NDCG: 0.7820
val Loss: 0.9633 LRAP: 0.7602 NDCG: 0.8139
EarlyStopping counter: 2 out of 25

Epoch 58/99
----------
train Loss: 0.9032 LRAP: 0.7261 NDCG: 0.7877
val Loss: 0.9695 LRAP: 0.7499 NDCG: 0.7986
EarlyStopping counter: 3 out of 25

Epoch 59/99
----------
train Loss: 0.9022 LRAP: 0.7269 NDCG: 0.7840
val Loss: 0.9554 LRAP: 0.7562 NDCG: 0.8065
Validation loss decreased (0.962777 --> 0.955425).  Saving model ...

Epoch 60/99
----------
train Loss: 0.9022 LRAP: 0.7231 NDCG: 0.7809
val Loss: 0.9646 LRAP: 0.7562 NDCG: 0.8053
EarlyStopping counter: 1 out of 25

Epoch 61/99
----------
train Loss: 0.8969 LRAP: 0.7236 NDCG: 0.7782
val Loss: 0.9619 LRAP: 0.7622 NDCG: 0.8070
EarlyStopping counter: 2 out of 25

Epoch 62/99
----------
train Loss: 0.8965 LRAP: 0.7274 NDCG: 0.7817
val Loss: 0.9609 LRAP: 0.7556 NDCG: 0.8063
EarlyStopping counter: 3 out of 25

Epoch 63/99
----------
train Loss: 0.8947 LRAP: 0.7302 NDCG: 0.7896
val Loss: 0.9619 LRAP: 0.7516 NDCG: 0.8136
EarlyStopping counter: 4 out of 25

Epoch 64/99
----------
train Loss: 0.8906 LRAP: 0.7241 NDCG: 0.7797
val Loss: 0.9549 LRAP: 0.7611 NDCG: 0.8105
Validation loss decreased (0.955425 --> 0.954911).  Saving model ...

Epoch 65/99
----------
train Loss: 0.8920 LRAP: 0.7246 NDCG: 0.7821
val Loss: 0.9528 LRAP: 0.7599 NDCG: 0.8127
Validation loss decreased (0.954911 --> 0.952750).  Saving model ...

Epoch 66/99
----------
train Loss: 0.8882 LRAP: 0.7258 NDCG: 0.7837
val Loss: 0.9621 LRAP: 0.7456 NDCG: 0.8021
EarlyStopping counter: 1 out of 25

Epoch 67/99
----------
train Loss: 0.8887 LRAP: 0.7334 NDCG: 0.7834
val Loss: 0.9540 LRAP: 0.7642 NDCG: 0.8188
EarlyStopping counter: 2 out of 25

Epoch 68/99
----------
train Loss: 0.8898 LRAP: 0.7274 NDCG: 0.7842
val Loss: 0.9692 LRAP: 0.7365 NDCG: 0.7898
EarlyStopping counter: 3 out of 25

Epoch 69/99
----------
train Loss: 0.8880 LRAP: 0.7317 NDCG: 0.7829
val Loss: 0.9565 LRAP: 0.7531 NDCG: 0.8086
EarlyStopping counter: 4 out of 25

Epoch 70/99
----------
train Loss: 0.8834 LRAP: 0.7343 NDCG: 0.7825
val Loss: 0.9568 LRAP: 0.7596 NDCG: 0.8124
EarlyStopping counter: 5 out of 25

Epoch 71/99
----------
train Loss: 0.8798 LRAP: 0.7378 NDCG: 0.7921
val Loss: 0.9514 LRAP: 0.7671 NDCG: 0.8122
Validation loss decreased (0.952750 --> 0.951397).  Saving model ...

Epoch 72/99
----------
train Loss: 0.8753 LRAP: 0.7395 NDCG: 0.7851
val Loss: 0.9512 LRAP: 0.7656 NDCG: 0.8151
Validation loss decreased (0.951397 --> 0.951161).  Saving model ...

Epoch 73/99
----------
train Loss: 0.8761 LRAP: 0.7414 NDCG: 0.7886
val Loss: 0.9514 LRAP: 0.7596 NDCG: 0.8063
EarlyStopping counter: 1 out of 25

Epoch 74/99
----------
train Loss: 0.8711 LRAP: 0.7388 NDCG: 0.7844
val Loss: 0.9493 LRAP: 0.7653 NDCG: 0.8127
Validation loss decreased (0.951161 --> 0.949253).  Saving model ...

Epoch 75/99
----------
train Loss: 0.8736 LRAP: 0.7378 NDCG: 0.7861
val Loss: 0.9503 LRAP: 0.7665 NDCG: 0.8126
EarlyStopping counter: 1 out of 25

Epoch 76/99
----------
train Loss: 0.8725 LRAP: 0.7400 NDCG: 0.7824
val Loss: 0.9511 LRAP: 0.7648 NDCG: 0.8118
EarlyStopping counter: 2 out of 25

Epoch 77/99
----------
train Loss: 0.8711 LRAP: 0.7376 NDCG: 0.7819
val Loss: 0.9485 LRAP: 0.7653 NDCG: 0.8116
Validation loss decreased (0.949253 --> 0.948457).  Saving model ...

Epoch 78/99
----------
train Loss: 0.8706 LRAP: 0.7409 NDCG: 0.7875
val Loss: 0.9489 LRAP: 0.7631 NDCG: 0.8099
EarlyStopping counter: 1 out of 25

Epoch 79/99
----------
train Loss: 0.8717 LRAP: 0.7423 NDCG: 0.7876
val Loss: 0.9534 LRAP: 0.7656 NDCG: 0.8109
EarlyStopping counter: 2 out of 25

Epoch 80/99
----------
train Loss: 0.8679 LRAP: 0.7403 NDCG: 0.7848
val Loss: 0.9475 LRAP: 0.7705 NDCG: 0.8165
Validation loss decreased (0.948457 --> 0.947455).  Saving model ...

Epoch 81/99
----------
train Loss: 0.8687 LRAP: 0.7405 NDCG: 0.7820
val Loss: 0.9475 LRAP: 0.7682 NDCG: 0.8126
EarlyStopping counter: 1 out of 25

Epoch 82/99
----------
train Loss: 0.8712 LRAP: 0.7413 NDCG: 0.7863
val Loss: 0.9468 LRAP: 0.7633 NDCG: 0.8107
Validation loss decreased (0.947455 --> 0.946846).  Saving model ...

Epoch 83/99
----------
train Loss: 0.8676 LRAP: 0.7381 NDCG: 0.7837
val Loss: 0.9488 LRAP: 0.7633 NDCG: 0.8050
EarlyStopping counter: 1 out of 25

Epoch 84/99
----------
train Loss: 0.8709 LRAP: 0.7422 NDCG: 0.7833
val Loss: 0.9493 LRAP: 0.7633 NDCG: 0.8068
EarlyStopping counter: 2 out of 25

Epoch 85/99
----------
train Loss: 0.8653 LRAP: 0.7409 NDCG: 0.7877
val Loss: 0.9513 LRAP: 0.7616 NDCG: 0.8041
EarlyStopping counter: 3 out of 25

Epoch 86/99
----------
train Loss: 0.8670 LRAP: 0.7389 NDCG: 0.7851
val Loss: 0.9476 LRAP: 0.7711 NDCG: 0.8176
EarlyStopping counter: 4 out of 25

Epoch 87/99
----------
train Loss: 0.8677 LRAP: 0.7422 NDCG: 0.7882
val Loss: 0.9488 LRAP: 0.7659 NDCG: 0.8093
EarlyStopping counter: 5 out of 25

Epoch 88/99
----------
train Loss: 0.8653 LRAP: 0.7416 NDCG: 0.7858
val Loss: 0.9486 LRAP: 0.7639 NDCG: 0.8072
EarlyStopping counter: 6 out of 25

Epoch 89/99
----------
train Loss: 0.8663 LRAP: 0.7392 NDCG: 0.7871
val Loss: 0.9481 LRAP: 0.7679 NDCG: 0.8118
EarlyStopping counter: 7 out of 25

Epoch 90/99
----------
train Loss: 0.8643 LRAP: 0.7413 NDCG: 0.7876
val Loss: 0.9478 LRAP: 0.7682 NDCG: 0.8114
EarlyStopping counter: 8 out of 25

Epoch 91/99
----------
train Loss: 0.8651 LRAP: 0.7430 NDCG: 0.7848
val Loss: 0.9486 LRAP: 0.7665 NDCG: 0.8065
EarlyStopping counter: 9 out of 25

Epoch 92/99
----------
train Loss: 0.8656 LRAP: 0.7407 NDCG: 0.7895
val Loss: 0.9492 LRAP: 0.7653 NDCG: 0.8076
EarlyStopping counter: 10 out of 25

Epoch 93/99
----------
train Loss: 0.8644 LRAP: 0.7432 NDCG: 0.7854
val Loss: 0.9470 LRAP: 0.7659 NDCG: 0.8106
EarlyStopping counter: 11 out of 25

Epoch 94/99
----------
train Loss: 0.8649 LRAP: 0.7420 NDCG: 0.7870
val Loss: 0.9484 LRAP: 0.7662 NDCG: 0.8089
EarlyStopping counter: 12 out of 25

Epoch 95/99
----------
train Loss: 0.8656 LRAP: 0.7419 NDCG: 0.7870
val Loss: 0.9477 LRAP: 0.7693 NDCG: 0.8130
EarlyStopping counter: 13 out of 25

Epoch 96/99
----------
train Loss: 0.8639 LRAP: 0.7430 NDCG: 0.7895
val Loss: 0.9476 LRAP: 0.7682 NDCG: 0.8120
EarlyStopping counter: 14 out of 25

Epoch 97/99
----------
train Loss: 0.8639 LRAP: 0.7435 NDCG: 0.7883
val Loss: 0.9479 LRAP: 0.7688 NDCG: 0.8126
EarlyStopping counter: 15 out of 25

Epoch 98/99
----------
train Loss: 0.8628 LRAP: 0.7425 NDCG: 0.7879
val Loss: 0.9463 LRAP: 0.7713 NDCG: 0.8163
Validation loss decreased (0.946846 --> 0.946272).  Saving model ...

Epoch 99/99
----------
train Loss: 0.8626 LRAP: 0.7414 NDCG: 0.7851
val Loss: 0.9504 LRAP: 0.7719 NDCG: 0.8149
EarlyStopping counter: 1 out of 25

Training complete in 12m 33s
Best val loss: 0.946272, best LRAP score: 0.9518

Saved training histories to epoch_data_infusion_trial_kingdom_2.pkl
Saved summary results to summary_infusion_trial_kingdom_2.csv
----------------
Run 9/10

All random seeds set to: 428
Split complete!
Train set size: 16348
Validation set size: 3503
Test set size: 3504
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.7404 LRAP: 0.2279 NDCG: 0.5741
val Loss: 1.3356 LRAP: 0.5909 NDCG: 0.7143
Validation loss decreased (0.000000 --> 1.335596).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2209 LRAP: 0.5862 NDCG: 0.7226
val Loss: 1.1400 LRAP: 0.6523 NDCG: 0.7674
Validation loss decreased (1.335596 --> 1.140023).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1134 LRAP: 0.6463 NDCG: 0.7548
val Loss: 1.0838 LRAP: 0.6751 NDCG: 0.7745
Validation loss decreased (1.140023 --> 1.083776).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0683 LRAP: 0.6692 NDCG: 0.7703
val Loss: 1.0591 LRAP: 0.6609 NDCG: 0.7696
Validation loss decreased (1.083776 --> 1.059052).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0338 LRAP: 0.6845 NDCG: 0.7832
val Loss: 1.0507 LRAP: 0.6900 NDCG: 0.7899
Validation loss decreased (1.059052 --> 1.050698).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0128 LRAP: 0.6928 NDCG: 0.7906
val Loss: 1.0227 LRAP: 0.7000 NDCG: 0.8045
Validation loss decreased (1.050698 --> 1.022652).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9808 LRAP: 0.6951 NDCG: 0.8014
val Loss: 1.0080 LRAP: 0.7125 NDCG: 0.8134
Validation loss decreased (1.022652 --> 1.007958).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9637 LRAP: 0.6917 NDCG: 0.8020
val Loss: 0.9881 LRAP: 0.7285 NDCG: 0.8259
Validation loss decreased (1.007958 --> 0.988144).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9434 LRAP: 0.7069 NDCG: 0.8140
val Loss: 0.9742 LRAP: 0.7294 NDCG: 0.8246
Validation loss decreased (0.988144 --> 0.974168).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9269 LRAP: 0.7112 NDCG: 0.8171
val Loss: 0.9670 LRAP: 0.7351 NDCG: 0.8231
Validation loss decreased (0.974168 --> 0.967020).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9153 LRAP: 0.7075 NDCG: 0.8183
val Loss: 0.9619 LRAP: 0.7097 NDCG: 0.8176
Validation loss decreased (0.967020 --> 0.961895).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9074 LRAP: 0.7227 NDCG: 0.8252
val Loss: 0.9483 LRAP: 0.7048 NDCG: 0.8201
Validation loss decreased (0.961895 --> 0.948265).  Saving model ...

Epoch 12/99
----------
train Loss: 0.8903 LRAP: 0.7269 NDCG: 0.8288
val Loss: 0.9503 LRAP: 0.7456 NDCG: 0.8319
EarlyStopping counter: 1 out of 25

Epoch 13/99
----------
train Loss: 0.8818 LRAP: 0.7302 NDCG: 0.8338
val Loss: 0.9521 LRAP: 0.7559 NDCG: 0.8397
EarlyStopping counter: 2 out of 25

Epoch 14/99
----------
train Loss: 0.8771 LRAP: 0.7362 NDCG: 0.8344
val Loss: 0.9610 LRAP: 0.7568 NDCG: 0.8397
EarlyStopping counter: 3 out of 25

Epoch 15/99
----------
train Loss: 0.8701 LRAP: 0.7451 NDCG: 0.8380
val Loss: 0.9434 LRAP: 0.7691 NDCG: 0.8494
Validation loss decreased (0.948265 --> 0.943382).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8615 LRAP: 0.7446 NDCG: 0.8359
val Loss: 0.9356 LRAP: 0.7722 NDCG: 0.8487
Validation loss decreased (0.943382 --> 0.935560).  Saving model ...

Epoch 17/99
----------
train Loss: 0.8528 LRAP: 0.7487 NDCG: 0.8339
val Loss: 0.9345 LRAP: 0.7297 NDCG: 0.8325
Validation loss decreased (0.935560 --> 0.934501).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8487 LRAP: 0.7513 NDCG: 0.8309
val Loss: 0.9477 LRAP: 0.7925 NDCG: 0.8454
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.8412 LRAP: 0.7575 NDCG: 0.8280
val Loss: 0.9387 LRAP: 0.7936 NDCG: 0.8542
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 0.8392 LRAP: 0.7499 NDCG: 0.8203
val Loss: 0.9467 LRAP: 0.7836 NDCG: 0.8324
EarlyStopping counter: 3 out of 25

Epoch 21/99
----------
train Loss: 0.8293 LRAP: 0.7569 NDCG: 0.8144
val Loss: 0.9374 LRAP: 0.7970 NDCG: 0.8423
EarlyStopping counter: 4 out of 25

Epoch 22/99
----------
train Loss: 0.8251 LRAP: 0.7674 NDCG: 0.8219
val Loss: 0.9235 LRAP: 0.7845 NDCG: 0.8375
Validation loss decreased (0.934501 --> 0.923531).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8236 LRAP: 0.7630 NDCG: 0.8235
val Loss: 0.9265 LRAP: 0.8184 NDCG: 0.8558
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8133 LRAP: 0.7756 NDCG: 0.8221
val Loss: 0.9349 LRAP: 0.8096 NDCG: 0.8384
EarlyStopping counter: 2 out of 25

Epoch 25/99
----------
train Loss: 0.8105 LRAP: 0.7773 NDCG: 0.8196
val Loss: 0.9276 LRAP: 0.8042 NDCG: 0.8485
EarlyStopping counter: 3 out of 25

Epoch 26/99
----------
train Loss: 0.8080 LRAP: 0.7695 NDCG: 0.8130
val Loss: 0.9146 LRAP: 0.7682 NDCG: 0.8312
Validation loss decreased (0.923531 --> 0.914628).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8031 LRAP: 0.7772 NDCG: 0.8198
val Loss: 0.9307 LRAP: 0.7970 NDCG: 0.8369
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.7991 LRAP: 0.7814 NDCG: 0.8160
val Loss: 0.9097 LRAP: 0.8079 NDCG: 0.8491
Validation loss decreased (0.914628 --> 0.909663).  Saving model ...

Epoch 29/99
----------
train Loss: 0.7935 LRAP: 0.7783 NDCG: 0.8044
val Loss: 0.9203 LRAP: 0.8042 NDCG: 0.8341
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.7873 LRAP: 0.7893 NDCG: 0.8102
val Loss: 0.9068 LRAP: 0.8150 NDCG: 0.8495
Validation loss decreased (0.909663 --> 0.906786).  Saving model ...

Epoch 31/99
----------
train Loss: 0.7875 LRAP: 0.7866 NDCG: 0.8099
val Loss: 0.9065 LRAP: 0.8084 NDCG: 0.8416
Validation loss decreased (0.906786 --> 0.906488).  Saving model ...

Epoch 32/99
----------
train Loss: 0.7819 LRAP: 0.7889 NDCG: 0.8024
val Loss: 0.9039 LRAP: 0.8107 NDCG: 0.8529
Validation loss decreased (0.906488 --> 0.903899).  Saving model ...

Epoch 33/99
----------
train Loss: 0.7779 LRAP: 0.7912 NDCG: 0.8099
val Loss: 0.9199 LRAP: 0.7873 NDCG: 0.8248
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.7753 LRAP: 0.7908 NDCG: 0.8110
val Loss: 0.9056 LRAP: 0.8067 NDCG: 0.8291
EarlyStopping counter: 2 out of 25

Epoch 35/99
----------
train Loss: 0.7730 LRAP: 0.7981 NDCG: 0.8133
val Loss: 0.9014 LRAP: 0.8207 NDCG: 0.8564
Validation loss decreased (0.903899 --> 0.901397).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7715 LRAP: 0.7927 NDCG: 0.8040
val Loss: 0.9053 LRAP: 0.7819 NDCG: 0.8199
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.7656 LRAP: 0.8016 NDCG: 0.8122
val Loss: 0.9186 LRAP: 0.7782 NDCG: 0.8240
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.7621 LRAP: 0.8069 NDCG: 0.8164
val Loss: 0.9111 LRAP: 0.8050 NDCG: 0.8257
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.7642 LRAP: 0.7992 NDCG: 0.8094
val Loss: 0.9162 LRAP: 0.7947 NDCG: 0.8409
EarlyStopping counter: 4 out of 25

Epoch 40/99
----------
train Loss: 0.7586 LRAP: 0.8063 NDCG: 0.8151
val Loss: 0.9169 LRAP: 0.8239 NDCG: 0.8529
EarlyStopping counter: 5 out of 25

Epoch 41/99
----------
train Loss: 0.7434 LRAP: 0.8131 NDCG: 0.8155
val Loss: 0.9006 LRAP: 0.8273 NDCG: 0.8459
Validation loss decreased (0.901397 --> 0.900580).  Saving model ...

Epoch 42/99
----------
train Loss: 0.7369 LRAP: 0.8178 NDCG: 0.8186
val Loss: 0.8982 LRAP: 0.8284 NDCG: 0.8514
Validation loss decreased (0.900580 --> 0.898245).  Saving model ...

Epoch 43/99
----------
train Loss: 0.7334 LRAP: 0.8185 NDCG: 0.8202
val Loss: 0.8983 LRAP: 0.8304 NDCG: 0.8464
EarlyStopping counter: 1 out of 25

Epoch 44/99
----------
train Loss: 0.7315 LRAP: 0.8212 NDCG: 0.8203
val Loss: 0.8959 LRAP: 0.8344 NDCG: 0.8518
Validation loss decreased (0.898245 --> 0.895892).  Saving model ...

Epoch 45/99
----------
train Loss: 0.7289 LRAP: 0.8212 NDCG: 0.8164
val Loss: 0.8965 LRAP: 0.8307 NDCG: 0.8501
EarlyStopping counter: 1 out of 25

Epoch 46/99
----------
train Loss: 0.7274 LRAP: 0.8236 NDCG: 0.8239
val Loss: 0.8896 LRAP: 0.8350 NDCG: 0.8574
Validation loss decreased (0.895892 --> 0.889603).  Saving model ...

Epoch 47/99
----------
train Loss: 0.7253 LRAP: 0.8271 NDCG: 0.8253
val Loss: 0.8948 LRAP: 0.8376 NDCG: 0.8551
EarlyStopping counter: 1 out of 25

Epoch 48/99
----------
train Loss: 0.7241 LRAP: 0.8259 NDCG: 0.8270
val Loss: 0.8990 LRAP: 0.8299 NDCG: 0.8459
EarlyStopping counter: 2 out of 25

Epoch 49/99
----------
train Loss: 0.7267 LRAP: 0.8257 NDCG: 0.8224
val Loss: 0.8972 LRAP: 0.8364 NDCG: 0.8552
EarlyStopping counter: 3 out of 25

Epoch 50/99
----------
train Loss: 0.7232 LRAP: 0.8278 NDCG: 0.8192
val Loss: 0.8957 LRAP: 0.8327 NDCG: 0.8507
EarlyStopping counter: 4 out of 25

Epoch 51/99
----------
train Loss: 0.7228 LRAP: 0.8292 NDCG: 0.8242
val Loss: 0.8952 LRAP: 0.8367 NDCG: 0.8607
EarlyStopping counter: 5 out of 25

Epoch 52/99
----------
train Loss: 0.7201 LRAP: 0.8296 NDCG: 0.8213
val Loss: 0.8956 LRAP: 0.8336 NDCG: 0.8518
EarlyStopping counter: 6 out of 25

Epoch 53/99
----------
train Loss: 0.7170 LRAP: 0.8282 NDCG: 0.8236
val Loss: 0.8945 LRAP: 0.8401 NDCG: 0.8585
EarlyStopping counter: 7 out of 25

Epoch 54/99
----------
train Loss: 0.7178 LRAP: 0.8311 NDCG: 0.8217
val Loss: 0.8951 LRAP: 0.8404 NDCG: 0.8554
EarlyStopping counter: 8 out of 25

Epoch 55/99
----------
train Loss: 0.7171 LRAP: 0.8289 NDCG: 0.8227
val Loss: 0.8961 LRAP: 0.8436 NDCG: 0.8551
EarlyStopping counter: 9 out of 25

Epoch 56/99
----------
train Loss: 0.7152 LRAP: 0.8315 NDCG: 0.8203
val Loss: 0.8959 LRAP: 0.8404 NDCG: 0.8538
EarlyStopping counter: 10 out of 25

Epoch 57/99
----------
train Loss: 0.7152 LRAP: 0.8330 NDCG: 0.8291
val Loss: 0.8957 LRAP: 0.8401 NDCG: 0.8535
EarlyStopping counter: 11 out of 25

Epoch 58/99
----------
train Loss: 0.7145 LRAP: 0.8369 NDCG: 0.8267
val Loss: 0.8981 LRAP: 0.8390 NDCG: 0.8489
EarlyStopping counter: 12 out of 25

Epoch 59/99
----------
train Loss: 0.7162 LRAP: 0.8309 NDCG: 0.8215
val Loss: 0.8964 LRAP: 0.8410 NDCG: 0.8542
EarlyStopping counter: 13 out of 25

Epoch 60/99
----------
train Loss: 0.7171 LRAP: 0.8339 NDCG: 0.8241
val Loss: 0.8958 LRAP: 0.8438 NDCG: 0.8575
EarlyStopping counter: 14 out of 25

Epoch 61/99
----------
train Loss: 0.7154 LRAP: 0.8316 NDCG: 0.8228
val Loss: 0.8971 LRAP: 0.8418 NDCG: 0.8549
EarlyStopping counter: 15 out of 25

Epoch 62/99
----------
train Loss: 0.7169 LRAP: 0.8350 NDCG: 0.8252
val Loss: 0.8962 LRAP: 0.8413 NDCG: 0.8551
EarlyStopping counter: 16 out of 25

Epoch 63/99
----------
train Loss: 0.7146 LRAP: 0.8348 NDCG: 0.8237
val Loss: 0.8958 LRAP: 0.8436 NDCG: 0.8600
EarlyStopping counter: 17 out of 25

Epoch 64/99
----------
train Loss: 0.7150 LRAP: 0.8325 NDCG: 0.8243
val Loss: 0.8982 LRAP: 0.8407 NDCG: 0.8531
EarlyStopping counter: 18 out of 25

Epoch 65/99
----------
train Loss: 0.7151 LRAP: 0.8355 NDCG: 0.8293
val Loss: 0.8959 LRAP: 0.8433 NDCG: 0.8558
EarlyStopping counter: 19 out of 25

Epoch 66/99
----------
train Loss: 0.7151 LRAP: 0.8315 NDCG: 0.8218
val Loss: 0.8978 LRAP: 0.8381 NDCG: 0.8519
EarlyStopping counter: 20 out of 25

Epoch 67/99
----------
train Loss: 0.7150 LRAP: 0.8323 NDCG: 0.8279
val Loss: 0.8971 LRAP: 0.8401 NDCG: 0.8508
EarlyStopping counter: 21 out of 25

Epoch 68/99
----------
train Loss: 0.7155 LRAP: 0.8339 NDCG: 0.8265
val Loss: 0.8958 LRAP: 0.8433 NDCG: 0.8559
EarlyStopping counter: 22 out of 25

Epoch 69/99
----------
train Loss: 0.7149 LRAP: 0.8336 NDCG: 0.8231
val Loss: 0.8979 LRAP: 0.8381 NDCG: 0.8506
EarlyStopping counter: 23 out of 25

Epoch 70/99
----------
train Loss: 0.7142 LRAP: 0.8337 NDCG: 0.8247
val Loss: 0.8992 LRAP: 0.8381 NDCG: 0.8521
EarlyStopping counter: 24 out of 25

Epoch 71/99
----------
train Loss: 0.7140 LRAP: 0.8358 NDCG: 0.8286
val Loss: 0.8981 LRAP: 0.8433 NDCG: 0.8550
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 8m 50s
Best val loss: 0.889603, best LRAP score: 0.9600

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 1.7490 LRAP: 0.2283 NDCG: 0.5893
val Loss: 1.3326 LRAP: 0.5635 NDCG: 0.6936
Validation loss decreased (0.000000 --> 1.332648).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2604 LRAP: 0.6047 NDCG: 0.7310
val Loss: 1.1771 LRAP: 0.6503 NDCG: 0.7452
Validation loss decreased (1.332648 --> 1.177094).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1357 LRAP: 0.6593 NDCG: 0.7655
val Loss: 1.1112 LRAP: 0.6543 NDCG: 0.7667
Validation loss decreased (1.177094 --> 1.111174).  Saving model ...

Epoch 3/99
----------
train Loss: 1.0910 LRAP: 0.6857 NDCG: 0.7826
val Loss: 1.0937 LRAP: 0.6914 NDCG: 0.7899
Validation loss decreased (1.111174 --> 1.093698).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0462 LRAP: 0.6946 NDCG: 0.7927
val Loss: 1.0808 LRAP: 0.6780 NDCG: 0.7926
Validation loss decreased (1.093698 --> 1.080789).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0183 LRAP: 0.7090 NDCG: 0.8037
val Loss: 1.0228 LRAP: 0.7145 NDCG: 0.8084
Validation loss decreased (1.080789 --> 1.022780).  Saving model ...

Epoch 6/99
----------
train Loss: 0.9991 LRAP: 0.7139 NDCG: 0.8103
val Loss: 1.0160 LRAP: 0.7214 NDCG: 0.8180
Validation loss decreased (1.022780 --> 1.016013).  Saving model ...

Epoch 7/99
----------
train Loss: 0.9854 LRAP: 0.7175 NDCG: 0.8123
val Loss: 1.0157 LRAP: 0.7234 NDCG: 0.8215
Validation loss decreased (1.016013 --> 1.015719).  Saving model ...

Epoch 8/99
----------
train Loss: 0.9619 LRAP: 0.7280 NDCG: 0.8216
val Loss: 0.9788 LRAP: 0.7291 NDCG: 0.8248
Validation loss decreased (1.015719 --> 0.978769).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9429 LRAP: 0.7428 NDCG: 0.8314
val Loss: 0.9861 LRAP: 0.7511 NDCG: 0.8314
EarlyStopping counter: 1 out of 25

Epoch 10/99
----------
train Loss: 0.9236 LRAP: 0.7493 NDCG: 0.8381
val Loss: 0.9900 LRAP: 0.7676 NDCG: 0.8438
EarlyStopping counter: 2 out of 25

Epoch 11/99
----------
train Loss: 0.9181 LRAP: 0.7569 NDCG: 0.8419
val Loss: 0.9722 LRAP: 0.7502 NDCG: 0.8395
Validation loss decreased (0.978769 --> 0.972248).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9023 LRAP: 0.7569 NDCG: 0.8443
val Loss: 0.9699 LRAP: 0.7819 NDCG: 0.8546
Validation loss decreased (0.972248 --> 0.969925).  Saving model ...

Epoch 13/99
----------
train Loss: 0.8928 LRAP: 0.7646 NDCG: 0.8471
val Loss: 0.9748 LRAP: 0.7799 NDCG: 0.8525
EarlyStopping counter: 1 out of 25

Epoch 14/99
----------
train Loss: 0.8833 LRAP: 0.7786 NDCG: 0.8537
val Loss: 0.9630 LRAP: 0.7970 NDCG: 0.8613
Validation loss decreased (0.969925 --> 0.963006).  Saving model ...

Epoch 15/99
----------
train Loss: 0.8734 LRAP: 0.7765 NDCG: 0.8523
val Loss: 0.9560 LRAP: 0.7759 NDCG: 0.8515
Validation loss decreased (0.963006 --> 0.955951).  Saving model ...

Epoch 16/99
----------
train Loss: 0.8684 LRAP: 0.7790 NDCG: 0.8523
val Loss: 0.9643 LRAP: 0.7916 NDCG: 0.8612
EarlyStopping counter: 1 out of 25

Epoch 17/99
----------
train Loss: 0.8615 LRAP: 0.7847 NDCG: 0.8548
val Loss: 0.9410 LRAP: 0.7853 NDCG: 0.8524
Validation loss decreased (0.955951 --> 0.941043).  Saving model ...

Epoch 18/99
----------
train Loss: 0.8550 LRAP: 0.7874 NDCG: 0.8533
val Loss: 0.9587 LRAP: 0.7696 NDCG: 0.8460
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.8493 LRAP: 0.7832 NDCG: 0.8479
val Loss: 0.9580 LRAP: 0.7973 NDCG: 0.8604
EarlyStopping counter: 2 out of 25

Epoch 20/99
----------
train Loss: 0.8437 LRAP: 0.7895 NDCG: 0.8400
val Loss: 0.9380 LRAP: 0.7996 NDCG: 0.8621
Validation loss decreased (0.941043 --> 0.937992).  Saving model ...

Epoch 21/99
----------
train Loss: 0.8350 LRAP: 0.7924 NDCG: 0.8488
val Loss: 0.9507 LRAP: 0.8073 NDCG: 0.8649
EarlyStopping counter: 1 out of 25

Epoch 22/99
----------
train Loss: 0.8349 LRAP: 0.7887 NDCG: 0.8405
val Loss: 0.9365 LRAP: 0.8030 NDCG: 0.8635
Validation loss decreased (0.937992 --> 0.936501).  Saving model ...

Epoch 23/99
----------
train Loss: 0.8299 LRAP: 0.7909 NDCG: 0.8378
val Loss: 0.9397 LRAP: 0.7965 NDCG: 0.8365
EarlyStopping counter: 1 out of 25

Epoch 24/99
----------
train Loss: 0.8219 LRAP: 0.7939 NDCG: 0.8340
val Loss: 0.9355 LRAP: 0.8233 NDCG: 0.8615
Validation loss decreased (0.936501 --> 0.935477).  Saving model ...

Epoch 25/99
----------
train Loss: 0.8173 LRAP: 0.7957 NDCG: 0.8321
val Loss: 0.9304 LRAP: 0.8010 NDCG: 0.8519
Validation loss decreased (0.935477 --> 0.930408).  Saving model ...

Epoch 26/99
----------
train Loss: 0.8118 LRAP: 0.8003 NDCG: 0.8250
val Loss: 0.9245 LRAP: 0.8073 NDCG: 0.8562
Validation loss decreased (0.930408 --> 0.924512).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8066 LRAP: 0.7983 NDCG: 0.8194
val Loss: 0.9269 LRAP: 0.8042 NDCG: 0.8205
EarlyStopping counter: 1 out of 25

Epoch 28/99
----------
train Loss: 0.8068 LRAP: 0.7967 NDCG: 0.8096
val Loss: 0.9174 LRAP: 0.8036 NDCG: 0.8539
Validation loss decreased (0.924512 --> 0.917413).  Saving model ...

Epoch 29/99
----------
train Loss: 0.8004 LRAP: 0.8019 NDCG: 0.8246
val Loss: 0.9324 LRAP: 0.8196 NDCG: 0.8566
EarlyStopping counter: 1 out of 25

Epoch 30/99
----------
train Loss: 0.7975 LRAP: 0.8065 NDCG: 0.8279
val Loss: 0.9220 LRAP: 0.8110 NDCG: 0.8486
EarlyStopping counter: 2 out of 25

Epoch 31/99
----------
train Loss: 0.7911 LRAP: 0.8065 NDCG: 0.8224
val Loss: 0.9199 LRAP: 0.8119 NDCG: 0.8354
EarlyStopping counter: 3 out of 25

Epoch 32/99
----------
train Loss: 0.7853 LRAP: 0.8083 NDCG: 0.8208
val Loss: 0.9154 LRAP: 0.8124 NDCG: 0.8492
Validation loss decreased (0.917413 --> 0.915435).  Saving model ...

Epoch 33/99
----------
train Loss: 0.7818 LRAP: 0.8118 NDCG: 0.8290
val Loss: 0.9103 LRAP: 0.8182 NDCG: 0.8474
Validation loss decreased (0.915435 --> 0.910251).  Saving model ...

Epoch 34/99
----------
train Loss: 0.7806 LRAP: 0.8074 NDCG: 0.8161
val Loss: 0.9092 LRAP: 0.7993 NDCG: 0.8468
Validation loss decreased (0.910251 --> 0.909185).  Saving model ...

Epoch 35/99
----------
train Loss: 0.7768 LRAP: 0.8093 NDCG: 0.8143
val Loss: 0.9081 LRAP: 0.8242 NDCG: 0.8472
Validation loss decreased (0.909185 --> 0.908150).  Saving model ...

Epoch 36/99
----------
train Loss: 0.7733 LRAP: 0.8146 NDCG: 0.8179
val Loss: 0.9102 LRAP: 0.8204 NDCG: 0.8456
EarlyStopping counter: 1 out of 25

Epoch 37/99
----------
train Loss: 0.7701 LRAP: 0.8172 NDCG: 0.8216
val Loss: 0.9147 LRAP: 0.8321 NDCG: 0.8545
EarlyStopping counter: 2 out of 25

Epoch 38/99
----------
train Loss: 0.7677 LRAP: 0.8179 NDCG: 0.8208
val Loss: 0.9415 LRAP: 0.8147 NDCG: 0.8307
EarlyStopping counter: 3 out of 25

Epoch 39/99
----------
train Loss: 0.7702 LRAP: 0.8101 NDCG: 0.8142
val Loss: 0.9020 LRAP: 0.8122 NDCG: 0.8452
Validation loss decreased (0.908150 --> 0.902018).  Saving model ...

Epoch 40/99
----------
train Loss: 0.7604 LRAP: 0.8159 NDCG: 0.8170
val Loss: 0.8871 LRAP: 0.8356 NDCG: 0.8758
Validation loss decreased (0.902018 --> 0.887051).  Saving model ...

Epoch 41/99
----------
train Loss: 0.7610 LRAP: 0.8288 NDCG: 0.8375
val Loss: 0.8939 LRAP: 0.8110 NDCG: 0.8475
EarlyStopping counter: 1 out of 25

Epoch 42/99
----------
train Loss: 0.7584 LRAP: 0.8242 NDCG: 0.8292
val Loss: 0.9122 LRAP: 0.8233 NDCG: 0.8473
EarlyStopping counter: 2 out of 25

Epoch 43/99
----------
train Loss: 0.7545 LRAP: 0.8356 NDCG: 0.8401
val Loss: 0.9098 LRAP: 0.8324 NDCG: 0.8443
EarlyStopping counter: 3 out of 25

Epoch 44/99
----------
train Loss: 0.7502 LRAP: 0.8266 NDCG: 0.8216
val Loss: 0.9110 LRAP: 0.8216 NDCG: 0.8540
EarlyStopping counter: 4 out of 25

Epoch 45/99
----------
train Loss: 0.7479 LRAP: 0.8299 NDCG: 0.8329
val Loss: 0.9050 LRAP: 0.8256 NDCG: 0.8436
EarlyStopping counter: 5 out of 25

Epoch 46/99
----------
train Loss: 0.7333 LRAP: 0.8430 NDCG: 0.8429
val Loss: 0.8910 LRAP: 0.8493 NDCG: 0.8741
EarlyStopping counter: 6 out of 25

Epoch 47/99
----------
train Loss: 0.7258 LRAP: 0.8449 NDCG: 0.8337
val Loss: 0.8913 LRAP: 0.8476 NDCG: 0.8705
EarlyStopping counter: 7 out of 25

Epoch 48/99
----------
train Loss: 0.7229 LRAP: 0.8414 NDCG: 0.8324
val Loss: 0.8977 LRAP: 0.8444 NDCG: 0.8625
EarlyStopping counter: 8 out of 25

Epoch 49/99
----------
train Loss: 0.7232 LRAP: 0.8462 NDCG: 0.8381
val Loss: 0.8908 LRAP: 0.8510 NDCG: 0.8774
EarlyStopping counter: 9 out of 25

Epoch 50/99
----------
train Loss: 0.7198 LRAP: 0.8487 NDCG: 0.8404
val Loss: 0.8847 LRAP: 0.8473 NDCG: 0.8709
Validation loss decreased (0.887051 --> 0.884721).  Saving model ...

Epoch 51/99
----------
train Loss: 0.7174 LRAP: 0.8477 NDCG: 0.8384
val Loss: 0.8917 LRAP: 0.8516 NDCG: 0.8736
EarlyStopping counter: 1 out of 25

Epoch 52/99
----------
train Loss: 0.7169 LRAP: 0.8527 NDCG: 0.8443
val Loss: 0.8860 LRAP: 0.8564 NDCG: 0.8819
EarlyStopping counter: 2 out of 25

Epoch 53/99
----------
train Loss: 0.7160 LRAP: 0.8537 NDCG: 0.8438
val Loss: 0.8920 LRAP: 0.8536 NDCG: 0.8725
EarlyStopping counter: 3 out of 25

Epoch 54/99
----------
train Loss: 0.7159 LRAP: 0.8536 NDCG: 0.8468
val Loss: 0.8922 LRAP: 0.8558 NDCG: 0.8750
EarlyStopping counter: 4 out of 25

Epoch 55/99
----------
train Loss: 0.7152 LRAP: 0.8511 NDCG: 0.8383
val Loss: 0.8928 LRAP: 0.8581 NDCG: 0.8758
EarlyStopping counter: 5 out of 25

Epoch 56/99
----------
train Loss: 0.7115 LRAP: 0.8521 NDCG: 0.8361
val Loss: 0.8891 LRAP: 0.8581 NDCG: 0.8767
EarlyStopping counter: 6 out of 25

Epoch 57/99
----------
train Loss: 0.7117 LRAP: 0.8537 NDCG: 0.8388
val Loss: 0.8892 LRAP: 0.8573 NDCG: 0.8739
EarlyStopping counter: 7 out of 25

Epoch 58/99
----------
train Loss: 0.7104 LRAP: 0.8531 NDCG: 0.8392
val Loss: 0.8891 LRAP: 0.8550 NDCG: 0.8720
EarlyStopping counter: 8 out of 25

Epoch 59/99
----------
train Loss: 0.7096 LRAP: 0.8580 NDCG: 0.8480
val Loss: 0.8903 LRAP: 0.8558 NDCG: 0.8708
EarlyStopping counter: 9 out of 25

Epoch 60/99
----------
train Loss: 0.7094 LRAP: 0.8564 NDCG: 0.8431
val Loss: 0.8900 LRAP: 0.8593 NDCG: 0.8805
EarlyStopping counter: 10 out of 25

Epoch 61/99
----------
train Loss: 0.7087 LRAP: 0.8594 NDCG: 0.8431
val Loss: 0.8899 LRAP: 0.8595 NDCG: 0.8796
EarlyStopping counter: 11 out of 25

Epoch 62/99
----------
train Loss: 0.7068 LRAP: 0.8586 NDCG: 0.8451
val Loss: 0.8886 LRAP: 0.8595 NDCG: 0.8812
EarlyStopping counter: 12 out of 25

Epoch 63/99
----------
train Loss: 0.7086 LRAP: 0.8591 NDCG: 0.8438
val Loss: 0.8924 LRAP: 0.8556 NDCG: 0.8733
EarlyStopping counter: 13 out of 25

Epoch 64/99
----------
train Loss: 0.7080 LRAP: 0.8603 NDCG: 0.8453
val Loss: 0.8905 LRAP: 0.8584 NDCG: 0.8778
EarlyStopping counter: 14 out of 25

Epoch 65/99
----------
train Loss: 0.7089 LRAP: 0.8567 NDCG: 0.8427
val Loss: 0.8924 LRAP: 0.8564 NDCG: 0.8735
EarlyStopping counter: 15 out of 25

Epoch 66/99
----------
train Loss: 0.7094 LRAP: 0.8567 NDCG: 0.8404
val Loss: 0.8902 LRAP: 0.8550 NDCG: 0.8739
EarlyStopping counter: 16 out of 25

Epoch 67/99
----------
train Loss: 0.7075 LRAP: 0.8562 NDCG: 0.8459
val Loss: 0.8904 LRAP: 0.8567 NDCG: 0.8779
EarlyStopping counter: 17 out of 25

Epoch 68/99
----------
train Loss: 0.7076 LRAP: 0.8583 NDCG: 0.8467
val Loss: 0.8927 LRAP: 0.8595 NDCG: 0.8799
EarlyStopping counter: 18 out of 25

Epoch 69/99
----------
train Loss: 0.7081 LRAP: 0.8555 NDCG: 0.8426
val Loss: 0.8910 LRAP: 0.8587 NDCG: 0.8778
EarlyStopping counter: 19 out of 25

Epoch 70/99
----------
train Loss: 0.7081 LRAP: 0.8586 NDCG: 0.8415
val Loss: 0.8895 LRAP: 0.8610 NDCG: 0.8816
EarlyStopping counter: 20 out of 25

Epoch 71/99
----------
train Loss: 0.7083 LRAP: 0.8570 NDCG: 0.8440
val Loss: 0.8903 LRAP: 0.8567 NDCG: 0.8767
EarlyStopping counter: 21 out of 25

Epoch 72/99
----------
train Loss: 0.7075 LRAP: 0.8580 NDCG: 0.8432
val Loss: 0.8898 LRAP: 0.8576 NDCG: 0.8782
EarlyStopping counter: 22 out of 25

Epoch 73/99
----------
train Loss: 0.7082 LRAP: 0.8563 NDCG: 0.8428
val Loss: 0.8903 LRAP: 0.8601 NDCG: 0.8789
EarlyStopping counter: 23 out of 25

Epoch 74/99
----------
train Loss: 0.7078 LRAP: 0.8563 NDCG: 0.8445
val Loss: 0.8938 LRAP: 0.8556 NDCG: 0.8735
EarlyStopping counter: 24 out of 25

Epoch 75/99
----------
train Loss: 0.7091 LRAP: 0.8566 NDCG: 0.8427
val Loss: 0.8909 LRAP: 0.8581 NDCG: 0.8775
EarlyStopping counter: 25 out of 25
Early stopping
Training complete in 9m 27s
Best val loss: 0.884721, best LRAP score: 0.9626

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=15, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 1.8885 LRAP: 0.1183 NDCG: 0.5410
val Loss: 1.8915 LRAP: 0.4619 NDCG: 0.6027
Validation loss decreased (0.000000 --> 1.891478).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3275 LRAP: 0.5291 NDCG: 0.6766
val Loss: 1.3209 LRAP: 0.6846 NDCG: 0.7439
Validation loss decreased (1.891478 --> 1.320870).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1855 LRAP: 0.6453 NDCG: 0.7147
val Loss: 1.3203 LRAP: 0.3760 NDCG: 0.6488
Validation loss decreased (1.320870 --> 1.320322).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1286 LRAP: 0.6624 NDCG: 0.7334
val Loss: 1.2115 LRAP: 0.5241 NDCG: 0.6827
Validation loss decreased (1.320322 --> 1.211523).  Saving model ...

Epoch 4/99
----------
train Loss: 1.0924 LRAP: 0.6723 NDCG: 0.7440
val Loss: 1.1443 LRAP: 0.6140 NDCG: 0.7252
Validation loss decreased (1.211523 --> 1.144282).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0811 LRAP: 0.6761 NDCG: 0.7542
val Loss: 1.0986 LRAP: 0.6880 NDCG: 0.7519
Validation loss decreased (1.144282 --> 1.098648).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0591 LRAP: 0.6878 NDCG: 0.7612
val Loss: 1.1100 LRAP: 0.6734 NDCG: 0.7686
EarlyStopping counter: 1 out of 25

Epoch 7/99
----------
train Loss: 1.0408 LRAP: 0.6896 NDCG: 0.7700
val Loss: 1.4385 LRAP: 0.4245 NDCG: 0.6915
EarlyStopping counter: 2 out of 25

Epoch 8/99
----------
train Loss: 1.0312 LRAP: 0.6937 NDCG: 0.7738
val Loss: 1.0871 LRAP: 0.6631 NDCG: 0.7649
Validation loss decreased (1.098648 --> 1.087102).  Saving model ...

Epoch 9/99
----------
train Loss: 1.0157 LRAP: 0.6891 NDCG: 0.7768
val Loss: 1.0725 LRAP: 0.6783 NDCG: 0.7715
Validation loss decreased (1.087102 --> 1.072502).  Saving model ...

Epoch 10/99
----------
train Loss: 1.0126 LRAP: 0.6912 NDCG: 0.7810
val Loss: 1.1991 LRAP: 0.6948 NDCG: 0.7847
EarlyStopping counter: 1 out of 25

Epoch 11/99
----------
train Loss: 0.9984 LRAP: 0.6847 NDCG: 0.7829
val Loss: 1.0886 LRAP: 0.6700 NDCG: 0.7810
EarlyStopping counter: 2 out of 25

Epoch 12/99
----------
train Loss: 0.9918 LRAP: 0.6935 NDCG: 0.7884
val Loss: 1.0973 LRAP: 0.7057 NDCG: 0.7974
EarlyStopping counter: 3 out of 25

Epoch 13/99
----------
train Loss: 0.9746 LRAP: 0.6969 NDCG: 0.7917
val Loss: 1.0712 LRAP: 0.7331 NDCG: 0.8037
Validation loss decreased (1.072502 --> 1.071211).  Saving model ...

Epoch 14/99
----------
train Loss: 0.9669 LRAP: 0.7039 NDCG: 0.7935
val Loss: 1.0180 LRAP: 0.7171 NDCG: 0.7943
Validation loss decreased (1.071211 --> 1.018029).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9550 LRAP: 0.6970 NDCG: 0.7910
val Loss: 1.0288 LRAP: 0.7465 NDCG: 0.8179
EarlyStopping counter: 1 out of 25

Epoch 16/99
----------
train Loss: 0.9440 LRAP: 0.7011 NDCG: 0.7943
val Loss: 1.0933 LRAP: 0.6072 NDCG: 0.7638
EarlyStopping counter: 2 out of 25

Epoch 17/99
----------
train Loss: 0.9358 LRAP: 0.7029 NDCG: 0.7937
val Loss: 0.9739 LRAP: 0.7088 NDCG: 0.8031
Validation loss decreased (1.018029 --> 0.973858).  Saving model ...

Epoch 18/99
----------
train Loss: 0.9253 LRAP: 0.7063 NDCG: 0.7849
val Loss: 0.9850 LRAP: 0.7305 NDCG: 0.8149
EarlyStopping counter: 1 out of 25

Epoch 19/99
----------
train Loss: 0.9210 LRAP: 0.7047 NDCG: 0.7907
val Loss: 0.9734 LRAP: 0.7165 NDCG: 0.7960
Validation loss decreased (0.973858 --> 0.973398).  Saving model ...

Epoch 20/99
----------
train Loss: 0.9177 LRAP: 0.7061 NDCG: 0.7836
val Loss: 0.9722 LRAP: 0.7322 NDCG: 0.8139
Validation loss decreased (0.973398 --> 0.972159).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9102 LRAP: 0.7135 NDCG: 0.7896
val Loss: 0.9583 LRAP: 0.7414 NDCG: 0.8227
Validation loss decreased (0.972159 --> 0.958329).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8977 LRAP: 0.7116 NDCG: 0.7821
val Loss: 1.0392 LRAP: 0.6751 NDCG: 0.7655
EarlyStopping counter: 1 out of 25

Epoch 23/99
----------
train Loss: 0.9007 LRAP: 0.7194 NDCG: 0.7833
val Loss: 0.9460 LRAP: 0.7265 NDCG: 0.8154
Validation loss decreased (0.958329 --> 0.946026).  Saving model ...

Epoch 24/99
----------
train Loss: 0.8917 LRAP: 0.7239 NDCG: 0.7865
val Loss: 0.9583 LRAP: 0.7274 NDCG: 0.8145
EarlyStopping counter: 1 out of 25

Epoch 25/99
----------
train Loss: 0.8920 LRAP: 0.7231 NDCG: 0.7816
val Loss: 1.0597 LRAP: 0.7636 NDCG: 0.8284
EarlyStopping counter: 2 out of 25

Epoch 26/99
----------
train Loss: 0.8835 LRAP: 0.7198 NDCG: 0.7710
val Loss: 0.9522 LRAP: 0.7399 NDCG: 0.7985
EarlyStopping counter: 3 out of 25

Epoch 27/99
----------
train Loss: 0.8789 LRAP: 0.7288 NDCG: 0.7785
val Loss: 0.9557 LRAP: 0.7502 NDCG: 0.8017
EarlyStopping counter: 4 out of 25

Epoch 28/99
----------
train Loss: 0.8686 LRAP: 0.7298 NDCG: 0.7802
val Loss: 0.9858 LRAP: 0.6623 NDCG: 0.7560
EarlyStopping counter: 5 out of 25

Epoch 29/99
----------
train Loss: 0.8484 LRAP: 0.7376 NDCG: 0.7806
val Loss: 0.9211 LRAP: 0.7579 NDCG: 0.8180
Validation loss decreased (0.946026 --> 0.921122).  Saving model ...

Epoch 30/99
----------
train Loss: 0.8428 LRAP: 0.7416 NDCG: 0.7763
val Loss: 0.9207 LRAP: 0.7528 NDCG: 0.8185
Validation loss decreased (0.921122 --> 0.920740).  Saving model ...

Epoch 31/99
----------
train Loss: 0.8394 LRAP: 0.7396 NDCG: 0.7731
val Loss: 0.9236 LRAP: 0.7525 NDCG: 0.8116
EarlyStopping counter: 1 out of 25

Epoch 32/99
----------
train Loss: 0.8316 LRAP: 0.7449 NDCG: 0.7759
val Loss: 0.9194 LRAP: 0.7651 NDCG: 0.8106
Validation loss decreased (0.920740 --> 0.919421).  Saving model ...

Epoch 33/99
----------
train Loss: 0.8287 LRAP: 0.7438 NDCG: 0.7740
val Loss: 0.9204 LRAP: 0.7625 NDCG: 0.8217
EarlyStopping counter: 1 out of 25

Epoch 34/99
----------
train Loss: 0.8264 LRAP: 0.7476 NDCG: 0.7759
val Loss: 0.9191 LRAP: 0.7522 NDCG: 0.8096
Validation loss decreased (0.919421 --> 0.919102).  Saving model ...

Epoch 35/99
----------
train Loss: 0.8239 LRAP: 0.7482 NDCG: 0.7794
val Loss: 0.9195 LRAP: 0.7676 NDCG: 0.8178
EarlyStopping counter: 1 out of 25

Epoch 36/99
----------
train Loss: 0.8221 LRAP: 0.7532 NDCG: 0.7829
val Loss: 0.9177 LRAP: 0.7745 NDCG: 0.8291
Validation loss decreased (0.919102 --> 0.917687).  Saving model ...

Epoch 37/99
----------
