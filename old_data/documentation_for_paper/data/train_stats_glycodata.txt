Epoch 0/99
----------
train Loss: 1.9638 LRAP: 0.0890 NDCG: 0.5336
val Loss: 1.3698 LRAP: 0.3700 NDCG: 0.6315
Validation loss decreased (0.000000 --> 1.369761).  Saving model ...

Epoch 1/99
----------
train Loss: 1.3356 LRAP: 0.4701 NDCG: 0.6723
val Loss: 1.2144 LRAP: 0.6006 NDCG: 0.7224
Validation loss decreased (1.369761 --> 1.214396).  Saving model ...

Epoch 2/99
----------
train Loss: 1.2431 LRAP: 0.5427 NDCG: 0.7128
val Loss: 1.1683 LRAP: 0.6343 NDCG: 0.7370
Validation loss decreased (1.214396 --> 1.168348).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1831 LRAP: 0.5918 NDCG: 0.7396
val Loss: 1.1343 LRAP: 0.6637 NDCG: 0.7697
Validation loss decreased (1.168348 --> 1.134258).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1451 LRAP: 0.5877 NDCG: 0.7497
val Loss: 1.1008 LRAP: 0.6689 NDCG: 0.7814
Validation loss decreased (1.134258 --> 1.100834).  Saving model ...

Epoch 5/99
----------
train Loss: 1.1096 LRAP: 0.6316 NDCG: 0.7734
val Loss: 1.0751 LRAP: 0.6694 NDCG: 0.7922
Validation loss decreased (1.100834 --> 1.075074).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0866 LRAP: 0.6297 NDCG: 0.7804
val Loss: 1.0529 LRAP: 0.6814 NDCG: 0.7978
Validation loss decreased (1.075074 --> 1.052927).  Saving model ...

Epoch 7/99
----------
train Loss: 1.0511 LRAP: 0.6610 NDCG: 0.7946
val Loss: 1.0355 LRAP: 0.7083 NDCG: 0.8159
Validation loss decreased (1.052927 --> 1.035492).  Saving model ...

Epoch 8/99
----------
train Loss: 1.0361 LRAP: 0.6740 NDCG: 0.8065
val Loss: 1.0270 LRAP: 0.7185 NDCG: 0.8215
Validation loss decreased (1.035492 --> 1.026967).  Saving model ...

Epoch 9/99
----------
train Loss: 1.0173 LRAP: 0.6877 NDCG: 0.8149
val Loss: 1.0201 LRAP: 0.7177 NDCG: 0.8321
Validation loss decreased (1.026967 --> 1.020135).  Saving model ...

Epoch 10/99
----------
train Loss: 1.0032 LRAP: 0.7012 NDCG: 0.8227
val Loss: 1.0144 LRAP: 0.7422 NDCG: 0.8385
Validation loss decreased (1.020135 --> 1.014417).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9927 LRAP: 0.7105 NDCG: 0.8315
val Loss: 1.0151 LRAP: 0.7154 NDCG: 0.8357
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 0.9818 LRAP: 0.7176 NDCG: 0.8349
val Loss: 1.0066 LRAP: 0.7556 NDCG: 0.8515
Validation loss decreased (1.014417 --> 1.006610).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9714 LRAP: 0.7297 NDCG: 0.8409
val Loss: 0.9954 LRAP: 0.7582 NDCG: 0.8562
Validation loss decreased (1.006610 --> 0.995376).  Saving model ...

Epoch 14/99
----------
train Loss: 0.9587 LRAP: 0.7401 NDCG: 0.8481
val Loss: 0.9940 LRAP: 0.7611 NDCG: 0.8596
Validation loss decreased (0.995376 --> 0.993959).  Saving model ...

Epoch 15/99
----------
train Loss: 0.9572 LRAP: 0.7488 NDCG: 0.8535
val Loss: 0.9891 LRAP: 0.7765 NDCG: 0.8648
Validation loss decreased (0.993959 --> 0.989056).  Saving model ...

Epoch 16/99
----------
train Loss: 0.9471 LRAP: 0.7564 NDCG: 0.8562
val Loss: 0.9943 LRAP: 0.7910 NDCG: 0.8708
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 0.9444 LRAP: 0.7619 NDCG: 0.8593
val Loss: 0.9880 LRAP: 0.7967 NDCG: 0.8756
Validation loss decreased (0.989056 --> 0.987955).  Saving model ...

Epoch 18/99
----------
train Loss: 0.9323 LRAP: 0.7779 NDCG: 0.8684
val Loss: 0.9807 LRAP: 0.7996 NDCG: 0.8750
Validation loss decreased (0.987955 --> 0.980676).  Saving model ...

Epoch 19/99
----------
train Loss: 0.9290 LRAP: 0.7780 NDCG: 0.8690
val Loss: 0.9790 LRAP: 0.7979 NDCG: 0.8750
Validation loss decreased (0.980676 --> 0.978976).  Saving model ...

Epoch 20/99
----------
train Loss: 0.9246 LRAP: 0.7836 NDCG: 0.8706
val Loss: 0.9755 LRAP: 0.8013 NDCG: 0.8777
Validation loss decreased (0.978976 --> 0.975498).  Saving model ...

Epoch 21/99
----------
train Loss: 0.9154 LRAP: 0.7898 NDCG: 0.8752
val Loss: 0.9743 LRAP: 0.8170 NDCG: 0.8813
Validation loss decreased (0.975498 --> 0.974254).  Saving model ...

Epoch 22/99
----------
train Loss: 0.9136 LRAP: 0.7995 NDCG: 0.8795
val Loss: 0.9705 LRAP: 0.8259 NDCG: 0.8865
Validation loss decreased (0.974254 --> 0.970488).  Saving model ...

Epoch 23/99
----------
train Loss: 0.9080 LRAP: 0.8016 NDCG: 0.8808
val Loss: 0.9736 LRAP: 0.8333 NDCG: 0.8899
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 0.9045 LRAP: 0.8102 NDCG: 0.8855
val Loss: 0.9732 LRAP: 0.8287 NDCG: 0.8909
EarlyStopping counter: 2 out of 50

Epoch 25/99
----------
train Loss: 0.8970 LRAP: 0.8181 NDCG: 0.8876
val Loss: 0.9731 LRAP: 0.8456 NDCG: 0.8951
EarlyStopping counter: 3 out of 50

Epoch 26/99
----------
train Loss: 0.8918 LRAP: 0.8205 NDCG: 0.8906
val Loss: 0.9706 LRAP: 0.8147 NDCG: 0.8809
EarlyStopping counter: 4 out of 50

Epoch 27/99
----------
train Loss: 0.8891 LRAP: 0.8215 NDCG: 0.8916
val Loss: 0.9673 LRAP: 0.8433 NDCG: 0.8938
Validation loss decreased (0.970488 --> 0.967251).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8842 LRAP: 0.8306 NDCG: 0.8957
val Loss: 0.9671 LRAP: 0.8387 NDCG: 0.8925
Validation loss decreased (0.967251 --> 0.967075).  Saving model ...

Epoch 29/99
----------
train Loss: 0.8815 LRAP: 0.8323 NDCG: 0.8973
val Loss: 0.9682 LRAP: 0.8270 NDCG: 0.8882
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 0.8771 LRAP: 0.8347 NDCG: 0.8992
val Loss: 0.9736 LRAP: 0.8333 NDCG: 0.8920
EarlyStopping counter: 2 out of 50

Epoch 31/99
----------
train Loss: 0.8761 LRAP: 0.8364 NDCG: 0.9010
val Loss: 0.9610 LRAP: 0.8476 NDCG: 0.8982
Validation loss decreased (0.967075 --> 0.961020).  Saving model ...

Epoch 32/99
----------
train Loss: 0.8689 LRAP: 0.8430 NDCG: 0.9034
val Loss: 0.9682 LRAP: 0.8516 NDCG: 0.8985
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 0.8644 LRAP: 0.8432 NDCG: 0.9031
val Loss: 0.9657 LRAP: 0.8516 NDCG: 0.8990
EarlyStopping counter: 2 out of 50

Epoch 34/99
----------
train Loss: 0.8650 LRAP: 0.8425 NDCG: 0.9038
val Loss: 0.9653 LRAP: 0.8470 NDCG: 0.8975
EarlyStopping counter: 3 out of 50

Epoch 35/99
----------
train Loss: 0.8603 LRAP: 0.8518 NDCG: 0.9089
val Loss: 0.9618 LRAP: 0.8418 NDCG: 0.8957
EarlyStopping counter: 4 out of 50

Epoch 36/99
----------
train Loss: 0.8573 LRAP: 0.8558 NDCG: 0.9107
val Loss: 0.9592 LRAP: 0.8590 NDCG: 0.9030
Validation loss decreased (0.961020 --> 0.959180).  Saving model ...

Epoch 37/99
----------
train Loss: 0.8509 LRAP: 0.8598 NDCG: 0.9133
val Loss: 0.9630 LRAP: 0.8524 NDCG: 0.8982
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 0.8520 LRAP: 0.8583 NDCG: 0.9125
val Loss: 0.9608 LRAP: 0.8661 NDCG: 0.9058
EarlyStopping counter: 2 out of 50

Epoch 39/99
----------
train Loss: 0.8479 LRAP: 0.8607 NDCG: 0.9140
val Loss: 0.9635 LRAP: 0.8607 NDCG: 0.9023
EarlyStopping counter: 3 out of 50

Epoch 40/99
----------
train Loss: 0.8439 LRAP: 0.8660 NDCG: 0.9166
val Loss: 0.9560 LRAP: 0.8536 NDCG: 0.9018
Validation loss decreased (0.959180 --> 0.956023).  Saving model ...

Epoch 41/99
----------
train Loss: 0.8431 LRAP: 0.8663 NDCG: 0.9168
val Loss: 0.9550 LRAP: 0.8561 NDCG: 0.9023
Validation loss decreased (0.956023 --> 0.954997).  Saving model ...

Epoch 42/99
----------
train Loss: 0.8370 LRAP: 0.8722 NDCG: 0.9203
val Loss: 0.9583 LRAP: 0.8561 NDCG: 0.9020
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 0.8363 LRAP: 0.8767 NDCG: 0.9225
val Loss: 0.9588 LRAP: 0.8513 NDCG: 0.8984
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 0.8361 LRAP: 0.8742 NDCG: 0.9211
val Loss: 0.9494 LRAP: 0.8510 NDCG: 0.9002
Validation loss decreased (0.954997 --> 0.949428).  Saving model ...

Epoch 45/99
----------
train Loss: 0.8338 LRAP: 0.8753 NDCG: 0.9215
val Loss: 0.9489 LRAP: 0.8604 NDCG: 0.9041
Validation loss decreased (0.949428 --> 0.948881).  Saving model ...

Epoch 46/99
----------
train Loss: 0.8312 LRAP: 0.8796 NDCG: 0.9245
val Loss: 0.9525 LRAP: 0.8581 NDCG: 0.9013
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 0.8282 LRAP: 0.8861 NDCG: 0.9287
val Loss: 0.9528 LRAP: 0.8707 NDCG: 0.9077
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 0.8264 LRAP: 0.8827 NDCG: 0.9270
val Loss: 0.9521 LRAP: 0.8727 NDCG: 0.9090
EarlyStopping counter: 3 out of 50

Epoch 49/99
----------
train Loss: 0.8239 LRAP: 0.8879 NDCG: 0.9301
val Loss: 0.9538 LRAP: 0.8733 NDCG: 0.9082
EarlyStopping counter: 4 out of 50

Epoch 50/99
----------
train Loss: 0.8221 LRAP: 0.8892 NDCG: 0.9303
val Loss: 0.9462 LRAP: 0.8695 NDCG: 0.9059
Validation loss decreased (0.948881 --> 0.946172).  Saving model ...

Epoch 51/99
----------
train Loss: 0.8176 LRAP: 0.8931 NDCG: 0.9324
val Loss: 0.9506 LRAP: 0.8678 NDCG: 0.9062
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 0.8183 LRAP: 0.8925 NDCG: 0.9321
val Loss: 0.9431 LRAP: 0.8661 NDCG: 0.9068
Validation loss decreased (0.946172 --> 0.943128).  Saving model ...

Epoch 53/99
----------
train Loss: 0.8166 LRAP: 0.8950 NDCG: 0.9339
val Loss: 0.9443 LRAP: 0.8675 NDCG: 0.9083
EarlyStopping counter: 1 out of 50

Epoch 54/99
----------
train Loss: 0.8140 LRAP: 0.8962 NDCG: 0.9345
val Loss: 0.9461 LRAP: 0.8735 NDCG: 0.9102
EarlyStopping counter: 2 out of 50

Epoch 55/99
----------
train Loss: 0.8133 LRAP: 0.8950 NDCG: 0.9342
val Loss: 0.9479 LRAP: 0.8718 NDCG: 0.9112
EarlyStopping counter: 3 out of 50

Epoch 56/99
----------
train Loss: 0.8120 LRAP: 0.8975 NDCG: 0.9356
val Loss: 0.9455 LRAP: 0.8715 NDCG: 0.9099
EarlyStopping counter: 4 out of 50

Epoch 57/99
----------
train Loss: 0.8069 LRAP: 0.9006 NDCG: 0.9382
val Loss: 0.9413 LRAP: 0.8738 NDCG: 0.9116
Validation loss decreased (0.943128 --> 0.941330).  Saving model ...

Epoch 58/99
----------
train Loss: 0.8067 LRAP: 0.9011 NDCG: 0.9386
val Loss: 0.9499 LRAP: 0.8770 NDCG: 0.9112
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 0.8069 LRAP: 0.9030 NDCG: 0.9393
val Loss: 0.9461 LRAP: 0.8810 NDCG: 0.9139
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 0.8038 LRAP: 0.9046 NDCG: 0.9408
val Loss: 0.9460 LRAP: 0.8778 NDCG: 0.9131
EarlyStopping counter: 3 out of 50

Epoch 61/99
----------
train Loss: 0.8017 LRAP: 0.9038 NDCG: 0.9405
val Loss: 0.9488 LRAP: 0.8681 NDCG: 0.9085
EarlyStopping counter: 4 out of 50

Epoch 62/99
----------
train Loss: 0.8002 LRAP: 0.9103 NDCG: 0.9442
val Loss: 0.9465 LRAP: 0.8718 NDCG: 0.9104
EarlyStopping counter: 5 out of 50

Epoch 63/99
----------
train Loss: 0.7955 LRAP: 0.9120 NDCG: 0.9445
val Loss: 0.9434 LRAP: 0.8790 NDCG: 0.9149
EarlyStopping counter: 6 out of 50

Epoch 64/99
----------
train Loss: 0.7919 LRAP: 0.9152 NDCG: 0.9472
val Loss: 0.9429 LRAP: 0.8790 NDCG: 0.9144
EarlyStopping counter: 7 out of 50

Epoch 65/99
----------
train Loss: 0.7911 LRAP: 0.9125 NDCG: 0.9459
val Loss: 0.9426 LRAP: 0.8858 NDCG: 0.9182
EarlyStopping counter: 8 out of 50

Epoch 66/99
----------
train Loss: 0.7896 LRAP: 0.9160 NDCG: 0.9474
val Loss: 0.9393 LRAP: 0.8804 NDCG: 0.9164
Validation loss decreased (0.941330 --> 0.939273).  Saving model ...

Epoch 67/99
----------
train Loss: 0.7882 LRAP: 0.9161 NDCG: 0.9479
val Loss: 0.9400 LRAP: 0.8841 NDCG: 0.9174
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 0.7895 LRAP: 0.9127 NDCG: 0.9467
val Loss: 0.9371 LRAP: 0.8804 NDCG: 0.9148
Validation loss decreased (0.939273 --> 0.937071).  Saving model ...

Epoch 69/99
----------
train Loss: 0.7883 LRAP: 0.9154 NDCG: 0.9476
val Loss: 0.9371 LRAP: 0.8807 NDCG: 0.9152
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 0.7883 LRAP: 0.9169 NDCG: 0.9484
val Loss: 0.9355 LRAP: 0.8767 NDCG: 0.9146
Validation loss decreased (0.937071 --> 0.935457).  Saving model ...

Epoch 71/99
----------
train Loss: 0.7860 LRAP: 0.9183 NDCG: 0.9495
val Loss: 0.9384 LRAP: 0.8810 NDCG: 0.9165
EarlyStopping counter: 1 out of 50

Epoch 72/99
----------
train Loss: 0.7856 LRAP: 0.9162 NDCG: 0.9484
val Loss: 0.9383 LRAP: 0.8870 NDCG: 0.9185
EarlyStopping counter: 2 out of 50

Epoch 73/99
----------
train Loss: 0.7842 LRAP: 0.9163 NDCG: 0.9487
val Loss: 0.9380 LRAP: 0.8812 NDCG: 0.9174
EarlyStopping counter: 3 out of 50

Epoch 74/99
----------
train Loss: 0.7854 LRAP: 0.9202 NDCG: 0.9507
val Loss: 0.9378 LRAP: 0.8827 NDCG: 0.9178
EarlyStopping counter: 4 out of 50

Epoch 75/99
----------
train Loss: 0.7847 LRAP: 0.9202 NDCG: 0.9511
val Loss: 0.9400 LRAP: 0.8858 NDCG: 0.9182
EarlyStopping counter: 5 out of 50

Epoch 76/99
----------
train Loss: 0.7835 LRAP: 0.9208 NDCG: 0.9511
val Loss: 0.9371 LRAP: 0.8858 NDCG: 0.9185
EarlyStopping counter: 6 out of 50

Epoch 77/99
----------
train Loss: 0.7835 LRAP: 0.9196 NDCG: 0.9502
val Loss: 0.9379 LRAP: 0.8804 NDCG: 0.9156
EarlyStopping counter: 7 out of 50

Epoch 78/99
----------
train Loss: 0.7814 LRAP: 0.9216 NDCG: 0.9518
val Loss: 0.9378 LRAP: 0.8795 NDCG: 0.9163
EarlyStopping counter: 8 out of 50

Epoch 79/99
----------
train Loss: 0.7825 LRAP: 0.9207 NDCG: 0.9510
val Loss: 0.9360 LRAP: 0.8815 NDCG: 0.9169
EarlyStopping counter: 9 out of 50

Epoch 80/99
----------
train Loss: 0.7807 LRAP: 0.9219 NDCG: 0.9525
val Loss: 0.9382 LRAP: 0.8812 NDCG: 0.9164
EarlyStopping counter: 10 out of 50

Epoch 81/99
----------
train Loss: 0.7823 LRAP: 0.9192 NDCG: 0.9505
val Loss: 0.9356 LRAP: 0.8872 NDCG: 0.9198
EarlyStopping counter: 11 out of 50

Epoch 82/99
----------
train Loss: 0.7822 LRAP: 0.9208 NDCG: 0.9517
val Loss: 0.9360 LRAP: 0.8827 NDCG: 0.9174
EarlyStopping counter: 12 out of 50

Epoch 83/99
----------
train Loss: 0.7806 LRAP: 0.9213 NDCG: 0.9516
val Loss: 0.9344 LRAP: 0.8841 NDCG: 0.9181
Validation loss decreased (0.935457 --> 0.934439).  Saving model ...

Epoch 84/99
----------
train Loss: 0.7817 LRAP: 0.9205 NDCG: 0.9514
val Loss: 0.9354 LRAP: 0.8844 NDCG: 0.9190
EarlyStopping counter: 1 out of 50

Epoch 85/99
----------
train Loss: 0.7822 LRAP: 0.9205 NDCG: 0.9515
val Loss: 0.9359 LRAP: 0.8838 NDCG: 0.9175
EarlyStopping counter: 2 out of 50

Epoch 86/99
----------
train Loss: 0.7821 LRAP: 0.9197 NDCG: 0.9509
val Loss: 0.9360 LRAP: 0.8827 NDCG: 0.9175
EarlyStopping counter: 3 out of 50

Epoch 87/99
----------
train Loss: 0.7818 LRAP: 0.9199 NDCG: 0.9512
val Loss: 0.9372 LRAP: 0.8858 NDCG: 0.9183
EarlyStopping counter: 4 out of 50

Epoch 88/99
----------
train Loss: 0.7821 LRAP: 0.9208 NDCG: 0.9515
val Loss: 0.9372 LRAP: 0.8827 NDCG: 0.9177
EarlyStopping counter: 5 out of 50

Epoch 89/99
----------
train Loss: 0.7818 LRAP: 0.9198 NDCG: 0.9505
val Loss: 0.9377 LRAP: 0.8784 NDCG: 0.9151
EarlyStopping counter: 6 out of 50

Epoch 90/99
----------
train Loss: 0.7807 LRAP: 0.9181 NDCG: 0.9500
val Loss: 0.9368 LRAP: 0.8852 NDCG: 0.9188
EarlyStopping counter: 7 out of 50

Epoch 91/99
----------
train Loss: 0.7826 LRAP: 0.9189 NDCG: 0.9503
val Loss: 0.9354 LRAP: 0.8867 NDCG: 0.9201
EarlyStopping counter: 8 out of 50

Epoch 92/99
----------
train Loss: 0.7812 LRAP: 0.9205 NDCG: 0.9514
val Loss: 0.9326 LRAP: 0.8821 NDCG: 0.9171
Validation loss decreased (0.934439 --> 0.932601).  Saving model ...

Epoch 93/99
----------
train Loss: 0.7809 LRAP: 0.9195 NDCG: 0.9503
val Loss: 0.9375 LRAP: 0.8850 NDCG: 0.9185
EarlyStopping counter: 1 out of 50

Epoch 94/99
----------
train Loss: 0.7820 LRAP: 0.9210 NDCG: 0.9511
val Loss: 0.9361 LRAP: 0.8847 NDCG: 0.9178
EarlyStopping counter: 2 out of 50

Epoch 95/99
----------
train Loss: 0.7812 LRAP: 0.9224 NDCG: 0.9520
val Loss: 0.9385 LRAP: 0.8864 NDCG: 0.9188
EarlyStopping counter: 3 out of 50

Epoch 96/99
----------
train Loss: 0.7809 LRAP: 0.9216 NDCG: 0.9515
val Loss: 0.9384 LRAP: 0.8852 NDCG: 0.9179
EarlyStopping counter: 4 out of 50

Epoch 97/99
----------
train Loss: 0.7817 LRAP: 0.9209 NDCG: 0.9511
val Loss: 0.9381 LRAP: 0.8818 NDCG: 0.9170
EarlyStopping counter: 5 out of 50

Epoch 98/99
----------
train Loss: 0.7816 LRAP: 0.9185 NDCG: 0.9500
val Loss: 0.9372 LRAP: 0.8827 NDCG: 0.9177
EarlyStopping counter: 6 out of 50

Epoch 99/99
----------
train Loss: 0.7812 LRAP: 0.9210 NDCG: 0.9515
val Loss: 0.9382 LRAP: 0.8872 NDCG: 0.9196
EarlyStopping counter: 7 out of 50

Training complete in 19m 15s
Best val loss: 0.932601, best LRAP score: 0.9645