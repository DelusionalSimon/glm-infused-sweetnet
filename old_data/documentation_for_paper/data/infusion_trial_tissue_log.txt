Initializing infusion_trial_tissue experiment with 4 configurations and 10 runs per configuration.
----------------
Run 1/10

All random seeds set to: 42
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.4439 LRAP: 0.0000 NDCG: 0.1789
val Loss: 4.9267 LRAP: 0.0000 NDCG: 0.2023
Validation loss decreased (0.000000 --> 4.926750).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9276 LRAP: 0.0033 NDCG: 0.1940
val Loss: 3.8855 LRAP: 0.0610 NDCG: 0.2071
Validation loss decreased (4.926750 --> 3.885523).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8058 LRAP: 0.0392 NDCG: 0.2163
val Loss: 4.4071 LRAP: 0.0076 NDCG: 0.2279
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.7100 LRAP: 0.0384 NDCG: 0.2180
val Loss: 3.7608 LRAP: 0.0648 NDCG: 0.2176
Validation loss decreased (3.885523 --> 3.760794).  Saving model ...

Epoch 4/99
----------
train Loss: 3.6356 LRAP: 0.0417 NDCG: 0.2275
val Loss: 3.9665 LRAP: 0.0064 NDCG: 0.2292
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.5273 LRAP: 0.0498 NDCG: 0.2320
val Loss: 3.7576 LRAP: 0.0381 NDCG: 0.2128
Validation loss decreased (3.760794 --> 3.757557).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4784 LRAP: 0.0365 NDCG: 0.2309
val Loss: 3.7959 LRAP: 0.1067 NDCG: 0.2279
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.4450 LRAP: 0.0678 NDCG: 0.2339
val Loss: 3.7164 LRAP: 0.0826 NDCG: 0.2283
Validation loss decreased (3.757557 --> 3.716376).  Saving model ...

Epoch 8/99
----------
train Loss: 3.4051 LRAP: 0.0648 NDCG: 0.2336
val Loss: 3.4885 LRAP: 0.0445 NDCG: 0.2207
Validation loss decreased (3.716376 --> 3.488484).  Saving model ...

Epoch 9/99
----------
train Loss: 3.2932 LRAP: 0.0689 NDCG: 0.2427
val Loss: 3.4812 LRAP: 0.0648 NDCG: 0.2375
Validation loss decreased (3.488484 --> 3.481248).  Saving model ...

Epoch 10/99
----------
train Loss: 3.2609 LRAP: 0.0721 NDCG: 0.2464
val Loss: 3.8677 LRAP: 0.1258 NDCG: 0.2045
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.2032 LRAP: 0.0814 NDCG: 0.2500
val Loss: 3.4255 LRAP: 0.0432 NDCG: 0.2452
Validation loss decreased (3.481248 --> 3.425537).  Saving model ...

Epoch 12/99
----------
train Loss: 3.1395 LRAP: 0.0915 NDCG: 0.2549
val Loss: 3.5311 LRAP: 0.1258 NDCG: 0.2560
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0825 LRAP: 0.0907 NDCG: 0.2614
val Loss: 3.4606 LRAP: 0.1118 NDCG: 0.2236
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 3.0349 LRAP: 0.0888 NDCG: 0.2605
val Loss: 3.1544 LRAP: 0.1194 NDCG: 0.2570
Validation loss decreased (3.425537 --> 3.154387).  Saving model ...

Epoch 15/99
----------
train Loss: 3.0129 LRAP: 0.0860 NDCG: 0.2669
val Loss: 3.3052 LRAP: 0.1283 NDCG: 0.2653
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.9638 LRAP: 0.0879 NDCG: 0.2704
val Loss: 3.0023 LRAP: 0.1029 NDCG: 0.2712
Validation loss decreased (3.154387 --> 3.002278).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9176 LRAP: 0.0939 NDCG: 0.2744
val Loss: 3.3567 LRAP: 0.0902 NDCG: 0.2461
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 2.8681 LRAP: 0.1007 NDCG: 0.2788
val Loss: 2.9947 LRAP: 0.1194 NDCG: 0.2700
Validation loss decreased (3.002278 --> 2.994703).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8513 LRAP: 0.1026 NDCG: 0.2785
val Loss: 3.1723 LRAP: 0.1258 NDCG: 0.2703
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 2.7941 LRAP: 0.1018 NDCG: 0.2844
val Loss: 3.6771 LRAP: 0.1258 NDCG: 0.2856
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 2.7957 LRAP: 0.0994 NDCG: 0.2808
val Loss: 2.9138 LRAP: 0.1017 NDCG: 0.2882
Validation loss decreased (2.994703 --> 2.913768).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7642 LRAP: 0.1007 NDCG: 0.2861
val Loss: 2.9393 LRAP: 0.1309 NDCG: 0.2731
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.7071 LRAP: 0.1018 NDCG: 0.2902
val Loss: 2.8335 LRAP: 0.1296 NDCG: 0.2984
Validation loss decreased (2.913768 --> 2.833541).  Saving model ...

Epoch 24/99
----------
train Loss: 2.6769 LRAP: 0.1051 NDCG: 0.2907
val Loss: 2.8978 LRAP: 0.0635 NDCG: 0.2983
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.6384 LRAP: 0.1024 NDCG: 0.2947
val Loss: 3.2437 LRAP: 0.0775 NDCG: 0.2688
EarlyStopping counter: 2 out of 50

Epoch 26/99
----------
train Loss: 2.6109 LRAP: 0.0991 NDCG: 0.2968
val Loss: 2.7975 LRAP: 0.1080 NDCG: 0.2922
Validation loss decreased (2.833541 --> 2.797500).  Saving model ...

Epoch 27/99
----------
train Loss: 2.5905 LRAP: 0.1084 NDCG: 0.3002
val Loss: 2.7743 LRAP: 0.1169 NDCG: 0.3071
Validation loss decreased (2.797500 --> 2.774268).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5538 LRAP: 0.1021 NDCG: 0.3006
val Loss: 2.8820 LRAP: 0.1194 NDCG: 0.3018
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 2.5588 LRAP: 0.1007 NDCG: 0.2995
val Loss: 2.8463 LRAP: 0.0978 NDCG: 0.3009
EarlyStopping counter: 2 out of 50

Epoch 30/99
----------
train Loss: 2.5145 LRAP: 0.1070 NDCG: 0.3065
val Loss: 2.9249 LRAP: 0.1296 NDCG: 0.2825
EarlyStopping counter: 3 out of 50

Epoch 31/99
----------
train Loss: 2.4615 LRAP: 0.1089 NDCG: 0.3077
val Loss: 2.9191 LRAP: 0.1512 NDCG: 0.3107
EarlyStopping counter: 4 out of 50

Epoch 32/99
----------
train Loss: 2.4484 LRAP: 0.1075 NDCG: 0.3103
val Loss: 2.8888 LRAP: 0.1296 NDCG: 0.3039
EarlyStopping counter: 5 out of 50

Epoch 33/99
----------
train Loss: 2.3645 LRAP: 0.1122 NDCG: 0.3125
val Loss: 2.5933 LRAP: 0.1245 NDCG: 0.3081
Validation loss decreased (2.774268 --> 2.593341).  Saving model ...

Epoch 34/99
----------
train Loss: 2.2998 LRAP: 0.1149 NDCG: 0.3146
val Loss: 2.5796 LRAP: 0.1321 NDCG: 0.3235
Validation loss decreased (2.593341 --> 2.579575).  Saving model ...

Epoch 35/99
----------
train Loss: 2.2935 LRAP: 0.1157 NDCG: 0.3163
val Loss: 2.5606 LRAP: 0.1347 NDCG: 0.3228
Validation loss decreased (2.579575 --> 2.560571).  Saving model ...

Epoch 36/99
----------
train Loss: 2.2877 LRAP: 0.1152 NDCG: 0.3179
val Loss: 2.5938 LRAP: 0.1360 NDCG: 0.3225
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 2.2711 LRAP: 0.1114 NDCG: 0.3165
val Loss: 2.5590 LRAP: 0.1398 NDCG: 0.3236
Validation loss decreased (2.560571 --> 2.558984).  Saving model ...

Epoch 38/99
----------
train Loss: 2.2540 LRAP: 0.1157 NDCG: 0.3178
val Loss: 2.5489 LRAP: 0.1474 NDCG: 0.3290
Validation loss decreased (2.558984 --> 2.548904).  Saving model ...

Epoch 39/99
----------
train Loss: 2.2356 LRAP: 0.1157 NDCG: 0.3181
val Loss: 2.5523 LRAP: 0.1436 NDCG: 0.3242
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.2342 LRAP: 0.1114 NDCG: 0.3224
val Loss: 2.5494 LRAP: 0.1436 NDCG: 0.3269
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 2.2147 LRAP: 0.1146 NDCG: 0.3208
val Loss: 2.5531 LRAP: 0.1372 NDCG: 0.3315
EarlyStopping counter: 3 out of 50

Epoch 42/99
----------
train Loss: 2.2038 LRAP: 0.1179 NDCG: 0.3236
val Loss: 2.5516 LRAP: 0.1360 NDCG: 0.3234
EarlyStopping counter: 4 out of 50

Epoch 43/99
----------
train Loss: 2.1828 LRAP: 0.1114 NDCG: 0.3202
val Loss: 2.5385 LRAP: 0.1512 NDCG: 0.3217
Validation loss decreased (2.548904 --> 2.538462).  Saving model ...

Epoch 44/99
----------
train Loss: 2.1775 LRAP: 0.1206 NDCG: 0.3224
val Loss: 2.5365 LRAP: 0.1372 NDCG: 0.3354
Validation loss decreased (2.538462 --> 2.536515).  Saving model ...

Epoch 45/99
----------
train Loss: 2.1656 LRAP: 0.1182 NDCG: 0.3252
val Loss: 2.5380 LRAP: 0.1499 NDCG: 0.3361
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 2.1518 LRAP: 0.1190 NDCG: 0.3242
val Loss: 2.5426 LRAP: 0.1347 NDCG: 0.3292
EarlyStopping counter: 2 out of 50

Epoch 47/99
----------
train Loss: 2.1525 LRAP: 0.1168 NDCG: 0.3250
val Loss: 2.5221 LRAP: 0.1436 NDCG: 0.3356
Validation loss decreased (2.536515 --> 2.522142).  Saving model ...

Epoch 48/99
----------
train Loss: 2.1432 LRAP: 0.1179 NDCG: 0.3239
val Loss: 2.5460 LRAP: 0.1461 NDCG: 0.3390
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 2.1369 LRAP: 0.1173 NDCG: 0.3272
val Loss: 2.5047 LRAP: 0.1512 NDCG: 0.3404
Validation loss decreased (2.522142 --> 2.504713).  Saving model ...

Epoch 50/99
----------
train Loss: 2.1224 LRAP: 0.1217 NDCG: 0.3276
val Loss: 2.5130 LRAP: 0.1449 NDCG: 0.3315
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 2.1192 LRAP: 0.1225 NDCG: 0.3287
val Loss: 2.5294 LRAP: 0.1563 NDCG: 0.3420
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 2.0956 LRAP: 0.1176 NDCG: 0.3305
val Loss: 2.5093 LRAP: 0.1449 NDCG: 0.3331
EarlyStopping counter: 3 out of 50

Epoch 53/99
----------
train Loss: 2.0938 LRAP: 0.1190 NDCG: 0.3292
val Loss: 2.4891 LRAP: 0.1550 NDCG: 0.3477
Validation loss decreased (2.504713 --> 2.489067).  Saving model ...

Epoch 54/99
----------
train Loss: 2.0879 LRAP: 0.1160 NDCG: 0.3328
val Loss: 2.4984 LRAP: 0.1537 NDCG: 0.3427
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 2.0898 LRAP: 0.1228 NDCG: 0.3330
val Loss: 2.4835 LRAP: 0.1385 NDCG: 0.3359
Validation loss decreased (2.489067 --> 2.483530).  Saving model ...

Epoch 56/99
----------
train Loss: 2.0729 LRAP: 0.1182 NDCG: 0.3329
val Loss: 2.4948 LRAP: 0.1563 NDCG: 0.3439
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 2.0646 LRAP: 0.1233 NDCG: 0.3348
val Loss: 2.4810 LRAP: 0.1563 NDCG: 0.3506
Validation loss decreased (2.483530 --> 2.480966).  Saving model ...

Epoch 58/99
----------
train Loss: 2.0498 LRAP: 0.1201 NDCG: 0.3328
val Loss: 2.4951 LRAP: 0.1499 NDCG: 0.3417
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 2.0397 LRAP: 0.1241 NDCG: 0.3372
val Loss: 2.4917 LRAP: 0.1461 NDCG: 0.3420
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 2.0250 LRAP: 0.1225 NDCG: 0.3379
val Loss: 2.4955 LRAP: 0.1449 NDCG: 0.3337
EarlyStopping counter: 3 out of 50

Epoch 61/99
----------
train Loss: 2.0246 LRAP: 0.1239 NDCG: 0.3379
val Loss: 2.4687 LRAP: 0.1576 NDCG: 0.3488
Validation loss decreased (2.480966 --> 2.468709).  Saving model ...

Epoch 62/99
----------
train Loss: 2.0209 LRAP: 0.1192 NDCG: 0.3366
val Loss: 2.4911 LRAP: 0.1474 NDCG: 0.3493
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 1.9995 LRAP: 0.1231 NDCG: 0.3379
val Loss: 2.4976 LRAP: 0.1309 NDCG: 0.3319
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 1.9930 LRAP: 0.1239 NDCG: 0.3406
val Loss: 2.4865 LRAP: 0.1512 NDCG: 0.3434
EarlyStopping counter: 3 out of 50

Epoch 65/99
----------
train Loss: 1.9846 LRAP: 0.1222 NDCG: 0.3403
val Loss: 2.4833 LRAP: 0.1436 NDCG: 0.3522
EarlyStopping counter: 4 out of 50

Epoch 66/99
----------
train Loss: 1.9770 LRAP: 0.1201 NDCG: 0.3415
val Loss: 2.4744 LRAP: 0.1537 NDCG: 0.3548
EarlyStopping counter: 5 out of 50

Epoch 67/99
----------
train Loss: 1.9392 LRAP: 0.1198 NDCG: 0.3443
val Loss: 2.4477 LRAP: 0.1563 NDCG: 0.3505
Validation loss decreased (2.468709 --> 2.447736).  Saving model ...

Epoch 68/99
----------
train Loss: 1.9409 LRAP: 0.1261 NDCG: 0.3455
val Loss: 2.4400 LRAP: 0.1512 NDCG: 0.3532
Validation loss decreased (2.447736 --> 2.439963).  Saving model ...

Epoch 69/99
----------
train Loss: 1.9132 LRAP: 0.1239 NDCG: 0.3447
val Loss: 2.4458 LRAP: 0.1537 NDCG: 0.3556
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 1.9256 LRAP: 0.1214 NDCG: 0.3453
val Loss: 2.4428 LRAP: 0.1525 NDCG: 0.3532
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 1.9320 LRAP: 0.1198 NDCG: 0.3452
val Loss: 2.4364 LRAP: 0.1576 NDCG: 0.3584
Validation loss decreased (2.439963 --> 2.436445).  Saving model ...

Epoch 72/99
----------
train Loss: 1.9242 LRAP: 0.1307 NDCG: 0.3445
val Loss: 2.4370 LRAP: 0.1525 NDCG: 0.3560
EarlyStopping counter: 1 out of 50

Epoch 73/99
----------
train Loss: 1.9119 LRAP: 0.1285 NDCG: 0.3455
val Loss: 2.4343 LRAP: 0.1537 NDCG: 0.3571
Validation loss decreased (2.436445 --> 2.434300).  Saving model ...

Epoch 74/99
----------
train Loss: 1.9252 LRAP: 0.1271 NDCG: 0.3448
val Loss: 2.4392 LRAP: 0.1550 NDCG: 0.3567
EarlyStopping counter: 1 out of 50

Epoch 75/99
----------
train Loss: 1.8926 LRAP: 0.1293 NDCG: 0.3458
val Loss: 2.4367 LRAP: 0.1550 NDCG: 0.3575
EarlyStopping counter: 2 out of 50

Epoch 76/99
----------
train Loss: 1.9184 LRAP: 0.1277 NDCG: 0.3466
val Loss: 2.4318 LRAP: 0.1537 NDCG: 0.3555
Validation loss decreased (2.434300 --> 2.431815).  Saving model ...

Epoch 77/99
----------
train Loss: 1.8920 LRAP: 0.1266 NDCG: 0.3486
val Loss: 2.4375 LRAP: 0.1563 NDCG: 0.3614
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 1.8996 LRAP: 0.1301 NDCG: 0.3461
val Loss: 2.4387 LRAP: 0.1563 NDCG: 0.3610
EarlyStopping counter: 2 out of 50

Epoch 79/99
----------
train Loss: 1.8955 LRAP: 0.1247 NDCG: 0.3486
val Loss: 2.4391 LRAP: 0.1537 NDCG: 0.3566
EarlyStopping counter: 3 out of 50

Epoch 80/99
----------
train Loss: 1.8983 LRAP: 0.1231 NDCG: 0.3476
val Loss: 2.4386 LRAP: 0.1563 NDCG: 0.3602
EarlyStopping counter: 4 out of 50

Epoch 81/99
----------
train Loss: 1.9073 LRAP: 0.1241 NDCG: 0.3468
val Loss: 2.4336 LRAP: 0.1550 NDCG: 0.3557
EarlyStopping counter: 5 out of 50

Epoch 82/99
----------
train Loss: 1.8970 LRAP: 0.1195 NDCG: 0.3470
val Loss: 2.4346 LRAP: 0.1550 NDCG: 0.3572
EarlyStopping counter: 6 out of 50

Epoch 83/99
----------
train Loss: 1.8852 LRAP: 0.1310 NDCG: 0.3474
val Loss: 2.4306 LRAP: 0.1563 NDCG: 0.3593
Validation loss decreased (2.431815 --> 2.430563).  Saving model ...

Epoch 84/99
----------
train Loss: 1.8761 LRAP: 0.1258 NDCG: 0.3497
val Loss: 2.4299 LRAP: 0.1563 NDCG: 0.3623
Validation loss decreased (2.430563 --> 2.429940).  Saving model ...

Epoch 85/99
----------
train Loss: 1.8872 LRAP: 0.1252 NDCG: 0.3479
val Loss: 2.4298 LRAP: 0.1537 NDCG: 0.3613
Validation loss decreased (2.429940 --> 2.429811).  Saving model ...

Epoch 86/99
----------
train Loss: 1.9049 LRAP: 0.1247 NDCG: 0.3474
val Loss: 2.4274 LRAP: 0.1563 NDCG: 0.3595
Validation loss decreased (2.429811 --> 2.427390).  Saving model ...

Epoch 87/99
----------
train Loss: 1.8900 LRAP: 0.1288 NDCG: 0.3478
val Loss: 2.4309 LRAP: 0.1563 NDCG: 0.3609
EarlyStopping counter: 1 out of 50

Epoch 88/99
----------
train Loss: 1.9053 LRAP: 0.1239 NDCG: 0.3458
val Loss: 2.4283 LRAP: 0.1550 NDCG: 0.3593
EarlyStopping counter: 2 out of 50

Epoch 89/99
----------
train Loss: 1.8810 LRAP: 0.1236 NDCG: 0.3473
val Loss: 2.4297 LRAP: 0.1563 NDCG: 0.3603
EarlyStopping counter: 3 out of 50

Epoch 90/99
----------
train Loss: 1.8984 LRAP: 0.1266 NDCG: 0.3477
val Loss: 2.4279 LRAP: 0.1576 NDCG: 0.3603
EarlyStopping counter: 4 out of 50

Epoch 91/99
----------
train Loss: 1.8784 LRAP: 0.1258 NDCG: 0.3478
val Loss: 2.4312 LRAP: 0.1576 NDCG: 0.3592
EarlyStopping counter: 5 out of 50

Epoch 92/99
----------
train Loss: 1.8927 LRAP: 0.1285 NDCG: 0.3490
val Loss: 2.4292 LRAP: 0.1563 NDCG: 0.3606
EarlyStopping counter: 6 out of 50

Epoch 93/99
----------
train Loss: 1.8823 LRAP: 0.1236 NDCG: 0.3487
val Loss: 2.4279 LRAP: 0.1563 NDCG: 0.3607
EarlyStopping counter: 7 out of 50

Epoch 94/99
----------
train Loss: 1.8785 LRAP: 0.1236 NDCG: 0.3483
val Loss: 2.4324 LRAP: 0.1563 NDCG: 0.3597
EarlyStopping counter: 8 out of 50

Epoch 95/99
----------
train Loss: 1.8876 LRAP: 0.1304 NDCG: 0.3483
val Loss: 2.4338 LRAP: 0.1537 NDCG: 0.3603
EarlyStopping counter: 9 out of 50

Epoch 96/99
----------
train Loss: 1.8893 LRAP: 0.1293 NDCG: 0.3489
val Loss: 2.4245 LRAP: 0.1537 NDCG: 0.3613
Validation loss decreased (2.427390 --> 2.424488).  Saving model ...

Epoch 97/99
----------
train Loss: 1.8733 LRAP: 0.1310 NDCG: 0.3500
val Loss: 2.4291 LRAP: 0.1550 NDCG: 0.3605
EarlyStopping counter: 1 out of 50

Epoch 98/99
----------
train Loss: 1.8795 LRAP: 0.1250 NDCG: 0.3482
val Loss: 2.4348 LRAP: 0.1550 NDCG: 0.3595
EarlyStopping counter: 2 out of 50

Epoch 99/99
----------
train Loss: 1.9002 LRAP: 0.1307 NDCG: 0.3466
val Loss: 2.4312 LRAP: 0.1537 NDCG: 0.3594
EarlyStopping counter: 3 out of 50

Training complete in 2m 29s
Best val loss: 2.424488, best LRAP score: 0.7487

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.5144 LRAP: 0.0000 NDCG: 0.1698
val Loss: 4.3289 LRAP: 0.0000 NDCG: 0.1860
Validation loss decreased (0.000000 --> 4.328938).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0055 LRAP: 0.0016 NDCG: 0.1966
val Loss: 3.9948 LRAP: 0.0076 NDCG: 0.2161
Validation loss decreased (4.328938 --> 3.994772).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8004 LRAP: 0.0046 NDCG: 0.2131
val Loss: 4.3803 LRAP: 0.0051 NDCG: 0.2207
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.6779 LRAP: 0.0068 NDCG: 0.2217
val Loss: 4.0457 LRAP: 0.0076 NDCG: 0.2126
EarlyStopping counter: 2 out of 50

Epoch 4/99
----------
train Loss: 3.5896 LRAP: 0.0095 NDCG: 0.2231
val Loss: 3.6171 LRAP: 0.0102 NDCG: 0.2187
Validation loss decreased (3.994772 --> 3.617146).  Saving model ...

Epoch 5/99
----------
train Loss: 3.5368 LRAP: 0.0270 NDCG: 0.2230
val Loss: 3.9076 LRAP: 0.0292 NDCG: 0.2088
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.4675 LRAP: 0.0158 NDCG: 0.2283
val Loss: 3.7682 LRAP: 0.0356 NDCG: 0.1956
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.3769 LRAP: 0.0248 NDCG: 0.2326
val Loss: 3.4699 LRAP: 0.0152 NDCG: 0.2332
Validation loss decreased (3.617146 --> 3.469876).  Saving model ...

Epoch 8/99
----------
train Loss: 3.3227 LRAP: 0.0395 NDCG: 0.2383
val Loss: 3.5160 LRAP: 0.0661 NDCG: 0.2251
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.2485 LRAP: 0.0427 NDCG: 0.2444
val Loss: 3.5876 LRAP: 0.0559 NDCG: 0.2190
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.1996 LRAP: 0.0506 NDCG: 0.2485
val Loss: 3.4892 LRAP: 0.0254 NDCG: 0.2542
EarlyStopping counter: 3 out of 50

Epoch 11/99
----------
train Loss: 3.1226 LRAP: 0.0493 NDCG: 0.2530
val Loss: 3.6102 LRAP: 0.1118 NDCG: 0.2507
EarlyStopping counter: 4 out of 50

Epoch 12/99
----------
train Loss: 3.0959 LRAP: 0.0577 NDCG: 0.2599
val Loss: 3.1998 LRAP: 0.0889 NDCG: 0.2763
Validation loss decreased (3.469876 --> 3.199810).  Saving model ...

Epoch 13/99
----------
train Loss: 3.0479 LRAP: 0.0634 NDCG: 0.2651
val Loss: 3.1509 LRAP: 0.1194 NDCG: 0.2583
Validation loss decreased (3.199810 --> 3.150865).  Saving model ...

Epoch 14/99
----------
train Loss: 2.9905 LRAP: 0.0741 NDCG: 0.2649
val Loss: 3.3573 LRAP: 0.0788 NDCG: 0.2454
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 2.9406 LRAP: 0.0792 NDCG: 0.2728
val Loss: 3.1811 LRAP: 0.0915 NDCG: 0.2541
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 2.9145 LRAP: 0.0809 NDCG: 0.2746
val Loss: 3.1538 LRAP: 0.1207 NDCG: 0.2505
EarlyStopping counter: 3 out of 50

Epoch 17/99
----------
train Loss: 2.8774 LRAP: 0.0784 NDCG: 0.2747
val Loss: 3.1035 LRAP: 0.1055 NDCG: 0.2796
Validation loss decreased (3.150865 --> 3.103506).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8333 LRAP: 0.0792 NDCG: 0.2786
val Loss: 2.9549 LRAP: 0.0572 NDCG: 0.2788
Validation loss decreased (3.103506 --> 2.954869).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8031 LRAP: 0.0743 NDCG: 0.2818
val Loss: 2.8934 LRAP: 0.0889 NDCG: 0.2803
Validation loss decreased (2.954869 --> 2.893414).  Saving model ...

Epoch 20/99
----------
train Loss: 2.7649 LRAP: 0.0814 NDCG: 0.2849
val Loss: 2.8910 LRAP: 0.0254 NDCG: 0.2796
Validation loss decreased (2.893414 --> 2.890951).  Saving model ...

Epoch 21/99
----------
train Loss: 2.7473 LRAP: 0.0822 NDCG: 0.2860
val Loss: 2.8932 LRAP: 0.0813 NDCG: 0.3011
EarlyStopping counter: 1 out of 50

Epoch 22/99
----------
train Loss: 2.7102 LRAP: 0.0847 NDCG: 0.2896
val Loss: 2.9120 LRAP: 0.0813 NDCG: 0.2681
EarlyStopping counter: 2 out of 50

Epoch 23/99
----------
train Loss: 2.6703 LRAP: 0.0825 NDCG: 0.2900
val Loss: 2.9826 LRAP: 0.1334 NDCG: 0.2789
EarlyStopping counter: 3 out of 50

Epoch 24/99
----------
train Loss: 2.6574 LRAP: 0.0825 NDCG: 0.2943
val Loss: 2.7898 LRAP: 0.1017 NDCG: 0.2925
Validation loss decreased (2.890951 --> 2.789838).  Saving model ...

Epoch 25/99
----------
train Loss: 2.6250 LRAP: 0.0904 NDCG: 0.2939
val Loss: 3.0017 LRAP: 0.1321 NDCG: 0.2787
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 2.5688 LRAP: 0.0849 NDCG: 0.2981
val Loss: 2.7884 LRAP: 0.1182 NDCG: 0.3147
Validation loss decreased (2.789838 --> 2.788435).  Saving model ...

Epoch 27/99
----------
train Loss: 2.5431 LRAP: 0.0819 NDCG: 0.3004
val Loss: 2.7943 LRAP: 0.1131 NDCG: 0.3025
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 2.5276 LRAP: 0.0874 NDCG: 0.3038
val Loss: 2.7378 LRAP: 0.1245 NDCG: 0.2903
Validation loss decreased (2.788435 --> 2.737792).  Saving model ...

Epoch 29/99
----------
train Loss: 2.5084 LRAP: 0.0806 NDCG: 0.3048
val Loss: 2.8158 LRAP: 0.0813 NDCG: 0.3089
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.4820 LRAP: 0.0860 NDCG: 0.3098
val Loss: 2.6937 LRAP: 0.1042 NDCG: 0.3028
Validation loss decreased (2.737792 --> 2.693679).  Saving model ...

Epoch 31/99
----------
train Loss: 2.4385 LRAP: 0.0839 NDCG: 0.3101
val Loss: 2.9202 LRAP: 0.1245 NDCG: 0.2933
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.4300 LRAP: 0.0918 NDCG: 0.3119
val Loss: 2.6305 LRAP: 0.1144 NDCG: 0.3060
Validation loss decreased (2.693679 --> 2.630469).  Saving model ...

Epoch 33/99
----------
train Loss: 2.3475 LRAP: 0.0904 NDCG: 0.3128
val Loss: 2.6313 LRAP: 0.1207 NDCG: 0.3103
EarlyStopping counter: 1 out of 50

Epoch 34/99
----------
train Loss: 2.3320 LRAP: 0.0882 NDCG: 0.3193
val Loss: 2.6714 LRAP: 0.1182 NDCG: 0.3321
EarlyStopping counter: 2 out of 50

Epoch 35/99
----------
train Loss: 2.3225 LRAP: 0.0926 NDCG: 0.3175
val Loss: 2.6571 LRAP: 0.1080 NDCG: 0.3344
EarlyStopping counter: 3 out of 50

Epoch 36/99
----------
train Loss: 2.2924 LRAP: 0.0866 NDCG: 0.3212
val Loss: 2.5921 LRAP: 0.1017 NDCG: 0.3241
Validation loss decreased (2.630469 --> 2.592053).  Saving model ...

Epoch 37/99
----------
train Loss: 2.2747 LRAP: 0.0882 NDCG: 0.3216
val Loss: 2.5777 LRAP: 0.1334 NDCG: 0.3306
Validation loss decreased (2.592053 --> 2.577722).  Saving model ...

Epoch 38/99
----------
train Loss: 2.2487 LRAP: 0.0882 NDCG: 0.3263
val Loss: 2.6189 LRAP: 0.1182 NDCG: 0.3322
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 2.2387 LRAP: 0.0885 NDCG: 0.3291
val Loss: 2.5620 LRAP: 0.1194 NDCG: 0.3304
Validation loss decreased (2.577722 --> 2.562027).  Saving model ...

Epoch 40/99
----------
train Loss: 2.2120 LRAP: 0.0844 NDCG: 0.3280
val Loss: 2.6811 LRAP: 0.1283 NDCG: 0.3547
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 2.1850 LRAP: 0.0885 NDCG: 0.3332
val Loss: 2.5341 LRAP: 0.1334 NDCG: 0.3384
Validation loss decreased (2.562027 --> 2.534119).  Saving model ...

Epoch 42/99
----------
train Loss: 2.1622 LRAP: 0.0898 NDCG: 0.3327
val Loss: 2.5724 LRAP: 0.1245 NDCG: 0.3268
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 2.1184 LRAP: 0.0961 NDCG: 0.3357
val Loss: 2.5769 LRAP: 0.1245 NDCG: 0.3403
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 2.0894 LRAP: 0.0958 NDCG: 0.3365
val Loss: 2.6371 LRAP: 0.1144 NDCG: 0.3360
EarlyStopping counter: 3 out of 50

Epoch 45/99
----------
train Loss: 2.0467 LRAP: 0.0939 NDCG: 0.3397
val Loss: 2.5065 LRAP: 0.1347 NDCG: 0.3537
Validation loss decreased (2.534119 --> 2.506480).  Saving model ...

Epoch 46/99
----------
train Loss: 2.0486 LRAP: 0.0999 NDCG: 0.3405
val Loss: 2.5377 LRAP: 0.1321 NDCG: 0.3348
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 2.0575 LRAP: 0.0945 NDCG: 0.3438
val Loss: 2.5690 LRAP: 0.1372 NDCG: 0.3463
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 2.0106 LRAP: 0.0986 NDCG: 0.3434
val Loss: 2.5063 LRAP: 0.1360 NDCG: 0.3522
Validation loss decreased (2.506480 --> 2.506336).  Saving model ...

Epoch 49/99
----------
train Loss: 1.9607 LRAP: 0.0956 NDCG: 0.3443
val Loss: 2.4656 LRAP: 0.1245 NDCG: 0.3575
Validation loss decreased (2.506336 --> 2.465587).  Saving model ...

Epoch 50/99
----------
train Loss: 1.9304 LRAP: 0.0999 NDCG: 0.3484
val Loss: 2.5170 LRAP: 0.1423 NDCG: 0.3568
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 1.9194 LRAP: 0.0958 NDCG: 0.3482
val Loss: 2.4610 LRAP: 0.1309 NDCG: 0.3627
Validation loss decreased (2.465587 --> 2.460981).  Saving model ...

Epoch 52/99
----------
train Loss: 1.9008 LRAP: 0.0994 NDCG: 0.3493
val Loss: 2.4529 LRAP: 0.1436 NDCG: 0.3717
Validation loss decreased (2.460981 --> 2.452879).  Saving model ...

Epoch 53/99
----------
train Loss: 1.8883 LRAP: 0.0947 NDCG: 0.3538
val Loss: 2.5400 LRAP: 0.1537 NDCG: 0.3591
EarlyStopping counter: 1 out of 50

Epoch 54/99
----------
train Loss: 1.8686 LRAP: 0.0994 NDCG: 0.3528
val Loss: 2.4919 LRAP: 0.1461 NDCG: 0.3662
EarlyStopping counter: 2 out of 50

Epoch 55/99
----------
train Loss: 1.8688 LRAP: 0.1029 NDCG: 0.3542
val Loss: 2.4692 LRAP: 0.1436 NDCG: 0.3714
EarlyStopping counter: 3 out of 50

Epoch 56/99
----------
train Loss: 1.8526 LRAP: 0.0947 NDCG: 0.3534
val Loss: 2.4366 LRAP: 0.1550 NDCG: 0.3680
Validation loss decreased (2.452879 --> 2.436620).  Saving model ...

Epoch 57/99
----------
train Loss: 1.8021 LRAP: 0.0958 NDCG: 0.3561
val Loss: 2.4502 LRAP: 0.1474 NDCG: 0.3867
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 1.7763 LRAP: 0.1018 NDCG: 0.3585
val Loss: 2.4434 LRAP: 0.1525 NDCG: 0.3786
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 1.7682 LRAP: 0.0975 NDCG: 0.3613
val Loss: 2.5326 LRAP: 0.1576 NDCG: 0.3890
EarlyStopping counter: 3 out of 50

Epoch 60/99
----------
train Loss: 1.7663 LRAP: 0.1029 NDCG: 0.3644
val Loss: 2.4339 LRAP: 0.1499 NDCG: 0.3874
Validation loss decreased (2.436620 --> 2.433935).  Saving model ...

Epoch 61/99
----------
train Loss: 1.7490 LRAP: 0.0972 NDCG: 0.3593
val Loss: 2.4283 LRAP: 0.1525 NDCG: 0.3818
Validation loss decreased (2.433935 --> 2.428266).  Saving model ...

Epoch 62/99
----------
train Loss: 1.7142 LRAP: 0.0945 NDCG: 0.3628
val Loss: 2.4317 LRAP: 0.1550 NDCG: 0.3912
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 1.6896 LRAP: 0.0994 NDCG: 0.3621
val Loss: 2.4591 LRAP: 0.1537 NDCG: 0.3873
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 1.6921 LRAP: 0.0969 NDCG: 0.3621
val Loss: 2.4898 LRAP: 0.1601 NDCG: 0.3815
EarlyStopping counter: 3 out of 50

Epoch 65/99
----------
train Loss: 1.6779 LRAP: 0.0994 NDCG: 0.3619
val Loss: 2.4402 LRAP: 0.1487 NDCG: 0.3839
EarlyStopping counter: 4 out of 50

Epoch 66/99
----------
train Loss: 1.6576 LRAP: 0.0999 NDCG: 0.3653
val Loss: 2.5293 LRAP: 0.1626 NDCG: 0.3951
EarlyStopping counter: 5 out of 50

Epoch 67/99
----------
train Loss: 1.5896 LRAP: 0.1018 NDCG: 0.3641
val Loss: 2.3607 LRAP: 0.1601 NDCG: 0.4035
Validation loss decreased (2.428266 --> 2.360745).  Saving model ...

Epoch 68/99
----------
train Loss: 1.5381 LRAP: 0.1067 NDCG: 0.3668
val Loss: 2.3494 LRAP: 0.1614 NDCG: 0.3981
Validation loss decreased (2.360745 --> 2.349415).  Saving model ...

Epoch 69/99
----------
train Loss: 1.5225 LRAP: 0.0991 NDCG: 0.3691
val Loss: 2.3627 LRAP: 0.1652 NDCG: 0.4040
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 1.5055 LRAP: 0.1048 NDCG: 0.3690
val Loss: 2.3601 LRAP: 0.1614 NDCG: 0.4016
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 1.4970 LRAP: 0.1089 NDCG: 0.3699
val Loss: 2.3638 LRAP: 0.1703 NDCG: 0.4010
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 1.5038 LRAP: 0.1108 NDCG: 0.3688
val Loss: 2.3541 LRAP: 0.1639 NDCG: 0.3991
EarlyStopping counter: 4 out of 50

Epoch 73/99
----------
train Loss: 1.4868 LRAP: 0.1097 NDCG: 0.3702
val Loss: 2.3571 LRAP: 0.1677 NDCG: 0.4064
EarlyStopping counter: 5 out of 50

Epoch 74/99
----------
train Loss: 1.4870 LRAP: 0.1135 NDCG: 0.3696
val Loss: 2.3577 LRAP: 0.1677 NDCG: 0.4055
EarlyStopping counter: 6 out of 50

Epoch 75/99
----------
train Loss: 1.4613 LRAP: 0.1119 NDCG: 0.3695
val Loss: 2.3560 LRAP: 0.1703 NDCG: 0.4074
EarlyStopping counter: 7 out of 50

Epoch 76/99
----------
train Loss: 1.4582 LRAP: 0.1094 NDCG: 0.3708
val Loss: 2.3606 LRAP: 0.1728 NDCG: 0.4085
EarlyStopping counter: 8 out of 50

Epoch 77/99
----------
train Loss: 1.4539 LRAP: 0.1143 NDCG: 0.3693
val Loss: 2.3581 LRAP: 0.1665 NDCG: 0.4068
EarlyStopping counter: 9 out of 50

Epoch 78/99
----------
train Loss: 1.4636 LRAP: 0.1182 NDCG: 0.3721
val Loss: 2.3617 LRAP: 0.1703 NDCG: 0.4062
EarlyStopping counter: 10 out of 50

Epoch 79/99
----------
train Loss: 1.4619 LRAP: 0.1067 NDCG: 0.3681
val Loss: 2.3606 LRAP: 0.1677 NDCG: 0.4037
EarlyStopping counter: 11 out of 50

Epoch 80/99
----------
train Loss: 1.4588 LRAP: 0.1084 NDCG: 0.3698
val Loss: 2.3539 LRAP: 0.1690 NDCG: 0.4065
EarlyStopping counter: 12 out of 50

Epoch 81/99
----------
train Loss: 1.4564 LRAP: 0.1149 NDCG: 0.3703
val Loss: 2.3600 LRAP: 0.1703 NDCG: 0.4067
EarlyStopping counter: 13 out of 50

Epoch 82/99
----------
train Loss: 1.4618 LRAP: 0.1094 NDCG: 0.3701
val Loss: 2.3548 LRAP: 0.1677 NDCG: 0.4079
EarlyStopping counter: 14 out of 50

Epoch 83/99
----------
train Loss: 1.4524 LRAP: 0.1065 NDCG: 0.3699
val Loss: 2.3583 LRAP: 0.1690 NDCG: 0.4068
EarlyStopping counter: 15 out of 50

Epoch 84/99
----------
train Loss: 1.4587 LRAP: 0.1114 NDCG: 0.3709
val Loss: 2.3557 LRAP: 0.1690 NDCG: 0.4069
EarlyStopping counter: 16 out of 50

Epoch 85/99
----------
train Loss: 1.4651 LRAP: 0.1081 NDCG: 0.3700
val Loss: 2.3534 LRAP: 0.1665 NDCG: 0.4048
EarlyStopping counter: 17 out of 50

Epoch 86/99
----------
train Loss: 1.4537 LRAP: 0.1065 NDCG: 0.3698
val Loss: 2.3610 LRAP: 0.1690 NDCG: 0.4072
EarlyStopping counter: 18 out of 50

Epoch 87/99
----------
train Loss: 1.4626 LRAP: 0.1103 NDCG: 0.3715
val Loss: 2.3561 LRAP: 0.1677 NDCG: 0.4038
EarlyStopping counter: 19 out of 50

Epoch 88/99
----------
train Loss: 1.4532 LRAP: 0.1127 NDCG: 0.3693
val Loss: 2.3569 LRAP: 0.1715 NDCG: 0.4069
EarlyStopping counter: 20 out of 50

Epoch 89/99
----------
train Loss: 1.4620 LRAP: 0.1040 NDCG: 0.3700
val Loss: 2.3616 LRAP: 0.1690 NDCG: 0.4081
EarlyStopping counter: 21 out of 50

Epoch 90/99
----------
train Loss: 1.4573 LRAP: 0.1138 NDCG: 0.3695
val Loss: 2.3589 LRAP: 0.1715 NDCG: 0.4077
EarlyStopping counter: 22 out of 50

Epoch 91/99
----------
train Loss: 1.4551 LRAP: 0.1075 NDCG: 0.3707
val Loss: 2.3524 LRAP: 0.1665 NDCG: 0.4051
EarlyStopping counter: 23 out of 50

Epoch 92/99
----------
train Loss: 1.4562 LRAP: 0.1078 NDCG: 0.3710
val Loss: 2.3615 LRAP: 0.1677 NDCG: 0.4066
EarlyStopping counter: 24 out of 50

Epoch 93/99
----------
train Loss: 1.4614 LRAP: 0.1081 NDCG: 0.3696
val Loss: 2.3596 LRAP: 0.1665 NDCG: 0.4055
EarlyStopping counter: 25 out of 50

Epoch 94/99
----------
train Loss: 1.4538 LRAP: 0.1122 NDCG: 0.3710
val Loss: 2.3544 LRAP: 0.1703 NDCG: 0.4078
EarlyStopping counter: 26 out of 50

Epoch 95/99
----------
train Loss: 1.4574 LRAP: 0.1116 NDCG: 0.3708
val Loss: 2.3587 LRAP: 0.1741 NDCG: 0.4071
EarlyStopping counter: 27 out of 50

Epoch 96/99
----------
train Loss: 1.4547 LRAP: 0.1122 NDCG: 0.3716
val Loss: 2.3578 LRAP: 0.1690 NDCG: 0.4064
EarlyStopping counter: 28 out of 50

Epoch 97/99
----------
train Loss: 1.4607 LRAP: 0.1100 NDCG: 0.3703
val Loss: 2.3592 LRAP: 0.1690 NDCG: 0.4063
EarlyStopping counter: 29 out of 50

Epoch 98/99
----------
train Loss: 1.4467 LRAP: 0.1084 NDCG: 0.3696
val Loss: 2.3612 LRAP: 0.1665 NDCG: 0.4049
EarlyStopping counter: 30 out of 50

Epoch 99/99
----------
train Loss: 1.4592 LRAP: 0.1116 NDCG: 0.3705
val Loss: 2.3587 LRAP: 0.1665 NDCG: 0.4054
EarlyStopping counter: 31 out of 50

Training complete in 2m 28s
Best val loss: 2.349415, best LRAP score: 0.7648

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.6870 LRAP: 0.0000 NDCG: 0.1668
val Loss: 4.6147 LRAP: 0.0000 NDCG: 0.1303
Validation loss decreased (0.000000 --> 4.614735).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1251 LRAP: 0.0003 NDCG: 0.1848
val Loss: 4.6347 LRAP: 0.0000 NDCG: 0.1639
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.9228 LRAP: 0.0025 NDCG: 0.1985
val Loss: 4.3128 LRAP: 0.0038 NDCG: 0.2165
Validation loss decreased (4.614735 --> 4.312810).  Saving model ...

Epoch 3/99
----------
train Loss: 3.8126 LRAP: 0.0060 NDCG: 0.2058
val Loss: 5.7871 LRAP: 0.0051 NDCG: 0.2220
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.7408 LRAP: 0.0065 NDCG: 0.2122
val Loss: 4.1122 LRAP: 0.0064 NDCG: 0.2075
Validation loss decreased (4.312810 --> 4.112184).  Saving model ...

Epoch 5/99
----------
train Loss: 3.6456 LRAP: 0.0046 NDCG: 0.2172
val Loss: 4.8650 LRAP: 0.0089 NDCG: 0.2403
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.6049 LRAP: 0.0082 NDCG: 0.2215
val Loss: 4.2798 LRAP: 0.0013 NDCG: 0.1751
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.5559 LRAP: 0.0068 NDCG: 0.2234
val Loss: 4.7444 LRAP: 0.0000 NDCG: 0.1676
EarlyStopping counter: 3 out of 50

Epoch 8/99
----------
train Loss: 3.5182 LRAP: 0.0112 NDCG: 0.2272
val Loss: 4.2924 LRAP: 0.0025 NDCG: 0.1858
EarlyStopping counter: 4 out of 50

Epoch 9/99
----------
train Loss: 3.4860 LRAP: 0.0106 NDCG: 0.2271
val Loss: 4.4644 LRAP: 0.0102 NDCG: 0.1996
EarlyStopping counter: 5 out of 50

Epoch 10/99
----------
train Loss: 3.4307 LRAP: 0.0150 NDCG: 0.2333
val Loss: 3.7643 LRAP: 0.0241 NDCG: 0.2020
Validation loss decreased (4.112184 --> 3.764312).  Saving model ...

Epoch 11/99
----------
train Loss: 3.3923 LRAP: 0.0120 NDCG: 0.2324
val Loss: 3.9232 LRAP: 0.0038 NDCG: 0.2003
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.3695 LRAP: 0.0191 NDCG: 0.2333
val Loss: 3.6312 LRAP: 0.0127 NDCG: 0.2129
Validation loss decreased (3.764312 --> 3.631179).  Saving model ...

Epoch 13/99
----------
train Loss: 3.3538 LRAP: 0.0163 NDCG: 0.2339
val Loss: 3.6420 LRAP: 0.0152 NDCG: 0.2067
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.3306 LRAP: 0.0152 NDCG: 0.2350
val Loss: 3.7082 LRAP: 0.0216 NDCG: 0.1981
EarlyStopping counter: 2 out of 50

Epoch 15/99
----------
train Loss: 3.3087 LRAP: 0.0218 NDCG: 0.2364
val Loss: 3.4352 LRAP: 0.0191 NDCG: 0.2180
Validation loss decreased (3.631179 --> 3.435173).  Saving model ...

Epoch 16/99
----------
train Loss: 3.2870 LRAP: 0.0264 NDCG: 0.2378
val Loss: 3.8572 LRAP: 0.0470 NDCG: 0.1937
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 3.2768 LRAP: 0.0280 NDCG: 0.2393
val Loss: 3.7572 LRAP: 0.0165 NDCG: 0.2436
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 3.2719 LRAP: 0.0308 NDCG: 0.2404
val Loss: 3.6310 LRAP: 0.0089 NDCG: 0.2069
EarlyStopping counter: 3 out of 50

Epoch 19/99
----------
train Loss: 3.2418 LRAP: 0.0316 NDCG: 0.2423
val Loss: 3.3407 LRAP: 0.0368 NDCG: 0.2364
Validation loss decreased (3.435173 --> 3.340706).  Saving model ...

Epoch 20/99
----------
train Loss: 3.2209 LRAP: 0.0354 NDCG: 0.2430
val Loss: 3.9936 LRAP: 0.0165 NDCG: 0.1858
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.2147 LRAP: 0.0376 NDCG: 0.2454
val Loss: 3.3394 LRAP: 0.0419 NDCG: 0.2429
Validation loss decreased (3.340706 --> 3.339365).  Saving model ...

Epoch 22/99
----------
train Loss: 3.2063 LRAP: 0.0343 NDCG: 0.2484
val Loss: 3.3812 LRAP: 0.0470 NDCG: 0.2382
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 3.1800 LRAP: 0.0417 NDCG: 0.2482
val Loss: 3.4393 LRAP: 0.0254 NDCG: 0.2307
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 3.1659 LRAP: 0.0449 NDCG: 0.2502
val Loss: 4.2722 LRAP: 0.0343 NDCG: 0.2420
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 3.1515 LRAP: 0.0447 NDCG: 0.2523
val Loss: 3.6831 LRAP: 0.0241 NDCG: 0.2139
EarlyStopping counter: 4 out of 50

Epoch 26/99
----------
train Loss: 3.1534 LRAP: 0.0539 NDCG: 0.2548
val Loss: 3.3713 LRAP: 0.0572 NDCG: 0.2297
EarlyStopping counter: 5 out of 50

Epoch 27/99
----------
train Loss: 3.1105 LRAP: 0.0463 NDCG: 0.2543
val Loss: 3.1837 LRAP: 0.0762 NDCG: 0.2554
Validation loss decreased (3.339365 --> 3.183658).  Saving model ...

Epoch 28/99
----------
train Loss: 3.0967 LRAP: 0.0574 NDCG: 0.2568
val Loss: 3.1985 LRAP: 0.0877 NDCG: 0.2580
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 3.0876 LRAP: 0.0566 NDCG: 0.2560
val Loss: 3.1715 LRAP: 0.0775 NDCG: 0.2552
Validation loss decreased (3.183658 --> 3.171452).  Saving model ...

Epoch 30/99
----------
train Loss: 3.0920 LRAP: 0.0580 NDCG: 0.2566
val Loss: 3.1657 LRAP: 0.0813 NDCG: 0.2577
Validation loss decreased (3.171452 --> 3.165741).  Saving model ...

Epoch 31/99
----------
train Loss: 3.0838 LRAP: 0.0539 NDCG: 0.2589
val Loss: 3.1828 LRAP: 0.0699 NDCG: 0.2516
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 3.0723 LRAP: 0.0569 NDCG: 0.2582
val Loss: 3.1746 LRAP: 0.0762 NDCG: 0.2551
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 3.0804 LRAP: 0.0602 NDCG: 0.2585
val Loss: 3.1533 LRAP: 0.0724 NDCG: 0.2547
Validation loss decreased (3.165741 --> 3.153253).  Saving model ...

Epoch 34/99
----------
train Loss: 3.0704 LRAP: 0.0545 NDCG: 0.2594
val Loss: 3.1567 LRAP: 0.0801 NDCG: 0.2586
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.0436 LRAP: 0.0539 NDCG: 0.2602
val Loss: 3.1486 LRAP: 0.0813 NDCG: 0.2604
Validation loss decreased (3.153253 --> 3.148574).  Saving model ...

Epoch 36/99
----------
train Loss: 3.0710 LRAP: 0.0577 NDCG: 0.2605
val Loss: 3.1693 LRAP: 0.0902 NDCG: 0.2600
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 3.0541 LRAP: 0.0580 NDCG: 0.2600
val Loss: 3.1517 LRAP: 0.0902 NDCG: 0.2590
EarlyStopping counter: 2 out of 50

Epoch 38/99
----------
train Loss: 3.0640 LRAP: 0.0596 NDCG: 0.2612
val Loss: 3.1792 LRAP: 0.0864 NDCG: 0.2552
EarlyStopping counter: 3 out of 50

Epoch 39/99
----------
train Loss: 3.0497 LRAP: 0.0588 NDCG: 0.2609
val Loss: 3.1491 LRAP: 0.0813 NDCG: 0.2562
EarlyStopping counter: 4 out of 50

Epoch 40/99
----------
train Loss: 3.0414 LRAP: 0.0596 NDCG: 0.2617
val Loss: 3.1755 LRAP: 0.0559 NDCG: 0.2588
EarlyStopping counter: 5 out of 50

Epoch 41/99
----------
train Loss: 3.0533 LRAP: 0.0602 NDCG: 0.2625
val Loss: 3.1304 LRAP: 0.0839 NDCG: 0.2598
Validation loss decreased (3.148574 --> 3.130420).  Saving model ...

Epoch 42/99
----------
train Loss: 3.0396 LRAP: 0.0583 NDCG: 0.2617
val Loss: 3.1255 LRAP: 0.0813 NDCG: 0.2616
Validation loss decreased (3.130420 --> 3.125484).  Saving model ...

Epoch 43/99
----------
train Loss: 3.0308 LRAP: 0.0629 NDCG: 0.2640
val Loss: 3.1314 LRAP: 0.0788 NDCG: 0.2579
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.0227 LRAP: 0.0610 NDCG: 0.2632
val Loss: 3.1264 LRAP: 0.0813 NDCG: 0.2601
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 3.0503 LRAP: 0.0596 NDCG: 0.2642
val Loss: 3.1249 LRAP: 0.0801 NDCG: 0.2610
Validation loss decreased (3.125484 --> 3.124917).  Saving model ...

Epoch 46/99
----------
train Loss: 3.0393 LRAP: 0.0610 NDCG: 0.2634
val Loss: 3.1227 LRAP: 0.0902 NDCG: 0.2616
Validation loss decreased (3.124917 --> 3.122747).  Saving model ...

Epoch 47/99
----------
train Loss: 3.0270 LRAP: 0.0583 NDCG: 0.2637
val Loss: 3.1245 LRAP: 0.0826 NDCG: 0.2609
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.0439 LRAP: 0.0623 NDCG: 0.2642
val Loss: 3.1257 LRAP: 0.0813 NDCG: 0.2615
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.0456 LRAP: 0.0618 NDCG: 0.2613
val Loss: 3.1204 LRAP: 0.0813 NDCG: 0.2614
Validation loss decreased (3.122747 --> 3.120407).  Saving model ...

Epoch 50/99
----------
train Loss: 3.0222 LRAP: 0.0596 NDCG: 0.2629
val Loss: 3.1205 LRAP: 0.0788 NDCG: 0.2617
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 3.0261 LRAP: 0.0604 NDCG: 0.2656
val Loss: 3.1237 LRAP: 0.0813 NDCG: 0.2606
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 3.0346 LRAP: 0.0626 NDCG: 0.2653
val Loss: 3.1219 LRAP: 0.0813 NDCG: 0.2608
EarlyStopping counter: 3 out of 50

Epoch 53/99
----------
train Loss: 3.0353 LRAP: 0.0634 NDCG: 0.2625
val Loss: 3.1241 LRAP: 0.0889 NDCG: 0.2602
EarlyStopping counter: 4 out of 50

Epoch 54/99
----------
train Loss: 3.0304 LRAP: 0.0588 NDCG: 0.2639
val Loss: 3.1193 LRAP: 0.0801 NDCG: 0.2605
Validation loss decreased (3.120407 --> 3.119345).  Saving model ...

Epoch 55/99
----------
train Loss: 3.0396 LRAP: 0.0588 NDCG: 0.2635
val Loss: 3.1246 LRAP: 0.0801 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 3.0341 LRAP: 0.0607 NDCG: 0.2648
val Loss: 3.1177 LRAP: 0.0826 NDCG: 0.2626
Validation loss decreased (3.119345 --> 3.117659).  Saving model ...

Epoch 57/99
----------
train Loss: 3.0317 LRAP: 0.0594 NDCG: 0.2641
val Loss: 3.1205 LRAP: 0.0826 NDCG: 0.2618
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 3.0273 LRAP: 0.0613 NDCG: 0.2640
val Loss: 3.1189 LRAP: 0.0788 NDCG: 0.2617
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 3.0203 LRAP: 0.0585 NDCG: 0.2661
val Loss: 3.1135 LRAP: 0.0864 NDCG: 0.2630
Validation loss decreased (3.117659 --> 3.113480).  Saving model ...

Epoch 60/99
----------
train Loss: 3.0334 LRAP: 0.0618 NDCG: 0.2640
val Loss: 3.1173 LRAP: 0.0839 NDCG: 0.2620
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 3.0347 LRAP: 0.0607 NDCG: 0.2649
val Loss: 3.1135 LRAP: 0.0902 NDCG: 0.2623
EarlyStopping counter: 2 out of 50

Epoch 62/99
----------
train Loss: 3.0151 LRAP: 0.0651 NDCG: 0.2666
val Loss: 3.1140 LRAP: 0.0839 NDCG: 0.2621
EarlyStopping counter: 3 out of 50

Epoch 63/99
----------
train Loss: 3.0201 LRAP: 0.0596 NDCG: 0.2649
val Loss: 3.1145 LRAP: 0.0839 NDCG: 0.2615
EarlyStopping counter: 4 out of 50

Epoch 64/99
----------
train Loss: 3.0260 LRAP: 0.0667 NDCG: 0.2662
val Loss: 3.1118 LRAP: 0.0877 NDCG: 0.2634
Validation loss decreased (3.113480 --> 3.111764).  Saving model ...

Epoch 65/99
----------
train Loss: 3.0240 LRAP: 0.0615 NDCG: 0.2652
val Loss: 3.1153 LRAP: 0.0851 NDCG: 0.2619
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 3.0189 LRAP: 0.0618 NDCG: 0.2664
val Loss: 3.1099 LRAP: 0.0826 NDCG: 0.2636
Validation loss decreased (3.111764 --> 3.109869).  Saving model ...

Epoch 67/99
----------
train Loss: 3.0277 LRAP: 0.0656 NDCG: 0.2658
val Loss: 3.1152 LRAP: 0.0839 NDCG: 0.2619
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 3.0206 LRAP: 0.0653 NDCG: 0.2648
val Loss: 3.1112 LRAP: 0.0813 NDCG: 0.2633
EarlyStopping counter: 2 out of 50

Epoch 69/99
----------
train Loss: 3.0229 LRAP: 0.0626 NDCG: 0.2656
val Loss: 3.1114 LRAP: 0.0801 NDCG: 0.2644
EarlyStopping counter: 3 out of 50

Epoch 70/99
----------
train Loss: 3.0250 LRAP: 0.0653 NDCG: 0.2650
val Loss: 3.1134 LRAP: 0.0877 NDCG: 0.2612
EarlyStopping counter: 4 out of 50

Epoch 71/99
----------
train Loss: 3.0230 LRAP: 0.0662 NDCG: 0.2644
val Loss: 3.1122 LRAP: 0.0851 NDCG: 0.2618
EarlyStopping counter: 5 out of 50

Epoch 72/99
----------
train Loss: 3.0177 LRAP: 0.0667 NDCG: 0.2649
val Loss: 3.1077 LRAP: 0.0864 NDCG: 0.2633
Validation loss decreased (3.109869 --> 3.107702).  Saving model ...

Epoch 73/99
----------
train Loss: 3.0219 LRAP: 0.0645 NDCG: 0.2644
val Loss: 3.1107 LRAP: 0.0864 NDCG: 0.2628
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 3.0105 LRAP: 0.0640 NDCG: 0.2666
val Loss: 3.1137 LRAP: 0.0864 NDCG: 0.2609
EarlyStopping counter: 2 out of 50

Epoch 75/99
----------
train Loss: 3.0215 LRAP: 0.0651 NDCG: 0.2648
val Loss: 3.1087 LRAP: 0.0877 NDCG: 0.2646
EarlyStopping counter: 3 out of 50

Epoch 76/99
----------
train Loss: 3.0179 LRAP: 0.0697 NDCG: 0.2666
val Loss: 3.1119 LRAP: 0.0788 NDCG: 0.2625
EarlyStopping counter: 4 out of 50

Epoch 77/99
----------
train Loss: 3.0158 LRAP: 0.0637 NDCG: 0.2645
val Loss: 3.1076 LRAP: 0.0864 NDCG: 0.2640
Validation loss decreased (3.107702 --> 3.107599).  Saving model ...

Epoch 78/99
----------
train Loss: 3.0150 LRAP: 0.0615 NDCG: 0.2666
val Loss: 3.1082 LRAP: 0.0889 NDCG: 0.2635
EarlyStopping counter: 1 out of 50

Epoch 79/99
----------
train Loss: 3.0164 LRAP: 0.0618 NDCG: 0.2641
val Loss: 3.1072 LRAP: 0.0851 NDCG: 0.2640
Validation loss decreased (3.107599 --> 3.107247).  Saving model ...

Epoch 80/99
----------
train Loss: 3.0199 LRAP: 0.0640 NDCG: 0.2641
val Loss: 3.1090 LRAP: 0.0877 NDCG: 0.2632
EarlyStopping counter: 1 out of 50

Epoch 81/99
----------
train Loss: 3.0127 LRAP: 0.0629 NDCG: 0.2659
val Loss: 3.1102 LRAP: 0.0851 NDCG: 0.2631
EarlyStopping counter: 2 out of 50

Epoch 82/99
----------
train Loss: 3.0074 LRAP: 0.0662 NDCG: 0.2660
val Loss: 3.1102 LRAP: 0.0839 NDCG: 0.2632
EarlyStopping counter: 3 out of 50

Epoch 83/99
----------
train Loss: 3.0135 LRAP: 0.0634 NDCG: 0.2653
val Loss: 3.1053 LRAP: 0.0877 NDCG: 0.2647
Validation loss decreased (3.107247 --> 3.105306).  Saving model ...

Epoch 84/99
----------
train Loss: 3.0142 LRAP: 0.0675 NDCG: 0.2648
val Loss: 3.1073 LRAP: 0.0851 NDCG: 0.2638
EarlyStopping counter: 1 out of 50

Epoch 85/99
----------
train Loss: 3.0150 LRAP: 0.0623 NDCG: 0.2659
val Loss: 3.1110 LRAP: 0.0851 NDCG: 0.2631
EarlyStopping counter: 2 out of 50

Epoch 86/99
----------
train Loss: 3.0144 LRAP: 0.0615 NDCG: 0.2657
val Loss: 3.1056 LRAP: 0.0877 NDCG: 0.2649
EarlyStopping counter: 3 out of 50

Epoch 87/99
----------
train Loss: 3.0138 LRAP: 0.0599 NDCG: 0.2660
val Loss: 3.1120 LRAP: 0.0813 NDCG: 0.2616
EarlyStopping counter: 4 out of 50

Epoch 88/99
----------
train Loss: 3.0216 LRAP: 0.0621 NDCG: 0.2667
val Loss: 3.1075 LRAP: 0.0902 NDCG: 0.2645
EarlyStopping counter: 5 out of 50

Epoch 89/99
----------
train Loss: 3.0096 LRAP: 0.0596 NDCG: 0.2656
val Loss: 3.1095 LRAP: 0.0928 NDCG: 0.2642
EarlyStopping counter: 6 out of 50

Epoch 90/99
----------
train Loss: 3.0172 LRAP: 0.0675 NDCG: 0.2669
val Loss: 3.1094 LRAP: 0.0851 NDCG: 0.2635
EarlyStopping counter: 7 out of 50

Epoch 91/99
----------
train Loss: 3.0137 LRAP: 0.0683 NDCG: 0.2655
val Loss: 3.1100 LRAP: 0.0851 NDCG: 0.2631
EarlyStopping counter: 8 out of 50

Epoch 92/99
----------
train Loss: 3.0080 LRAP: 0.0615 NDCG: 0.2656
val Loss: 3.1107 LRAP: 0.0801 NDCG: 0.2631
EarlyStopping counter: 9 out of 50

Epoch 93/99
----------
train Loss: 3.0171 LRAP: 0.0659 NDCG: 0.2662
val Loss: 3.1111 LRAP: 0.0864 NDCG: 0.2629
EarlyStopping counter: 10 out of 50

Epoch 94/99
----------
train Loss: 3.0117 LRAP: 0.0591 NDCG: 0.2663
val Loss: 3.1068 LRAP: 0.0864 NDCG: 0.2640
EarlyStopping counter: 11 out of 50

Epoch 95/99
----------
train Loss: 3.0148 LRAP: 0.0659 NDCG: 0.2657
val Loss: 3.1077 LRAP: 0.0902 NDCG: 0.2643
EarlyStopping counter: 12 out of 50

Epoch 96/99
----------
train Loss: 3.0118 LRAP: 0.0594 NDCG: 0.2665
val Loss: 3.1081 LRAP: 0.0864 NDCG: 0.2642
EarlyStopping counter: 13 out of 50

Epoch 97/99
----------
train Loss: 3.0108 LRAP: 0.0700 NDCG: 0.2666
val Loss: 3.1101 LRAP: 0.0851 NDCG: 0.2638
EarlyStopping counter: 14 out of 50

Epoch 98/99
----------
train Loss: 3.0083 LRAP: 0.0632 NDCG: 0.2655
val Loss: 3.1080 LRAP: 0.0839 NDCG: 0.2638
EarlyStopping counter: 15 out of 50

Epoch 99/99
----------
train Loss: 3.0188 LRAP: 0.0604 NDCG: 0.2659
val Loss: 3.1119 LRAP: 0.0851 NDCG: 0.2628
EarlyStopping counter: 16 out of 50

Training complete in 2m 32s
Best val loss: 3.105306, best LRAP score: 0.5985

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6293 LRAP: 0.0000 NDCG: 0.1686
val Loss: 4.6283 LRAP: 0.0000 NDCG: 0.1618
Validation loss decreased (0.000000 --> 4.628332).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9840 LRAP: 0.0000 NDCG: 0.1984
val Loss: 7.2936 LRAP: 0.0013 NDCG: 0.1688
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.8632 LRAP: 0.0041 NDCG: 0.2124
val Loss: 4.1825 LRAP: 0.0076 NDCG: 0.2211
Validation loss decreased (4.628332 --> 4.182485).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7937 LRAP: 0.0068 NDCG: 0.2172
val Loss: 4.7137 LRAP: 0.0089 NDCG: 0.2175
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.7310 LRAP: 0.0079 NDCG: 0.2182
val Loss: 4.5242 LRAP: 0.0000 NDCG: 0.1720
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.6942 LRAP: 0.0093 NDCG: 0.2220
val Loss: 4.4421 LRAP: 0.0076 NDCG: 0.1638
EarlyStopping counter: 3 out of 50

Epoch 6/99
----------
train Loss: 3.6613 LRAP: 0.0120 NDCG: 0.2227
val Loss: 3.9382 LRAP: 0.0025 NDCG: 0.2181
Validation loss decreased (4.182485 --> 3.938228).  Saving model ...

Epoch 7/99
----------
train Loss: 3.6268 LRAP: 0.0161 NDCG: 0.2254
val Loss: 4.0048 LRAP: 0.0000 NDCG: 0.1930
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.5877 LRAP: 0.0166 NDCG: 0.2329
val Loss: 5.7324 LRAP: 0.0102 NDCG: 0.2164
EarlyStopping counter: 2 out of 50

Epoch 9/99
----------
train Loss: 3.5623 LRAP: 0.0365 NDCG: 0.2312
val Loss: 4.5686 LRAP: 0.0330 NDCG: 0.1723
EarlyStopping counter: 3 out of 50

Epoch 10/99
----------
train Loss: 3.5067 LRAP: 0.0365 NDCG: 0.2350
val Loss: 4.5722 LRAP: 0.0051 NDCG: 0.1718
EarlyStopping counter: 4 out of 50

Epoch 11/99
----------
train Loss: 3.4799 LRAP: 0.0310 NDCG: 0.2363
val Loss: 3.6388 LRAP: 0.0483 NDCG: 0.2282
Validation loss decreased (3.938228 --> 3.638799).  Saving model ...

Epoch 12/99
----------
train Loss: 3.4530 LRAP: 0.0381 NDCG: 0.2398
val Loss: 3.8988 LRAP: 0.0470 NDCG: 0.2181
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.4360 LRAP: 0.0368 NDCG: 0.2399
val Loss: 3.5225 LRAP: 0.0432 NDCG: 0.2257
Validation loss decreased (3.638799 --> 3.522452).  Saving model ...

Epoch 14/99
----------
train Loss: 3.4027 LRAP: 0.0430 NDCG: 0.2389
val Loss: 3.8839 LRAP: 0.1004 NDCG: 0.2043
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 3.3700 LRAP: 0.0487 NDCG: 0.2453
val Loss: 4.1021 LRAP: 0.0254 NDCG: 0.1957
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 3.3570 LRAP: 0.0528 NDCG: 0.2462
val Loss: 4.3170 LRAP: 0.0610 NDCG: 0.2127
EarlyStopping counter: 3 out of 50

Epoch 17/99
----------
train Loss: 3.3383 LRAP: 0.0553 NDCG: 0.2483
val Loss: 3.6471 LRAP: 0.0483 NDCG: 0.2313
EarlyStopping counter: 4 out of 50

Epoch 18/99
----------
train Loss: 3.3143 LRAP: 0.0561 NDCG: 0.2482
val Loss: 3.4562 LRAP: 0.0801 NDCG: 0.2399
Validation loss decreased (3.522452 --> 3.456230).  Saving model ...

Epoch 19/99
----------
train Loss: 3.2974 LRAP: 0.0602 NDCG: 0.2475
val Loss: 4.3754 LRAP: 0.0470 NDCG: 0.1668
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.2771 LRAP: 0.0588 NDCG: 0.2520
val Loss: 3.6553 LRAP: 0.0661 NDCG: 0.2466
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 3.2450 LRAP: 0.0607 NDCG: 0.2554
val Loss: 3.8879 LRAP: 0.0203 NDCG: 0.2045
EarlyStopping counter: 3 out of 50

Epoch 22/99
----------
train Loss: 3.2422 LRAP: 0.0659 NDCG: 0.2530
val Loss: 4.1535 LRAP: 0.0445 NDCG: 0.1720
EarlyStopping counter: 4 out of 50

Epoch 23/99
----------
train Loss: 3.2347 LRAP: 0.0746 NDCG: 0.2539
val Loss: 3.7119 LRAP: 0.0572 NDCG: 0.2335
EarlyStopping counter: 5 out of 50

Epoch 24/99
----------
train Loss: 3.1848 LRAP: 0.0792 NDCG: 0.2583
val Loss: 3.4224 LRAP: 0.0712 NDCG: 0.2515
Validation loss decreased (3.456230 --> 3.422449).  Saving model ...

Epoch 25/99
----------
train Loss: 3.1434 LRAP: 0.0809 NDCG: 0.2575
val Loss: 3.2330 LRAP: 0.1004 NDCG: 0.2451
Validation loss decreased (3.422449 --> 3.232966).  Saving model ...

Epoch 26/99
----------
train Loss: 3.1286 LRAP: 0.0811 NDCG: 0.2618
val Loss: 3.2834 LRAP: 0.0953 NDCG: 0.2461
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.1244 LRAP: 0.0773 NDCG: 0.2612
val Loss: 3.3722 LRAP: 0.0813 NDCG: 0.2445
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 3.1166 LRAP: 0.0773 NDCG: 0.2619
val Loss: 3.2293 LRAP: 0.0978 NDCG: 0.2583
Validation loss decreased (3.232966 --> 3.229275).  Saving model ...

Epoch 29/99
----------
train Loss: 3.1129 LRAP: 0.0781 NDCG: 0.2630
val Loss: 3.3231 LRAP: 0.0889 NDCG: 0.2460
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 3.0873 LRAP: 0.0779 NDCG: 0.2618
val Loss: 3.2910 LRAP: 0.0724 NDCG: 0.2484
EarlyStopping counter: 2 out of 50

Epoch 31/99
----------
train Loss: 3.0961 LRAP: 0.0800 NDCG: 0.2634
val Loss: 3.2707 LRAP: 0.1055 NDCG: 0.2606
EarlyStopping counter: 3 out of 50

Epoch 32/99
----------
train Loss: 3.0796 LRAP: 0.0776 NDCG: 0.2642
val Loss: 3.2995 LRAP: 0.1118 NDCG: 0.2526
EarlyStopping counter: 4 out of 50

Epoch 33/99
----------
train Loss: 3.0719 LRAP: 0.0765 NDCG: 0.2648
val Loss: 3.2153 LRAP: 0.1017 NDCG: 0.2529
Validation loss decreased (3.229275 --> 3.215251).  Saving model ...

Epoch 34/99
----------
train Loss: 3.0551 LRAP: 0.0828 NDCG: 0.2662
val Loss: 3.3146 LRAP: 0.1067 NDCG: 0.2563
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.0574 LRAP: 0.0770 NDCG: 0.2655
val Loss: 3.2386 LRAP: 0.0750 NDCG: 0.2479
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 3.0498 LRAP: 0.0860 NDCG: 0.2644
val Loss: 3.4135 LRAP: 0.0470 NDCG: 0.2444
EarlyStopping counter: 3 out of 50

Epoch 37/99
----------
train Loss: 3.0341 LRAP: 0.0784 NDCG: 0.2701
val Loss: 3.3986 LRAP: 0.0496 NDCG: 0.2418
EarlyStopping counter: 4 out of 50

Epoch 38/99
----------
train Loss: 3.0339 LRAP: 0.0855 NDCG: 0.2670
val Loss: 3.2283 LRAP: 0.0877 NDCG: 0.2573
EarlyStopping counter: 5 out of 50

Epoch 39/99
----------
train Loss: 3.0258 LRAP: 0.0839 NDCG: 0.2696
val Loss: 3.1443 LRAP: 0.0991 NDCG: 0.2596
Validation loss decreased (3.215251 --> 3.144264).  Saving model ...

Epoch 40/99
----------
train Loss: 3.0217 LRAP: 0.0841 NDCG: 0.2682
val Loss: 3.1422 LRAP: 0.1017 NDCG: 0.2612
Validation loss decreased (3.144264 --> 3.142231).  Saving model ...

Epoch 41/99
----------
train Loss: 3.0145 LRAP: 0.0822 NDCG: 0.2690
val Loss: 3.1422 LRAP: 0.1029 NDCG: 0.2581
Validation loss decreased (3.142231 --> 3.142189).  Saving model ...

Epoch 42/99
----------
train Loss: 3.0169 LRAP: 0.0860 NDCG: 0.2700
val Loss: 3.1374 LRAP: 0.1017 NDCG: 0.2605
Validation loss decreased (3.142189 --> 3.137381).  Saving model ...

Epoch 43/99
----------
train Loss: 3.0108 LRAP: 0.0844 NDCG: 0.2678
val Loss: 3.1331 LRAP: 0.1042 NDCG: 0.2601
Validation loss decreased (3.137381 --> 3.133092).  Saving model ...

Epoch 44/99
----------
train Loss: 3.0254 LRAP: 0.0819 NDCG: 0.2676
val Loss: 3.1536 LRAP: 0.0966 NDCG: 0.2615
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 3.0108 LRAP: 0.0844 NDCG: 0.2670
val Loss: 3.1467 LRAP: 0.1029 NDCG: 0.2619
EarlyStopping counter: 2 out of 50

Epoch 46/99
----------
train Loss: 3.0019 LRAP: 0.0839 NDCG: 0.2696
val Loss: 3.1236 LRAP: 0.1042 NDCG: 0.2640
Validation loss decreased (3.133092 --> 3.123557).  Saving model ...

Epoch 47/99
----------
train Loss: 3.0007 LRAP: 0.0860 NDCG: 0.2683
val Loss: 3.1542 LRAP: 0.0928 NDCG: 0.2605
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 2.9988 LRAP: 0.0901 NDCG: 0.2678
val Loss: 3.1328 LRAP: 0.1029 NDCG: 0.2580
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.0015 LRAP: 0.0885 NDCG: 0.2677
val Loss: 3.1221 LRAP: 0.1029 NDCG: 0.2623
Validation loss decreased (3.123557 --> 3.122134).  Saving model ...

Epoch 50/99
----------
train Loss: 2.9981 LRAP: 0.0806 NDCG: 0.2698
val Loss: 3.1446 LRAP: 0.0966 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 2.9975 LRAP: 0.0866 NDCG: 0.2688
val Loss: 3.1191 LRAP: 0.1042 NDCG: 0.2642
Validation loss decreased (3.122134 --> 3.119117).  Saving model ...

Epoch 52/99
----------
train Loss: 2.9942 LRAP: 0.0814 NDCG: 0.2698
val Loss: 3.1197 LRAP: 0.1042 NDCG: 0.2616
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 2.9872 LRAP: 0.0839 NDCG: 0.2707
val Loss: 3.1218 LRAP: 0.1029 NDCG: 0.2628
EarlyStopping counter: 2 out of 50

Epoch 54/99
----------
train Loss: 2.9917 LRAP: 0.0839 NDCG: 0.2710
val Loss: 3.1225 LRAP: 0.1017 NDCG: 0.2610
EarlyStopping counter: 3 out of 50

Epoch 55/99
----------
train Loss: 2.9852 LRAP: 0.0795 NDCG: 0.2700
val Loss: 3.1186 LRAP: 0.1029 NDCG: 0.2637
Validation loss decreased (3.119117 --> 3.118577).  Saving model ...

Epoch 56/99
----------
train Loss: 2.9867 LRAP: 0.0904 NDCG: 0.2707
val Loss: 3.1090 LRAP: 0.1042 NDCG: 0.2645
Validation loss decreased (3.118577 --> 3.109006).  Saving model ...

Epoch 57/99
----------
train Loss: 2.9757 LRAP: 0.0828 NDCG: 0.2700
val Loss: 3.1184 LRAP: 0.1017 NDCG: 0.2623
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 2.9753 LRAP: 0.0809 NDCG: 0.2703
val Loss: 3.1130 LRAP: 0.1029 NDCG: 0.2646
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 2.9938 LRAP: 0.0844 NDCG: 0.2696
val Loss: 3.1165 LRAP: 0.1055 NDCG: 0.2669
EarlyStopping counter: 3 out of 50

Epoch 60/99
----------
train Loss: 2.9763 LRAP: 0.0817 NDCG: 0.2705
val Loss: 3.1139 LRAP: 0.1029 NDCG: 0.2627
EarlyStopping counter: 4 out of 50

Epoch 61/99
----------
train Loss: 2.9736 LRAP: 0.0830 NDCG: 0.2721
val Loss: 3.1088 LRAP: 0.1029 NDCG: 0.2640
Validation loss decreased (3.109006 --> 3.108810).  Saving model ...

Epoch 62/99
----------
train Loss: 2.9744 LRAP: 0.0885 NDCG: 0.2716
val Loss: 3.1105 LRAP: 0.1017 NDCG: 0.2635
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 2.9676 LRAP: 0.0860 NDCG: 0.2715
val Loss: 3.1085 LRAP: 0.1029 NDCG: 0.2641
Validation loss decreased (3.108810 --> 3.108492).  Saving model ...

Epoch 64/99
----------
train Loss: 2.9647 LRAP: 0.0942 NDCG: 0.2737
val Loss: 3.1120 LRAP: 0.1029 NDCG: 0.2636
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 2.9854 LRAP: 0.0879 NDCG: 0.2713
val Loss: 3.1093 LRAP: 0.1029 NDCG: 0.2644
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 2.9819 LRAP: 0.0874 NDCG: 0.2720
val Loss: 3.1053 LRAP: 0.1029 NDCG: 0.2644
Validation loss decreased (3.108492 --> 3.105278).  Saving model ...

Epoch 67/99
----------
train Loss: 2.9695 LRAP: 0.0879 NDCG: 0.2724
val Loss: 3.1076 LRAP: 0.1029 NDCG: 0.2644
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 2.9636 LRAP: 0.0888 NDCG: 0.2716
val Loss: 3.1061 LRAP: 0.1029 NDCG: 0.2662
EarlyStopping counter: 2 out of 50

Epoch 69/99
----------
train Loss: 2.9751 LRAP: 0.0879 NDCG: 0.2723
val Loss: 3.1072 LRAP: 0.1029 NDCG: 0.2651
EarlyStopping counter: 3 out of 50

Epoch 70/99
----------
train Loss: 2.9784 LRAP: 0.0879 NDCG: 0.2729
val Loss: 3.1115 LRAP: 0.1029 NDCG: 0.2640
EarlyStopping counter: 4 out of 50

Epoch 71/99
----------
train Loss: 2.9707 LRAP: 0.0866 NDCG: 0.2719
val Loss: 3.1055 LRAP: 0.1042 NDCG: 0.2648
EarlyStopping counter: 5 out of 50

Epoch 72/99
----------
train Loss: 2.9667 LRAP: 0.0890 NDCG: 0.2712
val Loss: 3.1073 LRAP: 0.1042 NDCG: 0.2648
EarlyStopping counter: 6 out of 50

Epoch 73/99
----------
train Loss: 2.9958 LRAP: 0.0825 NDCG: 0.2723
val Loss: 3.1069 LRAP: 0.1029 NDCG: 0.2621
EarlyStopping counter: 7 out of 50

Epoch 74/99
----------
train Loss: 2.9687 LRAP: 0.0855 NDCG: 0.2718
val Loss: 3.1085 LRAP: 0.1017 NDCG: 0.2644
EarlyStopping counter: 8 out of 50

Epoch 75/99
----------
train Loss: 2.9670 LRAP: 0.0877 NDCG: 0.2701
val Loss: 3.1079 LRAP: 0.1029 NDCG: 0.2635
EarlyStopping counter: 9 out of 50

Epoch 76/99
----------
train Loss: 2.9723 LRAP: 0.0860 NDCG: 0.2717
val Loss: 3.1062 LRAP: 0.1017 NDCG: 0.2639
EarlyStopping counter: 10 out of 50

Epoch 77/99
----------
train Loss: 2.9696 LRAP: 0.0836 NDCG: 0.2720
val Loss: 3.1060 LRAP: 0.1029 NDCG: 0.2653
EarlyStopping counter: 11 out of 50

Epoch 78/99
----------
train Loss: 2.9916 LRAP: 0.0817 NDCG: 0.2709
val Loss: 3.1082 LRAP: 0.1017 NDCG: 0.2627
EarlyStopping counter: 12 out of 50

Epoch 79/99
----------
train Loss: 2.9686 LRAP: 0.0833 NDCG: 0.2711
val Loss: 3.1061 LRAP: 0.1029 NDCG: 0.2652
EarlyStopping counter: 13 out of 50

Epoch 80/99
----------
train Loss: 2.9634 LRAP: 0.0866 NDCG: 0.2715
val Loss: 3.1091 LRAP: 0.1029 NDCG: 0.2645
EarlyStopping counter: 14 out of 50

Epoch 81/99
----------
train Loss: 2.9750 LRAP: 0.0871 NDCG: 0.2713
val Loss: 3.1082 LRAP: 0.1042 NDCG: 0.2652
EarlyStopping counter: 15 out of 50

Epoch 82/99
----------
train Loss: 2.9748 LRAP: 0.0866 NDCG: 0.2716
val Loss: 3.1054 LRAP: 0.1029 NDCG: 0.2655
EarlyStopping counter: 16 out of 50

Epoch 83/99
----------
train Loss: 2.9729 LRAP: 0.0866 NDCG: 0.2703
val Loss: 3.1062 LRAP: 0.1029 NDCG: 0.2655
EarlyStopping counter: 17 out of 50

Epoch 84/99
----------
train Loss: 2.9512 LRAP: 0.0863 NDCG: 0.2729
val Loss: 3.1070 LRAP: 0.1029 NDCG: 0.2654
EarlyStopping counter: 18 out of 50

Epoch 85/99
----------
train Loss: 2.9670 LRAP: 0.0847 NDCG: 0.2712
val Loss: 3.1045 LRAP: 0.1029 NDCG: 0.2663
Validation loss decreased (3.105278 --> 3.104500).  Saving model ...

Epoch 86/99
----------
train Loss: 2.9757 LRAP: 0.0855 NDCG: 0.2721
val Loss: 3.1070 LRAP: 0.1029 NDCG: 0.2648
EarlyStopping counter: 1 out of 50

Epoch 87/99
----------
train Loss: 2.9730 LRAP: 0.0863 NDCG: 0.2720
val Loss: 3.1065 LRAP: 0.1029 NDCG: 0.2645
EarlyStopping counter: 2 out of 50

Epoch 88/99
----------
train Loss: 2.9694 LRAP: 0.0877 NDCG: 0.2726
val Loss: 3.1044 LRAP: 0.1042 NDCG: 0.2647
Validation loss decreased (3.104500 --> 3.104432).  Saving model ...

Epoch 89/99
----------
train Loss: 2.9696 LRAP: 0.0852 NDCG: 0.2718
val Loss: 3.1079 LRAP: 0.1029 NDCG: 0.2644
EarlyStopping counter: 1 out of 50

Epoch 90/99
----------
train Loss: 2.9542 LRAP: 0.0904 NDCG: 0.2711
val Loss: 3.1074 LRAP: 0.1017 NDCG: 0.2645
EarlyStopping counter: 2 out of 50

Epoch 91/99
----------
train Loss: 2.9528 LRAP: 0.0879 NDCG: 0.2725
val Loss: 3.1068 LRAP: 0.1029 NDCG: 0.2652
EarlyStopping counter: 3 out of 50

Epoch 92/99
----------
train Loss: 2.9755 LRAP: 0.0877 NDCG: 0.2712
val Loss: 3.1053 LRAP: 0.1029 NDCG: 0.2648
EarlyStopping counter: 4 out of 50

Epoch 93/99
----------
train Loss: 2.9673 LRAP: 0.0868 NDCG: 0.2721
val Loss: 3.1079 LRAP: 0.1017 NDCG: 0.2634
EarlyStopping counter: 5 out of 50

Epoch 94/99
----------
train Loss: 2.9625 LRAP: 0.0841 NDCG: 0.2724
val Loss: 3.1065 LRAP: 0.1029 NDCG: 0.2662
EarlyStopping counter: 6 out of 50

Epoch 95/99
----------
train Loss: 2.9813 LRAP: 0.0819 NDCG: 0.2715
val Loss: 3.1063 LRAP: 0.1029 NDCG: 0.2651
EarlyStopping counter: 7 out of 50

Epoch 96/99
----------
train Loss: 2.9784 LRAP: 0.0855 NDCG: 0.2723
val Loss: 3.1074 LRAP: 0.1029 NDCG: 0.2643
EarlyStopping counter: 8 out of 50

Epoch 97/99
----------
train Loss: 2.9701 LRAP: 0.0858 NDCG: 0.2707
val Loss: 3.1068 LRAP: 0.1042 NDCG: 0.2642
EarlyStopping counter: 9 out of 50

Epoch 98/99
----------
train Loss: 2.9679 LRAP: 0.0836 NDCG: 0.2728
val Loss: 3.1058 LRAP: 0.1029 NDCG: 0.2652
EarlyStopping counter: 10 out of 50

Epoch 99/99
----------
train Loss: 2.9748 LRAP: 0.0882 NDCG: 0.2710
val Loss: 3.1057 LRAP: 0.1029 NDCG: 0.2656
EarlyStopping counter: 11 out of 50

Training complete in 2m 31s
Best val loss: 3.104432, best LRAP score: 0.5990

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 2/10

All random seeds set to: 43
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.4941 LRAP: 0.0000 NDCG: 0.1673
val Loss: 4.2278 LRAP: 0.0000 NDCG: 0.1933
Validation loss decreased (0.000000 --> 4.227822).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9332 LRAP: 0.0011 NDCG: 0.2056
val Loss: 3.9788 LRAP: 0.0076 NDCG: 0.2161
Validation loss decreased (4.227822 --> 3.978815).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7863 LRAP: 0.0139 NDCG: 0.2147
val Loss: 3.9764 LRAP: 0.0928 NDCG: 0.2406
Validation loss decreased (3.978815 --> 3.976357).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6875 LRAP: 0.0485 NDCG: 0.2221
val Loss: 3.9273 LRAP: 0.0051 NDCG: 0.2158
Validation loss decreased (3.976357 --> 3.927274).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5842 LRAP: 0.0417 NDCG: 0.2282
val Loss: 3.5190 LRAP: 0.0076 NDCG: 0.2330
Validation loss decreased (3.927274 --> 3.518990).  Saving model ...

Epoch 5/99
----------
train Loss: 3.5179 LRAP: 0.0485 NDCG: 0.2286
val Loss: 3.6340 LRAP: 0.0127 NDCG: 0.2265
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.4772 LRAP: 0.0749 NDCG: 0.2305
val Loss: 3.9528 LRAP: 0.0635 NDCG: 0.2328
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.4281 LRAP: 0.0528 NDCG: 0.2376
val Loss: 3.4937 LRAP: 0.1067 NDCG: 0.2426
Validation loss decreased (3.518990 --> 3.493696).  Saving model ...

Epoch 8/99
----------
train Loss: 3.3554 LRAP: 0.0664 NDCG: 0.2411
val Loss: 4.1000 LRAP: 0.0254 NDCG: 0.2448
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.2863 LRAP: 0.0651 NDCG: 0.2474
val Loss: 3.1611 LRAP: 0.1156 NDCG: 0.2595
Validation loss decreased (3.493696 --> 3.161129).  Saving model ...

Epoch 10/99
----------
train Loss: 3.2526 LRAP: 0.0809 NDCG: 0.2495
val Loss: 3.3618 LRAP: 0.0915 NDCG: 0.2575
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.2096 LRAP: 0.0760 NDCG: 0.2529
val Loss: 3.8545 LRAP: 0.1296 NDCG: 0.2713
EarlyStopping counter: 2 out of 50

Epoch 12/99
----------
train Loss: 3.1378 LRAP: 0.0806 NDCG: 0.2597
val Loss: 3.4085 LRAP: 0.0648 NDCG: 0.2432
EarlyStopping counter: 3 out of 50

Epoch 13/99
----------
train Loss: 3.1144 LRAP: 0.0855 NDCG: 0.2609
val Loss: 3.2501 LRAP: 0.0915 NDCG: 0.2517
EarlyStopping counter: 4 out of 50

Epoch 14/99
----------
train Loss: 3.0972 LRAP: 0.0877 NDCG: 0.2646
val Loss: 3.5162 LRAP: 0.0483 NDCG: 0.2512
EarlyStopping counter: 5 out of 50

Epoch 15/99
----------
train Loss: 3.0070 LRAP: 0.0953 NDCG: 0.2693
val Loss: 2.9051 LRAP: 0.1245 NDCG: 0.2799
Validation loss decreased (3.161129 --> 2.905060).  Saving model ...

Epoch 16/99
----------
train Loss: 2.9501 LRAP: 0.0920 NDCG: 0.2734
val Loss: 2.9055 LRAP: 0.1207 NDCG: 0.2794
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 2.9260 LRAP: 0.0920 NDCG: 0.2738
val Loss: 2.8461 LRAP: 0.1131 NDCG: 0.2838
Validation loss decreased (2.905060 --> 2.846073).  Saving model ...

Epoch 18/99
----------
train Loss: 2.9229 LRAP: 0.0939 NDCG: 0.2748
val Loss: 2.8388 LRAP: 0.1283 NDCG: 0.2835
Validation loss decreased (2.846073 --> 2.838841).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8923 LRAP: 0.0975 NDCG: 0.2772
val Loss: 2.8625 LRAP: 0.1156 NDCG: 0.2796
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 2.8836 LRAP: 0.0953 NDCG: 0.2797
val Loss: 2.9106 LRAP: 0.1258 NDCG: 0.2811
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 2.8932 LRAP: 0.0912 NDCG: 0.2766
val Loss: 2.8150 LRAP: 0.1156 NDCG: 0.2920
Validation loss decreased (2.838841 --> 2.814988).  Saving model ...

Epoch 22/99
----------
train Loss: 2.8679 LRAP: 0.0953 NDCG: 0.2802
val Loss: 2.8620 LRAP: 0.1182 NDCG: 0.2934
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.8436 LRAP: 0.0994 NDCG: 0.2815
val Loss: 2.8684 LRAP: 0.1105 NDCG: 0.2793
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 2.8195 LRAP: 0.0945 NDCG: 0.2850
val Loss: 2.8428 LRAP: 0.1258 NDCG: 0.2829
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 2.8276 LRAP: 0.0950 NDCG: 0.2834
val Loss: 2.8343 LRAP: 0.1309 NDCG: 0.2875
EarlyStopping counter: 4 out of 50

Epoch 26/99
----------
train Loss: 2.8155 LRAP: 0.0977 NDCG: 0.2854
val Loss: 2.8163 LRAP: 0.1220 NDCG: 0.2981
EarlyStopping counter: 5 out of 50

Epoch 27/99
----------
train Loss: 2.7960 LRAP: 0.1010 NDCG: 0.2886
val Loss: 2.7500 LRAP: 0.1283 NDCG: 0.2994
Validation loss decreased (2.814988 --> 2.749993).  Saving model ...

Epoch 28/99
----------
train Loss: 2.7709 LRAP: 0.1032 NDCG: 0.2881
val Loss: 2.7493 LRAP: 0.1258 NDCG: 0.2933
Validation loss decreased (2.749993 --> 2.749254).  Saving model ...

Epoch 29/99
----------
train Loss: 2.7553 LRAP: 0.1037 NDCG: 0.2875
val Loss: 2.7313 LRAP: 0.1220 NDCG: 0.2954
Validation loss decreased (2.749254 --> 2.731282).  Saving model ...

Epoch 30/99
----------
train Loss: 2.7760 LRAP: 0.0986 NDCG: 0.2869
val Loss: 2.7293 LRAP: 0.1245 NDCG: 0.3005
Validation loss decreased (2.731282 --> 2.729349).  Saving model ...

Epoch 31/99
----------
train Loss: 2.7712 LRAP: 0.0996 NDCG: 0.2879
val Loss: 2.7256 LRAP: 0.1245 NDCG: 0.2982
Validation loss decreased (2.729349 --> 2.725631).  Saving model ...

Epoch 32/99
----------
train Loss: 2.7549 LRAP: 0.1005 NDCG: 0.2895
val Loss: 2.7328 LRAP: 0.1207 NDCG: 0.2946
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.7492 LRAP: 0.1043 NDCG: 0.2901
val Loss: 2.7198 LRAP: 0.1258 NDCG: 0.3020
Validation loss decreased (2.725631 --> 2.719761).  Saving model ...

Epoch 34/99
----------
train Loss: 2.7407 LRAP: 0.1013 NDCG: 0.2886
val Loss: 2.7254 LRAP: 0.1220 NDCG: 0.2970
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 2.7455 LRAP: 0.0931 NDCG: 0.2885
val Loss: 2.7265 LRAP: 0.1182 NDCG: 0.2983
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 2.7387 LRAP: 0.0988 NDCG: 0.2920
val Loss: 2.7171 LRAP: 0.1194 NDCG: 0.3042
Validation loss decreased (2.719761 --> 2.717060).  Saving model ...

Epoch 37/99
----------
train Loss: 2.7315 LRAP: 0.1024 NDCG: 0.2915
val Loss: 2.7108 LRAP: 0.1296 NDCG: 0.2973
Validation loss decreased (2.717060 --> 2.710750).  Saving model ...

Epoch 38/99
----------
train Loss: 2.7483 LRAP: 0.1043 NDCG: 0.2901
val Loss: 2.7144 LRAP: 0.1220 NDCG: 0.3056
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 2.7285 LRAP: 0.0996 NDCG: 0.2910
val Loss: 2.7209 LRAP: 0.1271 NDCG: 0.2973
EarlyStopping counter: 2 out of 50

Epoch 40/99
----------
train Loss: 2.7342 LRAP: 0.1010 NDCG: 0.2925
val Loss: 2.7022 LRAP: 0.1258 NDCG: 0.3036
Validation loss decreased (2.710750 --> 2.702215).  Saving model ...

Epoch 41/99
----------
train Loss: 2.7219 LRAP: 0.1024 NDCG: 0.2916
val Loss: 2.7102 LRAP: 0.1271 NDCG: 0.2980
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 2.7219 LRAP: 0.0991 NDCG: 0.2935
val Loss: 2.7201 LRAP: 0.1283 NDCG: 0.3084
EarlyStopping counter: 2 out of 50

Epoch 43/99
----------
train Loss: 2.7298 LRAP: 0.1054 NDCG: 0.2926
val Loss: 2.6974 LRAP: 0.1258 NDCG: 0.3013
Validation loss decreased (2.702215 --> 2.697401).  Saving model ...

Epoch 44/99
----------
train Loss: 2.7209 LRAP: 0.1048 NDCG: 0.2915
val Loss: 2.6962 LRAP: 0.1309 NDCG: 0.3032
Validation loss decreased (2.697401 --> 2.696167).  Saving model ...

Epoch 45/99
----------
train Loss: 2.7158 LRAP: 0.1002 NDCG: 0.2914
val Loss: 2.6923 LRAP: 0.1271 NDCG: 0.3012
Validation loss decreased (2.696167 --> 2.692348).  Saving model ...

Epoch 46/99
----------
train Loss: 2.7095 LRAP: 0.0986 NDCG: 0.2923
val Loss: 2.6972 LRAP: 0.1233 NDCG: 0.3010
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 2.6968 LRAP: 0.1062 NDCG: 0.2948
val Loss: 2.6877 LRAP: 0.1220 NDCG: 0.3049
Validation loss decreased (2.692348 --> 2.687738).  Saving model ...

Epoch 48/99
----------
train Loss: 2.7058 LRAP: 0.1018 NDCG: 0.2941
val Loss: 2.6886 LRAP: 0.1309 NDCG: 0.3025
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 2.6985 LRAP: 0.1056 NDCG: 0.2937
val Loss: 2.6833 LRAP: 0.1245 NDCG: 0.3030
Validation loss decreased (2.687738 --> 2.683328).  Saving model ...

Epoch 50/99
----------
train Loss: 2.6976 LRAP: 0.1045 NDCG: 0.2936
val Loss: 2.6872 LRAP: 0.1245 NDCG: 0.3008
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 2.6926 LRAP: 0.0996 NDCG: 0.2948
val Loss: 2.6911 LRAP: 0.1283 NDCG: 0.3069
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 2.6876 LRAP: 0.1032 NDCG: 0.2961
val Loss: 2.6762 LRAP: 0.1220 NDCG: 0.3044
Validation loss decreased (2.683328 --> 2.676218).  Saving model ...

Epoch 53/99
----------
train Loss: 2.6881 LRAP: 0.1005 NDCG: 0.2931
val Loss: 2.6740 LRAP: 0.1283 NDCG: 0.3043
Validation loss decreased (2.676218 --> 2.673984).  Saving model ...

Epoch 54/99
----------
train Loss: 2.6698 LRAP: 0.0996 NDCG: 0.2951
val Loss: 2.6855 LRAP: 0.1296 NDCG: 0.3110
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 2.6865 LRAP: 0.1029 NDCG: 0.2952
val Loss: 2.6696 LRAP: 0.1334 NDCG: 0.3053
Validation loss decreased (2.673984 --> 2.669615).  Saving model ...

Epoch 56/99
----------
train Loss: 2.6689 LRAP: 0.1032 NDCG: 0.2993
val Loss: 2.6749 LRAP: 0.1220 NDCG: 0.3056
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 2.6677 LRAP: 0.1002 NDCG: 0.2961
val Loss: 2.6676 LRAP: 0.1309 NDCG: 0.3069
Validation loss decreased (2.669615 --> 2.667636).  Saving model ...

Epoch 58/99
----------
train Loss: 2.6748 LRAP: 0.0980 NDCG: 0.2967
val Loss: 2.6640 LRAP: 0.1245 NDCG: 0.3070
Validation loss decreased (2.667636 --> 2.664042).  Saving model ...

Epoch 59/99
----------
train Loss: 2.6640 LRAP: 0.1070 NDCG: 0.2975
val Loss: 2.6781 LRAP: 0.1271 NDCG: 0.3071
EarlyStopping counter: 1 out of 50

Epoch 60/99
----------
train Loss: 2.6784 LRAP: 0.1062 NDCG: 0.2980
val Loss: 2.6683 LRAP: 0.1233 NDCG: 0.3068
EarlyStopping counter: 2 out of 50

Epoch 61/99
----------
train Loss: 2.6499 LRAP: 0.1007 NDCG: 0.2991
val Loss: 2.6641 LRAP: 0.1283 NDCG: 0.3046
EarlyStopping counter: 3 out of 50

Epoch 62/99
----------
train Loss: 2.6567 LRAP: 0.1005 NDCG: 0.3002
val Loss: 2.6586 LRAP: 0.1309 NDCG: 0.3124
Validation loss decreased (2.664042 --> 2.658643).  Saving model ...

Epoch 63/99
----------
train Loss: 2.6579 LRAP: 0.1024 NDCG: 0.2986
val Loss: 2.6542 LRAP: 0.1309 NDCG: 0.3055
Validation loss decreased (2.658643 --> 2.654173).  Saving model ...

Epoch 64/99
----------
train Loss: 2.6564 LRAP: 0.1070 NDCG: 0.2999
val Loss: 2.6588 LRAP: 0.1360 NDCG: 0.3125
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 2.6407 LRAP: 0.1048 NDCG: 0.2999
val Loss: 2.6574 LRAP: 0.1347 NDCG: 0.3126
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 2.6400 LRAP: 0.1086 NDCG: 0.3003
val Loss: 2.6616 LRAP: 0.1321 NDCG: 0.3102
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 2.6413 LRAP: 0.1084 NDCG: 0.3013
val Loss: 2.6595 LRAP: 0.1334 NDCG: 0.3042
EarlyStopping counter: 4 out of 50

Epoch 68/99
----------
train Loss: 2.6507 LRAP: 0.1048 NDCG: 0.3007
val Loss: 2.6492 LRAP: 0.1296 NDCG: 0.3111
Validation loss decreased (2.654173 --> 2.649242).  Saving model ...

Epoch 69/99
----------
train Loss: 2.6331 LRAP: 0.1048 NDCG: 0.3016
val Loss: 2.6503 LRAP: 0.1347 NDCG: 0.3079
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 2.6318 LRAP: 0.1024 NDCG: 0.3020
val Loss: 2.6580 LRAP: 0.1334 NDCG: 0.3181
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 2.6203 LRAP: 0.1065 NDCG: 0.3038
val Loss: 2.6402 LRAP: 0.1321 NDCG: 0.3069
Validation loss decreased (2.649242 --> 2.640228).  Saving model ...

Epoch 72/99
----------
train Loss: 2.6239 LRAP: 0.1103 NDCG: 0.3027
val Loss: 2.6428 LRAP: 0.1334 NDCG: 0.3124
EarlyStopping counter: 1 out of 50

Epoch 73/99
----------
train Loss: 2.6405 LRAP: 0.1051 NDCG: 0.3035
val Loss: 2.6398 LRAP: 0.1321 NDCG: 0.3168
Validation loss decreased (2.640228 --> 2.639833).  Saving model ...

Epoch 74/99
----------
train Loss: 2.6187 LRAP: 0.1078 NDCG: 0.3027
val Loss: 2.6355 LRAP: 0.1258 NDCG: 0.3104
Validation loss decreased (2.639833 --> 2.635500).  Saving model ...

Epoch 75/99
----------
train Loss: 2.6179 LRAP: 0.1051 NDCG: 0.3029
val Loss: 2.6344 LRAP: 0.1347 NDCG: 0.3147
Validation loss decreased (2.635500 --> 2.634446).  Saving model ...

Epoch 76/99
----------
train Loss: 2.6074 LRAP: 0.1037 NDCG: 0.3052
val Loss: 2.6331 LRAP: 0.1321 NDCG: 0.3099
Validation loss decreased (2.634446 --> 2.633075).  Saving model ...

Epoch 77/99
----------
train Loss: 2.6113 LRAP: 0.1070 NDCG: 0.3035
val Loss: 2.6498 LRAP: 0.1334 NDCG: 0.3187
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 2.6119 LRAP: 0.1116 NDCG: 0.3067
val Loss: 2.6322 LRAP: 0.1334 NDCG: 0.3099
Validation loss decreased (2.633075 --> 2.632162).  Saving model ...

Epoch 79/99
----------
train Loss: 2.5982 LRAP: 0.1051 NDCG: 0.3045
val Loss: 2.6213 LRAP: 0.1296 NDCG: 0.3167
Validation loss decreased (2.632162 --> 2.621317).  Saving model ...

Epoch 80/99
----------
train Loss: 2.6037 LRAP: 0.1059 NDCG: 0.3061
val Loss: 2.6271 LRAP: 0.1309 NDCG: 0.3123
EarlyStopping counter: 1 out of 50

Epoch 81/99
----------
train Loss: 2.5914 LRAP: 0.1075 NDCG: 0.3062
val Loss: 2.6214 LRAP: 0.1309 NDCG: 0.3173
EarlyStopping counter: 2 out of 50

Epoch 82/99
----------
train Loss: 2.5855 LRAP: 0.1070 NDCG: 0.3053
val Loss: 2.6108 LRAP: 0.1334 NDCG: 0.3143
Validation loss decreased (2.621317 --> 2.610825).  Saving model ...

Epoch 83/99
----------
train Loss: 2.5883 LRAP: 0.1089 NDCG: 0.3077
val Loss: 2.6185 LRAP: 0.1309 NDCG: 0.3117
EarlyStopping counter: 1 out of 50

Epoch 84/99
----------
train Loss: 2.5848 LRAP: 0.1111 NDCG: 0.3075
val Loss: 2.6157 LRAP: 0.1347 NDCG: 0.3138
EarlyStopping counter: 2 out of 50

Epoch 85/99
----------
train Loss: 2.5885 LRAP: 0.1108 NDCG: 0.3083
val Loss: 2.6089 LRAP: 0.1360 NDCG: 0.3188
Validation loss decreased (2.610825 --> 2.608914).  Saving model ...

Epoch 86/99
----------
train Loss: 2.5805 LRAP: 0.1048 NDCG: 0.3089
val Loss: 2.6051 LRAP: 0.1334 NDCG: 0.3201
Validation loss decreased (2.608914 --> 2.605090).  Saving model ...

Epoch 87/99
----------
train Loss: 2.5717 LRAP: 0.1108 NDCG: 0.3075
val Loss: 2.6028 LRAP: 0.1321 NDCG: 0.3226
Validation loss decreased (2.605090 --> 2.602788).  Saving model ...

Epoch 88/99
----------
train Loss: 2.5717 LRAP: 0.1073 NDCG: 0.3091
val Loss: 2.6193 LRAP: 0.1309 NDCG: 0.3265
EarlyStopping counter: 1 out of 50

Epoch 89/99
----------
train Loss: 2.5765 LRAP: 0.1111 NDCG: 0.3106
val Loss: 2.6031 LRAP: 0.1347 NDCG: 0.3160
EarlyStopping counter: 2 out of 50

Epoch 90/99
----------
train Loss: 2.5611 LRAP: 0.1127 NDCG: 0.3097
val Loss: 2.5994 LRAP: 0.1334 NDCG: 0.3222
Validation loss decreased (2.602788 --> 2.599389).  Saving model ...

Epoch 91/99
----------
train Loss: 2.5635 LRAP: 0.1089 NDCG: 0.3081
val Loss: 2.5995 LRAP: 0.1347 NDCG: 0.3242
EarlyStopping counter: 1 out of 50

Epoch 92/99
----------
train Loss: 2.5496 LRAP: 0.1084 NDCG: 0.3109
val Loss: 2.6111 LRAP: 0.1347 NDCG: 0.3165
EarlyStopping counter: 2 out of 50

Epoch 93/99
----------
train Loss: 2.5341 LRAP: 0.1092 NDCG: 0.3127
val Loss: 2.5909 LRAP: 0.1334 NDCG: 0.3191
Validation loss decreased (2.599389 --> 2.590883).  Saving model ...

Epoch 94/99
----------
train Loss: 2.5511 LRAP: 0.1097 NDCG: 0.3144
val Loss: 2.5885 LRAP: 0.1360 NDCG: 0.3232
Validation loss decreased (2.590883 --> 2.588473).  Saving model ...

Epoch 95/99
----------
train Loss: 2.5588 LRAP: 0.1065 NDCG: 0.3116
val Loss: 2.5869 LRAP: 0.1360 NDCG: 0.3234
Validation loss decreased (2.588473 --> 2.586885).  Saving model ...

Epoch 96/99
----------
train Loss: 2.5479 LRAP: 0.1094 NDCG: 0.3126
val Loss: 2.5999 LRAP: 0.1347 NDCG: 0.3275
EarlyStopping counter: 1 out of 50

Epoch 97/99
----------
train Loss: 2.5256 LRAP: 0.1133 NDCG: 0.3140
val Loss: 2.5840 LRAP: 0.1347 NDCG: 0.3260
Validation loss decreased (2.586885 --> 2.584041).  Saving model ...

Epoch 98/99
----------
train Loss: 2.5350 LRAP: 0.1086 NDCG: 0.3150
val Loss: 2.5730 LRAP: 0.1372 NDCG: 0.3268
Validation loss decreased (2.584041 --> 2.573035).  Saving model ...

Epoch 99/99
----------
train Loss: 2.5330 LRAP: 0.1108 NDCG: 0.3135
val Loss: 2.5811 LRAP: 0.1334 NDCG: 0.3237
EarlyStopping counter: 1 out of 50

Training complete in 2m 31s
Best val loss: 2.573035, best LRAP score: 0.7052

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6105 LRAP: 0.0000 NDCG: 0.1696
val Loss: 5.0811 LRAP: 0.0000 NDCG: 0.1432
Validation loss decreased (0.000000 --> 5.081051).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9695 LRAP: 0.0000 NDCG: 0.2032
val Loss: 4.2159 LRAP: 0.0013 NDCG: 0.2224
Validation loss decreased (5.081051 --> 4.215940).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8091 LRAP: 0.0019 NDCG: 0.2118
val Loss: 3.8549 LRAP: 0.0025 NDCG: 0.2079
Validation loss decreased (4.215940 --> 3.854929).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6899 LRAP: 0.0060 NDCG: 0.2193
val Loss: 3.6809 LRAP: 0.0178 NDCG: 0.2299
Validation loss decreased (3.854929 --> 3.680896).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5673 LRAP: 0.0152 NDCG: 0.2248
val Loss: 3.5308 LRAP: 0.0508 NDCG: 0.2390
Validation loss decreased (3.680896 --> 3.530780).  Saving model ...

Epoch 5/99
----------
train Loss: 3.4783 LRAP: 0.0201 NDCG: 0.2313
val Loss: 4.0989 LRAP: 0.0191 NDCG: 0.2332
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.3899 LRAP: 0.0210 NDCG: 0.2374
val Loss: 3.5731 LRAP: 0.1118 NDCG: 0.2279
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.3100 LRAP: 0.0237 NDCG: 0.2422
val Loss: 3.4870 LRAP: 0.0889 NDCG: 0.2274
Validation loss decreased (3.530780 --> 3.486979).  Saving model ...

Epoch 8/99
----------
train Loss: 3.2397 LRAP: 0.0449 NDCG: 0.2474
val Loss: 3.3398 LRAP: 0.1055 NDCG: 0.2274
Validation loss decreased (3.486979 --> 3.339801).  Saving model ...

Epoch 9/99
----------
train Loss: 3.1929 LRAP: 0.0403 NDCG: 0.2534
val Loss: 3.2313 LRAP: 0.0394 NDCG: 0.2727
Validation loss decreased (3.339801 --> 3.231283).  Saving model ...

Epoch 10/99
----------
train Loss: 3.1405 LRAP: 0.0566 NDCG: 0.2570
val Loss: 3.3485 LRAP: 0.0978 NDCG: 0.2345
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.1065 LRAP: 0.0683 NDCG: 0.2574
val Loss: 2.9935 LRAP: 0.1156 NDCG: 0.2734
Validation loss decreased (3.231283 --> 2.993547).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0537 LRAP: 0.0724 NDCG: 0.2649
val Loss: 3.0786 LRAP: 0.1194 NDCG: 0.2819
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0040 LRAP: 0.0754 NDCG: 0.2682
val Loss: 3.0800 LRAP: 0.1182 NDCG: 0.2846
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 2.9643 LRAP: 0.0716 NDCG: 0.2695
val Loss: 3.1827 LRAP: 0.1118 NDCG: 0.2559
EarlyStopping counter: 3 out of 50

Epoch 15/99
----------
train Loss: 2.9166 LRAP: 0.0765 NDCG: 0.2713
val Loss: 3.1983 LRAP: 0.0407 NDCG: 0.2544
EarlyStopping counter: 4 out of 50

Epoch 16/99
----------
train Loss: 2.8928 LRAP: 0.0839 NDCG: 0.2754
val Loss: 2.8922 LRAP: 0.1029 NDCG: 0.2789
Validation loss decreased (2.993547 --> 2.892238).  Saving model ...

Epoch 17/99
----------
train Loss: 2.8460 LRAP: 0.0877 NDCG: 0.2806
val Loss: 2.8538 LRAP: 0.1220 NDCG: 0.2863
Validation loss decreased (2.892238 --> 2.853831).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8196 LRAP: 0.0866 NDCG: 0.2798
val Loss: 3.3511 LRAP: 0.0483 NDCG: 0.2487
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.7921 LRAP: 0.0833 NDCG: 0.2828
val Loss: 2.8601 LRAP: 0.0991 NDCG: 0.3007
EarlyStopping counter: 2 out of 50

Epoch 20/99
----------
train Loss: 2.7666 LRAP: 0.0947 NDCG: 0.2857
val Loss: 2.8580 LRAP: 0.1042 NDCG: 0.2808
EarlyStopping counter: 3 out of 50

Epoch 21/99
----------
train Loss: 2.7151 LRAP: 0.0868 NDCG: 0.2887
val Loss: 2.6658 LRAP: 0.1258 NDCG: 0.3014
Validation loss decreased (2.853831 --> 2.665833).  Saving model ...

Epoch 22/99
----------
train Loss: 2.6518 LRAP: 0.0920 NDCG: 0.2932
val Loss: 2.7661 LRAP: 0.1423 NDCG: 0.2974
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.6277 LRAP: 0.0915 NDCG: 0.2939
val Loss: 2.7151 LRAP: 0.1385 NDCG: 0.3134
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 2.6103 LRAP: 0.0912 NDCG: 0.2958
val Loss: 3.0721 LRAP: 0.0889 NDCG: 0.2754
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 2.5610 LRAP: 0.0920 NDCG: 0.2995
val Loss: 2.6111 LRAP: 0.1398 NDCG: 0.3186
Validation loss decreased (2.665833 --> 2.611109).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5307 LRAP: 0.0983 NDCG: 0.3016
val Loss: 2.8081 LRAP: 0.1258 NDCG: 0.3081
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 2.5135 LRAP: 0.0980 NDCG: 0.3028
val Loss: 2.6756 LRAP: 0.1207 NDCG: 0.3069
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 2.4751 LRAP: 0.0956 NDCG: 0.3044
val Loss: 2.7272 LRAP: 0.0928 NDCG: 0.3207
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 2.4528 LRAP: 0.0937 NDCG: 0.3061
val Loss: 2.8323 LRAP: 0.1321 NDCG: 0.3151
EarlyStopping counter: 4 out of 50

Epoch 30/99
----------
train Loss: 2.3867 LRAP: 0.0934 NDCG: 0.3070
val Loss: 2.5381 LRAP: 0.1169 NDCG: 0.3354
Validation loss decreased (2.611109 --> 2.538104).  Saving model ...

Epoch 31/99
----------
train Loss: 2.4113 LRAP: 0.0953 NDCG: 0.3099
val Loss: 2.5904 LRAP: 0.1233 NDCG: 0.3222
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.3464 LRAP: 0.0983 NDCG: 0.3149
val Loss: 2.6005 LRAP: 0.1080 NDCG: 0.3390
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 2.3409 LRAP: 0.0969 NDCG: 0.3137
val Loss: 2.6007 LRAP: 0.1360 NDCG: 0.3491
EarlyStopping counter: 3 out of 50

Epoch 34/99
----------
train Loss: 2.3161 LRAP: 0.0918 NDCG: 0.3202
val Loss: 2.5257 LRAP: 0.1334 NDCG: 0.3280
Validation loss decreased (2.538104 --> 2.525659).  Saving model ...

Epoch 35/99
----------
train Loss: 2.2898 LRAP: 0.1024 NDCG: 0.3167
val Loss: 2.5390 LRAP: 0.1436 NDCG: 0.3430
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 2.2577 LRAP: 0.0947 NDCG: 0.3208
val Loss: 2.4879 LRAP: 0.1398 NDCG: 0.3495
Validation loss decreased (2.525659 --> 2.487865).  Saving model ...

Epoch 37/99
----------
train Loss: 2.2356 LRAP: 0.0964 NDCG: 0.3217
val Loss: 2.4167 LRAP: 0.1347 NDCG: 0.3413
Validation loss decreased (2.487865 --> 2.416721).  Saving model ...

Epoch 38/99
----------
train Loss: 2.2013 LRAP: 0.1016 NDCG: 0.3239
val Loss: 2.4544 LRAP: 0.1131 NDCG: 0.3406
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 2.1919 LRAP: 0.0950 NDCG: 0.3267
val Loss: 2.4149 LRAP: 0.1563 NDCG: 0.3465
Validation loss decreased (2.416721 --> 2.414863).  Saving model ...

Epoch 40/99
----------
train Loss: 2.1374 LRAP: 0.1045 NDCG: 0.3316
val Loss: 2.3551 LRAP: 0.1271 NDCG: 0.3553
Validation loss decreased (2.414863 --> 2.355066).  Saving model ...

Epoch 41/99
----------
train Loss: 2.1402 LRAP: 0.0983 NDCG: 0.3291
val Loss: 2.5353 LRAP: 0.1321 NDCG: 0.3354
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 2.1005 LRAP: 0.1043 NDCG: 0.3321
val Loss: 2.3971 LRAP: 0.1550 NDCG: 0.3483
EarlyStopping counter: 2 out of 50

Epoch 43/99
----------
train Loss: 2.0939 LRAP: 0.1067 NDCG: 0.3344
val Loss: 2.4042 LRAP: 0.1461 NDCG: 0.3664
EarlyStopping counter: 3 out of 50

Epoch 44/99
----------
train Loss: 2.0506 LRAP: 0.0961 NDCG: 0.3369
val Loss: 2.4059 LRAP: 0.1385 NDCG: 0.3582
EarlyStopping counter: 4 out of 50

Epoch 45/99
----------
train Loss: 2.0484 LRAP: 0.1054 NDCG: 0.3356
val Loss: 2.4393 LRAP: 0.1487 NDCG: 0.3470
EarlyStopping counter: 5 out of 50

Epoch 46/99
----------
train Loss: 1.9544 LRAP: 0.1024 NDCG: 0.3411
val Loss: 2.2700 LRAP: 0.1588 NDCG: 0.3793
Validation loss decreased (2.355066 --> 2.269956).  Saving model ...

Epoch 47/99
----------
train Loss: 1.8919 LRAP: 0.1084 NDCG: 0.3426
val Loss: 2.2633 LRAP: 0.1576 NDCG: 0.3816
Validation loss decreased (2.269956 --> 2.263274).  Saving model ...

Epoch 48/99
----------
train Loss: 1.8808 LRAP: 0.1048 NDCG: 0.3428
val Loss: 2.2624 LRAP: 0.1614 NDCG: 0.3800
Validation loss decreased (2.263274 --> 2.262442).  Saving model ...

Epoch 49/99
----------
train Loss: 1.8722 LRAP: 0.1051 NDCG: 0.3448
val Loss: 2.2468 LRAP: 0.1614 NDCG: 0.3753
Validation loss decreased (2.262442 --> 2.246815).  Saving model ...

Epoch 50/99
----------
train Loss: 1.8354 LRAP: 0.1105 NDCG: 0.3475
val Loss: 2.2561 LRAP: 0.1652 NDCG: 0.3775
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 1.8425 LRAP: 0.1171 NDCG: 0.3474
val Loss: 2.2708 LRAP: 0.1677 NDCG: 0.3909
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 1.8362 LRAP: 0.1092 NDCG: 0.3471
val Loss: 2.2476 LRAP: 0.1677 NDCG: 0.3872
EarlyStopping counter: 3 out of 50

Epoch 53/99
----------
train Loss: 1.8232 LRAP: 0.1075 NDCG: 0.3480
val Loss: 2.2406 LRAP: 0.1588 NDCG: 0.3782
Validation loss decreased (2.246815 --> 2.240564).  Saving model ...

Epoch 54/99
----------
train Loss: 1.8093 LRAP: 0.1065 NDCG: 0.3513
val Loss: 2.2412 LRAP: 0.1639 NDCG: 0.3894
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.7919 LRAP: 0.1100 NDCG: 0.3478
val Loss: 2.2595 LRAP: 0.1626 NDCG: 0.3838
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 1.7889 LRAP: 0.1056 NDCG: 0.3503
val Loss: 2.2371 LRAP: 0.1652 NDCG: 0.3907
Validation loss decreased (2.240564 --> 2.237096).  Saving model ...

Epoch 57/99
----------
train Loss: 1.7899 LRAP: 0.1086 NDCG: 0.3507
val Loss: 2.2446 LRAP: 0.1703 NDCG: 0.3924
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 1.7831 LRAP: 0.1130 NDCG: 0.3530
val Loss: 2.2536 LRAP: 0.1665 NDCG: 0.3897
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 1.7641 LRAP: 0.1122 NDCG: 0.3533
val Loss: 2.2452 LRAP: 0.1703 NDCG: 0.3960
EarlyStopping counter: 3 out of 50

Epoch 60/99
----------
train Loss: 1.7718 LRAP: 0.1089 NDCG: 0.3539
val Loss: 2.2604 LRAP: 0.1665 NDCG: 0.3884
EarlyStopping counter: 4 out of 50

Epoch 61/99
----------
train Loss: 1.7494 LRAP: 0.1092 NDCG: 0.3545
val Loss: 2.2436 LRAP: 0.1639 NDCG: 0.3895
EarlyStopping counter: 5 out of 50

Epoch 62/99
----------
train Loss: 1.7420 LRAP: 0.1141 NDCG: 0.3556
val Loss: 2.2408 LRAP: 0.1728 NDCG: 0.3957
EarlyStopping counter: 6 out of 50

Epoch 63/99
----------
train Loss: 1.7171 LRAP: 0.1160 NDCG: 0.3564
val Loss: 2.2416 LRAP: 0.1703 NDCG: 0.3971
EarlyStopping counter: 7 out of 50

Epoch 64/99
----------
train Loss: 1.7069 LRAP: 0.1122 NDCG: 0.3564
val Loss: 2.2401 LRAP: 0.1741 NDCG: 0.3954
EarlyStopping counter: 8 out of 50

Epoch 65/99
----------
train Loss: 1.7069 LRAP: 0.1130 NDCG: 0.3558
val Loss: 2.2337 LRAP: 0.1703 NDCG: 0.3959
Validation loss decreased (2.237096 --> 2.233744).  Saving model ...

Epoch 66/99
----------
train Loss: 1.7062 LRAP: 0.1179 NDCG: 0.3542
val Loss: 2.2388 LRAP: 0.1741 NDCG: 0.3964
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 1.7083 LRAP: 0.1184 NDCG: 0.3553
val Loss: 2.2383 LRAP: 0.1715 NDCG: 0.3950
EarlyStopping counter: 2 out of 50

Epoch 68/99
----------
train Loss: 1.7008 LRAP: 0.1171 NDCG: 0.3555
val Loss: 2.2341 LRAP: 0.1728 NDCG: 0.3974
EarlyStopping counter: 3 out of 50

Epoch 69/99
----------
train Loss: 1.7159 LRAP: 0.1146 NDCG: 0.3539
val Loss: 2.2376 LRAP: 0.1728 NDCG: 0.3968
EarlyStopping counter: 4 out of 50

Epoch 70/99
----------
train Loss: 1.7037 LRAP: 0.1225 NDCG: 0.3553
val Loss: 2.2401 LRAP: 0.1715 NDCG: 0.3976
EarlyStopping counter: 5 out of 50

Epoch 71/99
----------
train Loss: 1.7082 LRAP: 0.1173 NDCG: 0.3546
val Loss: 2.2397 LRAP: 0.1741 NDCG: 0.3982
EarlyStopping counter: 6 out of 50

Epoch 72/99
----------
train Loss: 1.6971 LRAP: 0.1173 NDCG: 0.3559
val Loss: 2.2397 LRAP: 0.1715 NDCG: 0.3994
EarlyStopping counter: 7 out of 50

Epoch 73/99
----------
train Loss: 1.6924 LRAP: 0.1138 NDCG: 0.3561
val Loss: 2.2396 LRAP: 0.1741 NDCG: 0.4004
EarlyStopping counter: 8 out of 50

Epoch 74/99
----------
train Loss: 1.6991 LRAP: 0.1130 NDCG: 0.3552
val Loss: 2.2389 LRAP: 0.1728 NDCG: 0.3992
EarlyStopping counter: 9 out of 50

Epoch 75/99
----------
train Loss: 1.6971 LRAP: 0.1179 NDCG: 0.3565
val Loss: 2.2372 LRAP: 0.1728 NDCG: 0.3991
EarlyStopping counter: 10 out of 50

Epoch 76/99
----------
train Loss: 1.7035 LRAP: 0.1130 NDCG: 0.3557
val Loss: 2.2392 LRAP: 0.1741 NDCG: 0.4003
EarlyStopping counter: 11 out of 50

Epoch 77/99
----------
train Loss: 1.6905 LRAP: 0.1160 NDCG: 0.3582
val Loss: 2.2400 LRAP: 0.1728 NDCG: 0.3990
EarlyStopping counter: 12 out of 50

Epoch 78/99
----------
train Loss: 1.7105 LRAP: 0.1165 NDCG: 0.3553
val Loss: 2.2389 LRAP: 0.1715 NDCG: 0.3951
EarlyStopping counter: 13 out of 50

Epoch 79/99
----------
train Loss: 1.6894 LRAP: 0.1146 NDCG: 0.3582
val Loss: 2.2384 LRAP: 0.1728 NDCG: 0.3998
EarlyStopping counter: 14 out of 50

Epoch 80/99
----------
train Loss: 1.6875 LRAP: 0.1154 NDCG: 0.3559
val Loss: 2.2359 LRAP: 0.1728 NDCG: 0.3981
EarlyStopping counter: 15 out of 50

Epoch 81/99
----------
train Loss: 1.6828 LRAP: 0.1154 NDCG: 0.3597
val Loss: 2.2365 LRAP: 0.1728 NDCG: 0.4000
EarlyStopping counter: 16 out of 50

Epoch 82/99
----------
train Loss: 1.7079 LRAP: 0.1103 NDCG: 0.3553
val Loss: 2.2401 LRAP: 0.1715 NDCG: 0.3998
EarlyStopping counter: 17 out of 50

Epoch 83/99
----------
train Loss: 1.6974 LRAP: 0.1149 NDCG: 0.3572
val Loss: 2.2368 LRAP: 0.1741 NDCG: 0.4003
EarlyStopping counter: 18 out of 50

Epoch 84/99
----------
train Loss: 1.6937 LRAP: 0.1165 NDCG: 0.3558
val Loss: 2.2383 LRAP: 0.1728 NDCG: 0.3985
EarlyStopping counter: 19 out of 50

Epoch 85/99
----------
train Loss: 1.6953 LRAP: 0.1100 NDCG: 0.3578
val Loss: 2.2392 LRAP: 0.1728 NDCG: 0.3998
EarlyStopping counter: 20 out of 50

Epoch 86/99
----------
train Loss: 1.6829 LRAP: 0.1138 NDCG: 0.3562
val Loss: 2.2425 LRAP: 0.1753 NDCG: 0.3989
EarlyStopping counter: 21 out of 50

Epoch 87/99
----------
train Loss: 1.6904 LRAP: 0.1203 NDCG: 0.3566
val Loss: 2.2405 LRAP: 0.1703 NDCG: 0.3969
EarlyStopping counter: 22 out of 50

Epoch 88/99
----------
train Loss: 1.6865 LRAP: 0.1165 NDCG: 0.3572
val Loss: 2.2383 LRAP: 0.1728 NDCG: 0.3994
EarlyStopping counter: 23 out of 50

Epoch 89/99
----------
train Loss: 1.6982 LRAP: 0.1165 NDCG: 0.3566
val Loss: 2.2428 LRAP: 0.1741 NDCG: 0.3993
EarlyStopping counter: 24 out of 50

Epoch 90/99
----------
train Loss: 1.6991 LRAP: 0.1179 NDCG: 0.3559
val Loss: 2.2370 LRAP: 0.1715 NDCG: 0.3983
EarlyStopping counter: 25 out of 50

Epoch 91/99
----------
train Loss: 1.7067 LRAP: 0.1143 NDCG: 0.3557
val Loss: 2.2372 LRAP: 0.1703 NDCG: 0.3966
EarlyStopping counter: 26 out of 50

Epoch 92/99
----------
train Loss: 1.6997 LRAP: 0.1143 NDCG: 0.3578
val Loss: 2.2432 LRAP: 0.1715 NDCG: 0.3985
EarlyStopping counter: 27 out of 50

Epoch 93/99
----------
train Loss: 1.6883 LRAP: 0.1176 NDCG: 0.3584
val Loss: 2.2432 LRAP: 0.1741 NDCG: 0.3997
EarlyStopping counter: 28 out of 50

Epoch 94/99
----------
train Loss: 1.6805 LRAP: 0.1160 NDCG: 0.3569
val Loss: 2.2422 LRAP: 0.1741 NDCG: 0.3998
EarlyStopping counter: 29 out of 50

Epoch 95/99
----------
train Loss: 1.6967 LRAP: 0.1116 NDCG: 0.3562
val Loss: 2.2390 LRAP: 0.1728 NDCG: 0.4010
EarlyStopping counter: 30 out of 50

Epoch 96/99
----------
train Loss: 1.6899 LRAP: 0.1103 NDCG: 0.3567
val Loss: 2.2408 LRAP: 0.1715 NDCG: 0.3981
EarlyStopping counter: 31 out of 50

Epoch 97/99
----------
train Loss: 1.6936 LRAP: 0.1146 NDCG: 0.3578
val Loss: 2.2350 LRAP: 0.1728 NDCG: 0.3997
EarlyStopping counter: 32 out of 50

Epoch 98/99
----------
train Loss: 1.6949 LRAP: 0.1138 NDCG: 0.3563
val Loss: 2.2406 LRAP: 0.1728 NDCG: 0.3982
EarlyStopping counter: 33 out of 50

Epoch 99/99
----------
train Loss: 1.6918 LRAP: 0.1127 NDCG: 0.3555
val Loss: 2.2381 LRAP: 0.1715 NDCG: 0.3984
EarlyStopping counter: 34 out of 50

Training complete in 2m 33s
Best val loss: 2.233744, best LRAP score: 0.7801

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.6034 LRAP: 0.0000 NDCG: 0.1657
val Loss: 8.3583 LRAP: 0.0000 NDCG: 0.1356
Validation loss decreased (0.000000 --> 8.358271).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0613 LRAP: 0.0019 NDCG: 0.1896
val Loss: 6.4294 LRAP: 0.0025 NDCG: 0.1449
Validation loss decreased (8.358271 --> 6.429437).  Saving model ...

Epoch 2/99
----------
train Loss: 3.9176 LRAP: 0.0027 NDCG: 0.1985
val Loss: 4.9519 LRAP: 0.0076 NDCG: 0.1951
Validation loss decreased (6.429437 --> 4.951922).  Saving model ...

Epoch 3/99
----------
train Loss: 3.8226 LRAP: 0.0060 NDCG: 0.2049
val Loss: 9.7019 LRAP: 0.0038 NDCG: 0.1705
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.7776 LRAP: 0.0060 NDCG: 0.2088
val Loss: 4.8174 LRAP: 0.0076 NDCG: 0.2084
Validation loss decreased (4.951922 --> 4.817377).  Saving model ...

Epoch 5/99
----------
train Loss: 3.7157 LRAP: 0.0046 NDCG: 0.2139
val Loss: 4.3836 LRAP: 0.0025 NDCG: 0.2460
Validation loss decreased (4.817377 --> 4.383640).  Saving model ...

Epoch 6/99
----------
train Loss: 3.6754 LRAP: 0.0082 NDCG: 0.2144
val Loss: 3.8694 LRAP: 0.0038 NDCG: 0.1997
Validation loss decreased (4.383640 --> 3.869371).  Saving model ...

Epoch 7/99
----------
train Loss: 3.6549 LRAP: 0.0060 NDCG: 0.2194
val Loss: 4.2517 LRAP: 0.0152 NDCG: 0.2358
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.6292 LRAP: 0.0112 NDCG: 0.2206
val Loss: 5.0461 LRAP: 0.0280 NDCG: 0.2204
EarlyStopping counter: 2 out of 50

Epoch 9/99
----------
train Loss: 3.5830 LRAP: 0.0133 NDCG: 0.2188
val Loss: 3.6456 LRAP: 0.0280 NDCG: 0.2256
Validation loss decreased (3.869371 --> 3.645629).  Saving model ...

Epoch 10/99
----------
train Loss: 3.5459 LRAP: 0.0112 NDCG: 0.2221
val Loss: 5.1808 LRAP: 0.0051 NDCG: 0.2364
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.4895 LRAP: 0.0169 NDCG: 0.2276
val Loss: 4.3611 LRAP: 0.0292 NDCG: 0.2097
EarlyStopping counter: 2 out of 50

Epoch 12/99
----------
train Loss: 3.4532 LRAP: 0.0275 NDCG: 0.2324
val Loss: 3.8240 LRAP: 0.0025 NDCG: 0.2060
EarlyStopping counter: 3 out of 50

Epoch 13/99
----------
train Loss: 3.4294 LRAP: 0.0348 NDCG: 0.2311
val Loss: 4.4457 LRAP: 0.0673 NDCG: 0.1727
EarlyStopping counter: 4 out of 50

Epoch 14/99
----------
train Loss: 3.3947 LRAP: 0.0397 NDCG: 0.2376
val Loss: 3.8791 LRAP: 0.0000 NDCG: 0.2198
EarlyStopping counter: 5 out of 50

Epoch 15/99
----------
train Loss: 3.3181 LRAP: 0.0316 NDCG: 0.2390
val Loss: 3.4667 LRAP: 0.0496 NDCG: 0.2210
Validation loss decreased (3.645629 --> 3.466714).  Saving model ...

Epoch 16/99
----------
train Loss: 3.2700 LRAP: 0.0381 NDCG: 0.2431
val Loss: 3.2531 LRAP: 0.0686 NDCG: 0.2497
Validation loss decreased (3.466714 --> 3.253061).  Saving model ...

Epoch 17/99
----------
train Loss: 3.2693 LRAP: 0.0466 NDCG: 0.2421
val Loss: 3.4680 LRAP: 0.0483 NDCG: 0.2473
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 3.2324 LRAP: 0.0460 NDCG: 0.2436
val Loss: 3.1784 LRAP: 0.0801 NDCG: 0.2455
Validation loss decreased (3.253061 --> 3.178436).  Saving model ...

Epoch 19/99
----------
train Loss: 3.2210 LRAP: 0.0517 NDCG: 0.2448
val Loss: 4.0467 LRAP: 0.0826 NDCG: 0.2447
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.2192 LRAP: 0.0547 NDCG: 0.2452
val Loss: 3.2674 LRAP: 0.0241 NDCG: 0.2332
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 3.2245 LRAP: 0.0466 NDCG: 0.2431
val Loss: 3.4291 LRAP: 0.0839 NDCG: 0.2218
EarlyStopping counter: 3 out of 50

Epoch 22/99
----------
train Loss: 3.1961 LRAP: 0.0468 NDCG: 0.2458
val Loss: 3.2698 LRAP: 0.0534 NDCG: 0.2536
EarlyStopping counter: 4 out of 50

Epoch 23/99
----------
train Loss: 3.1958 LRAP: 0.0528 NDCG: 0.2455
val Loss: 3.3611 LRAP: 0.0788 NDCG: 0.2378
EarlyStopping counter: 5 out of 50

Epoch 24/99
----------
train Loss: 3.1703 LRAP: 0.0531 NDCG: 0.2503
val Loss: 3.0639 LRAP: 0.0686 NDCG: 0.2545
Validation loss decreased (3.178436 --> 3.063851).  Saving model ...

Epoch 25/99
----------
train Loss: 3.1547 LRAP: 0.0542 NDCG: 0.2484
val Loss: 3.0612 LRAP: 0.0839 NDCG: 0.2517
Validation loss decreased (3.063851 --> 3.061177).  Saving model ...

Epoch 26/99
----------
train Loss: 3.1705 LRAP: 0.0536 NDCG: 0.2483
val Loss: 3.0594 LRAP: 0.0788 NDCG: 0.2531
Validation loss decreased (3.061177 --> 3.059436).  Saving model ...

Epoch 27/99
----------
train Loss: 3.1409 LRAP: 0.0585 NDCG: 0.2508
val Loss: 3.0439 LRAP: 0.0928 NDCG: 0.2544
Validation loss decreased (3.059436 --> 3.043883).  Saving model ...

Epoch 28/99
----------
train Loss: 3.1487 LRAP: 0.0583 NDCG: 0.2498
val Loss: 3.0475 LRAP: 0.0940 NDCG: 0.2537
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 3.1550 LRAP: 0.0591 NDCG: 0.2485
val Loss: 3.0395 LRAP: 0.0940 NDCG: 0.2546
Validation loss decreased (3.043883 --> 3.039507).  Saving model ...

Epoch 30/99
----------
train Loss: 3.1556 LRAP: 0.0528 NDCG: 0.2502
val Loss: 3.0588 LRAP: 0.1004 NDCG: 0.2526
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 3.1434 LRAP: 0.0550 NDCG: 0.2500
val Loss: 3.0517 LRAP: 0.0991 NDCG: 0.2534
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 3.1393 LRAP: 0.0553 NDCG: 0.2502
val Loss: 3.0364 LRAP: 0.0902 NDCG: 0.2580
Validation loss decreased (3.039507 --> 3.036372).  Saving model ...

Epoch 33/99
----------
train Loss: 3.1357 LRAP: 0.0553 NDCG: 0.2516
val Loss: 3.0571 LRAP: 0.0851 NDCG: 0.2518
EarlyStopping counter: 1 out of 50

Epoch 34/99
----------
train Loss: 3.1256 LRAP: 0.0588 NDCG: 0.2500
val Loss: 3.0974 LRAP: 0.1004 NDCG: 0.2572
EarlyStopping counter: 2 out of 50

Epoch 35/99
----------
train Loss: 3.1227 LRAP: 0.0553 NDCG: 0.2527
val Loss: 3.0518 LRAP: 0.0940 NDCG: 0.2555
EarlyStopping counter: 3 out of 50

Epoch 36/99
----------
train Loss: 3.1300 LRAP: 0.0594 NDCG: 0.2498
val Loss: 3.0947 LRAP: 0.1118 NDCG: 0.2533
EarlyStopping counter: 4 out of 50

Epoch 37/99
----------
train Loss: 3.1404 LRAP: 0.0623 NDCG: 0.2502
val Loss: 3.0317 LRAP: 0.0902 NDCG: 0.2563
Validation loss decreased (3.036372 --> 3.031718).  Saving model ...

Epoch 38/99
----------
train Loss: 3.1196 LRAP: 0.0656 NDCG: 0.2498
val Loss: 3.0447 LRAP: 0.0953 NDCG: 0.2550
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 3.1268 LRAP: 0.0596 NDCG: 0.2521
val Loss: 3.0219 LRAP: 0.1004 NDCG: 0.2556
Validation loss decreased (3.031718 --> 3.021917).  Saving model ...

Epoch 40/99
----------
train Loss: 3.1153 LRAP: 0.0555 NDCG: 0.2495
val Loss: 3.0293 LRAP: 0.0864 NDCG: 0.2562
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 3.1229 LRAP: 0.0632 NDCG: 0.2513
val Loss: 3.0272 LRAP: 0.0940 NDCG: 0.2547
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 3.1115 LRAP: 0.0667 NDCG: 0.2519
val Loss: 3.0161 LRAP: 0.0940 NDCG: 0.2562
Validation loss decreased (3.021917 --> 3.016060).  Saving model ...

Epoch 43/99
----------
train Loss: 3.1223 LRAP: 0.0618 NDCG: 0.2508
val Loss: 3.0358 LRAP: 0.1017 NDCG: 0.2556
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.1155 LRAP: 0.0664 NDCG: 0.2514
val Loss: 3.0119 LRAP: 0.0940 NDCG: 0.2548
Validation loss decreased (3.016060 --> 3.011884).  Saving model ...

Epoch 45/99
----------
train Loss: 3.1084 LRAP: 0.0632 NDCG: 0.2527
val Loss: 3.0159 LRAP: 0.0940 NDCG: 0.2572
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 3.1018 LRAP: 0.0656 NDCG: 0.2527
val Loss: 3.0058 LRAP: 0.0966 NDCG: 0.2586
Validation loss decreased (3.011884 --> 3.005833).  Saving model ...

Epoch 47/99
----------
train Loss: 3.0994 LRAP: 0.0604 NDCG: 0.2530
val Loss: 3.0103 LRAP: 0.0978 NDCG: 0.2566
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.0940 LRAP: 0.0678 NDCG: 0.2526
val Loss: 3.0814 LRAP: 0.1029 NDCG: 0.2524
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.1102 LRAP: 0.0596 NDCG: 0.2527
val Loss: 3.0123 LRAP: 0.1042 NDCG: 0.2616
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 3.1091 LRAP: 0.0637 NDCG: 0.2555
val Loss: 3.0183 LRAP: 0.0978 NDCG: 0.2590
EarlyStopping counter: 4 out of 50

Epoch 51/99
----------
train Loss: 3.0849 LRAP: 0.0643 NDCG: 0.2548
val Loss: 3.0625 LRAP: 0.1118 NDCG: 0.2517
EarlyStopping counter: 5 out of 50

Epoch 52/99
----------
train Loss: 3.0929 LRAP: 0.0700 NDCG: 0.2539
val Loss: 2.9961 LRAP: 0.0978 NDCG: 0.2594
Validation loss decreased (3.005833 --> 2.996079).  Saving model ...

Epoch 53/99
----------
train Loss: 3.0862 LRAP: 0.0656 NDCG: 0.2548
val Loss: 2.9945 LRAP: 0.0991 NDCG: 0.2608
Validation loss decreased (2.996079 --> 2.994501).  Saving model ...

Epoch 54/99
----------
train Loss: 3.0873 LRAP: 0.0672 NDCG: 0.2537
val Loss: 2.9918 LRAP: 0.0953 NDCG: 0.2607
Validation loss decreased (2.994501 --> 2.991789).  Saving model ...

Epoch 55/99
----------
train Loss: 3.0946 LRAP: 0.0670 NDCG: 0.2542
val Loss: 2.9941 LRAP: 0.1004 NDCG: 0.2596
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 3.0806 LRAP: 0.0632 NDCG: 0.2546
val Loss: 2.9982 LRAP: 0.1017 NDCG: 0.2601
EarlyStopping counter: 2 out of 50

Epoch 57/99
----------
train Loss: 3.0876 LRAP: 0.0656 NDCG: 0.2539
val Loss: 2.9962 LRAP: 0.1004 NDCG: 0.2604
EarlyStopping counter: 3 out of 50

Epoch 58/99
----------
train Loss: 3.1049 LRAP: 0.0623 NDCG: 0.2546
val Loss: 2.9935 LRAP: 0.0978 NDCG: 0.2602
EarlyStopping counter: 4 out of 50

Epoch 59/99
----------
train Loss: 3.0864 LRAP: 0.0645 NDCG: 0.2561
val Loss: 2.9916 LRAP: 0.0953 NDCG: 0.2604
Validation loss decreased (2.991789 --> 2.991575).  Saving model ...

Epoch 60/99
----------
train Loss: 3.0860 LRAP: 0.0732 NDCG: 0.2558
val Loss: 2.9915 LRAP: 0.0978 NDCG: 0.2598
Validation loss decreased (2.991575 --> 2.991477).  Saving model ...

Epoch 61/99
----------
train Loss: 3.0890 LRAP: 0.0678 NDCG: 0.2549
val Loss: 2.9935 LRAP: 0.1004 NDCG: 0.2605
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 3.0824 LRAP: 0.0689 NDCG: 0.2539
val Loss: 2.9928 LRAP: 0.1004 NDCG: 0.2606
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 3.0811 LRAP: 0.0672 NDCG: 0.2547
val Loss: 2.9977 LRAP: 0.1029 NDCG: 0.2600
EarlyStopping counter: 3 out of 50

Epoch 64/99
----------
train Loss: 3.0824 LRAP: 0.0648 NDCG: 0.2545
val Loss: 2.9919 LRAP: 0.0991 NDCG: 0.2596
EarlyStopping counter: 4 out of 50

Epoch 65/99
----------
train Loss: 3.1026 LRAP: 0.0670 NDCG: 0.2537
val Loss: 2.9909 LRAP: 0.0991 NDCG: 0.2593
Validation loss decreased (2.991477 --> 2.990919).  Saving model ...

Epoch 66/99
----------
train Loss: 3.0827 LRAP: 0.0645 NDCG: 0.2552
val Loss: 2.9930 LRAP: 0.0978 NDCG: 0.2611
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 3.0791 LRAP: 0.0670 NDCG: 0.2538
val Loss: 2.9953 LRAP: 0.0978 NDCG: 0.2595
EarlyStopping counter: 2 out of 50

Epoch 68/99
----------
train Loss: 3.1052 LRAP: 0.0675 NDCG: 0.2559
val Loss: 2.9927 LRAP: 0.0991 NDCG: 0.2597
EarlyStopping counter: 3 out of 50

Epoch 69/99
----------
train Loss: 3.0834 LRAP: 0.0621 NDCG: 0.2540
val Loss: 2.9897 LRAP: 0.0953 NDCG: 0.2612
Validation loss decreased (2.990919 --> 2.989687).  Saving model ...

Epoch 70/99
----------
train Loss: 3.0931 LRAP: 0.0645 NDCG: 0.2555
val Loss: 2.9904 LRAP: 0.0991 NDCG: 0.2603
EarlyStopping counter: 1 out of 50

Epoch 71/99
----------
train Loss: 3.0789 LRAP: 0.0686 NDCG: 0.2556
val Loss: 2.9901 LRAP: 0.0991 NDCG: 0.2596
EarlyStopping counter: 2 out of 50

Epoch 72/99
----------
train Loss: 3.0977 LRAP: 0.0659 NDCG: 0.2551
val Loss: 2.9901 LRAP: 0.1017 NDCG: 0.2600
EarlyStopping counter: 3 out of 50

Epoch 73/99
----------
train Loss: 3.0903 LRAP: 0.0640 NDCG: 0.2543
val Loss: 2.9929 LRAP: 0.0991 NDCG: 0.2596
EarlyStopping counter: 4 out of 50

Epoch 74/99
----------
train Loss: 3.0857 LRAP: 0.0686 NDCG: 0.2554
val Loss: 2.9906 LRAP: 0.0991 NDCG: 0.2603
EarlyStopping counter: 5 out of 50

Epoch 75/99
----------
train Loss: 3.0881 LRAP: 0.0678 NDCG: 0.2544
val Loss: 2.9904 LRAP: 0.0991 NDCG: 0.2605
EarlyStopping counter: 6 out of 50

Epoch 76/99
----------
train Loss: 3.0883 LRAP: 0.0686 NDCG: 0.2536
val Loss: 2.9928 LRAP: 0.0991 NDCG: 0.2604
EarlyStopping counter: 7 out of 50

Epoch 77/99
----------
train Loss: 3.0898 LRAP: 0.0675 NDCG: 0.2572
val Loss: 2.9945 LRAP: 0.0991 NDCG: 0.2596
EarlyStopping counter: 8 out of 50

Epoch 78/99
----------
train Loss: 3.0798 LRAP: 0.0700 NDCG: 0.2564
val Loss: 2.9918 LRAP: 0.0991 NDCG: 0.2597
EarlyStopping counter: 9 out of 50

Epoch 79/99
----------
train Loss: 3.0868 LRAP: 0.0643 NDCG: 0.2555
val Loss: 2.9918 LRAP: 0.1004 NDCG: 0.2607
EarlyStopping counter: 10 out of 50

Epoch 80/99
----------
train Loss: 3.0872 LRAP: 0.0678 NDCG: 0.2556
val Loss: 2.9895 LRAP: 0.1004 NDCG: 0.2607
Validation loss decreased (2.989687 --> 2.989487).  Saving model ...

Epoch 81/99
----------
train Loss: 3.0796 LRAP: 0.0692 NDCG: 0.2544
val Loss: 2.9890 LRAP: 0.0978 NDCG: 0.2610
Validation loss decreased (2.989487 --> 2.988978).  Saving model ...

Epoch 82/99
----------
train Loss: 3.0710 LRAP: 0.0675 NDCG: 0.2556
val Loss: 2.9898 LRAP: 0.0991 NDCG: 0.2611
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.0816 LRAP: 0.0653 NDCG: 0.2551
val Loss: 2.9892 LRAP: 0.0991 NDCG: 0.2596
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.0834 LRAP: 0.0637 NDCG: 0.2543
val Loss: 2.9904 LRAP: 0.1004 NDCG: 0.2612
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.0809 LRAP: 0.0656 NDCG: 0.2554
val Loss: 2.9908 LRAP: 0.0991 NDCG: 0.2613
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.0869 LRAP: 0.0670 NDCG: 0.2563
val Loss: 2.9905 LRAP: 0.0991 NDCG: 0.2607
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 3.0890 LRAP: 0.0678 NDCG: 0.2551
val Loss: 2.9943 LRAP: 0.1017 NDCG: 0.2609
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 3.0810 LRAP: 0.0719 NDCG: 0.2544
val Loss: 2.9872 LRAP: 0.0978 NDCG: 0.2606
Validation loss decreased (2.988978 --> 2.987188).  Saving model ...

Epoch 89/99
----------
train Loss: 3.0802 LRAP: 0.0667 NDCG: 0.2557
val Loss: 2.9918 LRAP: 0.1004 NDCG: 0.2602
EarlyStopping counter: 1 out of 50

Epoch 90/99
----------
train Loss: 3.0923 LRAP: 0.0629 NDCG: 0.2553
val Loss: 2.9941 LRAP: 0.1029 NDCG: 0.2605
EarlyStopping counter: 2 out of 50

Epoch 91/99
----------
train Loss: 3.0912 LRAP: 0.0692 NDCG: 0.2551
val Loss: 2.9954 LRAP: 0.1004 NDCG: 0.2604
EarlyStopping counter: 3 out of 50

Epoch 92/99
----------
train Loss: 3.0878 LRAP: 0.0632 NDCG: 0.2544
val Loss: 2.9924 LRAP: 0.1017 NDCG: 0.2610
EarlyStopping counter: 4 out of 50

Epoch 93/99
----------
train Loss: 3.0768 LRAP: 0.0675 NDCG: 0.2544
val Loss: 2.9889 LRAP: 0.0991 NDCG: 0.2598
EarlyStopping counter: 5 out of 50

Epoch 94/99
----------
train Loss: 3.0896 LRAP: 0.0664 NDCG: 0.2543
val Loss: 2.9898 LRAP: 0.0991 NDCG: 0.2606
EarlyStopping counter: 6 out of 50

Epoch 95/99
----------
train Loss: 3.0890 LRAP: 0.0618 NDCG: 0.2521
val Loss: 2.9877 LRAP: 0.0953 NDCG: 0.2592
EarlyStopping counter: 7 out of 50

Epoch 96/99
----------
train Loss: 3.0927 LRAP: 0.0607 NDCG: 0.2558
val Loss: 2.9932 LRAP: 0.0966 NDCG: 0.2583
EarlyStopping counter: 8 out of 50

Epoch 97/99
----------
train Loss: 3.0787 LRAP: 0.0664 NDCG: 0.2529
val Loss: 2.9879 LRAP: 0.0978 NDCG: 0.2606
EarlyStopping counter: 9 out of 50

Epoch 98/99
----------
train Loss: 3.0864 LRAP: 0.0659 NDCG: 0.2548
val Loss: 2.9883 LRAP: 0.0991 NDCG: 0.2616
EarlyStopping counter: 10 out of 50

Epoch 99/99
----------
train Loss: 3.0808 LRAP: 0.0618 NDCG: 0.2542
val Loss: 2.9915 LRAP: 0.0991 NDCG: 0.2595
EarlyStopping counter: 11 out of 50

Training complete in 2m 36s
Best val loss: 2.987188, best LRAP score: 0.6188

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6603 LRAP: 0.0000 NDCG: 0.1604
val Loss: 5.1515 LRAP: 0.0000 NDCG: 0.1566
Validation loss decreased (0.000000 --> 5.151501).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1450 LRAP: 0.0003 NDCG: 0.1958
val Loss: 6.0847 LRAP: 0.0000 NDCG: 0.1671
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.9430 LRAP: 0.0003 NDCG: 0.2068
val Loss: 5.4150 LRAP: 0.0000 NDCG: 0.1040
EarlyStopping counter: 2 out of 50

Epoch 3/99
----------
train Loss: 3.8400 LRAP: 0.0027 NDCG: 0.2124
val Loss: 3.8492 LRAP: 0.0025 NDCG: 0.2115
Validation loss decreased (5.151501 --> 3.849196).  Saving model ...

Epoch 4/99
----------
train Loss: 3.8077 LRAP: 0.0033 NDCG: 0.2113
val Loss: 4.9326 LRAP: 0.0000 NDCG: 0.1009
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.7527 LRAP: 0.0084 NDCG: 0.2154
val Loss: 4.2802 LRAP: 0.0051 NDCG: 0.1552
EarlyStopping counter: 2 out of 50

Epoch 6/99
----------
train Loss: 3.7069 LRAP: 0.0071 NDCG: 0.2174
val Loss: 5.0081 LRAP: 0.0051 NDCG: 0.1024
EarlyStopping counter: 3 out of 50

Epoch 7/99
----------
train Loss: 3.6877 LRAP: 0.0131 NDCG: 0.2195
val Loss: 3.8092 LRAP: 0.0076 NDCG: 0.2176
Validation loss decreased (3.849196 --> 3.809178).  Saving model ...

Epoch 8/99
----------
train Loss: 3.6653 LRAP: 0.0261 NDCG: 0.2185
val Loss: 4.8400 LRAP: 0.0013 NDCG: 0.1303
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.6460 LRAP: 0.0218 NDCG: 0.2196
val Loss: 5.0408 LRAP: 0.1321 NDCG: 0.2098
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.6045 LRAP: 0.0321 NDCG: 0.2240
val Loss: 3.8291 LRAP: 0.1296 NDCG: 0.2233
EarlyStopping counter: 3 out of 50

Epoch 11/99
----------
train Loss: 3.5765 LRAP: 0.0335 NDCG: 0.2256
val Loss: 3.8166 LRAP: 0.0318 NDCG: 0.2054
EarlyStopping counter: 4 out of 50

Epoch 12/99
----------
train Loss: 3.5570 LRAP: 0.0512 NDCG: 0.2256
val Loss: 4.2864 LRAP: 0.0254 NDCG: 0.1514
EarlyStopping counter: 5 out of 50

Epoch 13/99
----------
train Loss: 3.4907 LRAP: 0.0487 NDCG: 0.2301
val Loss: 3.7077 LRAP: 0.1334 NDCG: 0.2339
Validation loss decreased (3.809178 --> 3.707679).  Saving model ...

Epoch 14/99
----------
train Loss: 3.4667 LRAP: 0.0528 NDCG: 0.2310
val Loss: 3.4738 LRAP: 0.0127 NDCG: 0.2296
Validation loss decreased (3.707679 --> 3.473775).  Saving model ...

Epoch 15/99
----------
train Loss: 3.4606 LRAP: 0.0479 NDCG: 0.2305
val Loss: 3.3883 LRAP: 0.0801 NDCG: 0.2380
Validation loss decreased (3.473775 --> 3.388254).  Saving model ...

Epoch 16/99
----------
train Loss: 3.4309 LRAP: 0.0558 NDCG: 0.2327
val Loss: 3.4924 LRAP: 0.1271 NDCG: 0.2336
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 3.4362 LRAP: 0.0528 NDCG: 0.2317
val Loss: 3.4893 LRAP: 0.0457 NDCG: 0.2241
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 3.4241 LRAP: 0.0482 NDCG: 0.2342
val Loss: 3.4551 LRAP: 0.1245 NDCG: 0.2394
EarlyStopping counter: 3 out of 50

Epoch 19/99
----------
train Loss: 3.4100 LRAP: 0.0623 NDCG: 0.2360
val Loss: 3.3381 LRAP: 0.0356 NDCG: 0.2381
Validation loss decreased (3.388254 --> 3.338103).  Saving model ...

Epoch 20/99
----------
train Loss: 3.3978 LRAP: 0.0599 NDCG: 0.2361
val Loss: 3.3873 LRAP: 0.1233 NDCG: 0.2365
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.3805 LRAP: 0.0724 NDCG: 0.2383
val Loss: 3.9739 LRAP: 0.1360 NDCG: 0.2273
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 3.3756 LRAP: 0.0667 NDCG: 0.2378
val Loss: 3.4578 LRAP: 0.0470 NDCG: 0.2352
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 3.3574 LRAP: 0.0656 NDCG: 0.2396
val Loss: 3.7056 LRAP: 0.1385 NDCG: 0.2364
EarlyStopping counter: 4 out of 50

Epoch 24/99
----------
train Loss: 3.3447 LRAP: 0.0716 NDCG: 0.2406
val Loss: 3.3868 LRAP: 0.0229 NDCG: 0.2400
EarlyStopping counter: 5 out of 50

Epoch 25/99
----------
train Loss: 3.3072 LRAP: 0.0672 NDCG: 0.2423
val Loss: 3.2725 LRAP: 0.0801 NDCG: 0.2476
Validation loss decreased (3.338103 --> 3.272541).  Saving model ...

Epoch 26/99
----------
train Loss: 3.3154 LRAP: 0.0653 NDCG: 0.2438
val Loss: 3.2501 LRAP: 0.1029 NDCG: 0.2511
Validation loss decreased (3.272541 --> 3.250075).  Saving model ...

Epoch 27/99
----------
train Loss: 3.3138 LRAP: 0.0645 NDCG: 0.2418
val Loss: 3.2429 LRAP: 0.1029 NDCG: 0.2489
Validation loss decreased (3.250075 --> 3.242926).  Saving model ...

Epoch 28/99
----------
train Loss: 3.3031 LRAP: 0.0713 NDCG: 0.2435
val Loss: 3.2371 LRAP: 0.0877 NDCG: 0.2498
Validation loss decreased (3.242926 --> 3.237055).  Saving model ...

Epoch 29/99
----------
train Loss: 3.3056 LRAP: 0.0746 NDCG: 0.2438
val Loss: 3.2357 LRAP: 0.1017 NDCG: 0.2483
Validation loss decreased (3.237055 --> 3.235682).  Saving model ...

Epoch 30/99
----------
train Loss: 3.3121 LRAP: 0.0645 NDCG: 0.2439
val Loss: 3.2431 LRAP: 0.1093 NDCG: 0.2516
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 3.3014 LRAP: 0.0768 NDCG: 0.2449
val Loss: 3.2362 LRAP: 0.0661 NDCG: 0.2531
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 3.3006 LRAP: 0.0713 NDCG: 0.2456
val Loss: 3.2450 LRAP: 0.1105 NDCG: 0.2487
EarlyStopping counter: 3 out of 50

Epoch 33/99
----------
train Loss: 3.2937 LRAP: 0.0787 NDCG: 0.2439
val Loss: 3.2259 LRAP: 0.1029 NDCG: 0.2515
Validation loss decreased (3.235682 --> 3.225861).  Saving model ...

Epoch 34/99
----------
train Loss: 3.2926 LRAP: 0.0716 NDCG: 0.2442
val Loss: 3.2303 LRAP: 0.0978 NDCG: 0.2529
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.2980 LRAP: 0.0713 NDCG: 0.2472
val Loss: 3.2207 LRAP: 0.0928 NDCG: 0.2528
Validation loss decreased (3.225861 --> 3.220728).  Saving model ...

Epoch 36/99
----------
train Loss: 3.2867 LRAP: 0.0716 NDCG: 0.2461
val Loss: 3.2517 LRAP: 0.1029 NDCG: 0.2511
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 3.2759 LRAP: 0.0713 NDCG: 0.2469
val Loss: 3.2234 LRAP: 0.1169 NDCG: 0.2517
EarlyStopping counter: 2 out of 50

Epoch 38/99
----------
train Loss: 3.2788 LRAP: 0.0754 NDCG: 0.2467
val Loss: 3.2202 LRAP: 0.0940 NDCG: 0.2546
Validation loss decreased (3.220728 --> 3.220213).  Saving model ...

Epoch 39/99
----------
train Loss: 3.2692 LRAP: 0.0681 NDCG: 0.2462
val Loss: 3.2131 LRAP: 0.0991 NDCG: 0.2524
Validation loss decreased (3.220213 --> 3.213121).  Saving model ...

Epoch 40/99
----------
train Loss: 3.2726 LRAP: 0.0732 NDCG: 0.2464
val Loss: 3.2102 LRAP: 0.1093 NDCG: 0.2547
Validation loss decreased (3.213121 --> 3.210155).  Saving model ...

Epoch 41/99
----------
train Loss: 3.2654 LRAP: 0.0727 NDCG: 0.2470
val Loss: 3.2412 LRAP: 0.0826 NDCG: 0.2503
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 3.2617 LRAP: 0.0749 NDCG: 0.2489
val Loss: 3.1976 LRAP: 0.0991 NDCG: 0.2544
Validation loss decreased (3.210155 --> 3.197612).  Saving model ...

Epoch 43/99
----------
train Loss: 3.2670 LRAP: 0.0719 NDCG: 0.2492
val Loss: 3.2171 LRAP: 0.1067 NDCG: 0.2523
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.2613 LRAP: 0.0757 NDCG: 0.2478
val Loss: 3.1967 LRAP: 0.1144 NDCG: 0.2550
Validation loss decreased (3.197612 --> 3.196712).  Saving model ...

Epoch 45/99
----------
train Loss: 3.2514 LRAP: 0.0814 NDCG: 0.2485
val Loss: 3.2000 LRAP: 0.0978 NDCG: 0.2554
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 3.2530 LRAP: 0.0784 NDCG: 0.2480
val Loss: 3.1897 LRAP: 0.0978 NDCG: 0.2557
Validation loss decreased (3.196712 --> 3.189695).  Saving model ...

Epoch 47/99
----------
train Loss: 3.2504 LRAP: 0.0700 NDCG: 0.2502
val Loss: 3.2060 LRAP: 0.1118 NDCG: 0.2556
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.2589 LRAP: 0.0760 NDCG: 0.2490
val Loss: 3.2482 LRAP: 0.0686 NDCG: 0.2508
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.2522 LRAP: 0.0768 NDCG: 0.2495
val Loss: 3.1981 LRAP: 0.0928 NDCG: 0.2553
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 3.2361 LRAP: 0.0790 NDCG: 0.2514
val Loss: 3.1888 LRAP: 0.1093 NDCG: 0.2548
Validation loss decreased (3.189695 --> 3.188825).  Saving model ...

Epoch 51/99
----------
train Loss: 3.2332 LRAP: 0.0773 NDCG: 0.2501
val Loss: 3.2053 LRAP: 0.1017 NDCG: 0.2544
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 3.2434 LRAP: 0.0787 NDCG: 0.2508
val Loss: 3.1780 LRAP: 0.1093 NDCG: 0.2578
Validation loss decreased (3.188825 --> 3.178026).  Saving model ...

Epoch 53/99
----------
train Loss: 3.2420 LRAP: 0.0833 NDCG: 0.2516
val Loss: 3.1749 LRAP: 0.1080 NDCG: 0.2565
Validation loss decreased (3.178026 --> 3.174916).  Saving model ...

Epoch 54/99
----------
train Loss: 3.2414 LRAP: 0.0855 NDCG: 0.2487
val Loss: 3.1928 LRAP: 0.1144 NDCG: 0.2568
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 3.2306 LRAP: 0.0792 NDCG: 0.2517
val Loss: 3.2045 LRAP: 0.0813 NDCG: 0.2559
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 3.2449 LRAP: 0.0773 NDCG: 0.2515
val Loss: 3.1901 LRAP: 0.1067 NDCG: 0.2539
EarlyStopping counter: 3 out of 50

Epoch 57/99
----------
train Loss: 3.2367 LRAP: 0.0847 NDCG: 0.2503
val Loss: 3.1772 LRAP: 0.1042 NDCG: 0.2579
EarlyStopping counter: 4 out of 50

Epoch 58/99
----------
train Loss: 3.2312 LRAP: 0.0800 NDCG: 0.2495
val Loss: 3.1710 LRAP: 0.1118 NDCG: 0.2576
Validation loss decreased (3.174916 --> 3.171007).  Saving model ...

Epoch 59/99
----------
train Loss: 3.2245 LRAP: 0.0795 NDCG: 0.2519
val Loss: 3.1631 LRAP: 0.1105 NDCG: 0.2583
Validation loss decreased (3.171007 --> 3.163147).  Saving model ...

Epoch 60/99
----------
train Loss: 3.2124 LRAP: 0.0828 NDCG: 0.2534
val Loss: 3.1568 LRAP: 0.0991 NDCG: 0.2605
Validation loss decreased (3.163147 --> 3.156833).  Saving model ...

Epoch 61/99
----------
train Loss: 3.2276 LRAP: 0.0784 NDCG: 0.2515
val Loss: 3.1641 LRAP: 0.0991 NDCG: 0.2571
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 3.2168 LRAP: 0.0817 NDCG: 0.2523
val Loss: 3.1652 LRAP: 0.1194 NDCG: 0.2626
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 3.2076 LRAP: 0.0882 NDCG: 0.2527
val Loss: 3.1701 LRAP: 0.1004 NDCG: 0.2593
EarlyStopping counter: 3 out of 50

Epoch 64/99
----------
train Loss: 3.2004 LRAP: 0.0849 NDCG: 0.2527
val Loss: 3.1626 LRAP: 0.0902 NDCG: 0.2572
EarlyStopping counter: 4 out of 50

Epoch 65/99
----------
train Loss: 3.2149 LRAP: 0.0833 NDCG: 0.2527
val Loss: 3.1754 LRAP: 0.0928 NDCG: 0.2588
EarlyStopping counter: 5 out of 50

Epoch 66/99
----------
train Loss: 3.1916 LRAP: 0.0923 NDCG: 0.2536
val Loss: 3.1507 LRAP: 0.1144 NDCG: 0.2605
Validation loss decreased (3.156833 --> 3.150689).  Saving model ...

Epoch 67/99
----------
train Loss: 3.1993 LRAP: 0.0819 NDCG: 0.2543
val Loss: 3.1484 LRAP: 0.1105 NDCG: 0.2610
Validation loss decreased (3.150689 --> 3.148356).  Saving model ...

Epoch 68/99
----------
train Loss: 3.2014 LRAP: 0.0814 NDCG: 0.2534
val Loss: 3.1484 LRAP: 0.1156 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 69/99
----------
train Loss: 3.1929 LRAP: 0.0839 NDCG: 0.2548
val Loss: 3.1446 LRAP: 0.1105 NDCG: 0.2603
Validation loss decreased (3.148356 --> 3.144622).  Saving model ...

Epoch 70/99
----------
train Loss: 3.1869 LRAP: 0.0874 NDCG: 0.2549
val Loss: 3.1440 LRAP: 0.1118 NDCG: 0.2602
Validation loss decreased (3.144622 --> 3.143957).  Saving model ...

Epoch 71/99
----------
train Loss: 3.2043 LRAP: 0.0809 NDCG: 0.2552
val Loss: 3.1437 LRAP: 0.1118 NDCG: 0.2603
Validation loss decreased (3.143957 --> 3.143747).  Saving model ...

Epoch 72/99
----------
train Loss: 3.2122 LRAP: 0.0877 NDCG: 0.2550
val Loss: 3.1397 LRAP: 0.1105 NDCG: 0.2605
Validation loss decreased (3.143747 --> 3.139736).  Saving model ...

Epoch 73/99
----------
train Loss: 3.1970 LRAP: 0.0844 NDCG: 0.2551
val Loss: 3.1401 LRAP: 0.1105 NDCG: 0.2607
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 3.2046 LRAP: 0.0852 NDCG: 0.2522
val Loss: 3.1394 LRAP: 0.1105 NDCG: 0.2611
Validation loss decreased (3.139736 --> 3.139356).  Saving model ...

Epoch 75/99
----------
train Loss: 3.1955 LRAP: 0.0841 NDCG: 0.2548
val Loss: 3.1379 LRAP: 0.1093 NDCG: 0.2613
Validation loss decreased (3.139356 --> 3.137865).  Saving model ...

Epoch 76/99
----------
train Loss: 3.2077 LRAP: 0.0879 NDCG: 0.2551
val Loss: 3.1416 LRAP: 0.1118 NDCG: 0.2610
EarlyStopping counter: 1 out of 50

Epoch 77/99
----------
train Loss: 3.2016 LRAP: 0.0822 NDCG: 0.2549
val Loss: 3.1426 LRAP: 0.1118 NDCG: 0.2614
EarlyStopping counter: 2 out of 50

Epoch 78/99
----------
train Loss: 3.1857 LRAP: 0.0833 NDCG: 0.2567
val Loss: 3.1396 LRAP: 0.1118 NDCG: 0.2608
EarlyStopping counter: 3 out of 50

Epoch 79/99
----------
train Loss: 3.1884 LRAP: 0.0879 NDCG: 0.2551
val Loss: 3.1353 LRAP: 0.1029 NDCG: 0.2620
Validation loss decreased (3.137865 --> 3.135273).  Saving model ...

Epoch 80/99
----------
train Loss: 3.1981 LRAP: 0.0868 NDCG: 0.2551
val Loss: 3.1369 LRAP: 0.1093 NDCG: 0.2608
EarlyStopping counter: 1 out of 50

Epoch 81/99
----------
train Loss: 3.1767 LRAP: 0.0814 NDCG: 0.2571
val Loss: 3.1370 LRAP: 0.1118 NDCG: 0.2613
EarlyStopping counter: 2 out of 50

Epoch 82/99
----------
train Loss: 3.1778 LRAP: 0.0866 NDCG: 0.2552
val Loss: 3.1429 LRAP: 0.1017 NDCG: 0.2613
EarlyStopping counter: 3 out of 50

Epoch 83/99
----------
train Loss: 3.1861 LRAP: 0.0841 NDCG: 0.2562
val Loss: 3.1345 LRAP: 0.1105 NDCG: 0.2612
Validation loss decreased (3.135273 --> 3.134503).  Saving model ...

Epoch 84/99
----------
train Loss: 3.1879 LRAP: 0.0847 NDCG: 0.2552
val Loss: 3.1352 LRAP: 0.1131 NDCG: 0.2623
EarlyStopping counter: 1 out of 50

Epoch 85/99
----------
train Loss: 3.1689 LRAP: 0.0852 NDCG: 0.2571
val Loss: 3.1389 LRAP: 0.1118 NDCG: 0.2613
EarlyStopping counter: 2 out of 50

Epoch 86/99
----------
train Loss: 3.2031 LRAP: 0.0836 NDCG: 0.2549
val Loss: 3.1362 LRAP: 0.1131 NDCG: 0.2629
EarlyStopping counter: 3 out of 50

Epoch 87/99
----------
train Loss: 3.1977 LRAP: 0.0858 NDCG: 0.2557
val Loss: 3.1369 LRAP: 0.1080 NDCG: 0.2620
EarlyStopping counter: 4 out of 50

Epoch 88/99
----------
train Loss: 3.1919 LRAP: 0.0860 NDCG: 0.2557
val Loss: 3.1344 LRAP: 0.1118 NDCG: 0.2611
Validation loss decreased (3.134503 --> 3.134449).  Saving model ...

Epoch 89/99
----------
train Loss: 3.1893 LRAP: 0.0847 NDCG: 0.2548
val Loss: 3.1318 LRAP: 0.1042 NDCG: 0.2609
Validation loss decreased (3.134449 --> 3.131816).  Saving model ...

Epoch 90/99
----------
train Loss: 3.1863 LRAP: 0.0898 NDCG: 0.2548
val Loss: 3.1345 LRAP: 0.1118 NDCG: 0.2623
EarlyStopping counter: 1 out of 50

Epoch 91/99
----------
train Loss: 3.1971 LRAP: 0.0893 NDCG: 0.2556
val Loss: 3.1321 LRAP: 0.1017 NDCG: 0.2616
EarlyStopping counter: 2 out of 50

Epoch 92/99
----------
train Loss: 3.1908 LRAP: 0.0852 NDCG: 0.2561
val Loss: 3.1350 LRAP: 0.1131 NDCG: 0.2617
EarlyStopping counter: 3 out of 50

Epoch 93/99
----------
train Loss: 3.1882 LRAP: 0.0907 NDCG: 0.2562
val Loss: 3.1333 LRAP: 0.1131 NDCG: 0.2630
EarlyStopping counter: 4 out of 50

Epoch 94/99
----------
train Loss: 3.1835 LRAP: 0.0868 NDCG: 0.2555
val Loss: 3.1330 LRAP: 0.1118 NDCG: 0.2615
EarlyStopping counter: 5 out of 50

Epoch 95/99
----------
train Loss: 3.1847 LRAP: 0.0874 NDCG: 0.2567
val Loss: 3.1322 LRAP: 0.1105 NDCG: 0.2617
EarlyStopping counter: 6 out of 50

Epoch 96/99
----------
train Loss: 3.1709 LRAP: 0.0893 NDCG: 0.2575
val Loss: 3.1352 LRAP: 0.1182 NDCG: 0.2618
EarlyStopping counter: 7 out of 50

Epoch 97/99
----------
train Loss: 3.1818 LRAP: 0.0787 NDCG: 0.2560
val Loss: 3.1334 LRAP: 0.1042 NDCG: 0.2625
EarlyStopping counter: 8 out of 50

Epoch 98/99
----------
train Loss: 3.1950 LRAP: 0.0893 NDCG: 0.2562
val Loss: 3.1326 LRAP: 0.1118 NDCG: 0.2624
EarlyStopping counter: 9 out of 50

Epoch 99/99
----------
train Loss: 3.1899 LRAP: 0.0819 NDCG: 0.2564
val Loss: 3.1366 LRAP: 0.1118 NDCG: 0.2622
EarlyStopping counter: 10 out of 50

Training complete in 2m 31s
Best val loss: 3.131816, best LRAP score: 0.6026

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 3/10

All random seeds set to: 44
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.4646 LRAP: 0.0000 NDCG: 0.1660
val Loss: 4.6213 LRAP: 0.0000 NDCG: 0.1756
Validation loss decreased (0.000000 --> 4.621276).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9149 LRAP: 0.0008 NDCG: 0.1948
val Loss: 4.0740 LRAP: 0.0013 NDCG: 0.2042
Validation loss decreased (4.621276 --> 4.074020).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7463 LRAP: 0.0057 NDCG: 0.2114
val Loss: 3.9569 LRAP: 0.0076 NDCG: 0.2119
Validation loss decreased (4.074020 --> 3.956892).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6733 LRAP: 0.0117 NDCG: 0.2134
val Loss: 3.8604 LRAP: 0.0064 NDCG: 0.2035
Validation loss decreased (3.956892 --> 3.860368).  Saving model ...

Epoch 4/99
----------
train Loss: 3.6205 LRAP: 0.0223 NDCG: 0.2180
val Loss: 3.8693 LRAP: 0.0191 NDCG: 0.2098
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.5562 LRAP: 0.0231 NDCG: 0.2229
val Loss: 3.6667 LRAP: 0.0127 NDCG: 0.2323
Validation loss decreased (3.860368 --> 3.666671).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4956 LRAP: 0.0324 NDCG: 0.2241
val Loss: 3.7448 LRAP: 0.0076 NDCG: 0.2239
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.4441 LRAP: 0.0319 NDCG: 0.2300
val Loss: 3.5290 LRAP: 0.0661 NDCG: 0.2251
Validation loss decreased (3.666671 --> 3.529042).  Saving model ...

Epoch 8/99
----------
train Loss: 3.3787 LRAP: 0.0523 NDCG: 0.2388
val Loss: 3.7570 LRAP: 0.0470 NDCG: 0.2051
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.3209 LRAP: 0.0414 NDCG: 0.2392
val Loss: 3.5096 LRAP: 0.0724 NDCG: 0.2331
Validation loss decreased (3.529042 --> 3.509650).  Saving model ...

Epoch 10/99
----------
train Loss: 3.2732 LRAP: 0.0498 NDCG: 0.2440
val Loss: 3.4569 LRAP: 0.1004 NDCG: 0.2382
Validation loss decreased (3.509650 --> 3.456889).  Saving model ...

Epoch 11/99
----------
train Loss: 3.2335 LRAP: 0.0594 NDCG: 0.2485
val Loss: 3.6774 LRAP: 0.0127 NDCG: 0.2420
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.1560 LRAP: 0.0672 NDCG: 0.2508
val Loss: 3.2060 LRAP: 0.0851 NDCG: 0.2684
Validation loss decreased (3.456889 --> 3.206015).  Saving model ...

Epoch 13/99
----------
train Loss: 3.1222 LRAP: 0.0591 NDCG: 0.2591
val Loss: 3.3524 LRAP: 0.0978 NDCG: 0.2615
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.0954 LRAP: 0.0672 NDCG: 0.2595
val Loss: 3.1447 LRAP: 0.1105 NDCG: 0.2603
Validation loss decreased (3.206015 --> 3.144743).  Saving model ...

Epoch 15/99
----------
train Loss: 3.0120 LRAP: 0.0705 NDCG: 0.2633
val Loss: 3.0426 LRAP: 0.1105 NDCG: 0.2673
Validation loss decreased (3.144743 --> 3.042621).  Saving model ...

Epoch 16/99
----------
train Loss: 2.9756 LRAP: 0.0643 NDCG: 0.2641
val Loss: 3.0612 LRAP: 0.0966 NDCG: 0.2602
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 2.9493 LRAP: 0.0923 NDCG: 0.2678
val Loss: 3.0871 LRAP: 0.0978 NDCG: 0.2560
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 2.9323 LRAP: 0.0751 NDCG: 0.2711
val Loss: 3.0244 LRAP: 0.0978 NDCG: 0.2613
Validation loss decreased (3.042621 --> 3.024447).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8753 LRAP: 0.0790 NDCG: 0.2741
val Loss: 3.2188 LRAP: 0.0915 NDCG: 0.2725
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 2.8531 LRAP: 0.0746 NDCG: 0.2772
val Loss: 3.1663 LRAP: 0.1144 NDCG: 0.2738
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 2.8262 LRAP: 0.0874 NDCG: 0.2787
val Loss: 2.9462 LRAP: 0.1055 NDCG: 0.2675
Validation loss decreased (3.024447 --> 2.946188).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7860 LRAP: 0.0819 NDCG: 0.2838
val Loss: 2.9123 LRAP: 0.0915 NDCG: 0.2729
Validation loss decreased (2.946188 --> 2.912321).  Saving model ...

Epoch 23/99
----------
train Loss: 2.7472 LRAP: 0.0811 NDCG: 0.2851
val Loss: 2.8419 LRAP: 0.1055 NDCG: 0.2822
Validation loss decreased (2.912321 --> 2.841907).  Saving model ...

Epoch 24/99
----------
train Loss: 2.7013 LRAP: 0.0888 NDCG: 0.2876
val Loss: 2.9714 LRAP: 0.1080 NDCG: 0.2854
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.6936 LRAP: 0.0806 NDCG: 0.2913
val Loss: 2.8356 LRAP: 0.1118 NDCG: 0.3040
Validation loss decreased (2.841907 --> 2.835572).  Saving model ...

Epoch 26/99
----------
train Loss: 2.6837 LRAP: 0.0830 NDCG: 0.2937
val Loss: 3.0042 LRAP: 0.1207 NDCG: 0.2980
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 2.6344 LRAP: 0.0773 NDCG: 0.2952
val Loss: 2.9468 LRAP: 0.0801 NDCG: 0.2946
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 2.6053 LRAP: 0.0765 NDCG: 0.2982
val Loss: 2.7940 LRAP: 0.0648 NDCG: 0.2982
Validation loss decreased (2.835572 --> 2.793972).  Saving model ...

Epoch 29/99
----------
train Loss: 2.5494 LRAP: 0.0762 NDCG: 0.3007
val Loss: 2.8324 LRAP: 0.1169 NDCG: 0.3039
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.5397 LRAP: 0.0890 NDCG: 0.3029
val Loss: 2.8082 LRAP: 0.1105 NDCG: 0.3234
EarlyStopping counter: 2 out of 50

Epoch 31/99
----------
train Loss: 2.5053 LRAP: 0.0828 NDCG: 0.3034
val Loss: 3.1275 LRAP: 0.0762 NDCG: 0.3209
EarlyStopping counter: 3 out of 50

Epoch 32/99
----------
train Loss: 2.4729 LRAP: 0.0890 NDCG: 0.3055
val Loss: 2.8639 LRAP: 0.1118 NDCG: 0.3005
EarlyStopping counter: 4 out of 50

Epoch 33/99
----------
train Loss: 2.4580 LRAP: 0.0781 NDCG: 0.3083
val Loss: 2.6487 LRAP: 0.1042 NDCG: 0.3251
Validation loss decreased (2.793972 --> 2.648688).  Saving model ...

Epoch 34/99
----------
train Loss: 2.4031 LRAP: 0.0809 NDCG: 0.3097
val Loss: 2.6762 LRAP: 0.1182 NDCG: 0.3182
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 2.3939 LRAP: 0.0901 NDCG: 0.3132
val Loss: 2.7530 LRAP: 0.1169 NDCG: 0.3319
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 2.3447 LRAP: 0.0833 NDCG: 0.3156
val Loss: 2.6637 LRAP: 0.1067 NDCG: 0.3257
EarlyStopping counter: 3 out of 50

Epoch 37/99
----------
train Loss: 2.3402 LRAP: 0.0901 NDCG: 0.3198
val Loss: 2.6772 LRAP: 0.1105 NDCG: 0.3208
EarlyStopping counter: 4 out of 50

Epoch 38/99
----------
train Loss: 2.2971 LRAP: 0.0849 NDCG: 0.3205
val Loss: 2.5397 LRAP: 0.1182 NDCG: 0.3365
Validation loss decreased (2.648688 --> 2.539714).  Saving model ...

Epoch 39/99
----------
train Loss: 2.2800 LRAP: 0.0931 NDCG: 0.3214
val Loss: 2.6824 LRAP: 0.1207 NDCG: 0.3297
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.2552 LRAP: 0.0956 NDCG: 0.3227
val Loss: 2.6234 LRAP: 0.1233 NDCG: 0.3191
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 2.2420 LRAP: 0.0975 NDCG: 0.3225
val Loss: 2.5666 LRAP: 0.0864 NDCG: 0.3321
EarlyStopping counter: 3 out of 50

Epoch 42/99
----------
train Loss: 2.2119 LRAP: 0.0961 NDCG: 0.3270
val Loss: 2.5141 LRAP: 0.1194 NDCG: 0.3368
Validation loss decreased (2.539714 --> 2.514108).  Saving model ...

Epoch 43/99
----------
train Loss: 2.1928 LRAP: 0.0977 NDCG: 0.3268
val Loss: 2.5234 LRAP: 0.1207 NDCG: 0.3398
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 2.1629 LRAP: 0.0945 NDCG: 0.3322
val Loss: 2.6341 LRAP: 0.1360 NDCG: 0.3554
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 2.1528 LRAP: 0.1024 NDCG: 0.3329
val Loss: 2.5139 LRAP: 0.1194 NDCG: 0.3374
Validation loss decreased (2.514108 --> 2.513874).  Saving model ...

Epoch 46/99
----------
train Loss: 2.1335 LRAP: 0.0969 NDCG: 0.3342
val Loss: 2.5471 LRAP: 0.1080 NDCG: 0.3306
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 2.1195 LRAP: 0.1016 NDCG: 0.3356
val Loss: 2.5268 LRAP: 0.1207 NDCG: 0.3578
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 2.0048 LRAP: 0.1010 NDCG: 0.3414
val Loss: 2.4004 LRAP: 0.1271 NDCG: 0.3635
Validation loss decreased (2.513874 --> 2.400399).  Saving model ...

Epoch 49/99
----------
train Loss: 1.9548 LRAP: 0.0977 NDCG: 0.3397
val Loss: 2.3780 LRAP: 0.1309 NDCG: 0.3617
Validation loss decreased (2.400399 --> 2.377981).  Saving model ...

Epoch 50/99
----------
train Loss: 1.9302 LRAP: 0.1029 NDCG: 0.3431
val Loss: 2.3786 LRAP: 0.1296 NDCG: 0.3581
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 1.9283 LRAP: 0.1043 NDCG: 0.3406
val Loss: 2.3795 LRAP: 0.1296 NDCG: 0.3596
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 1.9204 LRAP: 0.1016 NDCG: 0.3447
val Loss: 2.3815 LRAP: 0.1309 NDCG: 0.3626
EarlyStopping counter: 3 out of 50

Epoch 53/99
----------
train Loss: 1.8900 LRAP: 0.1010 NDCG: 0.3443
val Loss: 2.3772 LRAP: 0.1347 NDCG: 0.3651
Validation loss decreased (2.377981 --> 2.377172).  Saving model ...

Epoch 54/99
----------
train Loss: 1.8923 LRAP: 0.1013 NDCG: 0.3448
val Loss: 2.3704 LRAP: 0.1296 NDCG: 0.3689
Validation loss decreased (2.377172 --> 2.370351).  Saving model ...

Epoch 55/99
----------
train Loss: 1.8843 LRAP: 0.1045 NDCG: 0.3436
val Loss: 2.3698 LRAP: 0.1321 NDCG: 0.3657
Validation loss decreased (2.370351 --> 2.369803).  Saving model ...

Epoch 56/99
----------
train Loss: 1.8698 LRAP: 0.1075 NDCG: 0.3435
val Loss: 2.3710 LRAP: 0.1258 NDCG: 0.3645
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 1.8600 LRAP: 0.0996 NDCG: 0.3469
val Loss: 2.3755 LRAP: 0.1309 NDCG: 0.3633
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 1.8669 LRAP: 0.1035 NDCG: 0.3481
val Loss: 2.3736 LRAP: 0.1309 NDCG: 0.3726
EarlyStopping counter: 3 out of 50

Epoch 59/99
----------
train Loss: 1.8660 LRAP: 0.1045 NDCG: 0.3449
val Loss: 2.3699 LRAP: 0.1347 NDCG: 0.3636
EarlyStopping counter: 4 out of 50

Epoch 60/99
----------
train Loss: 1.8403 LRAP: 0.1051 NDCG: 0.3455
val Loss: 2.3719 LRAP: 0.1410 NDCG: 0.3718
EarlyStopping counter: 5 out of 50

Epoch 61/99
----------
train Loss: 1.7962 LRAP: 0.1135 NDCG: 0.3478
val Loss: 2.3597 LRAP: 0.1334 NDCG: 0.3684
Validation loss decreased (2.369803 --> 2.359665).  Saving model ...

Epoch 62/99
----------
train Loss: 1.8099 LRAP: 0.1065 NDCG: 0.3480
val Loss: 2.3589 LRAP: 0.1321 NDCG: 0.3688
Validation loss decreased (2.359665 --> 2.358947).  Saving model ...

Epoch 63/99
----------
train Loss: 1.7873 LRAP: 0.1084 NDCG: 0.3498
val Loss: 2.3560 LRAP: 0.1347 NDCG: 0.3715
Validation loss decreased (2.358947 --> 2.356015).  Saving model ...

Epoch 64/99
----------
train Loss: 1.8086 LRAP: 0.1040 NDCG: 0.3487
val Loss: 2.3574 LRAP: 0.1334 NDCG: 0.3711
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 1.7944 LRAP: 0.1070 NDCG: 0.3492
val Loss: 2.3622 LRAP: 0.1347 NDCG: 0.3713
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 1.8033 LRAP: 0.1062 NDCG: 0.3481
val Loss: 2.3623 LRAP: 0.1334 NDCG: 0.3711
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 1.7903 LRAP: 0.1089 NDCG: 0.3485
val Loss: 2.3607 LRAP: 0.1360 NDCG: 0.3709
EarlyStopping counter: 4 out of 50

Epoch 68/99
----------
train Loss: 1.7750 LRAP: 0.1067 NDCG: 0.3468
val Loss: 2.3622 LRAP: 0.1347 NDCG: 0.3710
EarlyStopping counter: 5 out of 50

Epoch 69/99
----------
train Loss: 1.7897 LRAP: 0.1054 NDCG: 0.3487
val Loss: 2.3606 LRAP: 0.1334 NDCG: 0.3717
EarlyStopping counter: 6 out of 50

Epoch 70/99
----------
train Loss: 1.7784 LRAP: 0.1122 NDCG: 0.3476
val Loss: 2.3599 LRAP: 0.1347 NDCG: 0.3734
EarlyStopping counter: 7 out of 50

Epoch 71/99
----------
train Loss: 1.7939 LRAP: 0.1084 NDCG: 0.3484
val Loss: 2.3644 LRAP: 0.1360 NDCG: 0.3712
EarlyStopping counter: 8 out of 50

Epoch 72/99
----------
train Loss: 1.7951 LRAP: 0.1097 NDCG: 0.3493
val Loss: 2.3587 LRAP: 0.1385 NDCG: 0.3704
EarlyStopping counter: 9 out of 50

Epoch 73/99
----------
train Loss: 1.7969 LRAP: 0.1078 NDCG: 0.3501
val Loss: 2.3585 LRAP: 0.1334 NDCG: 0.3699
EarlyStopping counter: 10 out of 50

Epoch 74/99
----------
train Loss: 1.7892 LRAP: 0.1075 NDCG: 0.3505
val Loss: 2.3594 LRAP: 0.1321 NDCG: 0.3718
EarlyStopping counter: 11 out of 50

Epoch 75/99
----------
train Loss: 1.7799 LRAP: 0.1075 NDCG: 0.3498
val Loss: 2.3617 LRAP: 0.1347 NDCG: 0.3728
EarlyStopping counter: 12 out of 50

Epoch 76/99
----------
train Loss: 1.7875 LRAP: 0.1100 NDCG: 0.3506
val Loss: 2.3600 LRAP: 0.1334 NDCG: 0.3722
EarlyStopping counter: 13 out of 50

Epoch 77/99
----------
train Loss: 1.7746 LRAP: 0.1054 NDCG: 0.3504
val Loss: 2.3587 LRAP: 0.1321 NDCG: 0.3712
EarlyStopping counter: 14 out of 50

Epoch 78/99
----------
train Loss: 1.7915 LRAP: 0.1051 NDCG: 0.3488
val Loss: 2.3594 LRAP: 0.1321 NDCG: 0.3720
EarlyStopping counter: 15 out of 50

Epoch 79/99
----------
train Loss: 1.7907 LRAP: 0.1084 NDCG: 0.3490
val Loss: 2.3560 LRAP: 0.1334 NDCG: 0.3717
EarlyStopping counter: 16 out of 50

Epoch 80/99
----------
train Loss: 1.7752 LRAP: 0.1078 NDCG: 0.3483
val Loss: 2.3599 LRAP: 0.1347 NDCG: 0.3721
EarlyStopping counter: 17 out of 50

Epoch 81/99
----------
train Loss: 1.7771 LRAP: 0.1081 NDCG: 0.3485
val Loss: 2.3621 LRAP: 0.1334 NDCG: 0.3722
EarlyStopping counter: 18 out of 50

Epoch 82/99
----------
train Loss: 1.7762 LRAP: 0.1089 NDCG: 0.3479
val Loss: 2.3635 LRAP: 0.1360 NDCG: 0.3717
EarlyStopping counter: 19 out of 50

Epoch 83/99
----------
train Loss: 1.7673 LRAP: 0.1097 NDCG: 0.3500
val Loss: 2.3581 LRAP: 0.1334 NDCG: 0.3716
EarlyStopping counter: 20 out of 50

Epoch 84/99
----------
train Loss: 1.7956 LRAP: 0.1056 NDCG: 0.3495
val Loss: 2.3591 LRAP: 0.1360 NDCG: 0.3732
EarlyStopping counter: 21 out of 50

Epoch 85/99
----------
train Loss: 1.7843 LRAP: 0.1089 NDCG: 0.3504
val Loss: 2.3599 LRAP: 0.1321 NDCG: 0.3709
EarlyStopping counter: 22 out of 50

Epoch 86/99
----------
train Loss: 1.7772 LRAP: 0.1094 NDCG: 0.3500
val Loss: 2.3617 LRAP: 0.1347 NDCG: 0.3736
EarlyStopping counter: 23 out of 50

Epoch 87/99
----------
train Loss: 1.7805 LRAP: 0.1127 NDCG: 0.3488
val Loss: 2.3588 LRAP: 0.1347 NDCG: 0.3719
EarlyStopping counter: 24 out of 50

Epoch 88/99
----------
train Loss: 1.7824 LRAP: 0.1105 NDCG: 0.3472
val Loss: 2.3616 LRAP: 0.1360 NDCG: 0.3718
EarlyStopping counter: 25 out of 50

Epoch 89/99
----------
train Loss: 1.7826 LRAP: 0.1094 NDCG: 0.3484
val Loss: 2.3609 LRAP: 0.1347 NDCG: 0.3722
EarlyStopping counter: 26 out of 50

Epoch 90/99
----------
train Loss: 1.7724 LRAP: 0.1135 NDCG: 0.3479
val Loss: 2.3572 LRAP: 0.1372 NDCG: 0.3714
EarlyStopping counter: 27 out of 50

Epoch 91/99
----------
train Loss: 1.7876 LRAP: 0.1078 NDCG: 0.3487
val Loss: 2.3573 LRAP: 0.1347 NDCG: 0.3719
EarlyStopping counter: 28 out of 50

Epoch 92/99
----------
train Loss: 1.7885 LRAP: 0.1021 NDCG: 0.3488
val Loss: 2.3597 LRAP: 0.1360 NDCG: 0.3734
EarlyStopping counter: 29 out of 50

Epoch 93/99
----------
train Loss: 1.7677 LRAP: 0.1111 NDCG: 0.3505
val Loss: 2.3601 LRAP: 0.1334 NDCG: 0.3717
EarlyStopping counter: 30 out of 50

Epoch 94/99
----------
train Loss: 1.7677 LRAP: 0.1092 NDCG: 0.3502
val Loss: 2.3605 LRAP: 0.1372 NDCG: 0.3732
EarlyStopping counter: 31 out of 50

Epoch 95/99
----------
train Loss: 1.7729 LRAP: 0.1067 NDCG: 0.3506
val Loss: 2.3609 LRAP: 0.1347 NDCG: 0.3722
EarlyStopping counter: 32 out of 50

Epoch 96/99
----------
train Loss: 1.7774 LRAP: 0.1078 NDCG: 0.3496
val Loss: 2.3614 LRAP: 0.1347 NDCG: 0.3713
EarlyStopping counter: 33 out of 50

Epoch 97/99
----------
train Loss: 1.7900 LRAP: 0.1094 NDCG: 0.3479
val Loss: 2.3614 LRAP: 0.1334 NDCG: 0.3715
EarlyStopping counter: 34 out of 50

Epoch 98/99
----------
train Loss: 1.7917 LRAP: 0.1078 NDCG: 0.3491
val Loss: 2.3575 LRAP: 0.1360 NDCG: 0.3713
EarlyStopping counter: 35 out of 50

Epoch 99/99
----------
train Loss: 1.7688 LRAP: 0.1070 NDCG: 0.3498
val Loss: 2.3623 LRAP: 0.1334 NDCG: 0.3709
EarlyStopping counter: 36 out of 50

Training complete in 2m 32s
Best val loss: 2.356015, best LRAP score: 0.7623

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4774 LRAP: 0.0000 NDCG: 0.1747
val Loss: 4.9654 LRAP: 0.0000 NDCG: 0.1721
Validation loss decreased (0.000000 --> 4.965390).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9261 LRAP: 0.0000 NDCG: 0.2037
val Loss: 3.9263 LRAP: 0.0000 NDCG: 0.2133
Validation loss decreased (4.965390 --> 3.926306).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7506 LRAP: 0.0035 NDCG: 0.2170
val Loss: 3.9373 LRAP: 0.0089 NDCG: 0.2339
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.6266 LRAP: 0.0057 NDCG: 0.2258
val Loss: 3.6130 LRAP: 0.0064 NDCG: 0.2155
Validation loss decreased (3.926306 --> 3.612984).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5455 LRAP: 0.0109 NDCG: 0.2279
val Loss: 3.9993 LRAP: 0.0064 NDCG: 0.2209
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.4864 LRAP: 0.0123 NDCG: 0.2295
val Loss: 3.4691 LRAP: 0.0152 NDCG: 0.2246
Validation loss decreased (3.612984 --> 3.469088).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4118 LRAP: 0.0152 NDCG: 0.2425
val Loss: 3.4245 LRAP: 0.0089 NDCG: 0.2368
Validation loss decreased (3.469088 --> 3.424479).  Saving model ...

Epoch 7/99
----------
train Loss: 3.3315 LRAP: 0.0272 NDCG: 0.2403
val Loss: 3.5555 LRAP: 0.0851 NDCG: 0.2513
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.2845 LRAP: 0.0392 NDCG: 0.2460
val Loss: 3.4205 LRAP: 0.0597 NDCG: 0.2374
Validation loss decreased (3.424479 --> 3.420521).  Saving model ...

Epoch 9/99
----------
train Loss: 3.2253 LRAP: 0.0512 NDCG: 0.2512
val Loss: 3.4430 LRAP: 0.0203 NDCG: 0.2363
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.1618 LRAP: 0.0400 NDCG: 0.2545
val Loss: 3.1877 LRAP: 0.0940 NDCG: 0.2607
Validation loss decreased (3.420521 --> 3.187710).  Saving model ...

Epoch 11/99
----------
train Loss: 3.0968 LRAP: 0.0457 NDCG: 0.2646
val Loss: 3.1019 LRAP: 0.0762 NDCG: 0.2683
Validation loss decreased (3.187710 --> 3.101936).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0656 LRAP: 0.0602 NDCG: 0.2683
val Loss: 3.3343 LRAP: 0.1105 NDCG: 0.2632
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0403 LRAP: 0.0591 NDCG: 0.2696
val Loss: 3.1532 LRAP: 0.0762 NDCG: 0.2516
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 2.9886 LRAP: 0.0713 NDCG: 0.2709
val Loss: 2.9898 LRAP: 0.0445 NDCG: 0.2760
Validation loss decreased (3.101936 --> 2.989791).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9216 LRAP: 0.0825 NDCG: 0.2775
val Loss: 3.0492 LRAP: 0.1029 NDCG: 0.2648
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.9043 LRAP: 0.0692 NDCG: 0.2797
val Loss: 2.9933 LRAP: 0.1105 NDCG: 0.2866
EarlyStopping counter: 2 out of 50

Epoch 17/99
----------
train Loss: 2.8639 LRAP: 0.0847 NDCG: 0.2817
val Loss: 3.1572 LRAP: 0.0762 NDCG: 0.2546
EarlyStopping counter: 3 out of 50

Epoch 18/99
----------
train Loss: 2.8529 LRAP: 0.0724 NDCG: 0.2833
val Loss: 3.0129 LRAP: 0.1055 NDCG: 0.2765
EarlyStopping counter: 4 out of 50

Epoch 19/99
----------
train Loss: 2.8103 LRAP: 0.0741 NDCG: 0.2894
val Loss: 2.8880 LRAP: 0.0928 NDCG: 0.3028
Validation loss decreased (2.989791 --> 2.888032).  Saving model ...

Epoch 20/99
----------
train Loss: 2.7708 LRAP: 0.0806 NDCG: 0.2901
val Loss: 2.8892 LRAP: 0.1156 NDCG: 0.2879
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.7373 LRAP: 0.0939 NDCG: 0.2957
val Loss: 2.8459 LRAP: 0.0813 NDCG: 0.3008
Validation loss decreased (2.888032 --> 2.845887).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7045 LRAP: 0.0855 NDCG: 0.2983
val Loss: 2.8614 LRAP: 0.1118 NDCG: 0.2832
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.6783 LRAP: 0.0994 NDCG: 0.2976
val Loss: 2.9300 LRAP: 0.0940 NDCG: 0.2830
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 2.6623 LRAP: 0.0920 NDCG: 0.2996
val Loss: 2.8745 LRAP: 0.1017 NDCG: 0.3015
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 2.6179 LRAP: 0.1013 NDCG: 0.3041
val Loss: 2.7798 LRAP: 0.1093 NDCG: 0.3126
Validation loss decreased (2.845887 --> 2.779825).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5872 LRAP: 0.0994 NDCG: 0.3055
val Loss: 2.7062 LRAP: 0.1156 NDCG: 0.3257
Validation loss decreased (2.779825 --> 2.706195).  Saving model ...

Epoch 27/99
----------
train Loss: 2.5581 LRAP: 0.0923 NDCG: 0.3084
val Loss: 2.7850 LRAP: 0.1283 NDCG: 0.3092
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 2.5197 LRAP: 0.0961 NDCG: 0.3108
val Loss: 2.6305 LRAP: 0.1080 NDCG: 0.3260
Validation loss decreased (2.706195 --> 2.630463).  Saving model ...

Epoch 29/99
----------
train Loss: 2.4608 LRAP: 0.0983 NDCG: 0.3156
val Loss: 2.6684 LRAP: 0.1207 NDCG: 0.3287
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.4418 LRAP: 0.0983 NDCG: 0.3169
val Loss: 2.5555 LRAP: 0.1207 NDCG: 0.3192
Validation loss decreased (2.630463 --> 2.555503).  Saving model ...

Epoch 31/99
----------
train Loss: 2.4252 LRAP: 0.1018 NDCG: 0.3202
val Loss: 2.5934 LRAP: 0.1156 NDCG: 0.3327
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.4116 LRAP: 0.1018 NDCG: 0.3188
val Loss: 2.5882 LRAP: 0.1207 NDCG: 0.3190
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 2.3869 LRAP: 0.1043 NDCG: 0.3198
val Loss: 2.7089 LRAP: 0.1156 NDCG: 0.3272
EarlyStopping counter: 3 out of 50

Epoch 34/99
----------
train Loss: 2.3575 LRAP: 0.0999 NDCG: 0.3242
val Loss: 2.6763 LRAP: 0.1207 NDCG: 0.3365
EarlyStopping counter: 4 out of 50

Epoch 35/99
----------
train Loss: 2.3330 LRAP: 0.1081 NDCG: 0.3258
val Loss: 2.4944 LRAP: 0.1347 NDCG: 0.3307
Validation loss decreased (2.555503 --> 2.494435).  Saving model ...

Epoch 36/99
----------
train Loss: 2.3104 LRAP: 0.0958 NDCG: 0.3283
val Loss: 2.7949 LRAP: 0.0978 NDCG: 0.3086
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 2.3008 LRAP: 0.1073 NDCG: 0.3280
val Loss: 2.5402 LRAP: 0.1385 NDCG: 0.3314
EarlyStopping counter: 2 out of 50

Epoch 38/99
----------
train Loss: 2.2395 LRAP: 0.1078 NDCG: 0.3329
val Loss: 2.5642 LRAP: 0.1334 NDCG: 0.3320
EarlyStopping counter: 3 out of 50

Epoch 39/99
----------
train Loss: 2.2236 LRAP: 0.1100 NDCG: 0.3327
val Loss: 2.4797 LRAP: 0.1321 NDCG: 0.3470
Validation loss decreased (2.494435 --> 2.479696).  Saving model ...

Epoch 40/99
----------
train Loss: 2.1878 LRAP: 0.1070 NDCG: 0.3342
val Loss: 2.5148 LRAP: 0.1321 NDCG: 0.3378
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 2.1767 LRAP: 0.1073 NDCG: 0.3369
val Loss: 2.5389 LRAP: 0.1550 NDCG: 0.3571
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 2.1429 LRAP: 0.1133 NDCG: 0.3395
val Loss: 2.4655 LRAP: 0.1309 NDCG: 0.3621
Validation loss decreased (2.479696 --> 2.465521).  Saving model ...

Epoch 43/99
----------
train Loss: 2.1222 LRAP: 0.1075 NDCG: 0.3403
val Loss: 2.5043 LRAP: 0.1283 NDCG: 0.3481
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 2.1011 LRAP: 0.1160 NDCG: 0.3432
val Loss: 2.4543 LRAP: 0.1309 NDCG: 0.3550
Validation loss decreased (2.465521 --> 2.454276).  Saving model ...

Epoch 45/99
----------
train Loss: 2.0728 LRAP: 0.1037 NDCG: 0.3421
val Loss: 2.4787 LRAP: 0.1423 NDCG: 0.3598
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 2.0594 LRAP: 0.1054 NDCG: 0.3443
val Loss: 2.4149 LRAP: 0.1436 NDCG: 0.3705
Validation loss decreased (2.454276 --> 2.414941).  Saving model ...

Epoch 47/99
----------
train Loss: 2.0149 LRAP: 0.1119 NDCG: 0.3483
val Loss: 2.4843 LRAP: 0.1398 NDCG: 0.3652
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 2.0116 LRAP: 0.1124 NDCG: 0.3508
val Loss: 2.5156 LRAP: 0.1436 NDCG: 0.3803
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 1.9929 LRAP: 0.1114 NDCG: 0.3515
val Loss: 2.5297 LRAP: 0.1233 NDCG: 0.3406
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 1.9810 LRAP: 0.1075 NDCG: 0.3537
val Loss: 2.5129 LRAP: 0.1576 NDCG: 0.3614
EarlyStopping counter: 4 out of 50

Epoch 51/99
----------
train Loss: 1.9535 LRAP: 0.1222 NDCG: 0.3555
val Loss: 2.4660 LRAP: 0.1410 NDCG: 0.3698
EarlyStopping counter: 5 out of 50

Epoch 52/99
----------
train Loss: 1.8683 LRAP: 0.1176 NDCG: 0.3553
val Loss: 2.3297 LRAP: 0.1550 NDCG: 0.3774
Validation loss decreased (2.414941 --> 2.329652).  Saving model ...

Epoch 53/99
----------
train Loss: 1.8366 LRAP: 0.1222 NDCG: 0.3590
val Loss: 2.3226 LRAP: 0.1563 NDCG: 0.3776
Validation loss decreased (2.329652 --> 2.322641).  Saving model ...

Epoch 54/99
----------
train Loss: 1.7758 LRAP: 0.1176 NDCG: 0.3611
val Loss: 2.3227 LRAP: 0.1576 NDCG: 0.3816
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.7767 LRAP: 0.1220 NDCG: 0.3606
val Loss: 2.3251 LRAP: 0.1614 NDCG: 0.3793
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 1.7562 LRAP: 0.1236 NDCG: 0.3603
val Loss: 2.3190 LRAP: 0.1626 NDCG: 0.3845
Validation loss decreased (2.322641 --> 2.319018).  Saving model ...

Epoch 57/99
----------
train Loss: 1.7511 LRAP: 0.1157 NDCG: 0.3609
val Loss: 2.3274 LRAP: 0.1614 NDCG: 0.3907
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 1.7487 LRAP: 0.1239 NDCG: 0.3626
val Loss: 2.3266 LRAP: 0.1563 NDCG: 0.3833
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 1.7374 LRAP: 0.1241 NDCG: 0.3650
val Loss: 2.3232 LRAP: 0.1626 NDCG: 0.3875
EarlyStopping counter: 3 out of 50

Epoch 60/99
----------
train Loss: 1.7217 LRAP: 0.1212 NDCG: 0.3647
val Loss: 2.3182 LRAP: 0.1626 NDCG: 0.3881
Validation loss decreased (2.319018 --> 2.318177).  Saving model ...

Epoch 61/99
----------
train Loss: 1.7190 LRAP: 0.1228 NDCG: 0.3645
val Loss: 2.3170 LRAP: 0.1639 NDCG: 0.3878
Validation loss decreased (2.318177 --> 2.317028).  Saving model ...

Epoch 62/99
----------
train Loss: 1.7147 LRAP: 0.1244 NDCG: 0.3657
val Loss: 2.3239 LRAP: 0.1715 NDCG: 0.3879
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 1.7042 LRAP: 0.1301 NDCG: 0.3639
val Loss: 2.3191 LRAP: 0.1626 NDCG: 0.3908
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 1.6830 LRAP: 0.1280 NDCG: 0.3677
val Loss: 2.3336 LRAP: 0.1690 NDCG: 0.3900
EarlyStopping counter: 3 out of 50

Epoch 65/99
----------
train Loss: 1.6821 LRAP: 0.1269 NDCG: 0.3658
val Loss: 2.3102 LRAP: 0.1703 NDCG: 0.3918
Validation loss decreased (2.317028 --> 2.310230).  Saving model ...

Epoch 66/99
----------
train Loss: 1.6661 LRAP: 0.1209 NDCG: 0.3678
val Loss: 2.3501 LRAP: 0.1690 NDCG: 0.3932
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 1.6825 LRAP: 0.1241 NDCG: 0.3673
val Loss: 2.3278 LRAP: 0.1677 NDCG: 0.3893
EarlyStopping counter: 2 out of 50

Epoch 68/99
----------
train Loss: 1.6783 LRAP: 0.1241 NDCG: 0.3648
val Loss: 2.3210 LRAP: 0.1652 NDCG: 0.3852
EarlyStopping counter: 3 out of 50

Epoch 69/99
----------
train Loss: 1.6547 LRAP: 0.1252 NDCG: 0.3669
val Loss: 2.3286 LRAP: 0.1677 NDCG: 0.4010
EarlyStopping counter: 4 out of 50

Epoch 70/99
----------
train Loss: 1.6668 LRAP: 0.1233 NDCG: 0.3671
val Loss: 2.3420 LRAP: 0.1677 NDCG: 0.3936
EarlyStopping counter: 5 out of 50

Epoch 71/99
----------
train Loss: 1.6456 LRAP: 0.1304 NDCG: 0.3693
val Loss: 2.3254 LRAP: 0.1690 NDCG: 0.3931
EarlyStopping counter: 6 out of 50

Epoch 72/99
----------
train Loss: 1.6178 LRAP: 0.1280 NDCG: 0.3693
val Loss: 2.3244 LRAP: 0.1690 NDCG: 0.3902
EarlyStopping counter: 7 out of 50

Epoch 73/99
----------
train Loss: 1.6513 LRAP: 0.1255 NDCG: 0.3698
val Loss: 2.3255 LRAP: 0.1703 NDCG: 0.3934
EarlyStopping counter: 8 out of 50

Epoch 74/99
----------
train Loss: 1.6197 LRAP: 0.1231 NDCG: 0.3690
val Loss: 2.3237 LRAP: 0.1690 NDCG: 0.3898
EarlyStopping counter: 9 out of 50

Epoch 75/99
----------
train Loss: 1.6237 LRAP: 0.1228 NDCG: 0.3707
val Loss: 2.3262 LRAP: 0.1703 NDCG: 0.3916
EarlyStopping counter: 10 out of 50

Epoch 76/99
----------
train Loss: 1.6050 LRAP: 0.1201 NDCG: 0.3703
val Loss: 2.3217 LRAP: 0.1703 NDCG: 0.3963
EarlyStopping counter: 11 out of 50

Epoch 77/99
----------
train Loss: 1.6261 LRAP: 0.1203 NDCG: 0.3700
val Loss: 2.3280 LRAP: 0.1677 NDCG: 0.3934
EarlyStopping counter: 12 out of 50

Epoch 78/99
----------
train Loss: 1.6272 LRAP: 0.1241 NDCG: 0.3683
val Loss: 2.3280 LRAP: 0.1690 NDCG: 0.3927
EarlyStopping counter: 13 out of 50

Epoch 79/99
----------
train Loss: 1.6133 LRAP: 0.1266 NDCG: 0.3700
val Loss: 2.3241 LRAP: 0.1665 NDCG: 0.3937
EarlyStopping counter: 14 out of 50

Epoch 80/99
----------
train Loss: 1.6102 LRAP: 0.1266 NDCG: 0.3702
val Loss: 2.3220 LRAP: 0.1677 NDCG: 0.3904
EarlyStopping counter: 15 out of 50

Epoch 81/99
----------
train Loss: 1.6211 LRAP: 0.1233 NDCG: 0.3701
val Loss: 2.3263 LRAP: 0.1677 NDCG: 0.3932
EarlyStopping counter: 16 out of 50

Epoch 82/99
----------
train Loss: 1.6002 LRAP: 0.1269 NDCG: 0.3700
val Loss: 2.3212 LRAP: 0.1690 NDCG: 0.3901
EarlyStopping counter: 17 out of 50

Epoch 83/99
----------
train Loss: 1.6240 LRAP: 0.1236 NDCG: 0.3710
val Loss: 2.3258 LRAP: 0.1728 NDCG: 0.3951
EarlyStopping counter: 18 out of 50

Epoch 84/99
----------
train Loss: 1.6025 LRAP: 0.1239 NDCG: 0.3714
val Loss: 2.3268 LRAP: 0.1665 NDCG: 0.3918
EarlyStopping counter: 19 out of 50

Epoch 85/99
----------
train Loss: 1.6018 LRAP: 0.1261 NDCG: 0.3719
val Loss: 2.3235 LRAP: 0.1703 NDCG: 0.3961
EarlyStopping counter: 20 out of 50

Epoch 86/99
----------
train Loss: 1.6013 LRAP: 0.1255 NDCG: 0.3697
val Loss: 2.3198 LRAP: 0.1665 NDCG: 0.3954
EarlyStopping counter: 21 out of 50

Epoch 87/99
----------
train Loss: 1.6105 LRAP: 0.1184 NDCG: 0.3707
val Loss: 2.3208 LRAP: 0.1715 NDCG: 0.3945
EarlyStopping counter: 22 out of 50

Epoch 88/99
----------
train Loss: 1.6108 LRAP: 0.1261 NDCG: 0.3715
val Loss: 2.3292 LRAP: 0.1690 NDCG: 0.3927
EarlyStopping counter: 23 out of 50

Epoch 89/99
----------
train Loss: 1.6045 LRAP: 0.1244 NDCG: 0.3706
val Loss: 2.3236 LRAP: 0.1728 NDCG: 0.3949
EarlyStopping counter: 24 out of 50

Epoch 90/99
----------
train Loss: 1.6067 LRAP: 0.1176 NDCG: 0.3694
val Loss: 2.3290 LRAP: 0.1677 NDCG: 0.3929
EarlyStopping counter: 25 out of 50

Epoch 91/99
----------
train Loss: 1.6123 LRAP: 0.1225 NDCG: 0.3706
val Loss: 2.3280 LRAP: 0.1715 NDCG: 0.3946
EarlyStopping counter: 26 out of 50

Epoch 92/99
----------
train Loss: 1.6049 LRAP: 0.1222 NDCG: 0.3713
val Loss: 2.3274 LRAP: 0.1677 NDCG: 0.3938
EarlyStopping counter: 27 out of 50

Epoch 93/99
----------
train Loss: 1.6051 LRAP: 0.1217 NDCG: 0.3707
val Loss: 2.3248 LRAP: 0.1703 NDCG: 0.3929
EarlyStopping counter: 28 out of 50

Epoch 94/99
----------
train Loss: 1.6184 LRAP: 0.1261 NDCG: 0.3711
val Loss: 2.3286 LRAP: 0.1703 NDCG: 0.3922
EarlyStopping counter: 29 out of 50

Epoch 95/99
----------
train Loss: 1.6183 LRAP: 0.1209 NDCG: 0.3689
val Loss: 2.3277 LRAP: 0.1715 NDCG: 0.3942
EarlyStopping counter: 30 out of 50

Epoch 96/99
----------
train Loss: 1.6157 LRAP: 0.1231 NDCG: 0.3679
val Loss: 2.3244 LRAP: 0.1677 NDCG: 0.3937
EarlyStopping counter: 31 out of 50

Epoch 97/99
----------
train Loss: 1.6143 LRAP: 0.1239 NDCG: 0.3689
val Loss: 2.3242 LRAP: 0.1715 NDCG: 0.3961
EarlyStopping counter: 32 out of 50

Epoch 98/99
----------
train Loss: 1.6158 LRAP: 0.1293 NDCG: 0.3700
val Loss: 2.3261 LRAP: 0.1690 NDCG: 0.3918
EarlyStopping counter: 33 out of 50

Epoch 99/99
----------
train Loss: 1.6091 LRAP: 0.1277 NDCG: 0.3706
val Loss: 2.3225 LRAP: 0.1728 NDCG: 0.3946
EarlyStopping counter: 34 out of 50

Training complete in 2m 30s
Best val loss: 2.310230, best LRAP score: 0.7621

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5405 LRAP: 0.0000 NDCG: 0.1686
val Loss: 5.2769 LRAP: 0.0000 NDCG: 0.1723
Validation loss decreased (0.000000 --> 5.276881).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0258 LRAP: 0.0000 NDCG: 0.1932
val Loss: 6.7056 LRAP: 0.0038 NDCG: 0.1490
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.8855 LRAP: 0.0025 NDCG: 0.2065
val Loss: 6.4351 LRAP: 0.0089 NDCG: 0.1572
EarlyStopping counter: 2 out of 50

Epoch 3/99
----------
train Loss: 3.7943 LRAP: 0.0054 NDCG: 0.2145
val Loss: 4.1884 LRAP: 0.0076 NDCG: 0.2148
Validation loss decreased (5.276881 --> 4.188433).  Saving model ...

Epoch 4/99
----------
train Loss: 3.7391 LRAP: 0.0060 NDCG: 0.2180
val Loss: 7.9294 LRAP: 0.0076 NDCG: 0.1976
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.6897 LRAP: 0.0052 NDCG: 0.2209
val Loss: 3.8567 LRAP: 0.0089 NDCG: 0.2177
Validation loss decreased (4.188433 --> 3.856680).  Saving model ...

Epoch 6/99
----------
train Loss: 3.6455 LRAP: 0.0063 NDCG: 0.2259
val Loss: 3.9352 LRAP: 0.0051 NDCG: 0.1991
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.6175 LRAP: 0.0065 NDCG: 0.2250
val Loss: 5.3012 LRAP: 0.0051 NDCG: 0.2194
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.5786 LRAP: 0.0068 NDCG: 0.2277
val Loss: 3.7970 LRAP: 0.0038 NDCG: 0.2211
Validation loss decreased (3.856680 --> 3.797028).  Saving model ...

Epoch 9/99
----------
train Loss: 3.5407 LRAP: 0.0106 NDCG: 0.2321
val Loss: 3.8438 LRAP: 0.0051 NDCG: 0.2404
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.5058 LRAP: 0.0095 NDCG: 0.2357
val Loss: 4.3377 LRAP: 0.0064 NDCG: 0.2298
EarlyStopping counter: 2 out of 50

Epoch 11/99
----------
train Loss: 3.4822 LRAP: 0.0150 NDCG: 0.2372
val Loss: 4.2474 LRAP: 0.0038 NDCG: 0.2011
EarlyStopping counter: 3 out of 50

Epoch 12/99
----------
train Loss: 3.4423 LRAP: 0.0123 NDCG: 0.2395
val Loss: 5.3023 LRAP: 0.0025 NDCG: 0.1959
EarlyStopping counter: 4 out of 50

Epoch 13/99
----------
train Loss: 3.3912 LRAP: 0.0193 NDCG: 0.2420
val Loss: 4.1189 LRAP: 0.0064 NDCG: 0.2236
EarlyStopping counter: 5 out of 50

Epoch 14/99
----------
train Loss: 3.3293 LRAP: 0.0215 NDCG: 0.2477
val Loss: 3.6290 LRAP: 0.0521 NDCG: 0.2252
Validation loss decreased (3.797028 --> 3.629031).  Saving model ...

Epoch 15/99
----------
train Loss: 3.2893 LRAP: 0.0261 NDCG: 0.2488
val Loss: 3.3467 LRAP: 0.0635 NDCG: 0.2429
Validation loss decreased (3.629031 --> 3.346734).  Saving model ...

Epoch 16/99
----------
train Loss: 3.2698 LRAP: 0.0308 NDCG: 0.2509
val Loss: 3.5284 LRAP: 0.0457 NDCG: 0.2226
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 3.2748 LRAP: 0.0275 NDCG: 0.2504
val Loss: 3.4359 LRAP: 0.0051 NDCG: 0.2443
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 3.2545 LRAP: 0.0302 NDCG: 0.2479
val Loss: 3.3315 LRAP: 0.0496 NDCG: 0.2351
Validation loss decreased (3.346734 --> 3.331499).  Saving model ...

Epoch 19/99
----------
train Loss: 3.2354 LRAP: 0.0280 NDCG: 0.2527
val Loss: 3.3353 LRAP: 0.0457 NDCG: 0.2536
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.2285 LRAP: 0.0400 NDCG: 0.2535
val Loss: 3.7562 LRAP: 0.0025 NDCG: 0.1942
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 3.2118 LRAP: 0.0313 NDCG: 0.2558
val Loss: 3.6068 LRAP: 0.0305 NDCG: 0.2184
EarlyStopping counter: 3 out of 50

Epoch 22/99
----------
train Loss: 3.2040 LRAP: 0.0376 NDCG: 0.2540
val Loss: 3.5744 LRAP: 0.0737 NDCG: 0.2302
EarlyStopping counter: 4 out of 50

Epoch 23/99
----------
train Loss: 3.1943 LRAP: 0.0406 NDCG: 0.2565
val Loss: 3.5426 LRAP: 0.0928 NDCG: 0.2419
EarlyStopping counter: 5 out of 50

Epoch 24/99
----------
train Loss: 3.1723 LRAP: 0.0357 NDCG: 0.2573
val Loss: 3.1843 LRAP: 0.0648 NDCG: 0.2539
Validation loss decreased (3.331499 --> 3.184306).  Saving model ...

Epoch 25/99
----------
train Loss: 3.1466 LRAP: 0.0332 NDCG: 0.2586
val Loss: 3.2334 LRAP: 0.0661 NDCG: 0.2512
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 3.1551 LRAP: 0.0389 NDCG: 0.2569
val Loss: 3.2034 LRAP: 0.0572 NDCG: 0.2574
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 3.1660 LRAP: 0.0348 NDCG: 0.2570
val Loss: 3.1702 LRAP: 0.0280 NDCG: 0.2558
Validation loss decreased (3.184306 --> 3.170246).  Saving model ...

Epoch 28/99
----------
train Loss: 3.1441 LRAP: 0.0414 NDCG: 0.2587
val Loss: 3.2924 LRAP: 0.0801 NDCG: 0.2477
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 3.1391 LRAP: 0.0362 NDCG: 0.2584
val Loss: 3.1794 LRAP: 0.0724 NDCG: 0.2601
EarlyStopping counter: 2 out of 50

Epoch 30/99
----------
train Loss: 3.1433 LRAP: 0.0389 NDCG: 0.2604
val Loss: 3.1593 LRAP: 0.0572 NDCG: 0.2548
Validation loss decreased (3.170246 --> 3.159310).  Saving model ...

Epoch 31/99
----------
train Loss: 3.1421 LRAP: 0.0449 NDCG: 0.2590
val Loss: 3.1739 LRAP: 0.0775 NDCG: 0.2585
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 3.1320 LRAP: 0.0357 NDCG: 0.2596
val Loss: 3.2483 LRAP: 0.0902 NDCG: 0.2530
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 3.1418 LRAP: 0.0384 NDCG: 0.2578
val Loss: 3.1582 LRAP: 0.0534 NDCG: 0.2565
Validation loss decreased (3.159310 --> 3.158159).  Saving model ...

Epoch 34/99
----------
train Loss: 3.1498 LRAP: 0.0417 NDCG: 0.2588
val Loss: 3.1502 LRAP: 0.0699 NDCG: 0.2573
Validation loss decreased (3.158159 --> 3.150229).  Saving model ...

Epoch 35/99
----------
train Loss: 3.1337 LRAP: 0.0466 NDCG: 0.2602
val Loss: 3.1957 LRAP: 0.0851 NDCG: 0.2521
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 3.1434 LRAP: 0.0417 NDCG: 0.2585
val Loss: 3.1866 LRAP: 0.0889 NDCG: 0.2611
EarlyStopping counter: 2 out of 50

Epoch 37/99
----------
train Loss: 3.1231 LRAP: 0.0436 NDCG: 0.2608
val Loss: 3.1576 LRAP: 0.0712 NDCG: 0.2566
EarlyStopping counter: 3 out of 50

Epoch 38/99
----------
train Loss: 3.1361 LRAP: 0.0444 NDCG: 0.2602
val Loss: 3.1777 LRAP: 0.0902 NDCG: 0.2613
EarlyStopping counter: 4 out of 50

Epoch 39/99
----------
train Loss: 3.1188 LRAP: 0.0479 NDCG: 0.2602
val Loss: 3.2010 LRAP: 0.0813 NDCG: 0.2513
EarlyStopping counter: 5 out of 50

Epoch 40/99
----------
train Loss: 3.0978 LRAP: 0.0493 NDCG: 0.2599
val Loss: 3.1394 LRAP: 0.0839 NDCG: 0.2593
Validation loss decreased (3.150229 --> 3.139397).  Saving model ...

Epoch 41/99
----------
train Loss: 3.1130 LRAP: 0.0463 NDCG: 0.2611
val Loss: 3.1393 LRAP: 0.0851 NDCG: 0.2601
Validation loss decreased (3.139397 --> 3.139274).  Saving model ...

Epoch 42/99
----------
train Loss: 3.1245 LRAP: 0.0498 NDCG: 0.2611
val Loss: 3.1399 LRAP: 0.0762 NDCG: 0.2594
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 3.1225 LRAP: 0.0447 NDCG: 0.2617
val Loss: 3.1355 LRAP: 0.0775 NDCG: 0.2602
Validation loss decreased (3.139274 --> 3.135483).  Saving model ...

Epoch 44/99
----------
train Loss: 3.1076 LRAP: 0.0504 NDCG: 0.2620
val Loss: 3.1380 LRAP: 0.0801 NDCG: 0.2595
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 3.0938 LRAP: 0.0452 NDCG: 0.2626
val Loss: 3.1372 LRAP: 0.0813 NDCG: 0.2594
EarlyStopping counter: 2 out of 50

Epoch 46/99
----------
train Loss: 3.1071 LRAP: 0.0403 NDCG: 0.2616
val Loss: 3.1334 LRAP: 0.0826 NDCG: 0.2598
Validation loss decreased (3.135483 --> 3.133442).  Saving model ...

Epoch 47/99
----------
train Loss: 3.1096 LRAP: 0.0444 NDCG: 0.2615
val Loss: 3.1352 LRAP: 0.0826 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.1100 LRAP: 0.0463 NDCG: 0.2591
val Loss: 3.1366 LRAP: 0.0864 NDCG: 0.2595
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.1064 LRAP: 0.0476 NDCG: 0.2627
val Loss: 3.1347 LRAP: 0.0801 NDCG: 0.2602
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 3.1119 LRAP: 0.0436 NDCG: 0.2608
val Loss: 3.1377 LRAP: 0.0877 NDCG: 0.2593
EarlyStopping counter: 4 out of 50

Epoch 51/99
----------
train Loss: 3.1067 LRAP: 0.0509 NDCG: 0.2600
val Loss: 3.1295 LRAP: 0.0813 NDCG: 0.2607
Validation loss decreased (3.133442 --> 3.129454).  Saving model ...

Epoch 52/99
----------
train Loss: 3.1087 LRAP: 0.0504 NDCG: 0.2639
val Loss: 3.1363 LRAP: 0.0851 NDCG: 0.2603
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 3.1087 LRAP: 0.0493 NDCG: 0.2615
val Loss: 3.1405 LRAP: 0.0864 NDCG: 0.2591
EarlyStopping counter: 2 out of 50

Epoch 54/99
----------
train Loss: 3.0993 LRAP: 0.0525 NDCG: 0.2610
val Loss: 3.1346 LRAP: 0.0877 NDCG: 0.2605
EarlyStopping counter: 3 out of 50

Epoch 55/99
----------
train Loss: 3.1139 LRAP: 0.0485 NDCG: 0.2609
val Loss: 3.1356 LRAP: 0.0889 NDCG: 0.2598
EarlyStopping counter: 4 out of 50

Epoch 56/99
----------
train Loss: 3.0971 LRAP: 0.0493 NDCG: 0.2627
val Loss: 3.1345 LRAP: 0.0813 NDCG: 0.2599
EarlyStopping counter: 5 out of 50

Epoch 57/99
----------
train Loss: 3.1110 LRAP: 0.0468 NDCG: 0.2621
val Loss: 3.1327 LRAP: 0.0851 NDCG: 0.2605
EarlyStopping counter: 6 out of 50

Epoch 58/99
----------
train Loss: 3.1014 LRAP: 0.0474 NDCG: 0.2621
val Loss: 3.1332 LRAP: 0.0889 NDCG: 0.2610
EarlyStopping counter: 7 out of 50

Epoch 59/99
----------
train Loss: 3.0978 LRAP: 0.0531 NDCG: 0.2635
val Loss: 3.1323 LRAP: 0.0889 NDCG: 0.2611
EarlyStopping counter: 8 out of 50

Epoch 60/99
----------
train Loss: 3.1071 LRAP: 0.0498 NDCG: 0.2630
val Loss: 3.1327 LRAP: 0.0877 NDCG: 0.2607
EarlyStopping counter: 9 out of 50

Epoch 61/99
----------
train Loss: 3.0996 LRAP: 0.0457 NDCG: 0.2638
val Loss: 3.1331 LRAP: 0.0877 NDCG: 0.2598
EarlyStopping counter: 10 out of 50

Epoch 62/99
----------
train Loss: 3.1033 LRAP: 0.0463 NDCG: 0.2622
val Loss: 3.1320 LRAP: 0.0889 NDCG: 0.2605
EarlyStopping counter: 11 out of 50

Epoch 63/99
----------
train Loss: 3.0844 LRAP: 0.0501 NDCG: 0.2621
val Loss: 3.1316 LRAP: 0.0889 NDCG: 0.2600
EarlyStopping counter: 12 out of 50

Epoch 64/99
----------
train Loss: 3.1002 LRAP: 0.0545 NDCG: 0.2620
val Loss: 3.1319 LRAP: 0.0889 NDCG: 0.2609
EarlyStopping counter: 13 out of 50

Epoch 65/99
----------
train Loss: 3.0977 LRAP: 0.0550 NDCG: 0.2614
val Loss: 3.1336 LRAP: 0.0889 NDCG: 0.2607
EarlyStopping counter: 14 out of 50

Epoch 66/99
----------
train Loss: 3.0980 LRAP: 0.0460 NDCG: 0.2619
val Loss: 3.1306 LRAP: 0.0851 NDCG: 0.2605
EarlyStopping counter: 15 out of 50

Epoch 67/99
----------
train Loss: 3.1011 LRAP: 0.0515 NDCG: 0.2649
val Loss: 3.1308 LRAP: 0.0889 NDCG: 0.2609
EarlyStopping counter: 16 out of 50

Epoch 68/99
----------
train Loss: 3.1006 LRAP: 0.0531 NDCG: 0.2639
val Loss: 3.1300 LRAP: 0.0839 NDCG: 0.2604
EarlyStopping counter: 17 out of 50

Epoch 69/99
----------
train Loss: 3.0998 LRAP: 0.0496 NDCG: 0.2624
val Loss: 3.1301 LRAP: 0.0877 NDCG: 0.2608
EarlyStopping counter: 18 out of 50

Epoch 70/99
----------
train Loss: 3.1008 LRAP: 0.0479 NDCG: 0.2619
val Loss: 3.1303 LRAP: 0.0826 NDCG: 0.2601
EarlyStopping counter: 19 out of 50

Epoch 71/99
----------
train Loss: 3.0974 LRAP: 0.0512 NDCG: 0.2621
val Loss: 3.1302 LRAP: 0.0864 NDCG: 0.2605
EarlyStopping counter: 20 out of 50

Epoch 72/99
----------
train Loss: 3.1069 LRAP: 0.0474 NDCG: 0.2636
val Loss: 3.1289 LRAP: 0.0839 NDCG: 0.2610
Validation loss decreased (3.129454 --> 3.128855).  Saving model ...

Epoch 73/99
----------
train Loss: 3.1008 LRAP: 0.0555 NDCG: 0.2612
val Loss: 3.1294 LRAP: 0.0864 NDCG: 0.2609
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 3.1040 LRAP: 0.0487 NDCG: 0.2629
val Loss: 3.1321 LRAP: 0.0889 NDCG: 0.2600
EarlyStopping counter: 2 out of 50

Epoch 75/99
----------
train Loss: 3.0961 LRAP: 0.0485 NDCG: 0.2618
val Loss: 3.1363 LRAP: 0.0902 NDCG: 0.2604
EarlyStopping counter: 3 out of 50

Epoch 76/99
----------
train Loss: 3.1082 LRAP: 0.0545 NDCG: 0.2624
val Loss: 3.1313 LRAP: 0.0889 NDCG: 0.2603
EarlyStopping counter: 4 out of 50

Epoch 77/99
----------
train Loss: 3.1007 LRAP: 0.0455 NDCG: 0.2623
val Loss: 3.1324 LRAP: 0.0889 NDCG: 0.2616
EarlyStopping counter: 5 out of 50

Epoch 78/99
----------
train Loss: 3.0857 LRAP: 0.0485 NDCG: 0.2644
val Loss: 3.1315 LRAP: 0.0877 NDCG: 0.2604
EarlyStopping counter: 6 out of 50

Epoch 79/99
----------
train Loss: 3.1017 LRAP: 0.0498 NDCG: 0.2645
val Loss: 3.1321 LRAP: 0.0877 NDCG: 0.2607
EarlyStopping counter: 7 out of 50

Epoch 80/99
----------
train Loss: 3.0933 LRAP: 0.0496 NDCG: 0.2620
val Loss: 3.1300 LRAP: 0.0877 NDCG: 0.2605
EarlyStopping counter: 8 out of 50

Epoch 81/99
----------
train Loss: 3.1096 LRAP: 0.0534 NDCG: 0.2612
val Loss: 3.1316 LRAP: 0.0889 NDCG: 0.2603
EarlyStopping counter: 9 out of 50

Epoch 82/99
----------
train Loss: 3.0978 LRAP: 0.0504 NDCG: 0.2612
val Loss: 3.1303 LRAP: 0.0889 NDCG: 0.2600
EarlyStopping counter: 10 out of 50

Epoch 83/99
----------
train Loss: 3.1015 LRAP: 0.0504 NDCG: 0.2630
val Loss: 3.1292 LRAP: 0.0877 NDCG: 0.2606
EarlyStopping counter: 11 out of 50

Epoch 84/99
----------
train Loss: 3.0938 LRAP: 0.0479 NDCG: 0.2620
val Loss: 3.1312 LRAP: 0.0889 NDCG: 0.2605
EarlyStopping counter: 12 out of 50

Epoch 85/99
----------
train Loss: 3.0963 LRAP: 0.0523 NDCG: 0.2631
val Loss: 3.1309 LRAP: 0.0877 NDCG: 0.2609
EarlyStopping counter: 13 out of 50

Epoch 86/99
----------
train Loss: 3.0942 LRAP: 0.0542 NDCG: 0.2633
val Loss: 3.1305 LRAP: 0.0864 NDCG: 0.2608
EarlyStopping counter: 14 out of 50

Epoch 87/99
----------
train Loss: 3.1106 LRAP: 0.0498 NDCG: 0.2626
val Loss: 3.1291 LRAP: 0.0813 NDCG: 0.2606
EarlyStopping counter: 15 out of 50

Epoch 88/99
----------
train Loss: 3.0992 LRAP: 0.0493 NDCG: 0.2629
val Loss: 3.1318 LRAP: 0.0851 NDCG: 0.2611
EarlyStopping counter: 16 out of 50

Epoch 89/99
----------
train Loss: 3.0999 LRAP: 0.0471 NDCG: 0.2637
val Loss: 3.1307 LRAP: 0.0877 NDCG: 0.2604
EarlyStopping counter: 17 out of 50

Epoch 90/99
----------
train Loss: 3.1134 LRAP: 0.0460 NDCG: 0.2626
val Loss: 3.1303 LRAP: 0.0889 NDCG: 0.2606
EarlyStopping counter: 18 out of 50

Epoch 91/99
----------
train Loss: 3.0860 LRAP: 0.0487 NDCG: 0.2631
val Loss: 3.1272 LRAP: 0.0839 NDCG: 0.2605
Validation loss decreased (3.128855 --> 3.127201).  Saving model ...

Epoch 92/99
----------
train Loss: 3.0910 LRAP: 0.0539 NDCG: 0.2627
val Loss: 3.1281 LRAP: 0.0851 NDCG: 0.2609
EarlyStopping counter: 1 out of 50

Epoch 93/99
----------
train Loss: 3.1107 LRAP: 0.0498 NDCG: 0.2640
val Loss: 3.1299 LRAP: 0.0877 NDCG: 0.2613
EarlyStopping counter: 2 out of 50

Epoch 94/99
----------
train Loss: 3.0941 LRAP: 0.0539 NDCG: 0.2636
val Loss: 3.1296 LRAP: 0.0839 NDCG: 0.2606
EarlyStopping counter: 3 out of 50

Epoch 95/99
----------
train Loss: 3.1074 LRAP: 0.0498 NDCG: 0.2624
val Loss: 3.1286 LRAP: 0.0851 NDCG: 0.2601
EarlyStopping counter: 4 out of 50

Epoch 96/99
----------
train Loss: 3.0946 LRAP: 0.0496 NDCG: 0.2622
val Loss: 3.1284 LRAP: 0.0826 NDCG: 0.2612
EarlyStopping counter: 5 out of 50

Epoch 97/99
----------
train Loss: 3.0995 LRAP: 0.0490 NDCG: 0.2631
val Loss: 3.1297 LRAP: 0.0864 NDCG: 0.2611
EarlyStopping counter: 6 out of 50

Epoch 98/99
----------
train Loss: 3.1065 LRAP: 0.0496 NDCG: 0.2623
val Loss: 3.1309 LRAP: 0.0889 NDCG: 0.2604
EarlyStopping counter: 7 out of 50

Epoch 99/99
----------
train Loss: 3.0954 LRAP: 0.0525 NDCG: 0.2629
val Loss: 3.1310 LRAP: 0.0877 NDCG: 0.2603
EarlyStopping counter: 8 out of 50

Training complete in 2m 31s
Best val loss: 3.127201, best LRAP score: 0.5855

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6267 LRAP: 0.0000 NDCG: 0.1650
val Loss: 7.9079 LRAP: 0.0000 NDCG: 0.1246
Validation loss decreased (0.000000 --> 7.907902).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0712 LRAP: 0.0011 NDCG: 0.1916
val Loss: 9.0429 LRAP: 0.0076 NDCG: 0.2035
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.8935 LRAP: 0.0060 NDCG: 0.2139
val Loss: 4.8886 LRAP: 0.0089 NDCG: 0.1832
Validation loss decreased (7.907902 --> 4.888619).  Saving model ...

Epoch 3/99
----------
train Loss: 3.8270 LRAP: 0.0076 NDCG: 0.2155
val Loss: 4.7387 LRAP: 0.0013 NDCG: 0.1908
Validation loss decreased (4.888619 --> 4.738707).  Saving model ...

Epoch 4/99
----------
train Loss: 3.7844 LRAP: 0.0071 NDCG: 0.2136
val Loss: 4.4087 LRAP: 0.0013 NDCG: 0.1690
Validation loss decreased (4.738707 --> 4.408658).  Saving model ...

Epoch 5/99
----------
train Loss: 3.7598 LRAP: 0.0101 NDCG: 0.2154
val Loss: 4.1394 LRAP: 0.0089 NDCG: 0.2189
Validation loss decreased (4.408658 --> 4.139423).  Saving model ...

Epoch 6/99
----------
train Loss: 3.7140 LRAP: 0.0098 NDCG: 0.2190
val Loss: 4.0276 LRAP: 0.0076 NDCG: 0.2453
Validation loss decreased (4.139423 --> 4.027581).  Saving model ...

Epoch 7/99
----------
train Loss: 3.6929 LRAP: 0.0120 NDCG: 0.2223
val Loss: 4.8927 LRAP: 0.0076 NDCG: 0.2008
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.6523 LRAP: 0.0131 NDCG: 0.2234
val Loss: 3.8107 LRAP: 0.0089 NDCG: 0.2357
Validation loss decreased (4.027581 --> 3.810736).  Saving model ...

Epoch 9/99
----------
train Loss: 3.6457 LRAP: 0.0182 NDCG: 0.2254
val Loss: 5.3528 LRAP: 0.0076 NDCG: 0.1933
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.6151 LRAP: 0.0215 NDCG: 0.2251
val Loss: 5.4565 LRAP: 0.0064 NDCG: 0.1271
EarlyStopping counter: 2 out of 50

Epoch 11/99
----------
train Loss: 3.5824 LRAP: 0.0201 NDCG: 0.2287
val Loss: 4.1516 LRAP: 0.0000 NDCG: 0.1923
EarlyStopping counter: 3 out of 50

Epoch 12/99
----------
train Loss: 3.5601 LRAP: 0.0169 NDCG: 0.2278
val Loss: 5.2820 LRAP: 0.0102 NDCG: 0.1143
EarlyStopping counter: 4 out of 50

Epoch 13/99
----------
train Loss: 3.5551 LRAP: 0.0182 NDCG: 0.2296
val Loss: 6.8048 LRAP: 0.0000 NDCG: 0.1495
EarlyStopping counter: 5 out of 50

Epoch 14/99
----------
train Loss: 3.4878 LRAP: 0.0226 NDCG: 0.2317
val Loss: 3.5086 LRAP: 0.0076 NDCG: 0.2335
Validation loss decreased (3.810736 --> 3.508569).  Saving model ...

Epoch 15/99
----------
train Loss: 3.4733 LRAP: 0.0245 NDCG: 0.2327
val Loss: 3.8168 LRAP: 0.0762 NDCG: 0.2098
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 3.4512 LRAP: 0.0215 NDCG: 0.2343
val Loss: 3.5974 LRAP: 0.0076 NDCG: 0.2146
EarlyStopping counter: 2 out of 50

Epoch 17/99
----------
train Loss: 3.4471 LRAP: 0.0226 NDCG: 0.2335
val Loss: 3.6418 LRAP: 0.0076 NDCG: 0.2139
EarlyStopping counter: 3 out of 50

Epoch 18/99
----------
train Loss: 3.4407 LRAP: 0.0221 NDCG: 0.2362
val Loss: 3.5537 LRAP: 0.0140 NDCG: 0.2201
EarlyStopping counter: 4 out of 50

Epoch 19/99
----------
train Loss: 3.4411 LRAP: 0.0237 NDCG: 0.2346
val Loss: 3.4979 LRAP: 0.0191 NDCG: 0.2338
Validation loss decreased (3.508569 --> 3.497913).  Saving model ...

Epoch 20/99
----------
train Loss: 3.4270 LRAP: 0.0294 NDCG: 0.2355
val Loss: 3.6655 LRAP: 0.0368 NDCG: 0.2304
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.4136 LRAP: 0.0343 NDCG: 0.2369
val Loss: 3.5542 LRAP: 0.0191 NDCG: 0.2237
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 3.4159 LRAP: 0.0324 NDCG: 0.2360
val Loss: 3.5457 LRAP: 0.0140 NDCG: 0.2194
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 3.3981 LRAP: 0.0365 NDCG: 0.2372
val Loss: 3.8264 LRAP: 0.0089 NDCG: 0.2177
EarlyStopping counter: 4 out of 50

Epoch 24/99
----------
train Loss: 3.4078 LRAP: 0.0340 NDCG: 0.2345
val Loss: 3.9158 LRAP: 0.0076 NDCG: 0.1907
EarlyStopping counter: 5 out of 50

Epoch 25/99
----------
train Loss: 3.3925 LRAP: 0.0441 NDCG: 0.2381
val Loss: 3.4494 LRAP: 0.0648 NDCG: 0.2350
Validation loss decreased (3.497913 --> 3.449390).  Saving model ...

Epoch 26/99
----------
train Loss: 3.3771 LRAP: 0.0351 NDCG: 0.2374
val Loss: 3.4187 LRAP: 0.0470 NDCG: 0.2345
Validation loss decreased (3.449390 --> 3.418655).  Saving model ...

Epoch 27/99
----------
train Loss: 3.3800 LRAP: 0.0408 NDCG: 0.2378
val Loss: 3.4255 LRAP: 0.0432 NDCG: 0.2312
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 3.3855 LRAP: 0.0417 NDCG: 0.2375
val Loss: 3.4112 LRAP: 0.0305 NDCG: 0.2333
Validation loss decreased (3.418655 --> 3.411215).  Saving model ...

Epoch 29/99
----------
train Loss: 3.3801 LRAP: 0.0370 NDCG: 0.2379
val Loss: 3.4142 LRAP: 0.0470 NDCG: 0.2372
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 3.3802 LRAP: 0.0397 NDCG: 0.2388
val Loss: 3.4454 LRAP: 0.0546 NDCG: 0.2352
EarlyStopping counter: 2 out of 50

Epoch 31/99
----------
train Loss: 3.3815 LRAP: 0.0351 NDCG: 0.2398
val Loss: 3.4075 LRAP: 0.0457 NDCG: 0.2345
Validation loss decreased (3.411215 --> 3.407468).  Saving model ...

Epoch 32/99
----------
train Loss: 3.3787 LRAP: 0.0395 NDCG: 0.2376
val Loss: 3.4055 LRAP: 0.0343 NDCG: 0.2323
Validation loss decreased (3.407468 --> 3.405509).  Saving model ...

Epoch 33/99
----------
train Loss: 3.3658 LRAP: 0.0414 NDCG: 0.2380
val Loss: 3.4415 LRAP: 0.0635 NDCG: 0.2357
EarlyStopping counter: 1 out of 50

Epoch 34/99
----------
train Loss: 3.3654 LRAP: 0.0438 NDCG: 0.2399
val Loss: 3.4743 LRAP: 0.0775 NDCG: 0.2350
EarlyStopping counter: 2 out of 50

Epoch 35/99
----------
train Loss: 3.3745 LRAP: 0.0397 NDCG: 0.2390
val Loss: 3.4005 LRAP: 0.0432 NDCG: 0.2351
Validation loss decreased (3.405509 --> 3.400533).  Saving model ...

Epoch 36/99
----------
train Loss: 3.3697 LRAP: 0.0392 NDCG: 0.2388
val Loss: 3.3990 LRAP: 0.0483 NDCG: 0.2355
Validation loss decreased (3.400533 --> 3.398973).  Saving model ...

Epoch 37/99
----------
train Loss: 3.3651 LRAP: 0.0433 NDCG: 0.2383
val Loss: 3.4117 LRAP: 0.0457 NDCG: 0.2327
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 3.3633 LRAP: 0.0444 NDCG: 0.2392
val Loss: 3.3937 LRAP: 0.0457 NDCG: 0.2354
Validation loss decreased (3.398973 --> 3.393731).  Saving model ...

Epoch 39/99
----------
train Loss: 3.3499 LRAP: 0.0468 NDCG: 0.2410
val Loss: 3.3901 LRAP: 0.0534 NDCG: 0.2346
Validation loss decreased (3.393731 --> 3.390118).  Saving model ...

Epoch 40/99
----------
train Loss: 3.3568 LRAP: 0.0400 NDCG: 0.2394
val Loss: 3.3915 LRAP: 0.0457 NDCG: 0.2358
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 3.3519 LRAP: 0.0436 NDCG: 0.2400
val Loss: 3.3899 LRAP: 0.0457 NDCG: 0.2348
Validation loss decreased (3.390118 --> 3.389890).  Saving model ...

Epoch 42/99
----------
train Loss: 3.3588 LRAP: 0.0447 NDCG: 0.2394
val Loss: 3.3906 LRAP: 0.0521 NDCG: 0.2367
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 3.3440 LRAP: 0.0452 NDCG: 0.2397
val Loss: 3.3967 LRAP: 0.0635 NDCG: 0.2355
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 3.3485 LRAP: 0.0460 NDCG: 0.2394
val Loss: 3.3826 LRAP: 0.0483 NDCG: 0.2376
Validation loss decreased (3.389890 --> 3.382586).  Saving model ...

Epoch 45/99
----------
train Loss: 3.3537 LRAP: 0.0493 NDCG: 0.2394
val Loss: 3.4069 LRAP: 0.0686 NDCG: 0.2368
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 3.3454 LRAP: 0.0447 NDCG: 0.2394
val Loss: 3.4202 LRAP: 0.0648 NDCG: 0.2371
EarlyStopping counter: 2 out of 50

Epoch 47/99
----------
train Loss: 3.3559 LRAP: 0.0504 NDCG: 0.2385
val Loss: 3.3884 LRAP: 0.0534 NDCG: 0.2355
EarlyStopping counter: 3 out of 50

Epoch 48/99
----------
train Loss: 3.3607 LRAP: 0.0520 NDCG: 0.2395
val Loss: 3.3845 LRAP: 0.0559 NDCG: 0.2370
EarlyStopping counter: 4 out of 50

Epoch 49/99
----------
train Loss: 3.3490 LRAP: 0.0501 NDCG: 0.2416
val Loss: 3.4518 LRAP: 0.0788 NDCG: 0.2337
EarlyStopping counter: 5 out of 50

Epoch 50/99
----------
train Loss: 3.3415 LRAP: 0.0425 NDCG: 0.2410
val Loss: 3.3752 LRAP: 0.0534 NDCG: 0.2382
Validation loss decreased (3.382586 --> 3.375208).  Saving model ...

Epoch 51/99
----------
train Loss: 3.3332 LRAP: 0.0487 NDCG: 0.2409
val Loss: 3.3758 LRAP: 0.0534 NDCG: 0.2392
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 3.3297 LRAP: 0.0506 NDCG: 0.2407
val Loss: 3.3761 LRAP: 0.0546 NDCG: 0.2386
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 3.3427 LRAP: 0.0455 NDCG: 0.2417
val Loss: 3.3778 LRAP: 0.0635 NDCG: 0.2367
EarlyStopping counter: 3 out of 50

Epoch 54/99
----------
train Loss: 3.3428 LRAP: 0.0430 NDCG: 0.2405
val Loss: 3.3750 LRAP: 0.0648 NDCG: 0.2382
Validation loss decreased (3.375208 --> 3.374953).  Saving model ...

Epoch 55/99
----------
train Loss: 3.3293 LRAP: 0.0520 NDCG: 0.2398
val Loss: 3.3741 LRAP: 0.0623 NDCG: 0.2384
Validation loss decreased (3.374953 --> 3.374053).  Saving model ...

Epoch 56/99
----------
train Loss: 3.3382 LRAP: 0.0468 NDCG: 0.2411
val Loss: 3.3768 LRAP: 0.0534 NDCG: 0.2364
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 3.3364 LRAP: 0.0463 NDCG: 0.2413
val Loss: 3.3716 LRAP: 0.0610 NDCG: 0.2383
Validation loss decreased (3.374053 --> 3.371608).  Saving model ...

Epoch 58/99
----------
train Loss: 3.3350 LRAP: 0.0482 NDCG: 0.2417
val Loss: 3.3737 LRAP: 0.0610 NDCG: 0.2379
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 3.3255 LRAP: 0.0471 NDCG: 0.2413
val Loss: 3.3705 LRAP: 0.0534 NDCG: 0.2394
Validation loss decreased (3.371608 --> 3.370466).  Saving model ...

Epoch 60/99
----------
train Loss: 3.3437 LRAP: 0.0496 NDCG: 0.2408
val Loss: 3.3720 LRAP: 0.0610 NDCG: 0.2385
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 3.3401 LRAP: 0.0501 NDCG: 0.2389
val Loss: 3.3692 LRAP: 0.0572 NDCG: 0.2383
Validation loss decreased (3.370466 --> 3.369194).  Saving model ...

Epoch 62/99
----------
train Loss: 3.3365 LRAP: 0.0531 NDCG: 0.2412
val Loss: 3.3767 LRAP: 0.0546 NDCG: 0.2362
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 3.3354 LRAP: 0.0479 NDCG: 0.2411
val Loss: 3.3743 LRAP: 0.0610 NDCG: 0.2380
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 3.3393 LRAP: 0.0490 NDCG: 0.2400
val Loss: 3.3698 LRAP: 0.0559 NDCG: 0.2393
EarlyStopping counter: 3 out of 50

Epoch 65/99
----------
train Loss: 3.3245 LRAP: 0.0433 NDCG: 0.2413
val Loss: 3.3703 LRAP: 0.0572 NDCG: 0.2390
EarlyStopping counter: 4 out of 50

Epoch 66/99
----------
train Loss: 3.3277 LRAP: 0.0506 NDCG: 0.2419
val Loss: 3.3711 LRAP: 0.0546 NDCG: 0.2385
EarlyStopping counter: 5 out of 50

Epoch 67/99
----------
train Loss: 3.3309 LRAP: 0.0498 NDCG: 0.2410
val Loss: 3.3672 LRAP: 0.0559 NDCG: 0.2385
Validation loss decreased (3.369194 --> 3.367204).  Saving model ...

Epoch 68/99
----------
train Loss: 3.3370 LRAP: 0.0479 NDCG: 0.2394
val Loss: 3.3711 LRAP: 0.0623 NDCG: 0.2380
EarlyStopping counter: 1 out of 50

Epoch 69/99
----------
train Loss: 3.3383 LRAP: 0.0504 NDCG: 0.2405
val Loss: 3.3711 LRAP: 0.0635 NDCG: 0.2385
EarlyStopping counter: 2 out of 50

Epoch 70/99
----------
train Loss: 3.3217 LRAP: 0.0430 NDCG: 0.2414
val Loss: 3.3719 LRAP: 0.0572 NDCG: 0.2387
EarlyStopping counter: 3 out of 50

Epoch 71/99
----------
train Loss: 3.3448 LRAP: 0.0463 NDCG: 0.2393
val Loss: 3.3691 LRAP: 0.0559 NDCG: 0.2380
EarlyStopping counter: 4 out of 50

Epoch 72/99
----------
train Loss: 3.3236 LRAP: 0.0482 NDCG: 0.2420
val Loss: 3.3682 LRAP: 0.0483 NDCG: 0.2377
EarlyStopping counter: 5 out of 50

Epoch 73/99
----------
train Loss: 3.3463 LRAP: 0.0525 NDCG: 0.2409
val Loss: 3.3695 LRAP: 0.0623 NDCG: 0.2383
EarlyStopping counter: 6 out of 50

Epoch 74/99
----------
train Loss: 3.3331 LRAP: 0.0512 NDCG: 0.2414
val Loss: 3.3709 LRAP: 0.0686 NDCG: 0.2387
EarlyStopping counter: 7 out of 50

Epoch 75/99
----------
train Loss: 3.3278 LRAP: 0.0506 NDCG: 0.2405
val Loss: 3.3695 LRAP: 0.0661 NDCG: 0.2387
EarlyStopping counter: 8 out of 50

Epoch 76/99
----------
train Loss: 3.3342 LRAP: 0.0528 NDCG: 0.2407
val Loss: 3.3697 LRAP: 0.0661 NDCG: 0.2380
EarlyStopping counter: 9 out of 50

Epoch 77/99
----------
train Loss: 3.3345 LRAP: 0.0479 NDCG: 0.2412
val Loss: 3.3719 LRAP: 0.0661 NDCG: 0.2383
EarlyStopping counter: 10 out of 50

Epoch 78/99
----------
train Loss: 3.3407 LRAP: 0.0512 NDCG: 0.2409
val Loss: 3.3729 LRAP: 0.0559 NDCG: 0.2381
EarlyStopping counter: 11 out of 50

Epoch 79/99
----------
train Loss: 3.3205 LRAP: 0.0547 NDCG: 0.2413
val Loss: 3.3700 LRAP: 0.0623 NDCG: 0.2393
EarlyStopping counter: 12 out of 50

Epoch 80/99
----------
train Loss: 3.3366 LRAP: 0.0496 NDCG: 0.2410
val Loss: 3.3702 LRAP: 0.0610 NDCG: 0.2387
EarlyStopping counter: 13 out of 50

Epoch 81/99
----------
train Loss: 3.3246 LRAP: 0.0468 NDCG: 0.2405
val Loss: 3.3712 LRAP: 0.0673 NDCG: 0.2378
EarlyStopping counter: 14 out of 50

Epoch 82/99
----------
train Loss: 3.3321 LRAP: 0.0525 NDCG: 0.2408
val Loss: 3.3682 LRAP: 0.0559 NDCG: 0.2394
EarlyStopping counter: 15 out of 50

Epoch 83/99
----------
train Loss: 3.3394 LRAP: 0.0498 NDCG: 0.2406
val Loss: 3.3682 LRAP: 0.0572 NDCG: 0.2379
EarlyStopping counter: 16 out of 50

Epoch 84/99
----------
train Loss: 3.3433 LRAP: 0.0460 NDCG: 0.2423
val Loss: 3.3683 LRAP: 0.0572 NDCG: 0.2382
EarlyStopping counter: 17 out of 50

Epoch 85/99
----------
train Loss: 3.3359 LRAP: 0.0479 NDCG: 0.2394
val Loss: 3.3697 LRAP: 0.0635 NDCG: 0.2379
EarlyStopping counter: 18 out of 50

Epoch 86/99
----------
train Loss: 3.3364 LRAP: 0.0504 NDCG: 0.2426
val Loss: 3.3727 LRAP: 0.0699 NDCG: 0.2386
EarlyStopping counter: 19 out of 50

Epoch 87/99
----------
train Loss: 3.3346 LRAP: 0.0471 NDCG: 0.2399
val Loss: 3.3693 LRAP: 0.0635 NDCG: 0.2377
EarlyStopping counter: 20 out of 50

Epoch 88/99
----------
train Loss: 3.3299 LRAP: 0.0498 NDCG: 0.2409
val Loss: 3.3688 LRAP: 0.0623 NDCG: 0.2388
EarlyStopping counter: 21 out of 50

Epoch 89/99
----------
train Loss: 3.3466 LRAP: 0.0515 NDCG: 0.2413
val Loss: 3.3676 LRAP: 0.0572 NDCG: 0.2388
EarlyStopping counter: 22 out of 50

Epoch 90/99
----------
train Loss: 3.3274 LRAP: 0.0476 NDCG: 0.2405
val Loss: 3.3707 LRAP: 0.0623 NDCG: 0.2384
EarlyStopping counter: 23 out of 50

Epoch 91/99
----------
train Loss: 3.3214 LRAP: 0.0509 NDCG: 0.2391
val Loss: 3.3716 LRAP: 0.0673 NDCG: 0.2390
EarlyStopping counter: 24 out of 50

Epoch 92/99
----------
train Loss: 3.3280 LRAP: 0.0487 NDCG: 0.2388
val Loss: 3.3676 LRAP: 0.0521 NDCG: 0.2381
EarlyStopping counter: 25 out of 50

Epoch 93/99
----------
train Loss: 3.3382 LRAP: 0.0531 NDCG: 0.2398
val Loss: 3.3680 LRAP: 0.0559 NDCG: 0.2385
EarlyStopping counter: 26 out of 50

Epoch 94/99
----------
train Loss: 3.3367 LRAP: 0.0504 NDCG: 0.2412
val Loss: 3.3689 LRAP: 0.0534 NDCG: 0.2387
EarlyStopping counter: 27 out of 50

Epoch 95/99
----------
train Loss: 3.3414 LRAP: 0.0525 NDCG: 0.2414
val Loss: 3.3710 LRAP: 0.0546 NDCG: 0.2379
EarlyStopping counter: 28 out of 50

Epoch 96/99
----------
train Loss: 3.3344 LRAP: 0.0441 NDCG: 0.2417
val Loss: 3.3703 LRAP: 0.0635 NDCG: 0.2378
EarlyStopping counter: 29 out of 50

Epoch 97/99
----------
train Loss: 3.3349 LRAP: 0.0515 NDCG: 0.2402
val Loss: 3.3683 LRAP: 0.0673 NDCG: 0.2387
EarlyStopping counter: 30 out of 50

Epoch 98/99
----------
train Loss: 3.3256 LRAP: 0.0468 NDCG: 0.2395
val Loss: 3.3688 LRAP: 0.0597 NDCG: 0.2392
EarlyStopping counter: 31 out of 50

Epoch 99/99
----------
train Loss: 3.3384 LRAP: 0.0487 NDCG: 0.2415
val Loss: 3.3707 LRAP: 0.0648 NDCG: 0.2379
EarlyStopping counter: 32 out of 50

Training complete in 2m 31s
Best val loss: 3.367204, best LRAP score: 0.5398

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 4/10

All random seeds set to: 45
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5362 LRAP: 0.0000 NDCG: 0.1753
val Loss: 4.2190 LRAP: 0.0000 NDCG: 0.2041
Validation loss decreased (0.000000 --> 4.219013).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9832 LRAP: 0.0000 NDCG: 0.1976
val Loss: 3.9378 LRAP: 0.0038 NDCG: 0.2164
Validation loss decreased (4.219013 --> 3.937820).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7782 LRAP: 0.0022 NDCG: 0.2191
val Loss: 3.9356 LRAP: 0.0038 NDCG: 0.2329
Validation loss decreased (3.937820 --> 3.935606).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6597 LRAP: 0.0076 NDCG: 0.2229
val Loss: 3.7795 LRAP: 0.0025 NDCG: 0.2107
Validation loss decreased (3.935606 --> 3.779461).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5729 LRAP: 0.0095 NDCG: 0.2267
val Loss: 3.5666 LRAP: 0.0254 NDCG: 0.2340
Validation loss decreased (3.779461 --> 3.566642).  Saving model ...

Epoch 5/99
----------
train Loss: 3.4924 LRAP: 0.0144 NDCG: 0.2307
val Loss: 3.5672 LRAP: 0.0750 NDCG: 0.2341
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.4105 LRAP: 0.0237 NDCG: 0.2335
val Loss: 3.8226 LRAP: 0.0229 NDCG: 0.2146
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.3476 LRAP: 0.0365 NDCG: 0.2385
val Loss: 4.2159 LRAP: 0.1258 NDCG: 0.2435
EarlyStopping counter: 3 out of 50

Epoch 8/99
----------
train Loss: 3.2968 LRAP: 0.0509 NDCG: 0.2423
val Loss: 4.4496 LRAP: 0.0368 NDCG: 0.1851
EarlyStopping counter: 4 out of 50

Epoch 9/99
----------
train Loss: 3.2486 LRAP: 0.0493 NDCG: 0.2473
val Loss: 3.3666 LRAP: 0.0648 NDCG: 0.2310
Validation loss decreased (3.566642 --> 3.366639).  Saving model ...

Epoch 10/99
----------
train Loss: 3.1798 LRAP: 0.0438 NDCG: 0.2508
val Loss: 3.3050 LRAP: 0.0801 NDCG: 0.2484
Validation loss decreased (3.366639 --> 3.305031).  Saving model ...

Epoch 11/99
----------
train Loss: 3.1443 LRAP: 0.0667 NDCG: 0.2541
val Loss: 3.3208 LRAP: 0.1118 NDCG: 0.2421
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.0757 LRAP: 0.0542 NDCG: 0.2593
val Loss: 3.3235 LRAP: 0.1283 NDCG: 0.2530
EarlyStopping counter: 2 out of 50

Epoch 13/99
----------
train Loss: 3.0549 LRAP: 0.0504 NDCG: 0.2626
val Loss: 3.1099 LRAP: 0.1144 NDCG: 0.2665
Validation loss decreased (3.305031 --> 3.109939).  Saving model ...

Epoch 14/99
----------
train Loss: 3.0345 LRAP: 0.0664 NDCG: 0.2658
val Loss: 3.0921 LRAP: 0.1436 NDCG: 0.2627
Validation loss decreased (3.109939 --> 3.092063).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9714 LRAP: 0.0738 NDCG: 0.2705
val Loss: 3.1725 LRAP: 0.1220 NDCG: 0.2418
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.9499 LRAP: 0.0795 NDCG: 0.2728
val Loss: 3.0044 LRAP: 0.1245 NDCG: 0.2663
Validation loss decreased (3.092063 --> 3.004439).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9146 LRAP: 0.0757 NDCG: 0.2741
val Loss: 3.0688 LRAP: 0.1271 NDCG: 0.2724
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 2.8655 LRAP: 0.0847 NDCG: 0.2764
val Loss: 2.9618 LRAP: 0.0991 NDCG: 0.2624
Validation loss decreased (3.004439 --> 2.961779).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8204 LRAP: 0.0882 NDCG: 0.2758
val Loss: 3.2246 LRAP: 0.1004 NDCG: 0.2712
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 2.7788 LRAP: 0.0830 NDCG: 0.2807
val Loss: 2.9476 LRAP: 0.0762 NDCG: 0.2823
Validation loss decreased (2.961779 --> 2.947619).  Saving model ...

Epoch 21/99
----------
train Loss: 2.7646 LRAP: 0.0852 NDCG: 0.2855
val Loss: 3.0428 LRAP: 0.1283 NDCG: 0.2744
EarlyStopping counter: 1 out of 50

Epoch 22/99
----------
train Loss: 2.7297 LRAP: 0.0866 NDCG: 0.2859
val Loss: 2.9607 LRAP: 0.1144 NDCG: 0.3035
EarlyStopping counter: 2 out of 50

Epoch 23/99
----------
train Loss: 2.6651 LRAP: 0.0945 NDCG: 0.2889
val Loss: 2.8578 LRAP: 0.1321 NDCG: 0.2890
Validation loss decreased (2.947619 --> 2.857836).  Saving model ...

Epoch 24/99
----------
train Loss: 2.6641 LRAP: 0.0877 NDCG: 0.2906
val Loss: 2.8278 LRAP: 0.1118 NDCG: 0.2948
Validation loss decreased (2.857836 --> 2.827791).  Saving model ...

Epoch 25/99
----------
train Loss: 2.6212 LRAP: 0.0907 NDCG: 0.2949
val Loss: 2.7640 LRAP: 0.1042 NDCG: 0.3034
Validation loss decreased (2.827791 --> 2.764009).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5792 LRAP: 0.0904 NDCG: 0.2957
val Loss: 2.7430 LRAP: 0.0889 NDCG: 0.3060
Validation loss decreased (2.764009 --> 2.743005).  Saving model ...

Epoch 27/99
----------
train Loss: 2.5549 LRAP: 0.0964 NDCG: 0.2984
val Loss: 2.7687 LRAP: 0.1182 NDCG: 0.2970
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 2.5081 LRAP: 0.0999 NDCG: 0.3003
val Loss: 2.7496 LRAP: 0.0991 NDCG: 0.3087
EarlyStopping counter: 2 out of 50

Epoch 29/99
----------
train Loss: 2.4955 LRAP: 0.0920 NDCG: 0.3030
val Loss: 2.8743 LRAP: 0.1398 NDCG: 0.3001
EarlyStopping counter: 3 out of 50

Epoch 30/99
----------
train Loss: 2.4501 LRAP: 0.0942 NDCG: 0.3048
val Loss: 2.6817 LRAP: 0.1321 NDCG: 0.3031
Validation loss decreased (2.743005 --> 2.681702).  Saving model ...

Epoch 31/99
----------
train Loss: 2.4282 LRAP: 0.0961 NDCG: 0.3076
val Loss: 2.7066 LRAP: 0.1321 NDCG: 0.3306
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.3913 LRAP: 0.0967 NDCG: 0.3099
val Loss: 2.6874 LRAP: 0.1321 NDCG: 0.3055
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 2.3797 LRAP: 0.0986 NDCG: 0.3106
val Loss: 2.7739 LRAP: 0.1372 NDCG: 0.3147
EarlyStopping counter: 3 out of 50

Epoch 34/99
----------
train Loss: 2.3461 LRAP: 0.0986 NDCG: 0.3126
val Loss: 2.7632 LRAP: 0.0940 NDCG: 0.2941
EarlyStopping counter: 4 out of 50

Epoch 35/99
----------
train Loss: 2.3275 LRAP: 0.0945 NDCG: 0.3172
val Loss: 2.5833 LRAP: 0.1372 NDCG: 0.3215
Validation loss decreased (2.681702 --> 2.583329).  Saving model ...

Epoch 36/99
----------
train Loss: 2.2776 LRAP: 0.1097 NDCG: 0.3182
val Loss: 2.6988 LRAP: 0.1461 NDCG: 0.3405
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 2.2517 LRAP: 0.1075 NDCG: 0.3218
val Loss: 2.6990 LRAP: 0.1360 NDCG: 0.3229
EarlyStopping counter: 2 out of 50

Epoch 38/99
----------
train Loss: 2.2324 LRAP: 0.1045 NDCG: 0.3230
val Loss: 2.6703 LRAP: 0.1321 NDCG: 0.3291
EarlyStopping counter: 3 out of 50

Epoch 39/99
----------
train Loss: 2.2465 LRAP: 0.1062 NDCG: 0.3244
val Loss: 2.5381 LRAP: 0.1474 NDCG: 0.3292
Validation loss decreased (2.583329 --> 2.538084).  Saving model ...

Epoch 40/99
----------
train Loss: 2.2010 LRAP: 0.1002 NDCG: 0.3263
val Loss: 2.6903 LRAP: 0.1385 NDCG: 0.3198
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 2.1558 LRAP: 0.1013 NDCG: 0.3261
val Loss: 2.6452 LRAP: 0.1449 NDCG: 0.3247
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 2.1302 LRAP: 0.0969 NDCG: 0.3279
val Loss: 2.6464 LRAP: 0.1360 NDCG: 0.3559
EarlyStopping counter: 3 out of 50

Epoch 43/99
----------
train Loss: 2.1316 LRAP: 0.1018 NDCG: 0.3301
val Loss: 2.5723 LRAP: 0.1372 NDCG: 0.3356
EarlyStopping counter: 4 out of 50

Epoch 44/99
----------
train Loss: 2.0918 LRAP: 0.1078 NDCG: 0.3291
val Loss: 2.6007 LRAP: 0.1449 NDCG: 0.3627
EarlyStopping counter: 5 out of 50

Epoch 45/99
----------
train Loss: 2.0066 LRAP: 0.1062 NDCG: 0.3352
val Loss: 2.4529 LRAP: 0.1512 NDCG: 0.3465
Validation loss decreased (2.538084 --> 2.452898).  Saving model ...

Epoch 46/99
----------
train Loss: 1.9500 LRAP: 0.1086 NDCG: 0.3346
val Loss: 2.4505 LRAP: 0.1525 NDCG: 0.3527
Validation loss decreased (2.452898 --> 2.450451).  Saving model ...

Epoch 47/99
----------
train Loss: 1.9326 LRAP: 0.1111 NDCG: 0.3393
val Loss: 2.4484 LRAP: 0.1436 NDCG: 0.3490
Validation loss decreased (2.450451 --> 2.448390).  Saving model ...

Epoch 48/99
----------
train Loss: 1.9058 LRAP: 0.1130 NDCG: 0.3382
val Loss: 2.4475 LRAP: 0.1512 NDCG: 0.3524
Validation loss decreased (2.448390 --> 2.447485).  Saving model ...

Epoch 49/99
----------
train Loss: 1.9179 LRAP: 0.1143 NDCG: 0.3403
val Loss: 2.4319 LRAP: 0.1499 NDCG: 0.3528
Validation loss decreased (2.447485 --> 2.431855).  Saving model ...

Epoch 50/99
----------
train Loss: 1.9016 LRAP: 0.1092 NDCG: 0.3398
val Loss: 2.4324 LRAP: 0.1474 NDCG: 0.3519
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 1.8801 LRAP: 0.1092 NDCG: 0.3404
val Loss: 2.4342 LRAP: 0.1499 NDCG: 0.3542
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 1.8767 LRAP: 0.1103 NDCG: 0.3388
val Loss: 2.4386 LRAP: 0.1487 NDCG: 0.3577
EarlyStopping counter: 3 out of 50

Epoch 53/99
----------
train Loss: 1.8628 LRAP: 0.1081 NDCG: 0.3401
val Loss: 2.4266 LRAP: 0.1537 NDCG: 0.3571
Validation loss decreased (2.431855 --> 2.426597).  Saving model ...

Epoch 54/99
----------
train Loss: 1.8733 LRAP: 0.1073 NDCG: 0.3399
val Loss: 2.4118 LRAP: 0.1360 NDCG: 0.3534
Validation loss decreased (2.426597 --> 2.411776).  Saving model ...

Epoch 55/99
----------
train Loss: 1.8679 LRAP: 0.1116 NDCG: 0.3435
val Loss: 2.4177 LRAP: 0.1537 NDCG: 0.3631
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 1.8528 LRAP: 0.1078 NDCG: 0.3437
val Loss: 2.4137 LRAP: 0.1461 NDCG: 0.3620
EarlyStopping counter: 2 out of 50

Epoch 57/99
----------
train Loss: 1.8372 LRAP: 0.1154 NDCG: 0.3439
val Loss: 2.4259 LRAP: 0.1537 NDCG: 0.3660
EarlyStopping counter: 3 out of 50

Epoch 58/99
----------
train Loss: 1.8142 LRAP: 0.1168 NDCG: 0.3440
val Loss: 2.4208 LRAP: 0.1525 NDCG: 0.3568
EarlyStopping counter: 4 out of 50

Epoch 59/99
----------
train Loss: 1.8156 LRAP: 0.1135 NDCG: 0.3443
val Loss: 2.4131 LRAP: 0.1423 NDCG: 0.3582
EarlyStopping counter: 5 out of 50

Epoch 60/99
----------
train Loss: 1.8057 LRAP: 0.1103 NDCG: 0.3450
val Loss: 2.4182 LRAP: 0.1512 NDCG: 0.3647
EarlyStopping counter: 6 out of 50

Epoch 61/99
----------
train Loss: 1.7701 LRAP: 0.1149 NDCG: 0.3437
val Loss: 2.4205 LRAP: 0.1499 NDCG: 0.3641
EarlyStopping counter: 7 out of 50

Epoch 62/99
----------
train Loss: 1.7815 LRAP: 0.1124 NDCG: 0.3467
val Loss: 2.4123 LRAP: 0.1525 NDCG: 0.3640
EarlyStopping counter: 8 out of 50

Epoch 63/99
----------
train Loss: 1.7750 LRAP: 0.1130 NDCG: 0.3442
val Loss: 2.4098 LRAP: 0.1525 NDCG: 0.3646
Validation loss decreased (2.411776 --> 2.409845).  Saving model ...

Epoch 64/99
----------
train Loss: 1.7809 LRAP: 0.1111 NDCG: 0.3456
val Loss: 2.4098 LRAP: 0.1512 NDCG: 0.3660
Validation loss decreased (2.409845 --> 2.409823).  Saving model ...

Epoch 65/99
----------
train Loss: 1.7728 LRAP: 0.1108 NDCG: 0.3480
val Loss: 2.4131 LRAP: 0.1525 NDCG: 0.3665
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 1.7581 LRAP: 0.1168 NDCG: 0.3475
val Loss: 2.4063 LRAP: 0.1537 NDCG: 0.3640
Validation loss decreased (2.409823 --> 2.406301).  Saving model ...

Epoch 67/99
----------
train Loss: 1.7573 LRAP: 0.1146 NDCG: 0.3460
val Loss: 2.4118 LRAP: 0.1550 NDCG: 0.3644
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 1.7673 LRAP: 0.1097 NDCG: 0.3485
val Loss: 2.4060 LRAP: 0.1550 NDCG: 0.3654
Validation loss decreased (2.406301 --> 2.405986).  Saving model ...

Epoch 69/99
----------
train Loss: 1.7673 LRAP: 0.1141 NDCG: 0.3482
val Loss: 2.4171 LRAP: 0.1563 NDCG: 0.3663
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 1.7571 LRAP: 0.1157 NDCG: 0.3486
val Loss: 2.4069 LRAP: 0.1487 NDCG: 0.3656
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 1.7693 LRAP: 0.1103 NDCG: 0.3458
val Loss: 2.4055 LRAP: 0.1537 NDCG: 0.3686
Validation loss decreased (2.405986 --> 2.405481).  Saving model ...

Epoch 72/99
----------
train Loss: 1.7479 LRAP: 0.1122 NDCG: 0.3491
val Loss: 2.4092 LRAP: 0.1525 NDCG: 0.3651
EarlyStopping counter: 1 out of 50

Epoch 73/99
----------
train Loss: 1.7667 LRAP: 0.1146 NDCG: 0.3484
val Loss: 2.4058 LRAP: 0.1563 NDCG: 0.3689
EarlyStopping counter: 2 out of 50

Epoch 74/99
----------
train Loss: 1.7538 LRAP: 0.1143 NDCG: 0.3474
val Loss: 2.4106 LRAP: 0.1525 NDCG: 0.3668
EarlyStopping counter: 3 out of 50

Epoch 75/99
----------
train Loss: 1.7633 LRAP: 0.1163 NDCG: 0.3478
val Loss: 2.4091 LRAP: 0.1588 NDCG: 0.3675
EarlyStopping counter: 4 out of 50

Epoch 76/99
----------
train Loss: 1.7541 LRAP: 0.1176 NDCG: 0.3492
val Loss: 2.4090 LRAP: 0.1550 NDCG: 0.3667
EarlyStopping counter: 5 out of 50

Epoch 77/99
----------
train Loss: 1.7476 LRAP: 0.1108 NDCG: 0.3479
val Loss: 2.4125 LRAP: 0.1550 NDCG: 0.3680
EarlyStopping counter: 6 out of 50

Epoch 78/99
----------
train Loss: 1.7523 LRAP: 0.1187 NDCG: 0.3476
val Loss: 2.4086 LRAP: 0.1550 NDCG: 0.3663
EarlyStopping counter: 7 out of 50

Epoch 79/99
----------
train Loss: 1.7327 LRAP: 0.1152 NDCG: 0.3499
val Loss: 2.4134 LRAP: 0.1537 NDCG: 0.3659
EarlyStopping counter: 8 out of 50

Epoch 80/99
----------
train Loss: 1.7387 LRAP: 0.1143 NDCG: 0.3504
val Loss: 2.4093 LRAP: 0.1563 NDCG: 0.3659
EarlyStopping counter: 9 out of 50

Epoch 81/99
----------
train Loss: 1.7290 LRAP: 0.1152 NDCG: 0.3479
val Loss: 2.4099 LRAP: 0.1576 NDCG: 0.3663
EarlyStopping counter: 10 out of 50

Epoch 82/99
----------
train Loss: 1.7384 LRAP: 0.1192 NDCG: 0.3485
val Loss: 2.4108 LRAP: 0.1576 NDCG: 0.3658
EarlyStopping counter: 11 out of 50

Epoch 83/99
----------
train Loss: 1.7418 LRAP: 0.1160 NDCG: 0.3481
val Loss: 2.4118 LRAP: 0.1550 NDCG: 0.3676
EarlyStopping counter: 12 out of 50

Epoch 84/99
----------
train Loss: 1.7448 LRAP: 0.1190 NDCG: 0.3476
val Loss: 2.4065 LRAP: 0.1576 NDCG: 0.3656
EarlyStopping counter: 13 out of 50

Epoch 85/99
----------
train Loss: 1.7461 LRAP: 0.1135 NDCG: 0.3489
val Loss: 2.4099 LRAP: 0.1563 NDCG: 0.3675
EarlyStopping counter: 14 out of 50

Epoch 86/99
----------
train Loss: 1.7514 LRAP: 0.1094 NDCG: 0.3483
val Loss: 2.4131 LRAP: 0.1576 NDCG: 0.3677
EarlyStopping counter: 15 out of 50

Epoch 87/99
----------
train Loss: 1.7449 LRAP: 0.1130 NDCG: 0.3486
val Loss: 2.4094 LRAP: 0.1576 NDCG: 0.3659
EarlyStopping counter: 16 out of 50

Epoch 88/99
----------
train Loss: 1.7357 LRAP: 0.1160 NDCG: 0.3472
val Loss: 2.4104 LRAP: 0.1563 NDCG: 0.3692
EarlyStopping counter: 17 out of 50

Epoch 89/99
----------
train Loss: 1.7584 LRAP: 0.1111 NDCG: 0.3503
val Loss: 2.4137 LRAP: 0.1576 NDCG: 0.3700
EarlyStopping counter: 18 out of 50

Epoch 90/99
----------
train Loss: 1.7347 LRAP: 0.1122 NDCG: 0.3503
val Loss: 2.4111 LRAP: 0.1576 NDCG: 0.3672
EarlyStopping counter: 19 out of 50

Epoch 91/99
----------
train Loss: 1.7557 LRAP: 0.1163 NDCG: 0.3500
val Loss: 2.4085 LRAP: 0.1563 NDCG: 0.3671
EarlyStopping counter: 20 out of 50

Epoch 92/99
----------
train Loss: 1.7555 LRAP: 0.1114 NDCG: 0.3487
val Loss: 2.4092 LRAP: 0.1563 NDCG: 0.3655
EarlyStopping counter: 21 out of 50

Epoch 93/99
----------
train Loss: 1.7522 LRAP: 0.1168 NDCG: 0.3487
val Loss: 2.4098 LRAP: 0.1588 NDCG: 0.3683
EarlyStopping counter: 22 out of 50

Epoch 94/99
----------
train Loss: 1.7601 LRAP: 0.1103 NDCG: 0.3489
val Loss: 2.4079 LRAP: 0.1576 NDCG: 0.3653
EarlyStopping counter: 23 out of 50

Epoch 95/99
----------
train Loss: 1.7591 LRAP: 0.1192 NDCG: 0.3482
val Loss: 2.4096 LRAP: 0.1550 NDCG: 0.3680
EarlyStopping counter: 24 out of 50

Epoch 96/99
----------
train Loss: 1.7535 LRAP: 0.1127 NDCG: 0.3482
val Loss: 2.4102 LRAP: 0.1576 NDCG: 0.3681
EarlyStopping counter: 25 out of 50

Epoch 97/99
----------
train Loss: 1.7373 LRAP: 0.1135 NDCG: 0.3483
val Loss: 2.4099 LRAP: 0.1563 NDCG: 0.3654
EarlyStopping counter: 26 out of 50

Epoch 98/99
----------
train Loss: 1.7469 LRAP: 0.1127 NDCG: 0.3480
val Loss: 2.4093 LRAP: 0.1550 NDCG: 0.3661
EarlyStopping counter: 27 out of 50

Epoch 99/99
----------
train Loss: 1.7533 LRAP: 0.1133 NDCG: 0.3483
val Loss: 2.4091 LRAP: 0.1576 NDCG: 0.3666
EarlyStopping counter: 28 out of 50

Training complete in 2m 34s
Best val loss: 2.405481, best LRAP score: 0.7552

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4565 LRAP: 0.0000 NDCG: 0.1809
val Loss: 4.8114 LRAP: 0.0000 NDCG: 0.2067
Validation loss decreased (0.000000 --> 4.811395).  Saving model ...

Epoch 1/99
----------
train Loss: 3.8868 LRAP: 0.0000 NDCG: 0.2145
val Loss: 3.8834 LRAP: 0.0000 NDCG: 0.2320
Validation loss decreased (4.811395 --> 3.883354).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7418 LRAP: 0.0014 NDCG: 0.2315
val Loss: 3.5995 LRAP: 0.0000 NDCG: 0.2395
Validation loss decreased (3.883354 --> 3.599486).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6350 LRAP: 0.0011 NDCG: 0.2304
val Loss: 3.7861 LRAP: 0.0013 NDCG: 0.2208
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.5736 LRAP: 0.0033 NDCG: 0.2333
val Loss: 3.9873 LRAP: 0.0038 NDCG: 0.2225
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.4966 LRAP: 0.0065 NDCG: 0.2418
val Loss: 3.5877 LRAP: 0.0521 NDCG: 0.2485
Validation loss decreased (3.599486 --> 3.587725).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4240 LRAP: 0.0229 NDCG: 0.2467
val Loss: 3.3810 LRAP: 0.0673 NDCG: 0.2521
Validation loss decreased (3.587725 --> 3.380959).  Saving model ...

Epoch 7/99
----------
train Loss: 3.3617 LRAP: 0.0259 NDCG: 0.2505
val Loss: 3.5956 LRAP: 0.0623 NDCG: 0.2452
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.2884 LRAP: 0.0354 NDCG: 0.2596
val Loss: 3.5831 LRAP: 0.0407 NDCG: 0.2628
EarlyStopping counter: 2 out of 50

Epoch 9/99
----------
train Loss: 3.2548 LRAP: 0.0397 NDCG: 0.2601
val Loss: 3.3991 LRAP: 0.0788 NDCG: 0.2407
EarlyStopping counter: 3 out of 50

Epoch 10/99
----------
train Loss: 3.1624 LRAP: 0.0496 NDCG: 0.2694
val Loss: 3.2357 LRAP: 0.0966 NDCG: 0.2699
Validation loss decreased (3.380959 --> 3.235651).  Saving model ...

Epoch 11/99
----------
train Loss: 3.1622 LRAP: 0.0569 NDCG: 0.2703
val Loss: 3.2083 LRAP: 0.0877 NDCG: 0.2691
Validation loss decreased (3.235651 --> 3.208319).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0858 LRAP: 0.0485 NDCG: 0.2747
val Loss: 3.5627 LRAP: 0.0343 NDCG: 0.2784
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0569 LRAP: 0.0564 NDCG: 0.2786
val Loss: 3.1416 LRAP: 0.1118 NDCG: 0.2866
Validation loss decreased (3.208319 --> 3.141569).  Saving model ...

Epoch 14/99
----------
train Loss: 3.0162 LRAP: 0.0626 NDCG: 0.2813
val Loss: 3.1863 LRAP: 0.1245 NDCG: 0.2828
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 2.9769 LRAP: 0.0667 NDCG: 0.2854
val Loss: 3.2060 LRAP: 0.1105 NDCG: 0.2806
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 2.9457 LRAP: 0.0637 NDCG: 0.2862
val Loss: 3.0195 LRAP: 0.1271 NDCG: 0.2963
Validation loss decreased (3.141569 --> 3.019451).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9152 LRAP: 0.0768 NDCG: 0.2886
val Loss: 2.9623 LRAP: 0.0597 NDCG: 0.2914
Validation loss decreased (3.019451 --> 2.962281).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8663 LRAP: 0.0659 NDCG: 0.2922
val Loss: 3.0387 LRAP: 0.1118 NDCG: 0.2849
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.8401 LRAP: 0.0678 NDCG: 0.2952
val Loss: 3.1837 LRAP: 0.0851 NDCG: 0.2937
EarlyStopping counter: 2 out of 50

Epoch 20/99
----------
train Loss: 2.8232 LRAP: 0.0653 NDCG: 0.2946
val Loss: 2.9943 LRAP: 0.0610 NDCG: 0.2839
EarlyStopping counter: 3 out of 50

Epoch 21/99
----------
train Loss: 2.7637 LRAP: 0.0800 NDCG: 0.2982
val Loss: 2.8946 LRAP: 0.1220 NDCG: 0.3120
Validation loss decreased (2.962281 --> 2.894614).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7368 LRAP: 0.0839 NDCG: 0.3029
val Loss: 2.9252 LRAP: 0.1017 NDCG: 0.2970
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.7131 LRAP: 0.0792 NDCG: 0.3047
val Loss: 2.8730 LRAP: 0.1029 NDCG: 0.3033
Validation loss decreased (2.894614 --> 2.872991).  Saving model ...

Epoch 24/99
----------
train Loss: 2.6625 LRAP: 0.0795 NDCG: 0.3021
val Loss: 2.8669 LRAP: 0.1321 NDCG: 0.3077
Validation loss decreased (2.872991 --> 2.866905).  Saving model ...

Epoch 25/99
----------
train Loss: 2.6711 LRAP: 0.0871 NDCG: 0.3056
val Loss: 2.7908 LRAP: 0.1169 NDCG: 0.3141
Validation loss decreased (2.866905 --> 2.790817).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5892 LRAP: 0.0825 NDCG: 0.3084
val Loss: 2.8545 LRAP: 0.0712 NDCG: 0.2987
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 2.5627 LRAP: 0.0819 NDCG: 0.3122
val Loss: 2.7342 LRAP: 0.1245 NDCG: 0.3189
Validation loss decreased (2.790817 --> 2.734164).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5351 LRAP: 0.0760 NDCG: 0.3125
val Loss: 2.7730 LRAP: 0.1118 NDCG: 0.3211
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 2.4973 LRAP: 0.0926 NDCG: 0.3169
val Loss: 2.7179 LRAP: 0.1360 NDCG: 0.3213
Validation loss decreased (2.734164 --> 2.717904).  Saving model ...

Epoch 30/99
----------
train Loss: 2.4665 LRAP: 0.0945 NDCG: 0.3166
val Loss: 2.7726 LRAP: 0.1194 NDCG: 0.3252
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 2.4280 LRAP: 0.0901 NDCG: 0.3214
val Loss: 2.6928 LRAP: 0.1398 NDCG: 0.3282
Validation loss decreased (2.717904 --> 2.692817).  Saving model ...

Epoch 32/99
----------
train Loss: 2.3986 LRAP: 0.0915 NDCG: 0.3238
val Loss: 2.7057 LRAP: 0.1233 NDCG: 0.3445
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.3907 LRAP: 0.0915 NDCG: 0.3267
val Loss: 2.7308 LRAP: 0.1296 NDCG: 0.3411
EarlyStopping counter: 2 out of 50

Epoch 34/99
----------
train Loss: 2.3729 LRAP: 0.0937 NDCG: 0.3263
val Loss: 2.6859 LRAP: 0.1372 NDCG: 0.3384
Validation loss decreased (2.692817 --> 2.685882).  Saving model ...

Epoch 35/99
----------
train Loss: 2.3321 LRAP: 0.0912 NDCG: 0.3310
val Loss: 2.7078 LRAP: 0.1080 NDCG: 0.3361
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 2.3079 LRAP: 0.0918 NDCG: 0.3294
val Loss: 2.7711 LRAP: 0.1423 NDCG: 0.3289
EarlyStopping counter: 2 out of 50

Epoch 37/99
----------
train Loss: 2.3054 LRAP: 0.0863 NDCG: 0.3319
val Loss: 2.7761 LRAP: 0.1131 NDCG: 0.3217
EarlyStopping counter: 3 out of 50

Epoch 38/99
----------
train Loss: 2.2524 LRAP: 0.0961 NDCG: 0.3346
val Loss: 2.6608 LRAP: 0.1372 NDCG: 0.3460
Validation loss decreased (2.685882 --> 2.660830).  Saving model ...

Epoch 39/99
----------
train Loss: 2.2251 LRAP: 0.0967 NDCG: 0.3409
val Loss: 2.6880 LRAP: 0.1169 NDCG: 0.3277
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.2042 LRAP: 0.0969 NDCG: 0.3381
val Loss: 2.5552 LRAP: 0.1220 NDCG: 0.3414
Validation loss decreased (2.660830 --> 2.555238).  Saving model ...

Epoch 41/99
----------
train Loss: 2.1589 LRAP: 0.0972 NDCG: 0.3408
val Loss: 2.6838 LRAP: 0.1372 NDCG: 0.3530
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 2.1588 LRAP: 0.0980 NDCG: 0.3442
val Loss: 2.6001 LRAP: 0.1372 NDCG: 0.3487
EarlyStopping counter: 2 out of 50

Epoch 43/99
----------
train Loss: 2.1368 LRAP: 0.0893 NDCG: 0.3437
val Loss: 2.7032 LRAP: 0.1449 NDCG: 0.3640
EarlyStopping counter: 3 out of 50

Epoch 44/99
----------
train Loss: 2.1215 LRAP: 0.0961 NDCG: 0.3408
val Loss: 2.6059 LRAP: 0.1347 NDCG: 0.3698
EarlyStopping counter: 4 out of 50

Epoch 45/99
----------
train Loss: 2.0625 LRAP: 0.0931 NDCG: 0.3477
val Loss: 2.6551 LRAP: 0.1410 NDCG: 0.3606
EarlyStopping counter: 5 out of 50

Epoch 46/99
----------
train Loss: 1.9736 LRAP: 0.1024 NDCG: 0.3520
val Loss: 2.4665 LRAP: 0.1461 NDCG: 0.3692
Validation loss decreased (2.555238 --> 2.466498).  Saving model ...

Epoch 47/99
----------
train Loss: 1.9291 LRAP: 0.1010 NDCG: 0.3523
val Loss: 2.4559 LRAP: 0.1436 NDCG: 0.3719
Validation loss decreased (2.466498 --> 2.455912).  Saving model ...

Epoch 48/99
----------
train Loss: 1.9192 LRAP: 0.1075 NDCG: 0.3543
val Loss: 2.4544 LRAP: 0.1487 NDCG: 0.3720
Validation loss decreased (2.455912 --> 2.454425).  Saving model ...

Epoch 49/99
----------
train Loss: 1.8970 LRAP: 0.1005 NDCG: 0.3539
val Loss: 2.4619 LRAP: 0.1449 NDCG: 0.3682
EarlyStopping counter: 1 out of 50

Epoch 50/99
----------
train Loss: 1.9018 LRAP: 0.1029 NDCG: 0.3537
val Loss: 2.4670 LRAP: 0.1525 NDCG: 0.3762
EarlyStopping counter: 2 out of 50

Epoch 51/99
----------
train Loss: 1.8820 LRAP: 0.1062 NDCG: 0.3563
val Loss: 2.4595 LRAP: 0.1499 NDCG: 0.3709
EarlyStopping counter: 3 out of 50

Epoch 52/99
----------
train Loss: 1.8591 LRAP: 0.1051 NDCG: 0.3571
val Loss: 2.4587 LRAP: 0.1512 NDCG: 0.3795
EarlyStopping counter: 4 out of 50

Epoch 53/99
----------
train Loss: 1.8620 LRAP: 0.1048 NDCG: 0.3581
val Loss: 2.4710 LRAP: 0.1487 NDCG: 0.3755
EarlyStopping counter: 5 out of 50

Epoch 54/99
----------
train Loss: 1.8419 LRAP: 0.1035 NDCG: 0.3582
val Loss: 2.4612 LRAP: 0.1576 NDCG: 0.3778
EarlyStopping counter: 6 out of 50

Epoch 55/99
----------
train Loss: 1.8393 LRAP: 0.1026 NDCG: 0.3594
val Loss: 2.4583 LRAP: 0.1537 NDCG: 0.3748
EarlyStopping counter: 7 out of 50

Epoch 56/99
----------
train Loss: 1.8168 LRAP: 0.1045 NDCG: 0.3582
val Loss: 2.4544 LRAP: 0.1499 NDCG: 0.3760
EarlyStopping counter: 8 out of 50

Epoch 57/99
----------
train Loss: 1.8206 LRAP: 0.1048 NDCG: 0.3591
val Loss: 2.4595 LRAP: 0.1512 NDCG: 0.3783
EarlyStopping counter: 9 out of 50

Epoch 58/99
----------
train Loss: 1.8189 LRAP: 0.1048 NDCG: 0.3593
val Loss: 2.4551 LRAP: 0.1525 NDCG: 0.3780
EarlyStopping counter: 10 out of 50

Epoch 59/99
----------
train Loss: 1.8197 LRAP: 0.1059 NDCG: 0.3623
val Loss: 2.4567 LRAP: 0.1512 NDCG: 0.3780
EarlyStopping counter: 11 out of 50

Epoch 60/99
----------
train Loss: 1.8227 LRAP: 0.1035 NDCG: 0.3583
val Loss: 2.4546 LRAP: 0.1525 NDCG: 0.3782
EarlyStopping counter: 12 out of 50

Epoch 61/99
----------
train Loss: 1.8121 LRAP: 0.1051 NDCG: 0.3583
val Loss: 2.4642 LRAP: 0.1512 NDCG: 0.3786
EarlyStopping counter: 13 out of 50

Epoch 62/99
----------
train Loss: 1.8101 LRAP: 0.1067 NDCG: 0.3601
val Loss: 2.4578 LRAP: 0.1525 NDCG: 0.3780
EarlyStopping counter: 14 out of 50

Epoch 63/99
----------
train Loss: 1.8032 LRAP: 0.1065 NDCG: 0.3614
val Loss: 2.4602 LRAP: 0.1537 NDCG: 0.3780
EarlyStopping counter: 15 out of 50

Epoch 64/99
----------
train Loss: 1.8093 LRAP: 0.1054 NDCG: 0.3619
val Loss: 2.4576 LRAP: 0.1499 NDCG: 0.3776
EarlyStopping counter: 16 out of 50

Epoch 65/99
----------
train Loss: 1.8289 LRAP: 0.1051 NDCG: 0.3606
val Loss: 2.4575 LRAP: 0.1525 NDCG: 0.3767
EarlyStopping counter: 17 out of 50

Epoch 66/99
----------
train Loss: 1.8193 LRAP: 0.1084 NDCG: 0.3587
val Loss: 2.4575 LRAP: 0.1499 NDCG: 0.3754
EarlyStopping counter: 18 out of 50

Epoch 67/99
----------
train Loss: 1.8113 LRAP: 0.1067 NDCG: 0.3617
val Loss: 2.4602 LRAP: 0.1512 NDCG: 0.3774
EarlyStopping counter: 19 out of 50

Epoch 68/99
----------
train Loss: 1.8047 LRAP: 0.1045 NDCG: 0.3598
val Loss: 2.4644 LRAP: 0.1512 NDCG: 0.3784
EarlyStopping counter: 20 out of 50

Epoch 69/99
----------
train Loss: 1.8175 LRAP: 0.1065 NDCG: 0.3615
val Loss: 2.4573 LRAP: 0.1512 NDCG: 0.3780
EarlyStopping counter: 21 out of 50

Epoch 70/99
----------
train Loss: 1.8020 LRAP: 0.1092 NDCG: 0.3597
val Loss: 2.4619 LRAP: 0.1537 NDCG: 0.3777
EarlyStopping counter: 22 out of 50

Epoch 71/99
----------
train Loss: 1.8168 LRAP: 0.1105 NDCG: 0.3584
val Loss: 2.4606 LRAP: 0.1537 NDCG: 0.3770
EarlyStopping counter: 23 out of 50

Epoch 72/99
----------
train Loss: 1.8099 LRAP: 0.1035 NDCG: 0.3588
val Loss: 2.4612 LRAP: 0.1499 NDCG: 0.3773
EarlyStopping counter: 24 out of 50

Epoch 73/99
----------
train Loss: 1.7970 LRAP: 0.1097 NDCG: 0.3624
val Loss: 2.4597 LRAP: 0.1512 NDCG: 0.3779
EarlyStopping counter: 25 out of 50

Epoch 74/99
----------
train Loss: 1.8038 LRAP: 0.1067 NDCG: 0.3612
val Loss: 2.4581 LRAP: 0.1550 NDCG: 0.3767
EarlyStopping counter: 26 out of 50

Epoch 75/99
----------
train Loss: 1.7947 LRAP: 0.1054 NDCG: 0.3632
val Loss: 2.4616 LRAP: 0.1499 NDCG: 0.3782
EarlyStopping counter: 27 out of 50

Epoch 76/99
----------
train Loss: 1.8231 LRAP: 0.1103 NDCG: 0.3610
val Loss: 2.4617 LRAP: 0.1499 NDCG: 0.3795
EarlyStopping counter: 28 out of 50

Epoch 77/99
----------
train Loss: 1.8191 LRAP: 0.1073 NDCG: 0.3585
val Loss: 2.4607 LRAP: 0.1525 NDCG: 0.3771
EarlyStopping counter: 29 out of 50

Epoch 78/99
----------
train Loss: 1.8207 LRAP: 0.1032 NDCG: 0.3575
val Loss: 2.4619 LRAP: 0.1563 NDCG: 0.3777
EarlyStopping counter: 30 out of 50

Epoch 79/99
----------
train Loss: 1.8071 LRAP: 0.1078 NDCG: 0.3596
val Loss: 2.4556 LRAP: 0.1512 NDCG: 0.3771
EarlyStopping counter: 31 out of 50

Epoch 80/99
----------
train Loss: 1.8065 LRAP: 0.1043 NDCG: 0.3591
val Loss: 2.4544 LRAP: 0.1512 NDCG: 0.3774
Validation loss decreased (2.454425 --> 2.454407).  Saving model ...

Epoch 81/99
----------
train Loss: 1.8066 LRAP: 0.1067 NDCG: 0.3611
val Loss: 2.4627 LRAP: 0.1499 NDCG: 0.3773
EarlyStopping counter: 1 out of 50

Epoch 82/99
----------
train Loss: 1.8181 LRAP: 0.1094 NDCG: 0.3600
val Loss: 2.4607 LRAP: 0.1512 NDCG: 0.3789
EarlyStopping counter: 2 out of 50

Epoch 83/99
----------
train Loss: 1.8094 LRAP: 0.1054 NDCG: 0.3613
val Loss: 2.4621 LRAP: 0.1474 NDCG: 0.3758
EarlyStopping counter: 3 out of 50

Epoch 84/99
----------
train Loss: 1.8121 LRAP: 0.1065 NDCG: 0.3594
val Loss: 2.4608 LRAP: 0.1550 NDCG: 0.3786
EarlyStopping counter: 4 out of 50

Epoch 85/99
----------
train Loss: 1.8160 LRAP: 0.1089 NDCG: 0.3599
val Loss: 2.4594 LRAP: 0.1499 NDCG: 0.3785
EarlyStopping counter: 5 out of 50

Epoch 86/99
----------
train Loss: 1.8131 LRAP: 0.1075 NDCG: 0.3596
val Loss: 2.4598 LRAP: 0.1512 NDCG: 0.3786
EarlyStopping counter: 6 out of 50

Epoch 87/99
----------
train Loss: 1.8213 LRAP: 0.1032 NDCG: 0.3576
val Loss: 2.4599 LRAP: 0.1537 NDCG: 0.3778
EarlyStopping counter: 7 out of 50

Epoch 88/99
----------
train Loss: 1.8020 LRAP: 0.1084 NDCG: 0.3603
val Loss: 2.4584 LRAP: 0.1550 NDCG: 0.3778
EarlyStopping counter: 8 out of 50

Epoch 89/99
----------
train Loss: 1.8056 LRAP: 0.1075 NDCG: 0.3588
val Loss: 2.4539 LRAP: 0.1499 NDCG: 0.3773
Validation loss decreased (2.454407 --> 2.453938).  Saving model ...

Epoch 90/99
----------
train Loss: 1.8123 LRAP: 0.1062 NDCG: 0.3624
val Loss: 2.4615 LRAP: 0.1537 NDCG: 0.3781
EarlyStopping counter: 1 out of 50

Epoch 91/99
----------
train Loss: 1.8073 LRAP: 0.1070 NDCG: 0.3598
val Loss: 2.4554 LRAP: 0.1576 NDCG: 0.3790
EarlyStopping counter: 2 out of 50

Epoch 92/99
----------
train Loss: 1.8131 LRAP: 0.1045 NDCG: 0.3574
val Loss: 2.4567 LRAP: 0.1512 NDCG: 0.3772
EarlyStopping counter: 3 out of 50

Epoch 93/99
----------
train Loss: 1.8125 LRAP: 0.1048 NDCG: 0.3595
val Loss: 2.4615 LRAP: 0.1550 NDCG: 0.3776
EarlyStopping counter: 4 out of 50

Epoch 94/99
----------
train Loss: 1.8097 LRAP: 0.1086 NDCG: 0.3593
val Loss: 2.4558 LRAP: 0.1512 NDCG: 0.3775
EarlyStopping counter: 5 out of 50

Epoch 95/99
----------
train Loss: 1.8076 LRAP: 0.1021 NDCG: 0.3615
val Loss: 2.4590 LRAP: 0.1512 NDCG: 0.3791
EarlyStopping counter: 6 out of 50

Epoch 96/99
----------
train Loss: 1.8045 LRAP: 0.1035 NDCG: 0.3585
val Loss: 2.4550 LRAP: 0.1499 NDCG: 0.3775
EarlyStopping counter: 7 out of 50

Epoch 97/99
----------
train Loss: 1.8155 LRAP: 0.1114 NDCG: 0.3597
val Loss: 2.4596 LRAP: 0.1537 NDCG: 0.3785
EarlyStopping counter: 8 out of 50

Epoch 98/99
----------
train Loss: 1.8115 LRAP: 0.1070 NDCG: 0.3599
val Loss: 2.4537 LRAP: 0.1550 NDCG: 0.3784
Validation loss decreased (2.453938 --> 2.453701).  Saving model ...

Epoch 99/99
----------
train Loss: 1.8145 LRAP: 0.1035 NDCG: 0.3597
val Loss: 2.4558 LRAP: 0.1499 NDCG: 0.3777
EarlyStopping counter: 1 out of 50

Training complete in 2m 30s
Best val loss: 2.453701, best LRAP score: 0.7467

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.6158 LRAP: 0.0000 NDCG: 0.1669
val Loss: 8.2431 LRAP: 0.0000 NDCG: 0.1321
Validation loss decreased (0.000000 --> 8.243134).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0919 LRAP: 0.0003 NDCG: 0.1880
val Loss: 3.9670 LRAP: 0.0000 NDCG: 0.2017
Validation loss decreased (8.243134 --> 3.967013).  Saving model ...

Epoch 2/99
----------
train Loss: 3.9527 LRAP: 0.0011 NDCG: 0.1974
val Loss: 5.4308 LRAP: 0.0013 NDCG: 0.1862
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.8452 LRAP: 0.0027 NDCG: 0.2027
val Loss: 3.8833 LRAP: 0.0076 NDCG: 0.1927
Validation loss decreased (3.967013 --> 3.883348).  Saving model ...

Epoch 4/99
----------
train Loss: 3.7766 LRAP: 0.0054 NDCG: 0.2114
val Loss: 5.5506 LRAP: 0.0076 NDCG: 0.2217
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.7120 LRAP: 0.0033 NDCG: 0.2144
val Loss: 4.2459 LRAP: 0.0089 NDCG: 0.1702
EarlyStopping counter: 2 out of 50

Epoch 6/99
----------
train Loss: 3.6504 LRAP: 0.0057 NDCG: 0.2189
val Loss: 5.8081 LRAP: 0.0000 NDCG: 0.1729
EarlyStopping counter: 3 out of 50

Epoch 7/99
----------
train Loss: 3.6187 LRAP: 0.0065 NDCG: 0.2202
val Loss: 3.9927 LRAP: 0.0038 NDCG: 0.1990
EarlyStopping counter: 4 out of 50

Epoch 8/99
----------
train Loss: 3.5717 LRAP: 0.0065 NDCG: 0.2229
val Loss: 4.0984 LRAP: 0.0051 NDCG: 0.2237
EarlyStopping counter: 5 out of 50

Epoch 9/99
----------
train Loss: 3.4974 LRAP: 0.0076 NDCG: 0.2281
val Loss: 3.6473 LRAP: 0.0076 NDCG: 0.2072
Validation loss decreased (3.883348 --> 3.647337).  Saving model ...

Epoch 10/99
----------
train Loss: 3.4690 LRAP: 0.0074 NDCG: 0.2293
val Loss: 3.5811 LRAP: 0.0076 NDCG: 0.2284
Validation loss decreased (3.647337 --> 3.581086).  Saving model ...

Epoch 11/99
----------
train Loss: 3.4323 LRAP: 0.0093 NDCG: 0.2296
val Loss: 3.6113 LRAP: 0.0038 NDCG: 0.2064
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.4334 LRAP: 0.0101 NDCG: 0.2322
val Loss: 3.4658 LRAP: 0.0089 NDCG: 0.2363
Validation loss decreased (3.581086 --> 3.465834).  Saving model ...

Epoch 13/99
----------
train Loss: 3.4192 LRAP: 0.0112 NDCG: 0.2298
val Loss: 3.5255 LRAP: 0.0064 NDCG: 0.2348
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.3881 LRAP: 0.0109 NDCG: 0.2326
val Loss: 3.4484 LRAP: 0.0089 NDCG: 0.2294
Validation loss decreased (3.465834 --> 3.448376).  Saving model ...

Epoch 15/99
----------
train Loss: 3.3812 LRAP: 0.0131 NDCG: 0.2350
val Loss: 3.3609 LRAP: 0.0127 NDCG: 0.2346
Validation loss decreased (3.448376 --> 3.360948).  Saving model ...

Epoch 16/99
----------
train Loss: 3.3606 LRAP: 0.0136 NDCG: 0.2353
val Loss: 3.4951 LRAP: 0.0165 NDCG: 0.2212
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 3.3502 LRAP: 0.0172 NDCG: 0.2373
val Loss: 3.3799 LRAP: 0.0343 NDCG: 0.2250
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 3.3416 LRAP: 0.0210 NDCG: 0.2372
val Loss: 3.4293 LRAP: 0.0292 NDCG: 0.2448
EarlyStopping counter: 3 out of 50

Epoch 19/99
----------
train Loss: 3.3094 LRAP: 0.0237 NDCG: 0.2395
val Loss: 3.3283 LRAP: 0.0140 NDCG: 0.2406
Validation loss decreased (3.360948 --> 3.328283).  Saving model ...

Epoch 20/99
----------
train Loss: 3.2957 LRAP: 0.0180 NDCG: 0.2439
val Loss: 3.5193 LRAP: 0.0902 NDCG: 0.2291
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.2770 LRAP: 0.0270 NDCG: 0.2436
val Loss: 3.6621 LRAP: 0.0076 NDCG: 0.2375
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 3.2589 LRAP: 0.0229 NDCG: 0.2447
val Loss: 3.4491 LRAP: 0.0318 NDCG: 0.2482
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 3.2327 LRAP: 0.0319 NDCG: 0.2474
val Loss: 3.3985 LRAP: 0.0750 NDCG: 0.2269
EarlyStopping counter: 4 out of 50

Epoch 24/99
----------
train Loss: 3.2031 LRAP: 0.0316 NDCG: 0.2499
val Loss: 3.3702 LRAP: 0.0191 NDCG: 0.2347
EarlyStopping counter: 5 out of 50

Epoch 25/99
----------
train Loss: 3.1700 LRAP: 0.0289 NDCG: 0.2546
val Loss: 3.2111 LRAP: 0.0305 NDCG: 0.2472
Validation loss decreased (3.328283 --> 3.211089).  Saving model ...

Epoch 26/99
----------
train Loss: 3.1873 LRAP: 0.0316 NDCG: 0.2509
val Loss: 3.2084 LRAP: 0.0521 NDCG: 0.2507
Validation loss decreased (3.211089 --> 3.208390).  Saving model ...

Epoch 27/99
----------
train Loss: 3.1666 LRAP: 0.0387 NDCG: 0.2541
val Loss: 3.1904 LRAP: 0.0394 NDCG: 0.2519
Validation loss decreased (3.208390 --> 3.190355).  Saving model ...

Epoch 28/99
----------
train Loss: 3.1604 LRAP: 0.0348 NDCG: 0.2536
val Loss: 3.1992 LRAP: 0.0572 NDCG: 0.2553
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 3.1582 LRAP: 0.0346 NDCG: 0.2542
val Loss: 3.1973 LRAP: 0.0267 NDCG: 0.2505
EarlyStopping counter: 2 out of 50

Epoch 30/99
----------
train Loss: 3.1440 LRAP: 0.0329 NDCG: 0.2553
val Loss: 3.1768 LRAP: 0.0267 NDCG: 0.2545
Validation loss decreased (3.190355 --> 3.176826).  Saving model ...

Epoch 31/99
----------
train Loss: 3.1659 LRAP: 0.0373 NDCG: 0.2547
val Loss: 3.2096 LRAP: 0.0559 NDCG: 0.2534
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 3.1316 LRAP: 0.0378 NDCG: 0.2569
val Loss: 3.1877 LRAP: 0.0343 NDCG: 0.2578
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 3.1407 LRAP: 0.0359 NDCG: 0.2567
val Loss: 3.1640 LRAP: 0.0381 NDCG: 0.2546
Validation loss decreased (3.176826 --> 3.164001).  Saving model ...

Epoch 34/99
----------
train Loss: 3.1353 LRAP: 0.0389 NDCG: 0.2569
val Loss: 3.1816 LRAP: 0.0534 NDCG: 0.2549
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.1350 LRAP: 0.0354 NDCG: 0.2570
val Loss: 3.1747 LRAP: 0.0368 NDCG: 0.2545
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 3.1260 LRAP: 0.0408 NDCG: 0.2573
val Loss: 3.1581 LRAP: 0.0534 NDCG: 0.2565
Validation loss decreased (3.164001 --> 3.158065).  Saving model ...

Epoch 37/99
----------
train Loss: 3.1155 LRAP: 0.0425 NDCG: 0.2601
val Loss: 3.1477 LRAP: 0.0483 NDCG: 0.2571
Validation loss decreased (3.158065 --> 3.147704).  Saving model ...

Epoch 38/99
----------
train Loss: 3.1034 LRAP: 0.0438 NDCG: 0.2601
val Loss: 3.1540 LRAP: 0.0508 NDCG: 0.2551
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 3.1003 LRAP: 0.0400 NDCG: 0.2592
val Loss: 3.1543 LRAP: 0.0508 NDCG: 0.2565
EarlyStopping counter: 2 out of 50

Epoch 40/99
----------
train Loss: 3.0976 LRAP: 0.0460 NDCG: 0.2610
val Loss: 3.1457 LRAP: 0.0432 NDCG: 0.2548
Validation loss decreased (3.147704 --> 3.145730).  Saving model ...

Epoch 41/99
----------
train Loss: 3.0924 LRAP: 0.0403 NDCG: 0.2608
val Loss: 3.1525 LRAP: 0.0521 NDCG: 0.2558
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 3.0842 LRAP: 0.0422 NDCG: 0.2620
val Loss: 3.1341 LRAP: 0.0457 NDCG: 0.2605
Validation loss decreased (3.145730 --> 3.134052).  Saving model ...

Epoch 43/99
----------
train Loss: 3.0820 LRAP: 0.0378 NDCG: 0.2633
val Loss: 3.1753 LRAP: 0.0305 NDCG: 0.2530
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.0819 LRAP: 0.0430 NDCG: 0.2631
val Loss: 3.2070 LRAP: 0.0521 NDCG: 0.2665
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 3.0632 LRAP: 0.0463 NDCG: 0.2637
val Loss: 3.1235 LRAP: 0.0546 NDCG: 0.2613
Validation loss decreased (3.134052 --> 3.123481).  Saving model ...

Epoch 46/99
----------
train Loss: 3.0611 LRAP: 0.0455 NDCG: 0.2640
val Loss: 3.1437 LRAP: 0.0737 NDCG: 0.2589
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 3.0665 LRAP: 0.0449 NDCG: 0.2634
val Loss: 3.1512 LRAP: 0.0521 NDCG: 0.2697
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 3.0443 LRAP: 0.0506 NDCG: 0.2656
val Loss: 3.1083 LRAP: 0.0584 NDCG: 0.2593
Validation loss decreased (3.123481 --> 3.108328).  Saving model ...

Epoch 49/99
----------
train Loss: 3.0538 LRAP: 0.0441 NDCG: 0.2677
val Loss: 3.1053 LRAP: 0.0661 NDCG: 0.2672
Validation loss decreased (3.108328 --> 3.105292).  Saving model ...

Epoch 50/99
----------
train Loss: 3.0677 LRAP: 0.0485 NDCG: 0.2656
val Loss: 3.1068 LRAP: 0.0597 NDCG: 0.2623
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 3.0335 LRAP: 0.0506 NDCG: 0.2669
val Loss: 3.1046 LRAP: 0.0546 NDCG: 0.2589
Validation loss decreased (3.105292 --> 3.104610).  Saving model ...

Epoch 52/99
----------
train Loss: 3.0261 LRAP: 0.0534 NDCG: 0.2690
val Loss: 3.1041 LRAP: 0.0648 NDCG: 0.2752
Validation loss decreased (3.104610 --> 3.104056).  Saving model ...

Epoch 53/99
----------
train Loss: 3.0402 LRAP: 0.0520 NDCG: 0.2697
val Loss: 3.1419 LRAP: 0.0432 NDCG: 0.2663
EarlyStopping counter: 1 out of 50

Epoch 54/99
----------
train Loss: 3.0375 LRAP: 0.0550 NDCG: 0.2693
val Loss: 3.1051 LRAP: 0.0788 NDCG: 0.2736
EarlyStopping counter: 2 out of 50

Epoch 55/99
----------
train Loss: 3.0150 LRAP: 0.0545 NDCG: 0.2698
val Loss: 3.0934 LRAP: 0.0762 NDCG: 0.2656
Validation loss decreased (3.104056 --> 3.093410).  Saving model ...

Epoch 56/99
----------
train Loss: 3.0192 LRAP: 0.0430 NDCG: 0.2691
val Loss: 3.1545 LRAP: 0.0877 NDCG: 0.2604
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 3.0104 LRAP: 0.0504 NDCG: 0.2717
val Loss: 3.0713 LRAP: 0.0775 NDCG: 0.2734
Validation loss decreased (3.093410 --> 3.071257).  Saving model ...

Epoch 58/99
----------
train Loss: 3.0009 LRAP: 0.0545 NDCG: 0.2714
val Loss: 3.0769 LRAP: 0.0839 NDCG: 0.2664
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 3.0015 LRAP: 0.0523 NDCG: 0.2708
val Loss: 3.3095 LRAP: 0.0457 NDCG: 0.2702
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 2.9894 LRAP: 0.0604 NDCG: 0.2750
val Loss: 3.0545 LRAP: 0.0864 NDCG: 0.2695
Validation loss decreased (3.071257 --> 3.054550).  Saving model ...

Epoch 61/99
----------
train Loss: 3.0041 LRAP: 0.0564 NDCG: 0.2743
val Loss: 3.0468 LRAP: 0.0775 NDCG: 0.2717
Validation loss decreased (3.054550 --> 3.046787).  Saving model ...

Epoch 62/99
----------
train Loss: 2.9860 LRAP: 0.0569 NDCG: 0.2730
val Loss: 3.0553 LRAP: 0.0686 NDCG: 0.2680
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 2.9785 LRAP: 0.0528 NDCG: 0.2758
val Loss: 3.0611 LRAP: 0.0889 NDCG: 0.2729
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 2.9779 LRAP: 0.0561 NDCG: 0.2744
val Loss: 3.0782 LRAP: 0.0978 NDCG: 0.2714
EarlyStopping counter: 3 out of 50

Epoch 65/99
----------
train Loss: 2.9845 LRAP: 0.0536 NDCG: 0.2752
val Loss: 3.0585 LRAP: 0.0877 NDCG: 0.2803
EarlyStopping counter: 4 out of 50

Epoch 66/99
----------
train Loss: 2.9597 LRAP: 0.0621 NDCG: 0.2760
val Loss: 3.0335 LRAP: 0.0928 NDCG: 0.2730
Validation loss decreased (3.046787 --> 3.033495).  Saving model ...

Epoch 67/99
----------
train Loss: 2.9632 LRAP: 0.0637 NDCG: 0.2773
val Loss: 3.0824 LRAP: 0.0648 NDCG: 0.2770
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 2.9475 LRAP: 0.0577 NDCG: 0.2785
val Loss: 3.0683 LRAP: 0.0546 NDCG: 0.2759
EarlyStopping counter: 2 out of 50

Epoch 69/99
----------
train Loss: 2.9454 LRAP: 0.0599 NDCG: 0.2785
val Loss: 3.0821 LRAP: 0.0839 NDCG: 0.2662
EarlyStopping counter: 3 out of 50

Epoch 70/99
----------
train Loss: 2.9649 LRAP: 0.0594 NDCG: 0.2796
val Loss: 3.0851 LRAP: 0.1080 NDCG: 0.2852
EarlyStopping counter: 4 out of 50

Epoch 71/99
----------
train Loss: 2.9490 LRAP: 0.0659 NDCG: 0.2801
val Loss: 3.0393 LRAP: 0.1042 NDCG: 0.2835
EarlyStopping counter: 5 out of 50

Epoch 72/99
----------
train Loss: 2.9406 LRAP: 0.0683 NDCG: 0.2816
val Loss: 3.0028 LRAP: 0.0991 NDCG: 0.2782
Validation loss decreased (3.033495 --> 3.002757).  Saving model ...

Epoch 73/99
----------
train Loss: 2.9174 LRAP: 0.0670 NDCG: 0.2810
val Loss: 3.0030 LRAP: 0.0966 NDCG: 0.2761
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 2.9342 LRAP: 0.0651 NDCG: 0.2818
val Loss: 3.0029 LRAP: 0.0953 NDCG: 0.2789
EarlyStopping counter: 2 out of 50

Epoch 75/99
----------
train Loss: 2.9299 LRAP: 0.0656 NDCG: 0.2819
val Loss: 2.9991 LRAP: 0.0966 NDCG: 0.2790
Validation loss decreased (3.002757 --> 2.999099).  Saving model ...

Epoch 76/99
----------
train Loss: 2.9263 LRAP: 0.0686 NDCG: 0.2806
val Loss: 2.9970 LRAP: 0.0991 NDCG: 0.2800
Validation loss decreased (2.999099 --> 2.996969).  Saving model ...

Epoch 77/99
----------
train Loss: 2.9270 LRAP: 0.0664 NDCG: 0.2800
val Loss: 2.9952 LRAP: 0.0940 NDCG: 0.2792
Validation loss decreased (2.996969 --> 2.995238).  Saving model ...

Epoch 78/99
----------
train Loss: 2.9314 LRAP: 0.0694 NDCG: 0.2794
val Loss: 3.0010 LRAP: 0.0915 NDCG: 0.2797
EarlyStopping counter: 1 out of 50

Epoch 79/99
----------
train Loss: 2.9253 LRAP: 0.0640 NDCG: 0.2815
val Loss: 2.9957 LRAP: 0.0953 NDCG: 0.2800
EarlyStopping counter: 2 out of 50

Epoch 80/99
----------
train Loss: 2.9252 LRAP: 0.0664 NDCG: 0.2799
val Loss: 2.9963 LRAP: 0.1042 NDCG: 0.2797
EarlyStopping counter: 3 out of 50

Epoch 81/99
----------
train Loss: 2.9121 LRAP: 0.0651 NDCG: 0.2826
val Loss: 2.9946 LRAP: 0.1067 NDCG: 0.2793
Validation loss decreased (2.995238 --> 2.994643).  Saving model ...

Epoch 82/99
----------
train Loss: 2.9219 LRAP: 0.0692 NDCG: 0.2804
val Loss: 2.9948 LRAP: 0.0953 NDCG: 0.2776
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 2.9190 LRAP: 0.0659 NDCG: 0.2804
val Loss: 2.9950 LRAP: 0.0940 NDCG: 0.2791
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 2.9281 LRAP: 0.0686 NDCG: 0.2805
val Loss: 2.9932 LRAP: 0.1017 NDCG: 0.2794
Validation loss decreased (2.994643 --> 2.993250).  Saving model ...

Epoch 85/99
----------
train Loss: 2.9223 LRAP: 0.0664 NDCG: 0.2840
val Loss: 2.9981 LRAP: 0.1105 NDCG: 0.2808
EarlyStopping counter: 1 out of 50

Epoch 86/99
----------
train Loss: 2.9165 LRAP: 0.0667 NDCG: 0.2827
val Loss: 2.9956 LRAP: 0.1029 NDCG: 0.2822
EarlyStopping counter: 2 out of 50

Epoch 87/99
----------
train Loss: 2.9145 LRAP: 0.0681 NDCG: 0.2815
val Loss: 2.9895 LRAP: 0.0953 NDCG: 0.2789
Validation loss decreased (2.993250 --> 2.989543).  Saving model ...

Epoch 88/99
----------
train Loss: 2.9197 LRAP: 0.0667 NDCG: 0.2834
val Loss: 2.9897 LRAP: 0.0877 NDCG: 0.2802
EarlyStopping counter: 1 out of 50

Epoch 89/99
----------
train Loss: 2.9207 LRAP: 0.0675 NDCG: 0.2815
val Loss: 2.9873 LRAP: 0.0953 NDCG: 0.2800
Validation loss decreased (2.989543 --> 2.987327).  Saving model ...

Epoch 90/99
----------
train Loss: 2.9145 LRAP: 0.0662 NDCG: 0.2840
val Loss: 2.9860 LRAP: 0.1017 NDCG: 0.2820
Validation loss decreased (2.987327 --> 2.986000).  Saving model ...

Epoch 91/99
----------
train Loss: 2.9047 LRAP: 0.0713 NDCG: 0.2828
val Loss: 2.9883 LRAP: 0.1105 NDCG: 0.2796
EarlyStopping counter: 1 out of 50

Epoch 92/99
----------
train Loss: 2.9240 LRAP: 0.0711 NDCG: 0.2824
val Loss: 2.9887 LRAP: 0.1118 NDCG: 0.2794
EarlyStopping counter: 2 out of 50

Epoch 93/99
----------
train Loss: 2.9244 LRAP: 0.0678 NDCG: 0.2840
val Loss: 2.9901 LRAP: 0.1055 NDCG: 0.2807
EarlyStopping counter: 3 out of 50

Epoch 94/99
----------
train Loss: 2.9042 LRAP: 0.0762 NDCG: 0.2836
val Loss: 2.9854 LRAP: 0.1105 NDCG: 0.2810
Validation loss decreased (2.986000 --> 2.985434).  Saving model ...

Epoch 95/99
----------
train Loss: 2.9112 LRAP: 0.0686 NDCG: 0.2846
val Loss: 2.9855 LRAP: 0.1080 NDCG: 0.2824
EarlyStopping counter: 1 out of 50

Epoch 96/99
----------
train Loss: 2.9201 LRAP: 0.0686 NDCG: 0.2848
val Loss: 2.9840 LRAP: 0.1004 NDCG: 0.2816
Validation loss decreased (2.985434 --> 2.984001).  Saving model ...

Epoch 97/99
----------
train Loss: 2.9163 LRAP: 0.0686 NDCG: 0.2849
val Loss: 2.9806 LRAP: 0.1055 NDCG: 0.2811
Validation loss decreased (2.984001 --> 2.980586).  Saving model ...

Epoch 98/99
----------
train Loss: 2.9095 LRAP: 0.0705 NDCG: 0.2846
val Loss: 2.9810 LRAP: 0.1105 NDCG: 0.2832
EarlyStopping counter: 1 out of 50

Epoch 99/99
----------
train Loss: 2.8997 LRAP: 0.0689 NDCG: 0.2815
val Loss: 2.9780 LRAP: 0.1067 NDCG: 0.2841
Validation loss decreased (2.980586 --> 2.977970).  Saving model ...

Training complete in 2m 31s
Best val loss: 2.977970, best LRAP score: 0.6190

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6088 LRAP: 0.0000 NDCG: 0.1645
val Loss: 11.0311 LRAP: 0.0000 NDCG: 0.1291
Validation loss decreased (0.000000 --> 11.031080).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1700 LRAP: 0.0000 NDCG: 0.1847
val Loss: 9.5859 LRAP: 0.0000 NDCG: 0.1899
Validation loss decreased (11.031080 --> 9.585856).  Saving model ...

Epoch 2/99
----------
train Loss: 4.0125 LRAP: 0.0014 NDCG: 0.2048
val Loss: 3.9402 LRAP: 0.0038 NDCG: 0.2152
Validation loss decreased (9.585856 --> 3.940205).  Saving model ...

Epoch 3/99
----------
train Loss: 3.9157 LRAP: 0.0033 NDCG: 0.2051
val Loss: 4.0792 LRAP: 0.0089 NDCG: 0.2133
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.8554 LRAP: 0.0044 NDCG: 0.2034
val Loss: 4.0439 LRAP: 0.0038 NDCG: 0.1839
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.7932 LRAP: 0.0054 NDCG: 0.2081
val Loss: 6.5851 LRAP: 0.0000 NDCG: 0.1276
EarlyStopping counter: 3 out of 50

Epoch 6/99
----------
train Loss: 3.7696 LRAP: 0.0071 NDCG: 0.2123
val Loss: 3.9792 LRAP: 0.0051 NDCG: 0.1925
EarlyStopping counter: 4 out of 50

Epoch 7/99
----------
train Loss: 3.7262 LRAP: 0.0076 NDCG: 0.2105
val Loss: 3.8078 LRAP: 0.0089 NDCG: 0.1910
Validation loss decreased (3.940205 --> 3.807752).  Saving model ...

Epoch 8/99
----------
train Loss: 3.7059 LRAP: 0.0068 NDCG: 0.2151
val Loss: 4.4485 LRAP: 0.0064 NDCG: 0.1961
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.6725 LRAP: 0.0068 NDCG: 0.2160
val Loss: 3.8714 LRAP: 0.0356 NDCG: 0.2117
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.6468 LRAP: 0.0106 NDCG: 0.2175
val Loss: 3.6454 LRAP: 0.0102 NDCG: 0.2123
Validation loss decreased (3.807752 --> 3.645367).  Saving model ...

Epoch 11/99
----------
train Loss: 3.6238 LRAP: 0.0101 NDCG: 0.2201
val Loss: 3.6177 LRAP: 0.0076 NDCG: 0.2158
Validation loss decreased (3.645367 --> 3.617689).  Saving model ...

Epoch 12/99
----------
train Loss: 3.5792 LRAP: 0.0106 NDCG: 0.2251
val Loss: 4.1592 LRAP: 0.0089 NDCG: 0.1999
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.5463 LRAP: 0.0142 NDCG: 0.2243
val Loss: 3.8623 LRAP: 0.0432 NDCG: 0.2144
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 3.5226 LRAP: 0.0112 NDCG: 0.2294
val Loss: 3.6861 LRAP: 0.0102 NDCG: 0.2083
EarlyStopping counter: 3 out of 50

Epoch 15/99
----------
train Loss: 3.4851 LRAP: 0.0280 NDCG: 0.2305
val Loss: 3.9511 LRAP: 0.0013 NDCG: 0.2125
EarlyStopping counter: 4 out of 50

Epoch 16/99
----------
train Loss: 3.4457 LRAP: 0.0240 NDCG: 0.2344
val Loss: 3.9671 LRAP: 0.0051 NDCG: 0.2045
EarlyStopping counter: 5 out of 50

Epoch 17/99
----------
train Loss: 3.4018 LRAP: 0.0248 NDCG: 0.2342
val Loss: 3.4086 LRAP: 0.0152 NDCG: 0.2312
Validation loss decreased (3.617689 --> 3.408557).  Saving model ...

Epoch 18/99
----------
train Loss: 3.3527 LRAP: 0.0240 NDCG: 0.2397
val Loss: 3.4005 LRAP: 0.0407 NDCG: 0.2358
Validation loss decreased (3.408557 --> 3.400499).  Saving model ...

Epoch 19/99
----------
train Loss: 3.3345 LRAP: 0.0310 NDCG: 0.2388
val Loss: 3.5275 LRAP: 0.0394 NDCG: 0.2352
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.3254 LRAP: 0.0294 NDCG: 0.2392
val Loss: 3.3680 LRAP: 0.0305 NDCG: 0.2371
Validation loss decreased (3.400499 --> 3.367981).  Saving model ...

Epoch 21/99
----------
train Loss: 3.3174 LRAP: 0.0335 NDCG: 0.2402
val Loss: 3.3564 LRAP: 0.0470 NDCG: 0.2384
Validation loss decreased (3.367981 --> 3.356365).  Saving model ...

Epoch 22/99
----------
train Loss: 3.2999 LRAP: 0.0313 NDCG: 0.2430
val Loss: 3.6210 LRAP: 0.0241 NDCG: 0.2236
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 3.2820 LRAP: 0.0370 NDCG: 0.2452
val Loss: 3.5473 LRAP: 0.0457 NDCG: 0.2396
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 3.2776 LRAP: 0.0433 NDCG: 0.2454
val Loss: 3.3639 LRAP: 0.0356 NDCG: 0.2359
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 3.2565 LRAP: 0.0460 NDCG: 0.2457
val Loss: 3.5452 LRAP: 0.0623 NDCG: 0.2372
EarlyStopping counter: 4 out of 50

Epoch 26/99
----------
train Loss: 3.2642 LRAP: 0.0485 NDCG: 0.2465
val Loss: 3.7247 LRAP: 0.0470 NDCG: 0.2324
EarlyStopping counter: 5 out of 50

Epoch 27/99
----------
train Loss: 3.2382 LRAP: 0.0498 NDCG: 0.2473
val Loss: 3.3352 LRAP: 0.0635 NDCG: 0.2452
Validation loss decreased (3.356365 --> 3.335164).  Saving model ...

Epoch 28/99
----------
train Loss: 3.2240 LRAP: 0.0536 NDCG: 0.2482
val Loss: 3.2944 LRAP: 0.0712 NDCG: 0.2426
Validation loss decreased (3.335164 --> 3.294392).  Saving model ...

Epoch 29/99
----------
train Loss: 3.2217 LRAP: 0.0515 NDCG: 0.2476
val Loss: 3.2831 LRAP: 0.0737 NDCG: 0.2427
Validation loss decreased (3.294392 --> 3.283107).  Saving model ...

Epoch 30/99
----------
train Loss: 3.2296 LRAP: 0.0564 NDCG: 0.2484
val Loss: 3.2723 LRAP: 0.0788 NDCG: 0.2444
Validation loss decreased (3.283107 --> 3.272311).  Saving model ...

Epoch 31/99
----------
train Loss: 3.2231 LRAP: 0.0528 NDCG: 0.2488
val Loss: 3.2678 LRAP: 0.0673 NDCG: 0.2445
Validation loss decreased (3.272311 --> 3.267831).  Saving model ...

Epoch 32/99
----------
train Loss: 3.2126 LRAP: 0.0490 NDCG: 0.2472
val Loss: 3.2840 LRAP: 0.0750 NDCG: 0.2456
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 3.2217 LRAP: 0.0520 NDCG: 0.2483
val Loss: 3.2619 LRAP: 0.0648 NDCG: 0.2465
Validation loss decreased (3.267831 --> 3.261854).  Saving model ...

Epoch 34/99
----------
train Loss: 3.2171 LRAP: 0.0517 NDCG: 0.2456
val Loss: 3.2644 LRAP: 0.0699 NDCG: 0.2441
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.2171 LRAP: 0.0539 NDCG: 0.2481
val Loss: 3.2531 LRAP: 0.0775 NDCG: 0.2461
Validation loss decreased (3.261854 --> 3.253098).  Saving model ...

Epoch 36/99
----------
train Loss: 3.2091 LRAP: 0.0629 NDCG: 0.2492
val Loss: 3.2678 LRAP: 0.0686 NDCG: 0.2449
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 3.2059 LRAP: 0.0558 NDCG: 0.2507
val Loss: 3.2502 LRAP: 0.0788 NDCG: 0.2480
Validation loss decreased (3.253098 --> 3.250157).  Saving model ...

Epoch 38/99
----------
train Loss: 3.2059 LRAP: 0.0591 NDCG: 0.2489
val Loss: 3.2514 LRAP: 0.0699 NDCG: 0.2449
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 3.2006 LRAP: 0.0623 NDCG: 0.2489
val Loss: 3.2611 LRAP: 0.0788 NDCG: 0.2475
EarlyStopping counter: 2 out of 50

Epoch 40/99
----------
train Loss: 3.1937 LRAP: 0.0594 NDCG: 0.2500
val Loss: 3.2707 LRAP: 0.0686 NDCG: 0.2445
EarlyStopping counter: 3 out of 50

Epoch 41/99
----------
train Loss: 3.2084 LRAP: 0.0542 NDCG: 0.2488
val Loss: 3.2720 LRAP: 0.0775 NDCG: 0.2496
EarlyStopping counter: 4 out of 50

Epoch 42/99
----------
train Loss: 3.1906 LRAP: 0.0594 NDCG: 0.2503
val Loss: 3.2408 LRAP: 0.0712 NDCG: 0.2471
Validation loss decreased (3.250157 --> 3.240771).  Saving model ...

Epoch 43/99
----------
train Loss: 3.1944 LRAP: 0.0615 NDCG: 0.2504
val Loss: 3.2431 LRAP: 0.0737 NDCG: 0.2487
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.1806 LRAP: 0.0585 NDCG: 0.2514
val Loss: 3.2574 LRAP: 0.0826 NDCG: 0.2470
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 3.1847 LRAP: 0.0547 NDCG: 0.2504
val Loss: 3.2552 LRAP: 0.0788 NDCG: 0.2465
EarlyStopping counter: 3 out of 50

Epoch 46/99
----------
train Loss: 3.1870 LRAP: 0.0637 NDCG: 0.2510
val Loss: 3.2662 LRAP: 0.0801 NDCG: 0.2457
EarlyStopping counter: 4 out of 50

Epoch 47/99
----------
train Loss: 3.1746 LRAP: 0.0596 NDCG: 0.2502
val Loss: 3.2364 LRAP: 0.0813 NDCG: 0.2493
Validation loss decreased (3.240771 --> 3.236421).  Saving model ...

Epoch 48/99
----------
train Loss: 3.1729 LRAP: 0.0672 NDCG: 0.2513
val Loss: 3.2508 LRAP: 0.0978 NDCG: 0.2506
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 3.1684 LRAP: 0.0670 NDCG: 0.2528
val Loss: 3.2416 LRAP: 0.0801 NDCG: 0.2468
EarlyStopping counter: 2 out of 50

Epoch 50/99
----------
train Loss: 3.1601 LRAP: 0.0604 NDCG: 0.2518
val Loss: 3.2366 LRAP: 0.0826 NDCG: 0.2501
EarlyStopping counter: 3 out of 50

Epoch 51/99
----------
train Loss: 3.1636 LRAP: 0.0670 NDCG: 0.2525
val Loss: 3.2265 LRAP: 0.0915 NDCG: 0.2504
Validation loss decreased (3.236421 --> 3.226522).  Saving model ...

Epoch 52/99
----------
train Loss: 3.1731 LRAP: 0.0643 NDCG: 0.2521
val Loss: 3.2283 LRAP: 0.0966 NDCG: 0.2472
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 3.1619 LRAP: 0.0643 NDCG: 0.2536
val Loss: 3.2229 LRAP: 0.0775 NDCG: 0.2499
Validation loss decreased (3.226522 --> 3.222938).  Saving model ...

Epoch 54/99
----------
train Loss: 3.1643 LRAP: 0.0604 NDCG: 0.2527
val Loss: 3.2400 LRAP: 0.0788 NDCG: 0.2482
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 3.1644 LRAP: 0.0637 NDCG: 0.2540
val Loss: 3.2656 LRAP: 0.0966 NDCG: 0.2505
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 3.1646 LRAP: 0.0623 NDCG: 0.2539
val Loss: 3.2626 LRAP: 0.1017 NDCG: 0.2472
EarlyStopping counter: 3 out of 50

Epoch 57/99
----------
train Loss: 3.1615 LRAP: 0.0632 NDCG: 0.2534
val Loss: 3.2183 LRAP: 0.1004 NDCG: 0.2512
Validation loss decreased (3.222938 --> 3.218299).  Saving model ...

Epoch 58/99
----------
train Loss: 3.1567 LRAP: 0.0643 NDCG: 0.2544
val Loss: 3.2625 LRAP: 0.0940 NDCG: 0.2452
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 3.1497 LRAP: 0.0705 NDCG: 0.2539
val Loss: 3.2679 LRAP: 0.1156 NDCG: 0.2554
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 3.1598 LRAP: 0.0711 NDCG: 0.2547
val Loss: 3.2608 LRAP: 0.0839 NDCG: 0.2457
EarlyStopping counter: 3 out of 50

Epoch 61/99
----------
train Loss: 3.1641 LRAP: 0.0648 NDCG: 0.2541
val Loss: 3.2074 LRAP: 0.1004 NDCG: 0.2512
Validation loss decreased (3.218299 --> 3.207409).  Saving model ...

Epoch 62/99
----------
train Loss: 3.1551 LRAP: 0.0656 NDCG: 0.2521
val Loss: 3.2146 LRAP: 0.0940 NDCG: 0.2524
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 3.1564 LRAP: 0.0762 NDCG: 0.2550
val Loss: 3.2112 LRAP: 0.1055 NDCG: 0.2500
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 3.1269 LRAP: 0.0697 NDCG: 0.2558
val Loss: 3.2057 LRAP: 0.1080 NDCG: 0.2520
Validation loss decreased (3.207409 --> 3.205697).  Saving model ...

Epoch 65/99
----------
train Loss: 3.1443 LRAP: 0.0711 NDCG: 0.2552
val Loss: 3.2184 LRAP: 0.1042 NDCG: 0.2528
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 3.1350 LRAP: 0.0746 NDCG: 0.2567
val Loss: 3.1990 LRAP: 0.1042 NDCG: 0.2509
Validation loss decreased (3.205697 --> 3.199025).  Saving model ...

Epoch 67/99
----------
train Loss: 3.1228 LRAP: 0.0692 NDCG: 0.2564
val Loss: 3.2141 LRAP: 0.1017 NDCG: 0.2488
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 3.1232 LRAP: 0.0689 NDCG: 0.2584
val Loss: 3.1940 LRAP: 0.1055 NDCG: 0.2506
Validation loss decreased (3.199025 --> 3.193983).  Saving model ...

Epoch 69/99
----------
train Loss: 3.1248 LRAP: 0.0746 NDCG: 0.2579
val Loss: 3.1970 LRAP: 0.0877 NDCG: 0.2523
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 3.1240 LRAP: 0.0749 NDCG: 0.2576
val Loss: 3.2090 LRAP: 0.1067 NDCG: 0.2511
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 3.1117 LRAP: 0.0776 NDCG: 0.2569
val Loss: 3.2085 LRAP: 0.1067 NDCG: 0.2523
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 3.1265 LRAP: 0.0751 NDCG: 0.2582
val Loss: 3.2025 LRAP: 0.1131 NDCG: 0.2561
EarlyStopping counter: 4 out of 50

Epoch 73/99
----------
train Loss: 3.1151 LRAP: 0.0787 NDCG: 0.2572
val Loss: 3.2196 LRAP: 0.1042 NDCG: 0.2496
EarlyStopping counter: 5 out of 50

Epoch 74/99
----------
train Loss: 3.1075 LRAP: 0.0713 NDCG: 0.2585
val Loss: 3.1883 LRAP: 0.1080 NDCG: 0.2535
Validation loss decreased (3.193983 --> 3.188251).  Saving model ...

Epoch 75/99
----------
train Loss: 3.0986 LRAP: 0.0790 NDCG: 0.2596
val Loss: 3.1895 LRAP: 0.1093 NDCG: 0.2527
EarlyStopping counter: 1 out of 50

Epoch 76/99
----------
train Loss: 3.1004 LRAP: 0.0768 NDCG: 0.2587
val Loss: 3.1923 LRAP: 0.1093 NDCG: 0.2516
EarlyStopping counter: 2 out of 50

Epoch 77/99
----------
train Loss: 3.1157 LRAP: 0.0781 NDCG: 0.2589
val Loss: 3.1874 LRAP: 0.1067 NDCG: 0.2522
Validation loss decreased (3.188251 --> 3.187440).  Saving model ...

Epoch 78/99
----------
train Loss: 3.1094 LRAP: 0.0757 NDCG: 0.2603
val Loss: 3.1895 LRAP: 0.1055 NDCG: 0.2519
EarlyStopping counter: 1 out of 50

Epoch 79/99
----------
train Loss: 3.1102 LRAP: 0.0803 NDCG: 0.2575
val Loss: 3.1918 LRAP: 0.1093 NDCG: 0.2530
EarlyStopping counter: 2 out of 50

Epoch 80/99
----------
train Loss: 3.1105 LRAP: 0.0770 NDCG: 0.2565
val Loss: 3.1841 LRAP: 0.1093 NDCG: 0.2527
Validation loss decreased (3.187440 --> 3.184097).  Saving model ...

Epoch 81/99
----------
train Loss: 3.1035 LRAP: 0.0768 NDCG: 0.2591
val Loss: 3.1887 LRAP: 0.1067 NDCG: 0.2531
EarlyStopping counter: 1 out of 50

Epoch 82/99
----------
train Loss: 3.1118 LRAP: 0.0830 NDCG: 0.2580
val Loss: 3.1905 LRAP: 0.1055 NDCG: 0.2533
EarlyStopping counter: 2 out of 50

Epoch 83/99
----------
train Loss: 3.1014 LRAP: 0.0790 NDCG: 0.2597
val Loss: 3.1855 LRAP: 0.1093 NDCG: 0.2518
EarlyStopping counter: 3 out of 50

Epoch 84/99
----------
train Loss: 3.0993 LRAP: 0.0841 NDCG: 0.2585
val Loss: 3.1851 LRAP: 0.1055 NDCG: 0.2521
EarlyStopping counter: 4 out of 50

Epoch 85/99
----------
train Loss: 3.1080 LRAP: 0.0757 NDCG: 0.2593
val Loss: 3.1834 LRAP: 0.1055 NDCG: 0.2533
Validation loss decreased (3.184097 --> 3.183428).  Saving model ...

Epoch 86/99
----------
train Loss: 3.0911 LRAP: 0.0768 NDCG: 0.2605
val Loss: 3.1910 LRAP: 0.1067 NDCG: 0.2522
EarlyStopping counter: 1 out of 50

Epoch 87/99
----------
train Loss: 3.1031 LRAP: 0.0770 NDCG: 0.2604
val Loss: 3.1832 LRAP: 0.1131 NDCG: 0.2534
Validation loss decreased (3.183428 --> 3.183163).  Saving model ...

Epoch 88/99
----------
train Loss: 3.0960 LRAP: 0.0776 NDCG: 0.2592
val Loss: 3.1841 LRAP: 0.1105 NDCG: 0.2527
EarlyStopping counter: 1 out of 50

Epoch 89/99
----------
train Loss: 3.1043 LRAP: 0.0795 NDCG: 0.2581
val Loss: 3.1820 LRAP: 0.1131 NDCG: 0.2537
Validation loss decreased (3.183163 --> 3.182006).  Saving model ...

Epoch 90/99
----------
train Loss: 3.0899 LRAP: 0.0784 NDCG: 0.2596
val Loss: 3.1846 LRAP: 0.1144 NDCG: 0.2534
EarlyStopping counter: 1 out of 50

Epoch 91/99
----------
train Loss: 3.1139 LRAP: 0.0790 NDCG: 0.2574
val Loss: 3.1821 LRAP: 0.1093 NDCG: 0.2532
EarlyStopping counter: 2 out of 50

Epoch 92/99
----------
train Loss: 3.1023 LRAP: 0.0743 NDCG: 0.2580
val Loss: 3.1786 LRAP: 0.1093 NDCG: 0.2531
Validation loss decreased (3.182006 --> 3.178596).  Saving model ...

Epoch 93/99
----------
train Loss: 3.0965 LRAP: 0.0787 NDCG: 0.2609
val Loss: 3.1798 LRAP: 0.1093 NDCG: 0.2542
EarlyStopping counter: 1 out of 50

Epoch 94/99
----------
train Loss: 3.1046 LRAP: 0.0746 NDCG: 0.2596
val Loss: 3.1814 LRAP: 0.1093 NDCG: 0.2535
EarlyStopping counter: 2 out of 50

Epoch 95/99
----------
train Loss: 3.1010 LRAP: 0.0765 NDCG: 0.2594
val Loss: 3.1810 LRAP: 0.1093 NDCG: 0.2538
EarlyStopping counter: 3 out of 50

Epoch 96/99
----------
train Loss: 3.1091 LRAP: 0.0784 NDCG: 0.2600
val Loss: 3.1813 LRAP: 0.1067 NDCG: 0.2539
EarlyStopping counter: 4 out of 50

Epoch 97/99
----------
train Loss: 3.0992 LRAP: 0.0781 NDCG: 0.2592
val Loss: 3.1786 LRAP: 0.1131 NDCG: 0.2535
Validation loss decreased (3.178596 --> 3.178568).  Saving model ...

Epoch 98/99
----------
train Loss: 3.0970 LRAP: 0.0822 NDCG: 0.2588
val Loss: 3.1795 LRAP: 0.1105 NDCG: 0.2533
EarlyStopping counter: 1 out of 50

Epoch 99/99
----------
train Loss: 3.0953 LRAP: 0.0795 NDCG: 0.2589
val Loss: 3.1776 LRAP: 0.1105 NDCG: 0.2536
Validation loss decreased (3.178568 --> 3.177557).  Saving model ...

Training complete in 2m 30s
Best val loss: 3.177557, best LRAP score: 0.5902

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 5/10

All random seeds set to: 46
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.4488 LRAP: 0.0000 NDCG: 0.1780
val Loss: 4.2800 LRAP: 0.0000 NDCG: 0.1881
Validation loss decreased (0.000000 --> 4.280024).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9075 LRAP: 0.0016 NDCG: 0.2018
val Loss: 4.2242 LRAP: 0.0051 NDCG: 0.2047
Validation loss decreased (4.280024 --> 4.224199).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7654 LRAP: 0.0152 NDCG: 0.2159
val Loss: 3.7639 LRAP: 0.0457 NDCG: 0.2104
Validation loss decreased (4.224199 --> 3.763856).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7053 LRAP: 0.0161 NDCG: 0.2223
val Loss: 5.2996 LRAP: 0.0000 NDCG: 0.2055
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.6071 LRAP: 0.0354 NDCG: 0.2216
val Loss: 3.8700 LRAP: 0.0940 NDCG: 0.1992
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.5379 LRAP: 0.0408 NDCG: 0.2265
val Loss: 3.4565 LRAP: 0.0064 NDCG: 0.2230
Validation loss decreased (3.763856 --> 3.456526).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4539 LRAP: 0.0536 NDCG: 0.2286
val Loss: 3.5092 LRAP: 0.0597 NDCG: 0.2326
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.4134 LRAP: 0.0561 NDCG: 0.2316
val Loss: 3.8606 LRAP: 0.0724 NDCG: 0.2282
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.3782 LRAP: 0.0594 NDCG: 0.2386
val Loss: 4.0473 LRAP: 0.0216 NDCG: 0.2340
EarlyStopping counter: 3 out of 50

Epoch 9/99
----------
train Loss: 3.3380 LRAP: 0.0678 NDCG: 0.2398
val Loss: 3.4751 LRAP: 0.0877 NDCG: 0.2381
EarlyStopping counter: 4 out of 50

Epoch 10/99
----------
train Loss: 3.2742 LRAP: 0.0566 NDCG: 0.2425
val Loss: 3.4925 LRAP: 0.0788 NDCG: 0.2222
EarlyStopping counter: 5 out of 50

Epoch 11/99
----------
train Loss: 3.2089 LRAP: 0.0705 NDCG: 0.2464
val Loss: 3.1732 LRAP: 0.0966 NDCG: 0.2433
Validation loss decreased (3.456526 --> 3.173238).  Saving model ...

Epoch 12/99
----------
train Loss: 3.1675 LRAP: 0.0727 NDCG: 0.2513
val Loss: 3.1235 LRAP: 0.0877 NDCG: 0.2493
Validation loss decreased (3.173238 --> 3.123490).  Saving model ...

Epoch 13/99
----------
train Loss: 3.1384 LRAP: 0.0732 NDCG: 0.2517
val Loss: 3.0512 LRAP: 0.0915 NDCG: 0.2553
Validation loss decreased (3.123490 --> 3.051201).  Saving model ...

Epoch 14/99
----------
train Loss: 3.1298 LRAP: 0.0770 NDCG: 0.2547
val Loss: 3.0270 LRAP: 0.0928 NDCG: 0.2593
Validation loss decreased (3.051201 --> 3.026977).  Saving model ...

Epoch 15/99
----------
train Loss: 3.1283 LRAP: 0.0828 NDCG: 0.2545
val Loss: 3.0519 LRAP: 0.1055 NDCG: 0.2588
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 3.1003 LRAP: 0.0751 NDCG: 0.2586
val Loss: 3.0422 LRAP: 0.0991 NDCG: 0.2581
EarlyStopping counter: 2 out of 50

Epoch 17/99
----------
train Loss: 3.0740 LRAP: 0.0741 NDCG: 0.2575
val Loss: 2.9820 LRAP: 0.0928 NDCG: 0.2614
Validation loss decreased (3.026977 --> 2.981979).  Saving model ...

Epoch 18/99
----------
train Loss: 3.0488 LRAP: 0.0809 NDCG: 0.2595
val Loss: 3.0011 LRAP: 0.1029 NDCG: 0.2523
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 3.0470 LRAP: 0.0877 NDCG: 0.2618
val Loss: 2.9765 LRAP: 0.1067 NDCG: 0.2624
Validation loss decreased (2.981979 --> 2.976547).  Saving model ...

Epoch 20/99
----------
train Loss: 3.0367 LRAP: 0.0839 NDCG: 0.2630
val Loss: 2.9824 LRAP: 0.1004 NDCG: 0.2610
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.9916 LRAP: 0.0795 NDCG: 0.2653
val Loss: 2.9404 LRAP: 0.0889 NDCG: 0.2692
Validation loss decreased (2.976547 --> 2.940360).  Saving model ...

Epoch 22/99
----------
train Loss: 2.9865 LRAP: 0.0819 NDCG: 0.2672
val Loss: 2.9271 LRAP: 0.1080 NDCG: 0.2696
Validation loss decreased (2.940360 --> 2.927142).  Saving model ...

Epoch 23/99
----------
train Loss: 2.9876 LRAP: 0.0858 NDCG: 0.2691
val Loss: 2.9073 LRAP: 0.1194 NDCG: 0.2761
Validation loss decreased (2.927142 --> 2.907335).  Saving model ...

Epoch 24/99
----------
train Loss: 2.9533 LRAP: 0.0860 NDCG: 0.2707
val Loss: 2.9009 LRAP: 0.0915 NDCG: 0.2690
Validation loss decreased (2.907335 --> 2.900915).  Saving model ...

Epoch 25/99
----------
train Loss: 2.9314 LRAP: 0.0860 NDCG: 0.2723
val Loss: 2.9570 LRAP: 0.0902 NDCG: 0.2770
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 2.9276 LRAP: 0.0863 NDCG: 0.2734
val Loss: 2.9733 LRAP: 0.1093 NDCG: 0.2882
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 2.9167 LRAP: 0.0920 NDCG: 0.2762
val Loss: 2.8707 LRAP: 0.0928 NDCG: 0.2764
Validation loss decreased (2.900915 --> 2.870732).  Saving model ...

Epoch 28/99
----------
train Loss: 2.8896 LRAP: 0.0882 NDCG: 0.2758
val Loss: 2.9783 LRAP: 0.1131 NDCG: 0.2616
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 2.8957 LRAP: 0.0909 NDCG: 0.2766
val Loss: 2.8416 LRAP: 0.1017 NDCG: 0.2815
Validation loss decreased (2.870732 --> 2.841607).  Saving model ...

Epoch 30/99
----------
train Loss: 2.8605 LRAP: 0.0947 NDCG: 0.2804
val Loss: 2.9119 LRAP: 0.1105 NDCG: 0.2959
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 2.8384 LRAP: 0.0945 NDCG: 0.2812
val Loss: 2.8120 LRAP: 0.1144 NDCG: 0.2883
Validation loss decreased (2.841607 --> 2.812046).  Saving model ...

Epoch 32/99
----------
train Loss: 2.8311 LRAP: 0.0945 NDCG: 0.2825
val Loss: 2.8540 LRAP: 0.0940 NDCG: 0.2926
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.8184 LRAP: 0.0964 NDCG: 0.2833
val Loss: 2.7804 LRAP: 0.1131 NDCG: 0.2788
Validation loss decreased (2.812046 --> 2.780351).  Saving model ...

Epoch 34/99
----------
train Loss: 2.8062 LRAP: 0.1005 NDCG: 0.2846
val Loss: 2.8300 LRAP: 0.1131 NDCG: 0.2741
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 2.7863 LRAP: 0.0961 NDCG: 0.2877
val Loss: 2.7974 LRAP: 0.0775 NDCG: 0.2861
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 2.7949 LRAP: 0.0996 NDCG: 0.2881
val Loss: 2.7711 LRAP: 0.0902 NDCG: 0.2804
Validation loss decreased (2.780351 --> 2.771138).  Saving model ...

Epoch 37/99
----------
train Loss: 2.7434 LRAP: 0.1032 NDCG: 0.2928
val Loss: 2.7249 LRAP: 0.1144 NDCG: 0.2911
Validation loss decreased (2.771138 --> 2.724949).  Saving model ...

Epoch 38/99
----------
train Loss: 2.7415 LRAP: 0.0939 NDCG: 0.2928
val Loss: 2.7983 LRAP: 0.0966 NDCG: 0.2810
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 2.7401 LRAP: 0.1002 NDCG: 0.2956
val Loss: 2.7163 LRAP: 0.0978 NDCG: 0.2924
Validation loss decreased (2.724949 --> 2.716282).  Saving model ...

Epoch 40/99
----------
train Loss: 2.7085 LRAP: 0.1048 NDCG: 0.2968
val Loss: 2.7169 LRAP: 0.0940 NDCG: 0.2975
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 2.7029 LRAP: 0.0994 NDCG: 0.2965
val Loss: 2.7279 LRAP: 0.1093 NDCG: 0.2824
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 2.6909 LRAP: 0.1040 NDCG: 0.2967
val Loss: 2.6859 LRAP: 0.1105 NDCG: 0.2895
Validation loss decreased (2.716282 --> 2.685876).  Saving model ...

Epoch 43/99
----------
train Loss: 2.6722 LRAP: 0.1024 NDCG: 0.2998
val Loss: 2.7001 LRAP: 0.1029 NDCG: 0.2973
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 2.6526 LRAP: 0.1040 NDCG: 0.3038
val Loss: 2.6313 LRAP: 0.1055 NDCG: 0.3095
Validation loss decreased (2.685876 --> 2.631349).  Saving model ...

Epoch 45/99
----------
train Loss: 2.6505 LRAP: 0.1094 NDCG: 0.3000
val Loss: 2.6629 LRAP: 0.1131 NDCG: 0.3084
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 2.6298 LRAP: 0.1054 NDCG: 0.3040
val Loss: 2.6404 LRAP: 0.1245 NDCG: 0.3120
EarlyStopping counter: 2 out of 50

Epoch 47/99
----------
train Loss: 2.6059 LRAP: 0.1114 NDCG: 0.3063
val Loss: 2.7121 LRAP: 0.1182 NDCG: 0.2993
EarlyStopping counter: 3 out of 50

Epoch 48/99
----------
train Loss: 2.5965 LRAP: 0.1105 NDCG: 0.3082
val Loss: 2.5787 LRAP: 0.1207 NDCG: 0.3156
Validation loss decreased (2.631349 --> 2.578702).  Saving model ...

Epoch 49/99
----------
train Loss: 2.5807 LRAP: 0.1051 NDCG: 0.3075
val Loss: 2.5893 LRAP: 0.0851 NDCG: 0.3190
EarlyStopping counter: 1 out of 50

Epoch 50/99
----------
train Loss: 2.5629 LRAP: 0.1097 NDCG: 0.3124
val Loss: 2.6950 LRAP: 0.0966 NDCG: 0.3087
EarlyStopping counter: 2 out of 50

Epoch 51/99
----------
train Loss: 2.5620 LRAP: 0.1094 NDCG: 0.3136
val Loss: 2.5537 LRAP: 0.1207 NDCG: 0.3202
Validation loss decreased (2.578702 --> 2.553689).  Saving model ...

Epoch 52/99
----------
train Loss: 2.5493 LRAP: 0.1081 NDCG: 0.3139
val Loss: 2.6211 LRAP: 0.0813 NDCG: 0.3142
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 2.5370 LRAP: 0.1029 NDCG: 0.3161
val Loss: 2.5631 LRAP: 0.1207 NDCG: 0.3226
EarlyStopping counter: 2 out of 50

Epoch 54/99
----------
train Loss: 2.5207 LRAP: 0.1092 NDCG: 0.3211
val Loss: 2.6324 LRAP: 0.1360 NDCG: 0.3370
EarlyStopping counter: 3 out of 50

Epoch 55/99
----------
train Loss: 2.5068 LRAP: 0.1116 NDCG: 0.3208
val Loss: 2.6610 LRAP: 0.1144 NDCG: 0.3216
EarlyStopping counter: 4 out of 50

Epoch 56/99
----------
train Loss: 2.4805 LRAP: 0.1116 NDCG: 0.3226
val Loss: 2.5171 LRAP: 0.1220 NDCG: 0.3316
Validation loss decreased (2.553689 --> 2.517064).  Saving model ...

Epoch 57/99
----------
train Loss: 2.4870 LRAP: 0.1119 NDCG: 0.3224
val Loss: 2.4969 LRAP: 0.1194 NDCG: 0.3247
Validation loss decreased (2.517064 --> 2.496929).  Saving model ...

Epoch 58/99
----------
train Loss: 2.4683 LRAP: 0.1149 NDCG: 0.3233
val Loss: 2.5714 LRAP: 0.1080 NDCG: 0.3290
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 2.4584 LRAP: 0.1119 NDCG: 0.3263
val Loss: 2.8380 LRAP: 0.1563 NDCG: 0.3389
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 2.4443 LRAP: 0.1184 NDCG: 0.3329
val Loss: 2.5724 LRAP: 0.1245 NDCG: 0.3190
EarlyStopping counter: 3 out of 50

Epoch 61/99
----------
train Loss: 2.4162 LRAP: 0.1192 NDCG: 0.3331
val Loss: 2.5304 LRAP: 0.1334 NDCG: 0.3506
EarlyStopping counter: 4 out of 50

Epoch 62/99
----------
train Loss: 2.4134 LRAP: 0.1187 NDCG: 0.3329
val Loss: 2.5455 LRAP: 0.1245 NDCG: 0.3454
EarlyStopping counter: 5 out of 50

Epoch 63/99
----------
train Loss: 2.3692 LRAP: 0.1154 NDCG: 0.3334
val Loss: 2.4086 LRAP: 0.1347 NDCG: 0.3372
Validation loss decreased (2.496929 --> 2.408634).  Saving model ...

Epoch 64/99
----------
train Loss: 2.3393 LRAP: 0.1187 NDCG: 0.3346
val Loss: 2.3775 LRAP: 0.1347 NDCG: 0.3434
Validation loss decreased (2.408634 --> 2.377529).  Saving model ...

Epoch 65/99
----------
train Loss: 2.3267 LRAP: 0.1152 NDCG: 0.3379
val Loss: 2.3876 LRAP: 0.1372 NDCG: 0.3444
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 2.3381 LRAP: 0.1160 NDCG: 0.3361
val Loss: 2.3765 LRAP: 0.1321 NDCG: 0.3492
Validation loss decreased (2.377529 --> 2.376540).  Saving model ...

Epoch 67/99
----------
train Loss: 2.3162 LRAP: 0.1203 NDCG: 0.3367
val Loss: 2.3653 LRAP: 0.1309 NDCG: 0.3467
Validation loss decreased (2.376540 --> 2.365323).  Saving model ...

Epoch 68/99
----------
train Loss: 2.3227 LRAP: 0.1182 NDCG: 0.3385
val Loss: 2.3644 LRAP: 0.1347 NDCG: 0.3488
Validation loss decreased (2.365323 --> 2.364387).  Saving model ...

Epoch 69/99
----------
train Loss: 2.3218 LRAP: 0.1163 NDCG: 0.3396
val Loss: 2.3703 LRAP: 0.1334 NDCG: 0.3488
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 2.3101 LRAP: 0.1190 NDCG: 0.3410
val Loss: 2.3670 LRAP: 0.1334 NDCG: 0.3487
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 2.3021 LRAP: 0.1171 NDCG: 0.3422
val Loss: 2.3566 LRAP: 0.1347 NDCG: 0.3527
Validation loss decreased (2.364387 --> 2.356585).  Saving model ...

Epoch 72/99
----------
train Loss: 2.2992 LRAP: 0.1152 NDCG: 0.3414
val Loss: 2.3548 LRAP: 0.1347 NDCG: 0.3493
Validation loss decreased (2.356585 --> 2.354831).  Saving model ...

Epoch 73/99
----------
train Loss: 2.3000 LRAP: 0.1217 NDCG: 0.3429
val Loss: 2.3556 LRAP: 0.1296 NDCG: 0.3470
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 2.2969 LRAP: 0.1222 NDCG: 0.3419
val Loss: 2.3616 LRAP: 0.1385 NDCG: 0.3568
EarlyStopping counter: 2 out of 50

Epoch 75/99
----------
train Loss: 2.2925 LRAP: 0.1239 NDCG: 0.3442
val Loss: 2.3540 LRAP: 0.1360 NDCG: 0.3505
Validation loss decreased (2.354831 --> 2.354029).  Saving model ...

Epoch 76/99
----------
train Loss: 2.2720 LRAP: 0.1209 NDCG: 0.3435
val Loss: 2.3495 LRAP: 0.1296 NDCG: 0.3488
Validation loss decreased (2.354029 --> 2.349458).  Saving model ...

Epoch 77/99
----------
train Loss: 2.2915 LRAP: 0.1187 NDCG: 0.3442
val Loss: 2.3491 LRAP: 0.1410 NDCG: 0.3539
Validation loss decreased (2.349458 --> 2.349134).  Saving model ...

Epoch 78/99
----------
train Loss: 2.2703 LRAP: 0.1217 NDCG: 0.3446
val Loss: 2.3593 LRAP: 0.1372 NDCG: 0.3594
EarlyStopping counter: 1 out of 50

Epoch 79/99
----------
train Loss: 2.2745 LRAP: 0.1217 NDCG: 0.3482
val Loss: 2.3524 LRAP: 0.1347 NDCG: 0.3554
EarlyStopping counter: 2 out of 50

Epoch 80/99
----------
train Loss: 2.2662 LRAP: 0.1217 NDCG: 0.3455
val Loss: 2.3417 LRAP: 0.1423 NDCG: 0.3568
Validation loss decreased (2.349134 --> 2.341697).  Saving model ...

Epoch 81/99
----------
train Loss: 2.2546 LRAP: 0.1222 NDCG: 0.3454
val Loss: 2.3482 LRAP: 0.1283 NDCG: 0.3544
EarlyStopping counter: 1 out of 50

Epoch 82/99
----------
train Loss: 2.2515 LRAP: 0.1203 NDCG: 0.3448
val Loss: 2.3398 LRAP: 0.1385 NDCG: 0.3612
Validation loss decreased (2.341697 --> 2.339777).  Saving model ...

Epoch 83/99
----------
train Loss: 2.2409 LRAP: 0.1236 NDCG: 0.3491
val Loss: 2.3471 LRAP: 0.1347 NDCG: 0.3537
EarlyStopping counter: 1 out of 50

Epoch 84/99
----------
train Loss: 2.2490 LRAP: 0.1212 NDCG: 0.3456
val Loss: 2.3398 LRAP: 0.1474 NDCG: 0.3618
Validation loss decreased (2.339777 --> 2.339755).  Saving model ...

Epoch 85/99
----------
train Loss: 2.2398 LRAP: 0.1209 NDCG: 0.3510
val Loss: 2.3398 LRAP: 0.1410 NDCG: 0.3577
EarlyStopping counter: 1 out of 50

Epoch 86/99
----------
train Loss: 2.2391 LRAP: 0.1214 NDCG: 0.3514
val Loss: 2.3361 LRAP: 0.1499 NDCG: 0.3615
Validation loss decreased (2.339755 --> 2.336131).  Saving model ...

Epoch 87/99
----------
train Loss: 2.2276 LRAP: 0.1255 NDCG: 0.3492
val Loss: 2.3355 LRAP: 0.1474 NDCG: 0.3655
Validation loss decreased (2.336131 --> 2.335462).  Saving model ...

Epoch 88/99
----------
train Loss: 2.2379 LRAP: 0.1212 NDCG: 0.3526
val Loss: 2.3306 LRAP: 0.1410 NDCG: 0.3623
Validation loss decreased (2.335462 --> 2.330620).  Saving model ...

Epoch 89/99
----------
train Loss: 2.2308 LRAP: 0.1192 NDCG: 0.3529
val Loss: 2.3427 LRAP: 0.1449 NDCG: 0.3664
EarlyStopping counter: 1 out of 50

Epoch 90/99
----------
train Loss: 2.2210 LRAP: 0.1217 NDCG: 0.3529
val Loss: 2.3378 LRAP: 0.1487 NDCG: 0.3661
EarlyStopping counter: 2 out of 50

Epoch 91/99
----------
train Loss: 2.2030 LRAP: 0.1198 NDCG: 0.3538
val Loss: 2.3265 LRAP: 0.1436 NDCG: 0.3616
Validation loss decreased (2.330620 --> 2.326545).  Saving model ...

Epoch 92/99
----------
train Loss: 2.2280 LRAP: 0.1252 NDCG: 0.3534
val Loss: 2.3229 LRAP: 0.1512 NDCG: 0.3677
Validation loss decreased (2.326545 --> 2.322931).  Saving model ...

Epoch 93/99
----------
train Loss: 2.2096 LRAP: 0.1236 NDCG: 0.3544
val Loss: 2.3331 LRAP: 0.1385 NDCG: 0.3613
EarlyStopping counter: 1 out of 50

Epoch 94/99
----------
train Loss: 2.2154 LRAP: 0.1241 NDCG: 0.3546
val Loss: 2.3227 LRAP: 0.1474 NDCG: 0.3671
Validation loss decreased (2.322931 --> 2.322740).  Saving model ...

Epoch 95/99
----------
train Loss: 2.2061 LRAP: 0.1261 NDCG: 0.3559
val Loss: 2.3401 LRAP: 0.1398 NDCG: 0.3698
EarlyStopping counter: 1 out of 50

Epoch 96/99
----------
train Loss: 2.2052 LRAP: 0.1261 NDCG: 0.3545
val Loss: 2.3217 LRAP: 0.1499 NDCG: 0.3670
Validation loss decreased (2.322740 --> 2.321672).  Saving model ...

Epoch 97/99
----------
train Loss: 2.2051 LRAP: 0.1220 NDCG: 0.3552
val Loss: 2.3231 LRAP: 0.1499 NDCG: 0.3652
EarlyStopping counter: 1 out of 50

Epoch 98/99
----------
train Loss: 2.1887 LRAP: 0.1252 NDCG: 0.3557
val Loss: 2.3428 LRAP: 0.1512 NDCG: 0.3705
EarlyStopping counter: 2 out of 50

Epoch 99/99
----------
train Loss: 2.1968 LRAP: 0.1263 NDCG: 0.3571
val Loss: 2.3116 LRAP: 0.1474 NDCG: 0.3673
Validation loss decreased (2.321672 --> 2.311559).  Saving model ...

Training complete in 2m 35s
Best val loss: 2.311559, best LRAP score: 0.7658

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4991 LRAP: 0.0000 NDCG: 0.1754
val Loss: 4.1195 LRAP: 0.0000 NDCG: 0.2080
Validation loss decreased (0.000000 --> 4.119549).  Saving model ...

Epoch 1/99
----------
train Loss: 3.8387 LRAP: 0.0000 NDCG: 0.2148
val Loss: 4.3098 LRAP: 0.0000 NDCG: 0.2207
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.7157 LRAP: 0.0011 NDCG: 0.2302
val Loss: 3.8074 LRAP: 0.0013 NDCG: 0.2386
Validation loss decreased (4.119549 --> 3.807449).  Saving model ...

Epoch 3/99
----------
train Loss: 3.5883 LRAP: 0.0071 NDCG: 0.2326
val Loss: 3.6145 LRAP: 0.0051 NDCG: 0.2336
Validation loss decreased (3.807449 --> 3.614483).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5151 LRAP: 0.0076 NDCG: 0.2415
val Loss: 3.5547 LRAP: 0.0064 NDCG: 0.2420
Validation loss decreased (3.614483 --> 3.554736).  Saving model ...

Epoch 5/99
----------
train Loss: 3.4228 LRAP: 0.0240 NDCG: 0.2467
val Loss: 3.4702 LRAP: 0.0597 NDCG: 0.2585
Validation loss decreased (3.554736 --> 3.470201).  Saving model ...

Epoch 6/99
----------
train Loss: 3.3768 LRAP: 0.0376 NDCG: 0.2481
val Loss: 3.6397 LRAP: 0.0051 NDCG: 0.2391
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.2960 LRAP: 0.0291 NDCG: 0.2611
val Loss: 3.3461 LRAP: 0.0508 NDCG: 0.2451
Validation loss decreased (3.470201 --> 3.346118).  Saving model ...

Epoch 8/99
----------
train Loss: 3.2199 LRAP: 0.0515 NDCG: 0.2613
val Loss: 3.0823 LRAP: 0.0165 NDCG: 0.2719
Validation loss decreased (3.346118 --> 3.082316).  Saving model ...

Epoch 9/99
----------
train Loss: 3.1336 LRAP: 0.0479 NDCG: 0.2691
val Loss: 3.2291 LRAP: 0.0851 NDCG: 0.2641
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.0786 LRAP: 0.0525 NDCG: 0.2754
val Loss: 3.1573 LRAP: 0.1258 NDCG: 0.2640
EarlyStopping counter: 2 out of 50

Epoch 11/99
----------
train Loss: 3.0328 LRAP: 0.0585 NDCG: 0.2789
val Loss: 3.0342 LRAP: 0.0152 NDCG: 0.2744
Validation loss decreased (3.082316 --> 3.034162).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0076 LRAP: 0.0613 NDCG: 0.2828
val Loss: 3.0276 LRAP: 0.0991 NDCG: 0.2774
Validation loss decreased (3.034162 --> 3.027554).  Saving model ...

Epoch 13/99
----------
train Loss: 2.9503 LRAP: 0.0547 NDCG: 0.2858
val Loss: 2.9937 LRAP: 0.1042 NDCG: 0.2695
Validation loss decreased (3.027554 --> 2.993734).  Saving model ...

Epoch 14/99
----------
train Loss: 2.9126 LRAP: 0.0653 NDCG: 0.2875
val Loss: 2.8541 LRAP: 0.0864 NDCG: 0.2942
Validation loss decreased (2.993734 --> 2.854100).  Saving model ...

Epoch 15/99
----------
train Loss: 2.8848 LRAP: 0.0610 NDCG: 0.2922
val Loss: 2.8584 LRAP: 0.0737 NDCG: 0.2914
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.8666 LRAP: 0.0686 NDCG: 0.2942
val Loss: 2.7733 LRAP: 0.1233 NDCG: 0.3100
Validation loss decreased (2.854100 --> 2.773320).  Saving model ...

Epoch 17/99
----------
train Loss: 2.8117 LRAP: 0.0675 NDCG: 0.2987
val Loss: 2.8236 LRAP: 0.1067 NDCG: 0.3053
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 2.7460 LRAP: 0.0746 NDCG: 0.3017
val Loss: 2.6736 LRAP: 0.0559 NDCG: 0.3013
Validation loss decreased (2.773320 --> 2.673646).  Saving model ...

Epoch 19/99
----------
train Loss: 2.7214 LRAP: 0.0806 NDCG: 0.3024
val Loss: 2.6496 LRAP: 0.1245 NDCG: 0.3154
Validation loss decreased (2.673646 --> 2.649644).  Saving model ...

Epoch 20/99
----------
train Loss: 2.6832 LRAP: 0.0730 NDCG: 0.3051
val Loss: 2.6915 LRAP: 0.1156 NDCG: 0.2999
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.6493 LRAP: 0.0781 NDCG: 0.3073
val Loss: 2.5670 LRAP: 0.1169 NDCG: 0.3218
Validation loss decreased (2.649644 --> 2.566990).  Saving model ...

Epoch 22/99
----------
train Loss: 2.6297 LRAP: 0.0757 NDCG: 0.3113
val Loss: 2.6087 LRAP: 0.0991 NDCG: 0.3160
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.5924 LRAP: 0.0836 NDCG: 0.3114
val Loss: 2.5716 LRAP: 0.1296 NDCG: 0.3320
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 2.5603 LRAP: 0.0888 NDCG: 0.3148
val Loss: 2.5268 LRAP: 0.1309 NDCG: 0.3285
Validation loss decreased (2.566990 --> 2.526820).  Saving model ...

Epoch 25/99
----------
train Loss: 2.5252 LRAP: 0.0841 NDCG: 0.3184
val Loss: 2.5333 LRAP: 0.1321 NDCG: 0.3453
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 2.4911 LRAP: 0.0847 NDCG: 0.3209
val Loss: 2.5312 LRAP: 0.1283 NDCG: 0.3261
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 2.4671 LRAP: 0.0879 NDCG: 0.3248
val Loss: 2.4984 LRAP: 0.1194 NDCG: 0.3407
Validation loss decreased (2.526820 --> 2.498389).  Saving model ...

Epoch 28/99
----------
train Loss: 2.4391 LRAP: 0.0888 NDCG: 0.3252
val Loss: 2.4216 LRAP: 0.1309 NDCG: 0.3392
Validation loss decreased (2.498389 --> 2.421577).  Saving model ...

Epoch 29/99
----------
train Loss: 2.4034 LRAP: 0.0947 NDCG: 0.3285
val Loss: 2.4640 LRAP: 0.1296 NDCG: 0.3404
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.3789 LRAP: 0.0915 NDCG: 0.3322
val Loss: 2.4067 LRAP: 0.1271 NDCG: 0.3432
Validation loss decreased (2.421577 --> 2.406672).  Saving model ...

Epoch 31/99
----------
train Loss: 2.3532 LRAP: 0.0953 NDCG: 0.3302
val Loss: 2.4534 LRAP: 0.1245 NDCG: 0.3345
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.3273 LRAP: 0.0947 NDCG: 0.3338
val Loss: 2.3488 LRAP: 0.1398 NDCG: 0.3433
Validation loss decreased (2.406672 --> 2.348816).  Saving model ...

Epoch 33/99
----------
train Loss: 2.2724 LRAP: 0.0972 NDCG: 0.3357
val Loss: 2.3715 LRAP: 0.1525 NDCG: 0.3520
EarlyStopping counter: 1 out of 50

Epoch 34/99
----------
train Loss: 2.2280 LRAP: 0.1059 NDCG: 0.3448
val Loss: 2.4197 LRAP: 0.1233 NDCG: 0.3537
EarlyStopping counter: 2 out of 50

Epoch 35/99
----------
train Loss: 2.2353 LRAP: 0.1005 NDCG: 0.3406
val Loss: 2.3385 LRAP: 0.1347 NDCG: 0.3433
Validation loss decreased (2.348816 --> 2.338469).  Saving model ...

Epoch 36/99
----------
train Loss: 2.1987 LRAP: 0.0988 NDCG: 0.3419
val Loss: 2.3594 LRAP: 0.1499 NDCG: 0.3642
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 2.1703 LRAP: 0.0986 NDCG: 0.3443
val Loss: 2.3147 LRAP: 0.1360 NDCG: 0.3497
Validation loss decreased (2.338469 --> 2.314661).  Saving model ...

Epoch 38/99
----------
train Loss: 2.1468 LRAP: 0.1007 NDCG: 0.3476
val Loss: 2.3477 LRAP: 0.1385 NDCG: 0.3583
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 2.1171 LRAP: 0.0983 NDCG: 0.3481
val Loss: 2.3263 LRAP: 0.1449 NDCG: 0.3685
EarlyStopping counter: 2 out of 50

Epoch 40/99
----------
train Loss: 2.0682 LRAP: 0.0947 NDCG: 0.3516
val Loss: 2.3623 LRAP: 0.1614 NDCG: 0.3780
EarlyStopping counter: 3 out of 50

Epoch 41/99
----------
train Loss: 2.0793 LRAP: 0.1054 NDCG: 0.3564
val Loss: 2.2804 LRAP: 0.1360 NDCG: 0.3641
Validation loss decreased (2.314661 --> 2.280431).  Saving model ...

Epoch 42/99
----------
train Loss: 2.0438 LRAP: 0.1067 NDCG: 0.3543
val Loss: 2.2945 LRAP: 0.1461 NDCG: 0.3756
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 2.0152 LRAP: 0.1062 NDCG: 0.3574
val Loss: 2.3118 LRAP: 0.1512 NDCG: 0.3736
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 2.0150 LRAP: 0.1035 NDCG: 0.3595
val Loss: 2.2819 LRAP: 0.1512 NDCG: 0.3936
EarlyStopping counter: 3 out of 50

Epoch 45/99
----------
train Loss: 1.9670 LRAP: 0.1037 NDCG: 0.3601
val Loss: 2.2723 LRAP: 0.1614 NDCG: 0.3862
Validation loss decreased (2.280431 --> 2.272342).  Saving model ...

Epoch 46/99
----------
train Loss: 1.9399 LRAP: 0.1048 NDCG: 0.3590
val Loss: 2.2242 LRAP: 0.1588 NDCG: 0.3995
Validation loss decreased (2.272342 --> 2.224233).  Saving model ...

Epoch 47/99
----------
train Loss: 1.9417 LRAP: 0.0967 NDCG: 0.3596
val Loss: 2.2796 LRAP: 0.1550 NDCG: 0.3970
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 1.9007 LRAP: 0.1056 NDCG: 0.3652
val Loss: 2.2149 LRAP: 0.1537 NDCG: 0.3975
Validation loss decreased (2.224233 --> 2.214923).  Saving model ...

Epoch 49/99
----------
train Loss: 1.8873 LRAP: 0.1062 NDCG: 0.3670
val Loss: 2.2783 LRAP: 0.1499 NDCG: 0.3956
EarlyStopping counter: 1 out of 50

Epoch 50/99
----------
train Loss: 1.8435 LRAP: 0.1059 NDCG: 0.3684
val Loss: 2.2705 LRAP: 0.1652 NDCG: 0.3983
EarlyStopping counter: 2 out of 50

Epoch 51/99
----------
train Loss: 1.8233 LRAP: 0.1062 NDCG: 0.3678
val Loss: 2.2663 LRAP: 0.1576 NDCG: 0.3903
EarlyStopping counter: 3 out of 50

Epoch 52/99
----------
train Loss: 1.8260 LRAP: 0.1045 NDCG: 0.3692
val Loss: 2.3525 LRAP: 0.1766 NDCG: 0.4265
EarlyStopping counter: 4 out of 50

Epoch 53/99
----------
train Loss: 1.7871 LRAP: 0.1122 NDCG: 0.3727
val Loss: 2.2204 LRAP: 0.1601 NDCG: 0.4007
EarlyStopping counter: 5 out of 50

Epoch 54/99
----------
train Loss: 1.7147 LRAP: 0.1157 NDCG: 0.3736
val Loss: 2.1732 LRAP: 0.1665 NDCG: 0.4106
Validation loss decreased (2.214923 --> 2.173151).  Saving model ...

Epoch 55/99
----------
train Loss: 1.6716 LRAP: 0.1179 NDCG: 0.3744
val Loss: 2.1576 LRAP: 0.1804 NDCG: 0.4160
Validation loss decreased (2.173151 --> 2.157561).  Saving model ...

Epoch 56/99
----------
train Loss: 1.6312 LRAP: 0.1206 NDCG: 0.3778
val Loss: 2.1593 LRAP: 0.1753 NDCG: 0.4243
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 1.6331 LRAP: 0.1100 NDCG: 0.3781
val Loss: 2.1592 LRAP: 0.1881 NDCG: 0.4233
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 1.6317 LRAP: 0.1152 NDCG: 0.3783
val Loss: 2.1476 LRAP: 0.1690 NDCG: 0.4162
Validation loss decreased (2.157561 --> 2.147593).  Saving model ...

Epoch 59/99
----------
train Loss: 1.6146 LRAP: 0.1152 NDCG: 0.3769
val Loss: 2.1560 LRAP: 0.1766 NDCG: 0.4213
EarlyStopping counter: 1 out of 50

Epoch 60/99
----------
train Loss: 1.5946 LRAP: 0.1165 NDCG: 0.3783
val Loss: 2.1554 LRAP: 0.1855 NDCG: 0.4281
EarlyStopping counter: 2 out of 50

Epoch 61/99
----------
train Loss: 1.5851 LRAP: 0.1114 NDCG: 0.3788
val Loss: 2.1560 LRAP: 0.1830 NDCG: 0.4261
EarlyStopping counter: 3 out of 50

Epoch 62/99
----------
train Loss: 1.5838 LRAP: 0.1217 NDCG: 0.3826
val Loss: 2.1603 LRAP: 0.1842 NDCG: 0.4269
EarlyStopping counter: 4 out of 50

Epoch 63/99
----------
train Loss: 1.5749 LRAP: 0.1135 NDCG: 0.3783
val Loss: 2.1604 LRAP: 0.1792 NDCG: 0.4280
EarlyStopping counter: 5 out of 50

Epoch 64/99
----------
train Loss: 1.5555 LRAP: 0.1236 NDCG: 0.3827
val Loss: 2.1495 LRAP: 0.1830 NDCG: 0.4271
EarlyStopping counter: 6 out of 50

Epoch 65/99
----------
train Loss: 1.5585 LRAP: 0.1195 NDCG: 0.3809
val Loss: 2.1546 LRAP: 0.1868 NDCG: 0.4298
EarlyStopping counter: 7 out of 50

Epoch 66/99
----------
train Loss: 1.5425 LRAP: 0.1228 NDCG: 0.3806
val Loss: 2.1500 LRAP: 0.1881 NDCG: 0.4293
EarlyStopping counter: 8 out of 50

Epoch 67/99
----------
train Loss: 1.5455 LRAP: 0.1192 NDCG: 0.3799
val Loss: 2.1578 LRAP: 0.1893 NDCG: 0.4293
EarlyStopping counter: 9 out of 50

Epoch 68/99
----------
train Loss: 1.5574 LRAP: 0.1212 NDCG: 0.3838
val Loss: 2.1489 LRAP: 0.1855 NDCG: 0.4301
EarlyStopping counter: 10 out of 50

Epoch 69/99
----------
train Loss: 1.5355 LRAP: 0.1231 NDCG: 0.3808
val Loss: 2.1471 LRAP: 0.1830 NDCG: 0.4297
Validation loss decreased (2.147593 --> 2.147131).  Saving model ...

Epoch 70/99
----------
train Loss: 1.5360 LRAP: 0.1173 NDCG: 0.3834
val Loss: 2.1523 LRAP: 0.1881 NDCG: 0.4312
EarlyStopping counter: 1 out of 50

Epoch 71/99
----------
train Loss: 1.5422 LRAP: 0.1228 NDCG: 0.3845
val Loss: 2.1508 LRAP: 0.1830 NDCG: 0.4285
EarlyStopping counter: 2 out of 50

Epoch 72/99
----------
train Loss: 1.5478 LRAP: 0.1261 NDCG: 0.3820
val Loss: 2.1530 LRAP: 0.1881 NDCG: 0.4302
EarlyStopping counter: 3 out of 50

Epoch 73/99
----------
train Loss: 1.5218 LRAP: 0.1222 NDCG: 0.3820
val Loss: 2.1514 LRAP: 0.1906 NDCG: 0.4314
EarlyStopping counter: 4 out of 50

Epoch 74/99
----------
train Loss: 1.5457 LRAP: 0.1222 NDCG: 0.3819
val Loss: 2.1526 LRAP: 0.1855 NDCG: 0.4309
EarlyStopping counter: 5 out of 50

Epoch 75/99
----------
train Loss: 1.5410 LRAP: 0.1274 NDCG: 0.3826
val Loss: 2.1533 LRAP: 0.1855 NDCG: 0.4295
EarlyStopping counter: 6 out of 50

Epoch 76/99
----------
train Loss: 1.5381 LRAP: 0.1239 NDCG: 0.3824
val Loss: 2.1529 LRAP: 0.1881 NDCG: 0.4315
EarlyStopping counter: 7 out of 50

Epoch 77/99
----------
train Loss: 1.5299 LRAP: 0.1171 NDCG: 0.3848
val Loss: 2.1527 LRAP: 0.1881 NDCG: 0.4318
EarlyStopping counter: 8 out of 50

Epoch 78/99
----------
train Loss: 1.5283 LRAP: 0.1266 NDCG: 0.3807
val Loss: 2.1492 LRAP: 0.1855 NDCG: 0.4300
EarlyStopping counter: 9 out of 50

Epoch 79/99
----------
train Loss: 1.5458 LRAP: 0.1201 NDCG: 0.3809
val Loss: 2.1564 LRAP: 0.1855 NDCG: 0.4307
EarlyStopping counter: 10 out of 50

Epoch 80/99
----------
train Loss: 1.5375 LRAP: 0.1203 NDCG: 0.3813
val Loss: 2.1560 LRAP: 0.1906 NDCG: 0.4304
EarlyStopping counter: 11 out of 50

Epoch 81/99
----------
train Loss: 1.5366 LRAP: 0.1184 NDCG: 0.3821
val Loss: 2.1597 LRAP: 0.1881 NDCG: 0.4302
EarlyStopping counter: 12 out of 50

Epoch 82/99
----------
train Loss: 1.5360 LRAP: 0.1244 NDCG: 0.3826
val Loss: 2.1532 LRAP: 0.1830 NDCG: 0.4298
EarlyStopping counter: 13 out of 50

Epoch 83/99
----------
train Loss: 1.5379 LRAP: 0.1236 NDCG: 0.3826
val Loss: 2.1487 LRAP: 0.1868 NDCG: 0.4305
EarlyStopping counter: 14 out of 50

Epoch 84/99
----------
train Loss: 1.5348 LRAP: 0.1214 NDCG: 0.3801
val Loss: 2.1493 LRAP: 0.1881 NDCG: 0.4313
EarlyStopping counter: 15 out of 50

Epoch 85/99
----------
train Loss: 1.5343 LRAP: 0.1195 NDCG: 0.3808
val Loss: 2.1505 LRAP: 0.1881 NDCG: 0.4319
EarlyStopping counter: 16 out of 50

Epoch 86/99
----------
train Loss: 1.5397 LRAP: 0.1217 NDCG: 0.3812
val Loss: 2.1532 LRAP: 0.1855 NDCG: 0.4316
EarlyStopping counter: 17 out of 50

Epoch 87/99
----------
train Loss: 1.5251 LRAP: 0.1233 NDCG: 0.3820
val Loss: 2.1517 LRAP: 0.1868 NDCG: 0.4304
EarlyStopping counter: 18 out of 50

Epoch 88/99
----------
train Loss: 1.5330 LRAP: 0.1198 NDCG: 0.3824
val Loss: 2.1491 LRAP: 0.1868 NDCG: 0.4299
EarlyStopping counter: 19 out of 50

Epoch 89/99
----------
train Loss: 1.5267 LRAP: 0.1271 NDCG: 0.3822
val Loss: 2.1517 LRAP: 0.1842 NDCG: 0.4279
EarlyStopping counter: 20 out of 50

Epoch 90/99
----------
train Loss: 1.5343 LRAP: 0.1201 NDCG: 0.3826
val Loss: 2.1509 LRAP: 0.1881 NDCG: 0.4288
EarlyStopping counter: 21 out of 50

Epoch 91/99
----------
train Loss: 1.5194 LRAP: 0.1124 NDCG: 0.3801
val Loss: 2.1496 LRAP: 0.1855 NDCG: 0.4282
EarlyStopping counter: 22 out of 50

Epoch 92/99
----------
train Loss: 1.5320 LRAP: 0.1141 NDCG: 0.3820
val Loss: 2.1518 LRAP: 0.1868 NDCG: 0.4292
EarlyStopping counter: 23 out of 50

Epoch 93/99
----------
train Loss: 1.5416 LRAP: 0.1258 NDCG: 0.3818
val Loss: 2.1491 LRAP: 0.1868 NDCG: 0.4307
EarlyStopping counter: 24 out of 50

Epoch 94/99
----------
train Loss: 1.5328 LRAP: 0.1263 NDCG: 0.3835
val Loss: 2.1486 LRAP: 0.1893 NDCG: 0.4314
EarlyStopping counter: 25 out of 50

Epoch 95/99
----------
train Loss: 1.5312 LRAP: 0.1228 NDCG: 0.3821
val Loss: 2.1594 LRAP: 0.1893 NDCG: 0.4312
EarlyStopping counter: 26 out of 50

Epoch 96/99
----------
train Loss: 1.5323 LRAP: 0.1228 NDCG: 0.3814
val Loss: 2.1512 LRAP: 0.1842 NDCG: 0.4299
EarlyStopping counter: 27 out of 50

Epoch 97/99
----------
train Loss: 1.5380 LRAP: 0.1263 NDCG: 0.3808
val Loss: 2.1543 LRAP: 0.1868 NDCG: 0.4318
EarlyStopping counter: 28 out of 50

Epoch 98/99
----------
train Loss: 1.5361 LRAP: 0.1192 NDCG: 0.3825
val Loss: 2.1517 LRAP: 0.1893 NDCG: 0.4292
EarlyStopping counter: 29 out of 50

Epoch 99/99
----------
train Loss: 1.5213 LRAP: 0.1171 NDCG: 0.3828
val Loss: 2.1519 LRAP: 0.1842 NDCG: 0.4297
EarlyStopping counter: 30 out of 50

Training complete in 2m 38s
Best val loss: 2.147131, best LRAP score: 0.8065

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.6102 LRAP: 0.0000 NDCG: 0.1641
val Loss: 5.1479 LRAP: 0.0000 NDCG: 0.1479
Validation loss decreased (0.000000 --> 5.147902).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0554 LRAP: 0.0016 NDCG: 0.1898
val Loss: 4.6312 LRAP: 0.0076 NDCG: 0.1956
Validation loss decreased (5.147902 --> 4.631236).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8718 LRAP: 0.0052 NDCG: 0.2107
val Loss: 4.7244 LRAP: 0.0051 NDCG: 0.2295
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.7595 LRAP: 0.0054 NDCG: 0.2118
val Loss: 5.8042 LRAP: 0.0000 NDCG: 0.1646
EarlyStopping counter: 2 out of 50

Epoch 4/99
----------
train Loss: 3.6807 LRAP: 0.0041 NDCG: 0.2172
val Loss: 3.8556 LRAP: 0.0076 NDCG: 0.2344
Validation loss decreased (4.631236 --> 3.855629).  Saving model ...

Epoch 5/99
----------
train Loss: 3.6186 LRAP: 0.0071 NDCG: 0.2217
val Loss: 5.9278 LRAP: 0.0000 NDCG: 0.1935
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.6003 LRAP: 0.0068 NDCG: 0.2200
val Loss: 7.9535 LRAP: 0.0089 NDCG: 0.2084
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.5596 LRAP: 0.0090 NDCG: 0.2228
val Loss: 5.1633 LRAP: 0.0013 NDCG: 0.1506
EarlyStopping counter: 3 out of 50

Epoch 8/99
----------
train Loss: 3.5266 LRAP: 0.0125 NDCG: 0.2276
val Loss: 4.8416 LRAP: 0.0025 NDCG: 0.1939
EarlyStopping counter: 4 out of 50

Epoch 9/99
----------
train Loss: 3.4721 LRAP: 0.0185 NDCG: 0.2268
val Loss: 4.6471 LRAP: 0.0051 NDCG: 0.2001
EarlyStopping counter: 5 out of 50

Epoch 10/99
----------
train Loss: 3.4238 LRAP: 0.0191 NDCG: 0.2322
val Loss: 3.6129 LRAP: 0.0089 NDCG: 0.2254
Validation loss decreased (3.855629 --> 3.612879).  Saving model ...

Epoch 11/99
----------
train Loss: 3.4004 LRAP: 0.0231 NDCG: 0.2317
val Loss: 3.6672 LRAP: 0.0521 NDCG: 0.2312
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.3814 LRAP: 0.0180 NDCG: 0.2325
val Loss: 3.6531 LRAP: 0.0076 NDCG: 0.2200
EarlyStopping counter: 2 out of 50

Epoch 13/99
----------
train Loss: 3.3691 LRAP: 0.0207 NDCG: 0.2340
val Loss: 3.5987 LRAP: 0.0673 NDCG: 0.2237
Validation loss decreased (3.612879 --> 3.598697).  Saving model ...

Epoch 14/99
----------
train Loss: 3.3693 LRAP: 0.0229 NDCG: 0.2349
val Loss: 3.6201 LRAP: 0.0076 NDCG: 0.2138
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 3.3560 LRAP: 0.0237 NDCG: 0.2341
val Loss: 3.3761 LRAP: 0.0152 NDCG: 0.2448
Validation loss decreased (3.598697 --> 3.376053).  Saving model ...

Epoch 16/99
----------
train Loss: 3.3603 LRAP: 0.0321 NDCG: 0.2364
val Loss: 3.4683 LRAP: 0.0318 NDCG: 0.2322
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 3.3351 LRAP: 0.0308 NDCG: 0.2377
val Loss: 3.8607 LRAP: 0.0102 NDCG: 0.2004
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 3.3187 LRAP: 0.0272 NDCG: 0.2396
val Loss: 3.2825 LRAP: 0.0076 NDCG: 0.2400
Validation loss decreased (3.376053 --> 3.282524).  Saving model ...

Epoch 19/99
----------
train Loss: 3.3210 LRAP: 0.0278 NDCG: 0.2381
val Loss: 3.9801 LRAP: 0.0762 NDCG: 0.2003
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.3118 LRAP: 0.0289 NDCG: 0.2380
val Loss: 3.4466 LRAP: 0.0102 NDCG: 0.2511
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 3.3114 LRAP: 0.0368 NDCG: 0.2398
val Loss: 3.4027 LRAP: 0.0267 NDCG: 0.2313
EarlyStopping counter: 3 out of 50

Epoch 22/99
----------
train Loss: 3.2830 LRAP: 0.0308 NDCG: 0.2414
val Loss: 3.6450 LRAP: 0.0953 NDCG: 0.2215
EarlyStopping counter: 4 out of 50

Epoch 23/99
----------
train Loss: 3.2702 LRAP: 0.0411 NDCG: 0.2439
val Loss: 3.9802 LRAP: 0.0864 NDCG: 0.1835
EarlyStopping counter: 5 out of 50

Epoch 24/99
----------
train Loss: 3.2707 LRAP: 0.0400 NDCG: 0.2432
val Loss: 3.1961 LRAP: 0.0635 NDCG: 0.2498
Validation loss decreased (3.282524 --> 3.196084).  Saving model ...

Epoch 25/99
----------
train Loss: 3.2514 LRAP: 0.0438 NDCG: 0.2452
val Loss: 3.1760 LRAP: 0.0623 NDCG: 0.2467
Validation loss decreased (3.196084 --> 3.175995).  Saving model ...

Epoch 26/99
----------
train Loss: 3.2421 LRAP: 0.0436 NDCG: 0.2453
val Loss: 3.1958 LRAP: 0.0407 NDCG: 0.2433
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.2463 LRAP: 0.0463 NDCG: 0.2454
val Loss: 3.2705 LRAP: 0.0902 NDCG: 0.2455
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 3.2469 LRAP: 0.0479 NDCG: 0.2455
val Loss: 3.1907 LRAP: 0.0470 NDCG: 0.2453
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 3.2436 LRAP: 0.0452 NDCG: 0.2458
val Loss: 3.1604 LRAP: 0.0559 NDCG: 0.2477
Validation loss decreased (3.175995 --> 3.160422).  Saving model ...

Epoch 30/99
----------
train Loss: 3.2336 LRAP: 0.0447 NDCG: 0.2459
val Loss: 3.3664 LRAP: 0.1055 NDCG: 0.2427
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 3.2334 LRAP: 0.0485 NDCG: 0.2455
val Loss: 3.1635 LRAP: 0.0470 NDCG: 0.2486
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 3.2177 LRAP: 0.0493 NDCG: 0.2475
val Loss: 3.2270 LRAP: 0.0826 NDCG: 0.2411
EarlyStopping counter: 3 out of 50

Epoch 33/99
----------
train Loss: 3.2211 LRAP: 0.0498 NDCG: 0.2460
val Loss: 3.1602 LRAP: 0.0712 NDCG: 0.2480
Validation loss decreased (3.160422 --> 3.160204).  Saving model ...

Epoch 34/99
----------
train Loss: 3.2125 LRAP: 0.0455 NDCG: 0.2478
val Loss: 3.1599 LRAP: 0.0572 NDCG: 0.2485
Validation loss decreased (3.160204 --> 3.159942).  Saving model ...

Epoch 35/99
----------
train Loss: 3.2095 LRAP: 0.0449 NDCG: 0.2490
val Loss: 3.1830 LRAP: 0.0508 NDCG: 0.2515
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 3.2249 LRAP: 0.0479 NDCG: 0.2481
val Loss: 3.2212 LRAP: 0.0775 NDCG: 0.2427
EarlyStopping counter: 2 out of 50

Epoch 37/99
----------
train Loss: 3.2172 LRAP: 0.0425 NDCG: 0.2472
val Loss: 3.1284 LRAP: 0.0750 NDCG: 0.2504
Validation loss decreased (3.159942 --> 3.128403).  Saving model ...

Epoch 38/99
----------
train Loss: 3.2260 LRAP: 0.0447 NDCG: 0.2485
val Loss: 3.1723 LRAP: 0.0712 NDCG: 0.2477
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 3.2122 LRAP: 0.0520 NDCG: 0.2484
val Loss: 3.1500 LRAP: 0.0686 NDCG: 0.2578
EarlyStopping counter: 2 out of 50

Epoch 40/99
----------
train Loss: 3.2016 LRAP: 0.0485 NDCG: 0.2500
val Loss: 3.1503 LRAP: 0.0623 NDCG: 0.2569
EarlyStopping counter: 3 out of 50

Epoch 41/99
----------
train Loss: 3.2111 LRAP: 0.0479 NDCG: 0.2478
val Loss: 3.2470 LRAP: 0.0940 NDCG: 0.2467
EarlyStopping counter: 4 out of 50

Epoch 42/99
----------
train Loss: 3.1904 LRAP: 0.0531 NDCG: 0.2503
val Loss: 3.1537 LRAP: 0.0851 NDCG: 0.2493
EarlyStopping counter: 5 out of 50

Epoch 43/99
----------
train Loss: 3.2007 LRAP: 0.0506 NDCG: 0.2509
val Loss: 3.1085 LRAP: 0.0661 NDCG: 0.2507
Validation loss decreased (3.128403 --> 3.108477).  Saving model ...

Epoch 44/99
----------
train Loss: 3.1875 LRAP: 0.0490 NDCG: 0.2512
val Loss: 3.1102 LRAP: 0.0648 NDCG: 0.2537
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 3.1845 LRAP: 0.0528 NDCG: 0.2494
val Loss: 3.1092 LRAP: 0.0750 NDCG: 0.2529
EarlyStopping counter: 2 out of 50

Epoch 46/99
----------
train Loss: 3.1855 LRAP: 0.0536 NDCG: 0.2512
val Loss: 3.1102 LRAP: 0.0737 NDCG: 0.2522
EarlyStopping counter: 3 out of 50

Epoch 47/99
----------
train Loss: 3.1915 LRAP: 0.0520 NDCG: 0.2506
val Loss: 3.1077 LRAP: 0.0750 NDCG: 0.2547
Validation loss decreased (3.108477 --> 3.107700).  Saving model ...

Epoch 48/99
----------
train Loss: 3.1896 LRAP: 0.0520 NDCG: 0.2518
val Loss: 3.1069 LRAP: 0.0724 NDCG: 0.2538
Validation loss decreased (3.107700 --> 3.106935).  Saving model ...

Epoch 49/99
----------
train Loss: 3.1763 LRAP: 0.0498 NDCG: 0.2509
val Loss: 3.1058 LRAP: 0.0750 NDCG: 0.2562
Validation loss decreased (3.106935 --> 3.105761).  Saving model ...

Epoch 50/99
----------
train Loss: 3.1754 LRAP: 0.0528 NDCG: 0.2533
val Loss: 3.1067 LRAP: 0.0686 NDCG: 0.2533
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 3.1841 LRAP: 0.0547 NDCG: 0.2508
val Loss: 3.1058 LRAP: 0.0788 NDCG: 0.2547
Validation loss decreased (3.105761 --> 3.105751).  Saving model ...

Epoch 52/99
----------
train Loss: 3.1860 LRAP: 0.0509 NDCG: 0.2525
val Loss: 3.1009 LRAP: 0.0686 NDCG: 0.2555
Validation loss decreased (3.105751 --> 3.100938).  Saving model ...

Epoch 53/99
----------
train Loss: 3.1809 LRAP: 0.0515 NDCG: 0.2513
val Loss: 3.1011 LRAP: 0.0724 NDCG: 0.2551
EarlyStopping counter: 1 out of 50

Epoch 54/99
----------
train Loss: 3.1880 LRAP: 0.0493 NDCG: 0.2499
val Loss: 3.1019 LRAP: 0.0712 NDCG: 0.2555
EarlyStopping counter: 2 out of 50

Epoch 55/99
----------
train Loss: 3.1867 LRAP: 0.0498 NDCG: 0.2500
val Loss: 3.1029 LRAP: 0.0775 NDCG: 0.2548
EarlyStopping counter: 3 out of 50

Epoch 56/99
----------
train Loss: 3.1880 LRAP: 0.0531 NDCG: 0.2520
val Loss: 3.1022 LRAP: 0.0737 NDCG: 0.2554
EarlyStopping counter: 4 out of 50

Epoch 57/99
----------
train Loss: 3.1860 LRAP: 0.0496 NDCG: 0.2507
val Loss: 3.1005 LRAP: 0.0750 NDCG: 0.2546
Validation loss decreased (3.100938 --> 3.100481).  Saving model ...

Epoch 58/99
----------
train Loss: 3.1766 LRAP: 0.0493 NDCG: 0.2518
val Loss: 3.0998 LRAP: 0.0699 NDCG: 0.2556
Validation loss decreased (3.100481 --> 3.099809).  Saving model ...

Epoch 59/99
----------
train Loss: 3.1988 LRAP: 0.0525 NDCG: 0.2511
val Loss: 3.1010 LRAP: 0.0673 NDCG: 0.2555
EarlyStopping counter: 1 out of 50

Epoch 60/99
----------
train Loss: 3.1684 LRAP: 0.0487 NDCG: 0.2512
val Loss: 3.1001 LRAP: 0.0724 NDCG: 0.2572
EarlyStopping counter: 2 out of 50

Epoch 61/99
----------
train Loss: 3.1685 LRAP: 0.0545 NDCG: 0.2521
val Loss: 3.0985 LRAP: 0.0775 NDCG: 0.2562
Validation loss decreased (3.099809 --> 3.098499).  Saving model ...

Epoch 62/99
----------
train Loss: 3.1751 LRAP: 0.0504 NDCG: 0.2537
val Loss: 3.1011 LRAP: 0.0851 NDCG: 0.2551
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 3.1774 LRAP: 0.0561 NDCG: 0.2512
val Loss: 3.0959 LRAP: 0.0712 NDCG: 0.2562
Validation loss decreased (3.098499 --> 3.095898).  Saving model ...

Epoch 64/99
----------
train Loss: 3.1767 LRAP: 0.0574 NDCG: 0.2510
val Loss: 3.0979 LRAP: 0.0762 NDCG: 0.2546
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 3.1882 LRAP: 0.0572 NDCG: 0.2539
val Loss: 3.1001 LRAP: 0.0750 NDCG: 0.2563
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 3.1827 LRAP: 0.0561 NDCG: 0.2531
val Loss: 3.1033 LRAP: 0.0775 NDCG: 0.2562
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 3.1606 LRAP: 0.0528 NDCG: 0.2536
val Loss: 3.0943 LRAP: 0.0712 NDCG: 0.2578
Validation loss decreased (3.095898 --> 3.094276).  Saving model ...

Epoch 68/99
----------
train Loss: 3.1770 LRAP: 0.0504 NDCG: 0.2543
val Loss: 3.0931 LRAP: 0.0762 NDCG: 0.2581
Validation loss decreased (3.094276 --> 3.093113).  Saving model ...

Epoch 69/99
----------
train Loss: 3.1654 LRAP: 0.0569 NDCG: 0.2531
val Loss: 3.0963 LRAP: 0.0788 NDCG: 0.2577
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 3.1724 LRAP: 0.0547 NDCG: 0.2543
val Loss: 3.0970 LRAP: 0.0737 NDCG: 0.2548
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 3.1598 LRAP: 0.0564 NDCG: 0.2530
val Loss: 3.0982 LRAP: 0.0839 NDCG: 0.2563
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 3.1748 LRAP: 0.0523 NDCG: 0.2523
val Loss: 3.0942 LRAP: 0.0788 NDCG: 0.2582
EarlyStopping counter: 4 out of 50

Epoch 73/99
----------
train Loss: 3.1754 LRAP: 0.0550 NDCG: 0.2519
val Loss: 3.0919 LRAP: 0.0686 NDCG: 0.2579
Validation loss decreased (3.093113 --> 3.091907).  Saving model ...

Epoch 74/99
----------
train Loss: 3.1717 LRAP: 0.0517 NDCG: 0.2524
val Loss: 3.0941 LRAP: 0.0775 NDCG: 0.2563
EarlyStopping counter: 1 out of 50

Epoch 75/99
----------
train Loss: 3.1816 LRAP: 0.0555 NDCG: 0.2526
val Loss: 3.0871 LRAP: 0.0750 NDCG: 0.2585
Validation loss decreased (3.091907 --> 3.087080).  Saving model ...

Epoch 76/99
----------
train Loss: 3.1813 LRAP: 0.0531 NDCG: 0.2532
val Loss: 3.0882 LRAP: 0.0775 NDCG: 0.2574
EarlyStopping counter: 1 out of 50

Epoch 77/99
----------
train Loss: 3.1720 LRAP: 0.0542 NDCG: 0.2539
val Loss: 3.0913 LRAP: 0.0762 NDCG: 0.2579
EarlyStopping counter: 2 out of 50

Epoch 78/99
----------
train Loss: 3.1664 LRAP: 0.0585 NDCG: 0.2529
val Loss: 3.0962 LRAP: 0.0839 NDCG: 0.2580
EarlyStopping counter: 3 out of 50

Epoch 79/99
----------
train Loss: 3.1575 LRAP: 0.0553 NDCG: 0.2540
val Loss: 3.0862 LRAP: 0.0801 NDCG: 0.2591
Validation loss decreased (3.087080 --> 3.086187).  Saving model ...

Epoch 80/99
----------
train Loss: 3.1562 LRAP: 0.0487 NDCG: 0.2555
val Loss: 3.0845 LRAP: 0.0788 NDCG: 0.2584
Validation loss decreased (3.086187 --> 3.084463).  Saving model ...

Epoch 81/99
----------
train Loss: 3.1694 LRAP: 0.0523 NDCG: 0.2529
val Loss: 3.0801 LRAP: 0.0762 NDCG: 0.2575
Validation loss decreased (3.084463 --> 3.080107).  Saving model ...

Epoch 82/99
----------
train Loss: 3.1782 LRAP: 0.0525 NDCG: 0.2534
val Loss: 3.0857 LRAP: 0.0750 NDCG: 0.2595
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.1777 LRAP: 0.0561 NDCG: 0.2526
val Loss: 3.0830 LRAP: 0.0813 NDCG: 0.2586
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.1665 LRAP: 0.0553 NDCG: 0.2535
val Loss: 3.0857 LRAP: 0.0839 NDCG: 0.2588
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.1689 LRAP: 0.0555 NDCG: 0.2530
val Loss: 3.0823 LRAP: 0.0788 NDCG: 0.2592
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.1568 LRAP: 0.0547 NDCG: 0.2533
val Loss: 3.0870 LRAP: 0.0801 NDCG: 0.2593
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 3.1698 LRAP: 0.0569 NDCG: 0.2547
val Loss: 3.0813 LRAP: 0.0762 NDCG: 0.2599
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 3.1656 LRAP: 0.0569 NDCG: 0.2556
val Loss: 3.0815 LRAP: 0.0750 NDCG: 0.2607
EarlyStopping counter: 7 out of 50

Epoch 89/99
----------
train Loss: 3.1696 LRAP: 0.0496 NDCG: 0.2535
val Loss: 3.0827 LRAP: 0.0839 NDCG: 0.2591
EarlyStopping counter: 8 out of 50

Epoch 90/99
----------
train Loss: 3.1753 LRAP: 0.0610 NDCG: 0.2557
val Loss: 3.0812 LRAP: 0.0788 NDCG: 0.2600
EarlyStopping counter: 9 out of 50

Epoch 91/99
----------
train Loss: 3.1580 LRAP: 0.0566 NDCG: 0.2529
val Loss: 3.0848 LRAP: 0.0788 NDCG: 0.2590
EarlyStopping counter: 10 out of 50

Epoch 92/99
----------
train Loss: 3.1605 LRAP: 0.0553 NDCG: 0.2548
val Loss: 3.0811 LRAP: 0.0737 NDCG: 0.2609
EarlyStopping counter: 11 out of 50

Epoch 93/99
----------
train Loss: 3.1587 LRAP: 0.0512 NDCG: 0.2566
val Loss: 3.0790 LRAP: 0.0750 NDCG: 0.2610
Validation loss decreased (3.080107 --> 3.079026).  Saving model ...

Epoch 94/99
----------
train Loss: 3.1599 LRAP: 0.0583 NDCG: 0.2562
val Loss: 3.0784 LRAP: 0.0737 NDCG: 0.2599
Validation loss decreased (3.079026 --> 3.078395).  Saving model ...

Epoch 95/99
----------
train Loss: 3.1549 LRAP: 0.0515 NDCG: 0.2549
val Loss: 3.0795 LRAP: 0.0788 NDCG: 0.2593
EarlyStopping counter: 1 out of 50

Epoch 96/99
----------
train Loss: 3.1541 LRAP: 0.0476 NDCG: 0.2563
val Loss: 3.0795 LRAP: 0.0788 NDCG: 0.2604
EarlyStopping counter: 2 out of 50

Epoch 97/99
----------
train Loss: 3.1641 LRAP: 0.0591 NDCG: 0.2539
val Loss: 3.0807 LRAP: 0.0724 NDCG: 0.2590
EarlyStopping counter: 3 out of 50

Epoch 98/99
----------
train Loss: 3.1645 LRAP: 0.0550 NDCG: 0.2543
val Loss: 3.0784 LRAP: 0.0712 NDCG: 0.2592
Validation loss decreased (3.078395 --> 3.078376).  Saving model ...

Epoch 99/99
----------
train Loss: 3.1560 LRAP: 0.0572 NDCG: 0.2537
val Loss: 3.0776 LRAP: 0.0737 NDCG: 0.2594
Validation loss decreased (3.078376 --> 3.077595).  Saving model ...

Training complete in 3m 8s
Best val loss: 3.077595, best LRAP score: 0.6015

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6674 LRAP: 0.0000 NDCG: 0.1621
val Loss: 4.8311 LRAP: 0.0000 NDCG: 0.1320
Validation loss decreased (0.000000 --> 4.831073).  Saving model ...

Epoch 1/99
----------
train Loss: 4.2079 LRAP: 0.0000 NDCG: 0.1903
val Loss: 4.9300 LRAP: 0.0000 NDCG: 0.0958
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.9909 LRAP: 0.0000 NDCG: 0.1981
val Loss: 4.0288 LRAP: 0.0000 NDCG: 0.1987
Validation loss decreased (4.831073 --> 4.028812).  Saving model ...

Epoch 3/99
----------
train Loss: 3.8771 LRAP: 0.0008 NDCG: 0.2044
val Loss: 5.0523 LRAP: 0.0000 NDCG: 0.1835
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.7968 LRAP: 0.0022 NDCG: 0.2089
val Loss: 4.0342 LRAP: 0.0076 NDCG: 0.2222
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.7736 LRAP: 0.0071 NDCG: 0.2100
val Loss: 3.7867 LRAP: 0.0076 NDCG: 0.2144
Validation loss decreased (4.028812 --> 3.786657).  Saving model ...

Epoch 6/99
----------
train Loss: 3.7132 LRAP: 0.0068 NDCG: 0.2098
val Loss: 4.9128 LRAP: 0.0013 NDCG: 0.1545
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.6895 LRAP: 0.0076 NDCG: 0.2101
val Loss: 6.9771 LRAP: 0.0000 NDCG: 0.1560
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.6411 LRAP: 0.0071 NDCG: 0.2108
val Loss: 4.5429 LRAP: 0.0076 NDCG: 0.1831
EarlyStopping counter: 3 out of 50

Epoch 9/99
----------
train Loss: 3.6315 LRAP: 0.0101 NDCG: 0.2139
val Loss: 4.6124 LRAP: 0.0064 NDCG: 0.1286
EarlyStopping counter: 4 out of 50

Epoch 10/99
----------
train Loss: 3.5837 LRAP: 0.0188 NDCG: 0.2137
val Loss: 4.3607 LRAP: 0.0051 NDCG: 0.1901
EarlyStopping counter: 5 out of 50

Epoch 11/99
----------
train Loss: 3.5234 LRAP: 0.0169 NDCG: 0.2163
val Loss: 3.9056 LRAP: 0.0165 NDCG: 0.2237
EarlyStopping counter: 6 out of 50

Epoch 12/99
----------
train Loss: 3.4979 LRAP: 0.0191 NDCG: 0.2190
val Loss: 3.4513 LRAP: 0.0292 NDCG: 0.2252
Validation loss decreased (3.786657 --> 3.451336).  Saving model ...

Epoch 13/99
----------
train Loss: 3.4813 LRAP: 0.0207 NDCG: 0.2202
val Loss: 3.9250 LRAP: 0.0140 NDCG: 0.2211
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.4763 LRAP: 0.0245 NDCG: 0.2209
val Loss: 3.9532 LRAP: 0.0686 NDCG: 0.2073
EarlyStopping counter: 2 out of 50

Epoch 15/99
----------
train Loss: 3.4553 LRAP: 0.0278 NDCG: 0.2222
val Loss: 3.5383 LRAP: 0.0140 NDCG: 0.2220
EarlyStopping counter: 3 out of 50

Epoch 16/99
----------
train Loss: 3.4404 LRAP: 0.0223 NDCG: 0.2237
val Loss: 3.6771 LRAP: 0.0267 NDCG: 0.2339
EarlyStopping counter: 4 out of 50

Epoch 17/99
----------
train Loss: 3.4293 LRAP: 0.0267 NDCG: 0.2245
val Loss: 3.5990 LRAP: 0.0089 NDCG: 0.2176
EarlyStopping counter: 5 out of 50

Epoch 18/99
----------
train Loss: 3.4284 LRAP: 0.0267 NDCG: 0.2254
val Loss: 3.4003 LRAP: 0.0394 NDCG: 0.2251
Validation loss decreased (3.451336 --> 3.400293).  Saving model ...

Epoch 19/99
----------
train Loss: 3.4117 LRAP: 0.0242 NDCG: 0.2261
val Loss: 3.3187 LRAP: 0.0254 NDCG: 0.2256
Validation loss decreased (3.400293 --> 3.318674).  Saving model ...

Epoch 20/99
----------
train Loss: 3.4143 LRAP: 0.0248 NDCG: 0.2257
val Loss: 3.3232 LRAP: 0.0165 NDCG: 0.2250
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.4040 LRAP: 0.0308 NDCG: 0.2255
val Loss: 3.3234 LRAP: 0.0165 NDCG: 0.2295
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 3.4128 LRAP: 0.0286 NDCG: 0.2258
val Loss: 3.3235 LRAP: 0.0216 NDCG: 0.2292
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 3.3947 LRAP: 0.0324 NDCG: 0.2260
val Loss: 3.3376 LRAP: 0.0457 NDCG: 0.2259
EarlyStopping counter: 4 out of 50

Epoch 24/99
----------
train Loss: 3.4007 LRAP: 0.0278 NDCG: 0.2272
val Loss: 3.3225 LRAP: 0.0343 NDCG: 0.2267
EarlyStopping counter: 5 out of 50

Epoch 25/99
----------
train Loss: 3.3920 LRAP: 0.0289 NDCG: 0.2271
val Loss: 3.3112 LRAP: 0.0419 NDCG: 0.2277
Validation loss decreased (3.318674 --> 3.311161).  Saving model ...

Epoch 26/99
----------
train Loss: 3.3915 LRAP: 0.0346 NDCG: 0.2266
val Loss: 3.3115 LRAP: 0.0318 NDCG: 0.2284
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.3959 LRAP: 0.0283 NDCG: 0.2265
val Loss: 3.3102 LRAP: 0.0343 NDCG: 0.2272
Validation loss decreased (3.311161 --> 3.310216).  Saving model ...

Epoch 28/99
----------
train Loss: 3.3954 LRAP: 0.0324 NDCG: 0.2267
val Loss: 3.3093 LRAP: 0.0318 NDCG: 0.2276
Validation loss decreased (3.310216 --> 3.309327).  Saving model ...

Epoch 29/99
----------
train Loss: 3.3976 LRAP: 0.0329 NDCG: 0.2260
val Loss: 3.3073 LRAP: 0.0343 NDCG: 0.2278
Validation loss decreased (3.309327 --> 3.307303).  Saving model ...

Epoch 30/99
----------
train Loss: 3.3910 LRAP: 0.0294 NDCG: 0.2274
val Loss: 3.3092 LRAP: 0.0343 NDCG: 0.2286
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 3.3867 LRAP: 0.0302 NDCG: 0.2278
val Loss: 3.3075 LRAP: 0.0368 NDCG: 0.2282
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 3.3886 LRAP: 0.0283 NDCG: 0.2280
val Loss: 3.3122 LRAP: 0.0419 NDCG: 0.2278
EarlyStopping counter: 3 out of 50

Epoch 33/99
----------
train Loss: 3.4005 LRAP: 0.0321 NDCG: 0.2284
val Loss: 3.3050 LRAP: 0.0343 NDCG: 0.2292
Validation loss decreased (3.307303 --> 3.305007).  Saving model ...

Epoch 34/99
----------
train Loss: 3.3835 LRAP: 0.0316 NDCG: 0.2267
val Loss: 3.3028 LRAP: 0.0343 NDCG: 0.2286
Validation loss decreased (3.305007 --> 3.302843).  Saving model ...

Epoch 35/99
----------
train Loss: 3.3791 LRAP: 0.0248 NDCG: 0.2279
val Loss: 3.3029 LRAP: 0.0343 NDCG: 0.2286
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 3.3750 LRAP: 0.0340 NDCG: 0.2298
val Loss: 3.3023 LRAP: 0.0318 NDCG: 0.2293
Validation loss decreased (3.302843 --> 3.302312).  Saving model ...

Epoch 37/99
----------
train Loss: 3.3812 LRAP: 0.0368 NDCG: 0.2269
val Loss: 3.3058 LRAP: 0.0343 NDCG: 0.2273
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 3.3793 LRAP: 0.0310 NDCG: 0.2292
val Loss: 3.2986 LRAP: 0.0343 NDCG: 0.2293
Validation loss decreased (3.302312 --> 3.298639).  Saving model ...

Epoch 39/99
----------
train Loss: 3.3860 LRAP: 0.0338 NDCG: 0.2272
val Loss: 3.3011 LRAP: 0.0343 NDCG: 0.2282
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 3.3807 LRAP: 0.0357 NDCG: 0.2288
val Loss: 3.2980 LRAP: 0.0381 NDCG: 0.2283
Validation loss decreased (3.298639 --> 3.298046).  Saving model ...

Epoch 41/99
----------
train Loss: 3.3846 LRAP: 0.0338 NDCG: 0.2291
val Loss: 3.2999 LRAP: 0.0343 NDCG: 0.2292
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 3.3887 LRAP: 0.0362 NDCG: 0.2279
val Loss: 3.2997 LRAP: 0.0343 NDCG: 0.2289
EarlyStopping counter: 2 out of 50

Epoch 43/99
----------
train Loss: 3.3738 LRAP: 0.0346 NDCG: 0.2283
val Loss: 3.2979 LRAP: 0.0343 NDCG: 0.2286
Validation loss decreased (3.298046 --> 3.297868).  Saving model ...

Epoch 44/99
----------
train Loss: 3.3787 LRAP: 0.0395 NDCG: 0.2286
val Loss: 3.3012 LRAP: 0.0457 NDCG: 0.2295
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 3.3783 LRAP: 0.0327 NDCG: 0.2292
val Loss: 3.2952 LRAP: 0.0381 NDCG: 0.2286
Validation loss decreased (3.297868 --> 3.295216).  Saving model ...

Epoch 46/99
----------
train Loss: 3.3857 LRAP: 0.0368 NDCG: 0.2290
val Loss: 3.2996 LRAP: 0.0343 NDCG: 0.2281
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 3.3807 LRAP: 0.0389 NDCG: 0.2300
val Loss: 3.3033 LRAP: 0.0419 NDCG: 0.2284
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 3.3909 LRAP: 0.0319 NDCG: 0.2295
val Loss: 3.2961 LRAP: 0.0318 NDCG: 0.2282
EarlyStopping counter: 3 out of 50

Epoch 49/99
----------
train Loss: 3.3750 LRAP: 0.0346 NDCG: 0.2291
val Loss: 3.2933 LRAP: 0.0343 NDCG: 0.2308
Validation loss decreased (3.295216 --> 3.293328).  Saving model ...

Epoch 50/99
----------
train Loss: 3.3735 LRAP: 0.0362 NDCG: 0.2302
val Loss: 3.2952 LRAP: 0.0343 NDCG: 0.2303
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 3.3850 LRAP: 0.0329 NDCG: 0.2289
val Loss: 3.2964 LRAP: 0.0470 NDCG: 0.2300
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 3.3753 LRAP: 0.0403 NDCG: 0.2286
val Loss: 3.2914 LRAP: 0.0407 NDCG: 0.2290
Validation loss decreased (3.293328 --> 3.291412).  Saving model ...

Epoch 53/99
----------
train Loss: 3.3796 LRAP: 0.0346 NDCG: 0.2305
val Loss: 3.2926 LRAP: 0.0496 NDCG: 0.2310
EarlyStopping counter: 1 out of 50

Epoch 54/99
----------
train Loss: 3.3725 LRAP: 0.0332 NDCG: 0.2301
val Loss: 3.2940 LRAP: 0.0381 NDCG: 0.2304
EarlyStopping counter: 2 out of 50

Epoch 55/99
----------
train Loss: 3.3742 LRAP: 0.0362 NDCG: 0.2301
val Loss: 3.2916 LRAP: 0.0343 NDCG: 0.2293
EarlyStopping counter: 3 out of 50

Epoch 56/99
----------
train Loss: 3.3739 LRAP: 0.0357 NDCG: 0.2302
val Loss: 3.2924 LRAP: 0.0343 NDCG: 0.2301
EarlyStopping counter: 4 out of 50

Epoch 57/99
----------
train Loss: 3.3727 LRAP: 0.0359 NDCG: 0.2284
val Loss: 3.2939 LRAP: 0.0521 NDCG: 0.2305
EarlyStopping counter: 5 out of 50

Epoch 58/99
----------
train Loss: 3.3711 LRAP: 0.0392 NDCG: 0.2296
val Loss: 3.2913 LRAP: 0.0470 NDCG: 0.2307
Validation loss decreased (3.291412 --> 3.291266).  Saving model ...

Epoch 59/99
----------
train Loss: 3.3719 LRAP: 0.0335 NDCG: 0.2287
val Loss: 3.2936 LRAP: 0.0521 NDCG: 0.2307
EarlyStopping counter: 1 out of 50

Epoch 60/99
----------
train Loss: 3.3718 LRAP: 0.0403 NDCG: 0.2298
val Loss: 3.2929 LRAP: 0.0457 NDCG: 0.2303
EarlyStopping counter: 2 out of 50

Epoch 61/99
----------
train Loss: 3.3801 LRAP: 0.0338 NDCG: 0.2310
val Loss: 3.2930 LRAP: 0.0394 NDCG: 0.2303
EarlyStopping counter: 3 out of 50

Epoch 62/99
----------
train Loss: 3.3678 LRAP: 0.0324 NDCG: 0.2293
val Loss: 3.2894 LRAP: 0.0457 NDCG: 0.2294
Validation loss decreased (3.291266 --> 3.289419).  Saving model ...

Epoch 63/99
----------
train Loss: 3.3751 LRAP: 0.0381 NDCG: 0.2292
val Loss: 3.2885 LRAP: 0.0432 NDCG: 0.2309
Validation loss decreased (3.289419 --> 3.288489).  Saving model ...

Epoch 64/99
----------
train Loss: 3.3782 LRAP: 0.0414 NDCG: 0.2309
val Loss: 3.2887 LRAP: 0.0457 NDCG: 0.2306
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 3.3854 LRAP: 0.0378 NDCG: 0.2284
val Loss: 3.2908 LRAP: 0.0343 NDCG: 0.2310
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 3.3816 LRAP: 0.0327 NDCG: 0.2284
val Loss: 3.2929 LRAP: 0.0483 NDCG: 0.2309
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 3.3792 LRAP: 0.0403 NDCG: 0.2302
val Loss: 3.2884 LRAP: 0.0394 NDCG: 0.2289
Validation loss decreased (3.288489 --> 3.288384).  Saving model ...

Epoch 68/99
----------
train Loss: 3.3706 LRAP: 0.0384 NDCG: 0.2293
val Loss: 3.2881 LRAP: 0.0445 NDCG: 0.2311
Validation loss decreased (3.288384 --> 3.288128).  Saving model ...

Epoch 69/99
----------
train Loss: 3.3680 LRAP: 0.0348 NDCG: 0.2299
val Loss: 3.2911 LRAP: 0.0394 NDCG: 0.2309
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 3.3733 LRAP: 0.0340 NDCG: 0.2287
val Loss: 3.2861 LRAP: 0.0419 NDCG: 0.2309
Validation loss decreased (3.288128 --> 3.286136).  Saving model ...

Epoch 71/99
----------
train Loss: 3.3773 LRAP: 0.0381 NDCG: 0.2297
val Loss: 3.2892 LRAP: 0.0356 NDCG: 0.2303
EarlyStopping counter: 1 out of 50

Epoch 72/99
----------
train Loss: 3.3727 LRAP: 0.0354 NDCG: 0.2311
val Loss: 3.2907 LRAP: 0.0470 NDCG: 0.2304
EarlyStopping counter: 2 out of 50

Epoch 73/99
----------
train Loss: 3.3799 LRAP: 0.0368 NDCG: 0.2298
val Loss: 3.2931 LRAP: 0.0445 NDCG: 0.2304
EarlyStopping counter: 3 out of 50

Epoch 74/99
----------
train Loss: 3.3805 LRAP: 0.0400 NDCG: 0.2300
val Loss: 3.2901 LRAP: 0.0470 NDCG: 0.2302
EarlyStopping counter: 4 out of 50

Epoch 75/99
----------
train Loss: 3.3735 LRAP: 0.0378 NDCG: 0.2282
val Loss: 3.2883 LRAP: 0.0356 NDCG: 0.2316
EarlyStopping counter: 5 out of 50

Epoch 76/99
----------
train Loss: 3.3780 LRAP: 0.0384 NDCG: 0.2293
val Loss: 3.2906 LRAP: 0.0343 NDCG: 0.2312
EarlyStopping counter: 6 out of 50

Epoch 77/99
----------
train Loss: 3.3791 LRAP: 0.0381 NDCG: 0.2298
val Loss: 3.2882 LRAP: 0.0419 NDCG: 0.2313
EarlyStopping counter: 7 out of 50

Epoch 78/99
----------
train Loss: 3.3719 LRAP: 0.0362 NDCG: 0.2299
val Loss: 3.2925 LRAP: 0.0457 NDCG: 0.2303
EarlyStopping counter: 8 out of 50

Epoch 79/99
----------
train Loss: 3.3705 LRAP: 0.0376 NDCG: 0.2321
val Loss: 3.2876 LRAP: 0.0445 NDCG: 0.2312
EarlyStopping counter: 9 out of 50

Epoch 80/99
----------
train Loss: 3.3686 LRAP: 0.0357 NDCG: 0.2288
val Loss: 3.2880 LRAP: 0.0457 NDCG: 0.2313
EarlyStopping counter: 10 out of 50

Epoch 81/99
----------
train Loss: 3.3649 LRAP: 0.0384 NDCG: 0.2314
val Loss: 3.2877 LRAP: 0.0432 NDCG: 0.2308
EarlyStopping counter: 11 out of 50

Epoch 82/99
----------
train Loss: 3.3689 LRAP: 0.0395 NDCG: 0.2284
val Loss: 3.2909 LRAP: 0.0457 NDCG: 0.2314
EarlyStopping counter: 12 out of 50

Epoch 83/99
----------
train Loss: 3.3807 LRAP: 0.0397 NDCG: 0.2287
val Loss: 3.2896 LRAP: 0.0445 NDCG: 0.2308
EarlyStopping counter: 13 out of 50

Epoch 84/99
----------
train Loss: 3.3583 LRAP: 0.0373 NDCG: 0.2297
val Loss: 3.2898 LRAP: 0.0521 NDCG: 0.2316
EarlyStopping counter: 14 out of 50

Epoch 85/99
----------
train Loss: 3.3718 LRAP: 0.0389 NDCG: 0.2286
val Loss: 3.2931 LRAP: 0.0521 NDCG: 0.2316
EarlyStopping counter: 15 out of 50

Epoch 86/99
----------
train Loss: 3.3604 LRAP: 0.0368 NDCG: 0.2306
val Loss: 3.2876 LRAP: 0.0394 NDCG: 0.2296
EarlyStopping counter: 16 out of 50

Epoch 87/99
----------
train Loss: 3.3684 LRAP: 0.0340 NDCG: 0.2302
val Loss: 3.2893 LRAP: 0.0343 NDCG: 0.2317
EarlyStopping counter: 17 out of 50

Epoch 88/99
----------
train Loss: 3.3818 LRAP: 0.0387 NDCG: 0.2285
val Loss: 3.2905 LRAP: 0.0445 NDCG: 0.2320
EarlyStopping counter: 18 out of 50

Epoch 89/99
----------
train Loss: 3.3703 LRAP: 0.0427 NDCG: 0.2292
val Loss: 3.2944 LRAP: 0.0546 NDCG: 0.2299
EarlyStopping counter: 19 out of 50

Epoch 90/99
----------
train Loss: 3.3664 LRAP: 0.0387 NDCG: 0.2298
val Loss: 3.2880 LRAP: 0.0419 NDCG: 0.2302
EarlyStopping counter: 20 out of 50

Epoch 91/99
----------
train Loss: 3.3678 LRAP: 0.0384 NDCG: 0.2310
val Loss: 3.2879 LRAP: 0.0496 NDCG: 0.2311
EarlyStopping counter: 21 out of 50

Epoch 92/99
----------
train Loss: 3.3669 LRAP: 0.0338 NDCG: 0.2302
val Loss: 3.2873 LRAP: 0.0432 NDCG: 0.2311
EarlyStopping counter: 22 out of 50

Epoch 93/99
----------
train Loss: 3.3794 LRAP: 0.0354 NDCG: 0.2294
val Loss: 3.2889 LRAP: 0.0368 NDCG: 0.2304
EarlyStopping counter: 23 out of 50

Epoch 94/99
----------
train Loss: 3.3747 LRAP: 0.0321 NDCG: 0.2308
val Loss: 3.2922 LRAP: 0.0432 NDCG: 0.2317
EarlyStopping counter: 24 out of 50

Epoch 95/99
----------
train Loss: 3.3805 LRAP: 0.0373 NDCG: 0.2290
val Loss: 3.2882 LRAP: 0.0356 NDCG: 0.2297
EarlyStopping counter: 25 out of 50

Epoch 96/99
----------
train Loss: 3.3626 LRAP: 0.0414 NDCG: 0.2322
val Loss: 3.2895 LRAP: 0.0432 NDCG: 0.2304
EarlyStopping counter: 26 out of 50

Epoch 97/99
----------
train Loss: 3.3590 LRAP: 0.0365 NDCG: 0.2311
val Loss: 3.2918 LRAP: 0.0521 NDCG: 0.2300
EarlyStopping counter: 27 out of 50

Epoch 98/99
----------
train Loss: 3.3701 LRAP: 0.0338 NDCG: 0.2293
val Loss: 3.2875 LRAP: 0.0419 NDCG: 0.2307
EarlyStopping counter: 28 out of 50

Epoch 99/99
----------
train Loss: 3.3718 LRAP: 0.0381 NDCG: 0.2298
val Loss: 3.2896 LRAP: 0.0496 NDCG: 0.2295
EarlyStopping counter: 29 out of 50

Training complete in 2m 25s
Best val loss: 3.286136, best LRAP score: 0.5662

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 6/10

All random seeds set to: 47
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5310 LRAP: 0.0000 NDCG: 0.1765
val Loss: 4.7453 LRAP: 0.0000 NDCG: 0.1896
Validation loss decreased (0.000000 --> 4.745299).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9550 LRAP: 0.0000 NDCG: 0.2060
val Loss: 4.1919 LRAP: 0.0000 NDCG: 0.1859
Validation loss decreased (4.745299 --> 4.191857).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8102 LRAP: 0.0005 NDCG: 0.2179
val Loss: 3.8678 LRAP: 0.0025 NDCG: 0.2255
Validation loss decreased (4.191857 --> 3.867782).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6861 LRAP: 0.0000 NDCG: 0.2280
val Loss: 3.6938 LRAP: 0.0000 NDCG: 0.2239
Validation loss decreased (3.867782 --> 3.693767).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5722 LRAP: 0.0027 NDCG: 0.2314
val Loss: 3.6436 LRAP: 0.0013 NDCG: 0.2371
Validation loss decreased (3.693767 --> 3.643578).  Saving model ...

Epoch 5/99
----------
train Loss: 3.5195 LRAP: 0.0033 NDCG: 0.2370
val Loss: 3.4934 LRAP: 0.0076 NDCG: 0.2401
Validation loss decreased (3.643578 --> 3.493389).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4525 LRAP: 0.0044 NDCG: 0.2382
val Loss: 3.3655 LRAP: 0.0038 NDCG: 0.2339
Validation loss decreased (3.493389 --> 3.365453).  Saving model ...

Epoch 7/99
----------
train Loss: 3.3356 LRAP: 0.0093 NDCG: 0.2446
val Loss: 3.7798 LRAP: 0.0203 NDCG: 0.2284
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.2995 LRAP: 0.0093 NDCG: 0.2480
val Loss: 3.3021 LRAP: 0.0064 NDCG: 0.2374
Validation loss decreased (3.365453 --> 3.302132).  Saving model ...

Epoch 9/99
----------
train Loss: 3.2166 LRAP: 0.0133 NDCG: 0.2520
val Loss: 3.1867 LRAP: 0.0076 NDCG: 0.2499
Validation loss decreased (3.302132 --> 3.186712).  Saving model ...

Epoch 10/99
----------
train Loss: 3.1363 LRAP: 0.0123 NDCG: 0.2538
val Loss: 3.1444 LRAP: 0.0546 NDCG: 0.2591
Validation loss decreased (3.186712 --> 3.144383).  Saving model ...

Epoch 11/99
----------
train Loss: 3.0892 LRAP: 0.0302 NDCG: 0.2588
val Loss: 3.0468 LRAP: 0.0788 NDCG: 0.2683
Validation loss decreased (3.144383 --> 3.046768).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0448 LRAP: 0.0343 NDCG: 0.2641
val Loss: 3.1323 LRAP: 0.0801 NDCG: 0.2585
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0048 LRAP: 0.0482 NDCG: 0.2675
val Loss: 3.1614 LRAP: 0.1055 NDCG: 0.2575
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 2.9603 LRAP: 0.0452 NDCG: 0.2720
val Loss: 3.0060 LRAP: 0.0356 NDCG: 0.2723
Validation loss decreased (3.046768 --> 3.005998).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9116 LRAP: 0.0583 NDCG: 0.2751
val Loss: 3.0669 LRAP: 0.0546 NDCG: 0.2610
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.8582 LRAP: 0.0580 NDCG: 0.2804
val Loss: 2.9758 LRAP: 0.0597 NDCG: 0.2726
Validation loss decreased (3.005998 --> 2.975753).  Saving model ...

Epoch 17/99
----------
train Loss: 2.8116 LRAP: 0.0534 NDCG: 0.2836
val Loss: 2.9320 LRAP: 0.1055 NDCG: 0.2913
Validation loss decreased (2.975753 --> 2.932031).  Saving model ...

Epoch 18/99
----------
train Loss: 2.7755 LRAP: 0.0621 NDCG: 0.2848
val Loss: 2.8376 LRAP: 0.0457 NDCG: 0.2891
Validation loss decreased (2.932031 --> 2.837634).  Saving model ...

Epoch 19/99
----------
train Loss: 2.7455 LRAP: 0.0689 NDCG: 0.2880
val Loss: 2.9287 LRAP: 0.1194 NDCG: 0.2871
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 2.6932 LRAP: 0.0634 NDCG: 0.2904
val Loss: 2.8863 LRAP: 0.1131 NDCG: 0.2877
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 2.7209 LRAP: 0.0645 NDCG: 0.2921
val Loss: 2.8363 LRAP: 0.1067 NDCG: 0.2861
Validation loss decreased (2.837634 --> 2.836303).  Saving model ...

Epoch 22/99
----------
train Loss: 2.6634 LRAP: 0.0667 NDCG: 0.2946
val Loss: 2.7375 LRAP: 0.0889 NDCG: 0.3043
Validation loss decreased (2.836303 --> 2.737484).  Saving model ...

Epoch 23/99
----------
train Loss: 2.6394 LRAP: 0.0697 NDCG: 0.2999
val Loss: 2.7684 LRAP: 0.0572 NDCG: 0.2944
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 2.5894 LRAP: 0.0713 NDCG: 0.3010
val Loss: 2.6806 LRAP: 0.1118 NDCG: 0.3034
Validation loss decreased (2.737484 --> 2.680562).  Saving model ...

Epoch 25/99
----------
train Loss: 2.5620 LRAP: 0.0721 NDCG: 0.3016
val Loss: 2.6753 LRAP: 0.1042 NDCG: 0.3040
Validation loss decreased (2.680562 --> 2.675303).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5265 LRAP: 0.0713 NDCG: 0.3069
val Loss: 2.6665 LRAP: 0.0635 NDCG: 0.3079
Validation loss decreased (2.675303 --> 2.666534).  Saving model ...

Epoch 27/99
----------
train Loss: 2.4947 LRAP: 0.0683 NDCG: 0.3070
val Loss: 2.6566 LRAP: 0.0851 NDCG: 0.3151
Validation loss decreased (2.666534 --> 2.656600).  Saving model ...

Epoch 28/99
----------
train Loss: 2.4661 LRAP: 0.0768 NDCG: 0.3100
val Loss: 2.6243 LRAP: 0.1067 NDCG: 0.3090
Validation loss decreased (2.656600 --> 2.624282).  Saving model ...

Epoch 29/99
----------
train Loss: 2.4649 LRAP: 0.0836 NDCG: 0.3086
val Loss: 2.6268 LRAP: 0.1169 NDCG: 0.3225
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.4091 LRAP: 0.0828 NDCG: 0.3138
val Loss: 2.5773 LRAP: 0.1144 NDCG: 0.3211
Validation loss decreased (2.624282 --> 2.577341).  Saving model ...

Epoch 31/99
----------
train Loss: 2.3963 LRAP: 0.0746 NDCG: 0.3150
val Loss: 2.5500 LRAP: 0.0864 NDCG: 0.3275
Validation loss decreased (2.577341 --> 2.549969).  Saving model ...

Epoch 32/99
----------
train Loss: 2.3948 LRAP: 0.0751 NDCG: 0.3135
val Loss: 2.5854 LRAP: 0.1258 NDCG: 0.3233
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.3528 LRAP: 0.0792 NDCG: 0.3153
val Loss: 2.5806 LRAP: 0.1067 NDCG: 0.3385
EarlyStopping counter: 2 out of 50

Epoch 34/99
----------
train Loss: 2.3219 LRAP: 0.0779 NDCG: 0.3171
val Loss: 2.5286 LRAP: 0.0877 NDCG: 0.3227
Validation loss decreased (2.549969 --> 2.528629).  Saving model ...

Epoch 35/99
----------
train Loss: 2.2935 LRAP: 0.0830 NDCG: 0.3206
val Loss: 2.5270 LRAP: 0.1131 NDCG: 0.3336
Validation loss decreased (2.528629 --> 2.527007).  Saving model ...

Epoch 36/99
----------
train Loss: 2.2773 LRAP: 0.0874 NDCG: 0.3217
val Loss: 2.4987 LRAP: 0.1283 NDCG: 0.3321
Validation loss decreased (2.527007 --> 2.498697).  Saving model ...

Epoch 37/99
----------
train Loss: 2.2235 LRAP: 0.0888 NDCG: 0.3234
val Loss: 2.5866 LRAP: 0.1080 NDCG: 0.3175
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 2.2253 LRAP: 0.0958 NDCG: 0.3240
val Loss: 2.4634 LRAP: 0.1131 NDCG: 0.3387
Validation loss decreased (2.498697 --> 2.463359).  Saving model ...

Epoch 39/99
----------
train Loss: 2.2089 LRAP: 0.0909 NDCG: 0.3279
val Loss: 2.4643 LRAP: 0.1182 NDCG: 0.3446
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.1506 LRAP: 0.1007 NDCG: 0.3281
val Loss: 2.4471 LRAP: 0.1182 NDCG: 0.3469
Validation loss decreased (2.463359 --> 2.447111).  Saving model ...

Epoch 41/99
----------
train Loss: 2.1295 LRAP: 0.0918 NDCG: 0.3316
val Loss: 2.3450 LRAP: 0.1182 NDCG: 0.3493
Validation loss decreased (2.447111 --> 2.344951).  Saving model ...

Epoch 42/99
----------
train Loss: 2.1550 LRAP: 0.0972 NDCG: 0.3315
val Loss: 2.4201 LRAP: 0.1449 NDCG: 0.3449
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 2.0944 LRAP: 0.0991 NDCG: 0.3353
val Loss: 2.5155 LRAP: 0.1372 NDCG: 0.3466
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 2.0758 LRAP: 0.1024 NDCG: 0.3352
val Loss: 2.3807 LRAP: 0.1194 NDCG: 0.3651
EarlyStopping counter: 3 out of 50

Epoch 45/99
----------
train Loss: 2.0625 LRAP: 0.0975 NDCG: 0.3366
val Loss: 2.3754 LRAP: 0.1220 NDCG: 0.3446
EarlyStopping counter: 4 out of 50

Epoch 46/99
----------
train Loss: 2.0484 LRAP: 0.0885 NDCG: 0.3371
val Loss: 2.4533 LRAP: 0.1258 NDCG: 0.3406
EarlyStopping counter: 5 out of 50

Epoch 47/99
----------
train Loss: 1.9452 LRAP: 0.0950 NDCG: 0.3401
val Loss: 2.2528 LRAP: 0.1372 NDCG: 0.3660
Validation loss decreased (2.344951 --> 2.252821).  Saving model ...

Epoch 48/99
----------
train Loss: 1.8991 LRAP: 0.0983 NDCG: 0.3421
val Loss: 2.2545 LRAP: 0.1423 NDCG: 0.3704
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 1.8531 LRAP: 0.0999 NDCG: 0.3455
val Loss: 2.2359 LRAP: 0.1372 NDCG: 0.3669
Validation loss decreased (2.252821 --> 2.235855).  Saving model ...

Epoch 50/99
----------
train Loss: 1.8579 LRAP: 0.1018 NDCG: 0.3466
val Loss: 2.2371 LRAP: 0.1410 NDCG: 0.3731
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 1.8291 LRAP: 0.0969 NDCG: 0.3470
val Loss: 2.2415 LRAP: 0.1449 NDCG: 0.3675
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 1.8362 LRAP: 0.1051 NDCG: 0.3488
val Loss: 2.2341 LRAP: 0.1398 NDCG: 0.3689
Validation loss decreased (2.235855 --> 2.234109).  Saving model ...

Epoch 53/99
----------
train Loss: 1.8070 LRAP: 0.1067 NDCG: 0.3485
val Loss: 2.2213 LRAP: 0.1423 NDCG: 0.3731
Validation loss decreased (2.234109 --> 2.221341).  Saving model ...

Epoch 54/99
----------
train Loss: 1.8011 LRAP: 0.0991 NDCG: 0.3466
val Loss: 2.2329 LRAP: 0.1461 NDCG: 0.3753
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.7874 LRAP: 0.1010 NDCG: 0.3502
val Loss: 2.2249 LRAP: 0.1487 NDCG: 0.3728
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 1.7902 LRAP: 0.1013 NDCG: 0.3525
val Loss: 2.2174 LRAP: 0.1436 NDCG: 0.3771
Validation loss decreased (2.221341 --> 2.217355).  Saving model ...

Epoch 57/99
----------
train Loss: 1.7801 LRAP: 0.1133 NDCG: 0.3512
val Loss: 2.2135 LRAP: 0.1487 NDCG: 0.3771
Validation loss decreased (2.217355 --> 2.213494).  Saving model ...

Epoch 58/99
----------
train Loss: 1.7773 LRAP: 0.1002 NDCG: 0.3482
val Loss: 2.2137 LRAP: 0.1537 NDCG: 0.3754
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 1.7724 LRAP: 0.1157 NDCG: 0.3495
val Loss: 2.2186 LRAP: 0.1588 NDCG: 0.3839
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 1.7546 LRAP: 0.1114 NDCG: 0.3516
val Loss: 2.2105 LRAP: 0.1550 NDCG: 0.3782
Validation loss decreased (2.213494 --> 2.210479).  Saving model ...

Epoch 61/99
----------
train Loss: 1.7432 LRAP: 0.1048 NDCG: 0.3506
val Loss: 2.2166 LRAP: 0.1550 NDCG: 0.3783
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 1.7418 LRAP: 0.1075 NDCG: 0.3528
val Loss: 2.2104 LRAP: 0.1398 NDCG: 0.3759
Validation loss decreased (2.210479 --> 2.210399).  Saving model ...

Epoch 63/99
----------
train Loss: 1.7154 LRAP: 0.1081 NDCG: 0.3537
val Loss: 2.2125 LRAP: 0.1398 NDCG: 0.3837
EarlyStopping counter: 1 out of 50

Epoch 64/99
----------
train Loss: 1.7201 LRAP: 0.1062 NDCG: 0.3555
val Loss: 2.2042 LRAP: 0.1499 NDCG: 0.3813
Validation loss decreased (2.210399 --> 2.204248).  Saving model ...

Epoch 65/99
----------
train Loss: 1.7210 LRAP: 0.1119 NDCG: 0.3535
val Loss: 2.1961 LRAP: 0.1423 NDCG: 0.3793
Validation loss decreased (2.204248 --> 2.196120).  Saving model ...

Epoch 66/99
----------
train Loss: 1.6982 LRAP: 0.1084 NDCG: 0.3548
val Loss: 2.2061 LRAP: 0.1576 NDCG: 0.3841
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 1.6862 LRAP: 0.1094 NDCG: 0.3549
val Loss: 2.2027 LRAP: 0.1537 NDCG: 0.3853
EarlyStopping counter: 2 out of 50

Epoch 68/99
----------
train Loss: 1.6947 LRAP: 0.1081 NDCG: 0.3559
val Loss: 2.1995 LRAP: 0.1588 NDCG: 0.3872
EarlyStopping counter: 3 out of 50

Epoch 69/99
----------
train Loss: 1.6837 LRAP: 0.1111 NDCG: 0.3581
val Loss: 2.1906 LRAP: 0.1550 NDCG: 0.3881
Validation loss decreased (2.196120 --> 2.190600).  Saving model ...

Epoch 70/99
----------
train Loss: 1.6744 LRAP: 0.1067 NDCG: 0.3586
val Loss: 2.2075 LRAP: 0.1550 NDCG: 0.3879
EarlyStopping counter: 1 out of 50

Epoch 71/99
----------
train Loss: 1.6648 LRAP: 0.1084 NDCG: 0.3562
val Loss: 2.2091 LRAP: 0.1652 NDCG: 0.3860
EarlyStopping counter: 2 out of 50

Epoch 72/99
----------
train Loss: 1.6592 LRAP: 0.1114 NDCG: 0.3586
val Loss: 2.1967 LRAP: 0.1677 NDCG: 0.3876
EarlyStopping counter: 3 out of 50

Epoch 73/99
----------
train Loss: 1.6744 LRAP: 0.1081 NDCG: 0.3557
val Loss: 2.1975 LRAP: 0.1601 NDCG: 0.3847
EarlyStopping counter: 4 out of 50

Epoch 74/99
----------
train Loss: 1.6558 LRAP: 0.1122 NDCG: 0.3572
val Loss: 2.2091 LRAP: 0.1614 NDCG: 0.3833
EarlyStopping counter: 5 out of 50

Epoch 75/99
----------
train Loss: 1.6212 LRAP: 0.1143 NDCG: 0.3585
val Loss: 2.1866 LRAP: 0.1665 NDCG: 0.3919
Validation loss decreased (2.190600 --> 2.186629).  Saving model ...

Epoch 76/99
----------
train Loss: 1.6126 LRAP: 0.1124 NDCG: 0.3615
val Loss: 2.1809 LRAP: 0.1690 NDCG: 0.3931
Validation loss decreased (2.186629 --> 2.180901).  Saving model ...

Epoch 77/99
----------
train Loss: 1.6048 LRAP: 0.1081 NDCG: 0.3603
val Loss: 2.1816 LRAP: 0.1677 NDCG: 0.3874
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 1.6201 LRAP: 0.1163 NDCG: 0.3602
val Loss: 2.1860 LRAP: 0.1715 NDCG: 0.3914
EarlyStopping counter: 2 out of 50

Epoch 79/99
----------
train Loss: 1.6090 LRAP: 0.1122 NDCG: 0.3605
val Loss: 2.1829 LRAP: 0.1677 NDCG: 0.3906
EarlyStopping counter: 3 out of 50

Epoch 80/99
----------
train Loss: 1.6136 LRAP: 0.1179 NDCG: 0.3596
val Loss: 2.1803 LRAP: 0.1715 NDCG: 0.3893
Validation loss decreased (2.180901 --> 2.180338).  Saving model ...

Epoch 81/99
----------
train Loss: 1.6142 LRAP: 0.1146 NDCG: 0.3591
val Loss: 2.1764 LRAP: 0.1690 NDCG: 0.3896
Validation loss decreased (2.180338 --> 2.176422).  Saving model ...

Epoch 82/99
----------
train Loss: 1.6071 LRAP: 0.1105 NDCG: 0.3603
val Loss: 2.1846 LRAP: 0.1703 NDCG: 0.3909
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 1.6055 LRAP: 0.1078 NDCG: 0.3599
val Loss: 2.1874 LRAP: 0.1677 NDCG: 0.3901
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 1.5998 LRAP: 0.1143 NDCG: 0.3628
val Loss: 2.1788 LRAP: 0.1703 NDCG: 0.3920
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 1.5975 LRAP: 0.1160 NDCG: 0.3614
val Loss: 2.1801 LRAP: 0.1677 NDCG: 0.3924
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 1.5904 LRAP: 0.1092 NDCG: 0.3627
val Loss: 2.1771 LRAP: 0.1715 NDCG: 0.3924
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 1.5872 LRAP: 0.1154 NDCG: 0.3623
val Loss: 2.1775 LRAP: 0.1728 NDCG: 0.3933
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 1.5963 LRAP: 0.1163 NDCG: 0.3614
val Loss: 2.1754 LRAP: 0.1703 NDCG: 0.3902
Validation loss decreased (2.176422 --> 2.175356).  Saving model ...

Epoch 89/99
----------
train Loss: 1.5826 LRAP: 0.1143 NDCG: 0.3608
val Loss: 2.1817 LRAP: 0.1690 NDCG: 0.3909
EarlyStopping counter: 1 out of 50

Epoch 90/99
----------
train Loss: 1.5927 LRAP: 0.1179 NDCG: 0.3632
val Loss: 2.1802 LRAP: 0.1728 NDCG: 0.3934
EarlyStopping counter: 2 out of 50

Epoch 91/99
----------
train Loss: 1.5910 LRAP: 0.1108 NDCG: 0.3627
val Loss: 2.1777 LRAP: 0.1703 NDCG: 0.3921
EarlyStopping counter: 3 out of 50

Epoch 92/99
----------
train Loss: 1.5989 LRAP: 0.1084 NDCG: 0.3631
val Loss: 2.1787 LRAP: 0.1715 NDCG: 0.3926
EarlyStopping counter: 4 out of 50

Epoch 93/99
----------
train Loss: 1.5815 LRAP: 0.1114 NDCG: 0.3621
val Loss: 2.1823 LRAP: 0.1690 NDCG: 0.3908
EarlyStopping counter: 5 out of 50

Epoch 94/99
----------
train Loss: 1.5960 LRAP: 0.1062 NDCG: 0.3618
val Loss: 2.1812 LRAP: 0.1715 NDCG: 0.3925
EarlyStopping counter: 6 out of 50

Epoch 95/99
----------
train Loss: 1.5853 LRAP: 0.1092 NDCG: 0.3615
val Loss: 2.1797 LRAP: 0.1715 NDCG: 0.3917
EarlyStopping counter: 7 out of 50

Epoch 96/99
----------
train Loss: 1.5918 LRAP: 0.1165 NDCG: 0.3626
val Loss: 2.1788 LRAP: 0.1715 NDCG: 0.3908
EarlyStopping counter: 8 out of 50

Epoch 97/99
----------
train Loss: 1.5962 LRAP: 0.1163 NDCG: 0.3627
val Loss: 2.1818 LRAP: 0.1715 NDCG: 0.3915
EarlyStopping counter: 9 out of 50

Epoch 98/99
----------
train Loss: 1.5946 LRAP: 0.1127 NDCG: 0.3613
val Loss: 2.1814 LRAP: 0.1703 NDCG: 0.3920
EarlyStopping counter: 10 out of 50

Epoch 99/99
----------
train Loss: 1.5859 LRAP: 0.1122 NDCG: 0.3620
val Loss: 2.1816 LRAP: 0.1703 NDCG: 0.3923
EarlyStopping counter: 11 out of 50

Training complete in 2m 29s
Best val loss: 2.175356, best LRAP score: 0.7920

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.5301 LRAP: 0.0000 NDCG: 0.1711
val Loss: 4.4350 LRAP: 0.0000 NDCG: 0.1989
Validation loss decreased (0.000000 --> 4.435012).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9570 LRAP: 0.0003 NDCG: 0.1981
val Loss: 4.9182 LRAP: 0.0013 NDCG: 0.1999
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.7732 LRAP: 0.0022 NDCG: 0.2104
val Loss: 4.3613 LRAP: 0.0013 NDCG: 0.1591
Validation loss decreased (4.435012 --> 4.361276).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6632 LRAP: 0.0027 NDCG: 0.2148
val Loss: 4.1253 LRAP: 0.0051 NDCG: 0.2167
Validation loss decreased (4.361276 --> 4.125308).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5596 LRAP: 0.0084 NDCG: 0.2236
val Loss: 3.7961 LRAP: 0.0381 NDCG: 0.2078
Validation loss decreased (4.125308 --> 3.796102).  Saving model ...

Epoch 5/99
----------
train Loss: 3.4713 LRAP: 0.0166 NDCG: 0.2274
val Loss: 3.6054 LRAP: 0.0152 NDCG: 0.2336
Validation loss decreased (3.796102 --> 3.605404).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4076 LRAP: 0.0142 NDCG: 0.2346
val Loss: 4.7414 LRAP: 0.0470 NDCG: 0.2276
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.3289 LRAP: 0.0229 NDCG: 0.2417
val Loss: 3.9777 LRAP: 0.0152 NDCG: 0.2305
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.2801 LRAP: 0.0403 NDCG: 0.2449
val Loss: 3.5285 LRAP: 0.0534 NDCG: 0.2256
Validation loss decreased (3.605404 --> 3.528513).  Saving model ...

Epoch 9/99
----------
train Loss: 3.1984 LRAP: 0.0411 NDCG: 0.2521
val Loss: 3.5447 LRAP: 0.0699 NDCG: 0.2122
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.1893 LRAP: 0.0531 NDCG: 0.2533
val Loss: 3.2070 LRAP: 0.0940 NDCG: 0.2595
Validation loss decreased (3.528513 --> 3.207032).  Saving model ...

Epoch 11/99
----------
train Loss: 3.1346 LRAP: 0.0512 NDCG: 0.2603
val Loss: 3.7023 LRAP: 0.0762 NDCG: 0.2192
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.1162 LRAP: 0.0681 NDCG: 0.2585
val Loss: 3.4290 LRAP: 0.0902 NDCG: 0.2462
EarlyStopping counter: 2 out of 50

Epoch 13/99
----------
train Loss: 3.0592 LRAP: 0.0659 NDCG: 0.2642
val Loss: 3.3967 LRAP: 0.1055 NDCG: 0.2509
EarlyStopping counter: 3 out of 50

Epoch 14/99
----------
train Loss: 2.9909 LRAP: 0.0711 NDCG: 0.2674
val Loss: 3.1722 LRAP: 0.1093 NDCG: 0.2583
Validation loss decreased (3.207032 --> 3.172215).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9660 LRAP: 0.0749 NDCG: 0.2678
val Loss: 3.1558 LRAP: 0.1093 NDCG: 0.2565
Validation loss decreased (3.172215 --> 3.155772).  Saving model ...

Epoch 16/99
----------
train Loss: 2.9190 LRAP: 0.0738 NDCG: 0.2731
val Loss: 3.1939 LRAP: 0.0737 NDCG: 0.2666
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 2.8896 LRAP: 0.0819 NDCG: 0.2748
val Loss: 3.5117 LRAP: 0.0851 NDCG: 0.2447
EarlyStopping counter: 2 out of 50

Epoch 18/99
----------
train Loss: 2.8628 LRAP: 0.0811 NDCG: 0.2764
val Loss: 3.1189 LRAP: 0.0991 NDCG: 0.2674
Validation loss decreased (3.155772 --> 3.118878).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8328 LRAP: 0.0858 NDCG: 0.2793
val Loss: 3.1881 LRAP: 0.0330 NDCG: 0.2506
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 2.7767 LRAP: 0.0863 NDCG: 0.2841
val Loss: 3.1679 LRAP: 0.1105 NDCG: 0.2847
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 2.7592 LRAP: 0.0918 NDCG: 0.2851
val Loss: 2.9559 LRAP: 0.0623 NDCG: 0.2618
Validation loss decreased (3.118878 --> 2.955864).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7235 LRAP: 0.0863 NDCG: 0.2859
val Loss: 3.0140 LRAP: 0.0839 NDCG: 0.2845
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.6951 LRAP: 0.0901 NDCG: 0.2893
val Loss: 2.7874 LRAP: 0.0839 NDCG: 0.2958
Validation loss decreased (2.955864 --> 2.787372).  Saving model ...

Epoch 24/99
----------
train Loss: 2.6730 LRAP: 0.0890 NDCG: 0.2918
val Loss: 2.8402 LRAP: 0.0750 NDCG: 0.3057
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.6473 LRAP: 0.0814 NDCG: 0.2949
val Loss: 2.8330 LRAP: 0.1029 NDCG: 0.3135
EarlyStopping counter: 2 out of 50

Epoch 26/99
----------
train Loss: 2.6181 LRAP: 0.0806 NDCG: 0.2973
val Loss: 2.8489 LRAP: 0.1067 NDCG: 0.3071
EarlyStopping counter: 3 out of 50

Epoch 27/99
----------
train Loss: 2.5971 LRAP: 0.0874 NDCG: 0.2991
val Loss: 2.7076 LRAP: 0.1080 NDCG: 0.3019
Validation loss decreased (2.787372 --> 2.707595).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5438 LRAP: 0.0918 NDCG: 0.3047
val Loss: 2.7034 LRAP: 0.1118 NDCG: 0.3095
Validation loss decreased (2.707595 --> 2.703389).  Saving model ...

Epoch 29/99
----------
train Loss: 2.5154 LRAP: 0.0967 NDCG: 0.3059
val Loss: 2.7103 LRAP: 0.0978 NDCG: 0.3201
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.4931 LRAP: 0.0953 NDCG: 0.3072
val Loss: 2.7124 LRAP: 0.1118 NDCG: 0.2998
EarlyStopping counter: 2 out of 50

Epoch 31/99
----------
train Loss: 2.4738 LRAP: 0.0830 NDCG: 0.3082
val Loss: 2.6668 LRAP: 0.0724 NDCG: 0.3116
Validation loss decreased (2.703389 --> 2.666835).  Saving model ...

Epoch 32/99
----------
train Loss: 2.4472 LRAP: 0.0975 NDCG: 0.3087
val Loss: 2.7130 LRAP: 0.1042 NDCG: 0.3213
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.4317 LRAP: 0.0975 NDCG: 0.3141
val Loss: 2.6789 LRAP: 0.1296 NDCG: 0.3304
EarlyStopping counter: 2 out of 50

Epoch 34/99
----------
train Loss: 2.4173 LRAP: 0.0972 NDCG: 0.3120
val Loss: 2.6723 LRAP: 0.1029 NDCG: 0.3433
EarlyStopping counter: 3 out of 50

Epoch 35/99
----------
train Loss: 2.3773 LRAP: 0.0958 NDCG: 0.3153
val Loss: 2.5605 LRAP: 0.0826 NDCG: 0.3115
Validation loss decreased (2.666835 --> 2.560464).  Saving model ...

Epoch 36/99
----------
train Loss: 2.3188 LRAP: 0.0928 NDCG: 0.3214
val Loss: 2.5594 LRAP: 0.1309 NDCG: 0.3425
Validation loss decreased (2.560464 --> 2.559379).  Saving model ...

Epoch 37/99
----------
train Loss: 2.2970 LRAP: 0.1056 NDCG: 0.3229
val Loss: 2.5889 LRAP: 0.0902 NDCG: 0.3250
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 2.3006 LRAP: 0.1037 NDCG: 0.3213
val Loss: 2.5686 LRAP: 0.1105 NDCG: 0.3375
EarlyStopping counter: 2 out of 50

Epoch 39/99
----------
train Loss: 2.2554 LRAP: 0.0980 NDCG: 0.3231
val Loss: 2.6535 LRAP: 0.1156 NDCG: 0.3222
EarlyStopping counter: 3 out of 50

Epoch 40/99
----------
train Loss: 2.2431 LRAP: 0.0986 NDCG: 0.3262
val Loss: 2.6678 LRAP: 0.1334 NDCG: 0.3399
EarlyStopping counter: 4 out of 50

Epoch 41/99
----------
train Loss: 2.2153 LRAP: 0.1040 NDCG: 0.3267
val Loss: 2.4497 LRAP: 0.1207 NDCG: 0.3405
Validation loss decreased (2.559379 --> 2.449703).  Saving model ...

Epoch 42/99
----------
train Loss: 2.1899 LRAP: 0.1024 NDCG: 0.3314
val Loss: 2.4449 LRAP: 0.1398 NDCG: 0.3608
Validation loss decreased (2.449703 --> 2.444909).  Saving model ...

Epoch 43/99
----------
train Loss: 2.1755 LRAP: 0.0937 NDCG: 0.3312
val Loss: 2.5000 LRAP: 0.1347 NDCG: 0.3342
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 2.1636 LRAP: 0.0969 NDCG: 0.3350
val Loss: 2.4262 LRAP: 0.1398 NDCG: 0.3609
Validation loss decreased (2.444909 --> 2.426201).  Saving model ...

Epoch 45/99
----------
train Loss: 2.1505 LRAP: 0.1062 NDCG: 0.3378
val Loss: 2.7834 LRAP: 0.1296 NDCG: 0.3681
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 2.0989 LRAP: 0.0969 NDCG: 0.3360
val Loss: 2.4141 LRAP: 0.1283 NDCG: 0.3436
Validation loss decreased (2.426201 --> 2.414147).  Saving model ...

Epoch 47/99
----------
train Loss: 2.0875 LRAP: 0.1035 NDCG: 0.3411
val Loss: 2.5326 LRAP: 0.1410 NDCG: 0.3657
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 2.0637 LRAP: 0.1045 NDCG: 0.3404
val Loss: 2.4628 LRAP: 0.1220 NDCG: 0.3769
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 2.0464 LRAP: 0.1086 NDCG: 0.3417
val Loss: 2.4987 LRAP: 0.1271 NDCG: 0.3669
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 2.0370 LRAP: 0.1029 NDCG: 0.3429
val Loss: 2.4035 LRAP: 0.1423 NDCG: 0.3807
Validation loss decreased (2.414147 --> 2.403510).  Saving model ...

Epoch 51/99
----------
train Loss: 2.0292 LRAP: 0.1070 NDCG: 0.3439
val Loss: 2.3748 LRAP: 0.1449 NDCG: 0.3615
Validation loss decreased (2.403510 --> 2.374836).  Saving model ...

Epoch 52/99
----------
train Loss: 2.0008 LRAP: 0.1094 NDCG: 0.3448
val Loss: 2.3666 LRAP: 0.1449 NDCG: 0.3646
Validation loss decreased (2.374836 --> 2.366641).  Saving model ...

Epoch 53/99
----------
train Loss: 1.9792 LRAP: 0.1097 NDCG: 0.3467
val Loss: 2.3479 LRAP: 0.1283 NDCG: 0.3545
Validation loss decreased (2.366641 --> 2.347883).  Saving model ...

Epoch 54/99
----------
train Loss: 1.9436 LRAP: 0.1094 NDCG: 0.3493
val Loss: 2.4053 LRAP: 0.1512 NDCG: 0.3781
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.9247 LRAP: 0.1138 NDCG: 0.3487
val Loss: 2.3816 LRAP: 0.1474 NDCG: 0.3594
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 1.9232 LRAP: 0.1075 NDCG: 0.3504
val Loss: 2.3435 LRAP: 0.1690 NDCG: 0.3836
Validation loss decreased (2.347883 --> 2.343468).  Saving model ...

Epoch 57/99
----------
train Loss: 1.9028 LRAP: 0.1154 NDCG: 0.3522
val Loss: 2.3783 LRAP: 0.1677 NDCG: 0.3961
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 1.8783 LRAP: 0.1190 NDCG: 0.3526
val Loss: 2.3127 LRAP: 0.1398 NDCG: 0.3686
Validation loss decreased (2.343468 --> 2.312734).  Saving model ...

Epoch 59/99
----------
train Loss: 1.8578 LRAP: 0.1124 NDCG: 0.3564
val Loss: 2.3126 LRAP: 0.1588 NDCG: 0.3816
Validation loss decreased (2.312734 --> 2.312628).  Saving model ...

Epoch 60/99
----------
train Loss: 1.8372 LRAP: 0.1157 NDCG: 0.3580
val Loss: 2.3494 LRAP: 0.1525 NDCG: 0.3758
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 1.8085 LRAP: 0.1133 NDCG: 0.3579
val Loss: 2.3380 LRAP: 0.1474 NDCG: 0.3862
EarlyStopping counter: 2 out of 50

Epoch 62/99
----------
train Loss: 1.8146 LRAP: 0.1241 NDCG: 0.3595
val Loss: 2.3260 LRAP: 0.1690 NDCG: 0.3888
EarlyStopping counter: 3 out of 50

Epoch 63/99
----------
train Loss: 1.7812 LRAP: 0.1160 NDCG: 0.3565
val Loss: 2.3456 LRAP: 0.1449 NDCG: 0.3654
EarlyStopping counter: 4 out of 50

Epoch 64/99
----------
train Loss: 1.7149 LRAP: 0.1201 NDCG: 0.3589
val Loss: 2.1950 LRAP: 0.1715 NDCG: 0.3954
Validation loss decreased (2.312628 --> 2.195048).  Saving model ...

Epoch 65/99
----------
train Loss: 1.6670 LRAP: 0.1176 NDCG: 0.3621
val Loss: 2.1888 LRAP: 0.1766 NDCG: 0.3960
Validation loss decreased (2.195048 --> 2.188844).  Saving model ...

Epoch 66/99
----------
train Loss: 1.6644 LRAP: 0.1220 NDCG: 0.3595
val Loss: 2.1809 LRAP: 0.1753 NDCG: 0.3994
Validation loss decreased (2.188844 --> 2.180874).  Saving model ...

Epoch 67/99
----------
train Loss: 1.6294 LRAP: 0.1165 NDCG: 0.3640
val Loss: 2.1874 LRAP: 0.1690 NDCG: 0.3928
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 1.6226 LRAP: 0.1152 NDCG: 0.3630
val Loss: 2.1891 LRAP: 0.1817 NDCG: 0.4043
EarlyStopping counter: 2 out of 50

Epoch 69/99
----------
train Loss: 1.5995 LRAP: 0.1124 NDCG: 0.3656
val Loss: 2.1753 LRAP: 0.1792 NDCG: 0.4005
Validation loss decreased (2.180874 --> 2.175260).  Saving model ...

Epoch 70/99
----------
train Loss: 1.6010 LRAP: 0.1217 NDCG: 0.3647
val Loss: 2.1696 LRAP: 0.1728 NDCG: 0.3986
Validation loss decreased (2.175260 --> 2.169558).  Saving model ...

Epoch 71/99
----------
train Loss: 1.6092 LRAP: 0.1165 NDCG: 0.3664
val Loss: 2.1671 LRAP: 0.1690 NDCG: 0.3957
Validation loss decreased (2.169558 --> 2.167065).  Saving model ...

Epoch 72/99
----------
train Loss: 1.5870 LRAP: 0.1244 NDCG: 0.3643
val Loss: 2.1611 LRAP: 0.1842 NDCG: 0.4006
Validation loss decreased (2.167065 --> 2.161070).  Saving model ...

Epoch 73/99
----------
train Loss: 1.5804 LRAP: 0.1138 NDCG: 0.3627
val Loss: 2.1685 LRAP: 0.1855 NDCG: 0.3993
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 1.5678 LRAP: 0.1209 NDCG: 0.3656
val Loss: 2.1635 LRAP: 0.1753 NDCG: 0.3968
EarlyStopping counter: 2 out of 50

Epoch 75/99
----------
train Loss: 1.5644 LRAP: 0.1269 NDCG: 0.3646
val Loss: 2.1582 LRAP: 0.1792 NDCG: 0.4026
Validation loss decreased (2.161070 --> 2.158163).  Saving model ...

Epoch 76/99
----------
train Loss: 1.5778 LRAP: 0.1198 NDCG: 0.3649
val Loss: 2.1627 LRAP: 0.1906 NDCG: 0.4069
EarlyStopping counter: 1 out of 50

Epoch 77/99
----------
train Loss: 1.5719 LRAP: 0.1241 NDCG: 0.3644
val Loss: 2.1615 LRAP: 0.1817 NDCG: 0.4046
EarlyStopping counter: 2 out of 50

Epoch 78/99
----------
train Loss: 1.5531 LRAP: 0.1192 NDCG: 0.3666
val Loss: 2.1658 LRAP: 0.1944 NDCG: 0.4044
EarlyStopping counter: 3 out of 50

Epoch 79/99
----------
train Loss: 1.5432 LRAP: 0.1198 NDCG: 0.3670
val Loss: 2.1591 LRAP: 0.1817 NDCG: 0.4004
EarlyStopping counter: 4 out of 50

Epoch 80/99
----------
train Loss: 1.5403 LRAP: 0.1176 NDCG: 0.3670
val Loss: 2.1636 LRAP: 0.1919 NDCG: 0.4059
EarlyStopping counter: 5 out of 50

Epoch 81/99
----------
train Loss: 1.5210 LRAP: 0.1203 NDCG: 0.3694
val Loss: 2.1606 LRAP: 0.1868 NDCG: 0.4086
EarlyStopping counter: 6 out of 50

Epoch 82/99
----------
train Loss: 1.5344 LRAP: 0.1154 NDCG: 0.3673
val Loss: 2.1589 LRAP: 0.1817 NDCG: 0.4049
EarlyStopping counter: 7 out of 50

Epoch 83/99
----------
train Loss: 1.5248 LRAP: 0.1152 NDCG: 0.3680
val Loss: 2.1569 LRAP: 0.1792 NDCG: 0.4064
Validation loss decreased (2.158163 --> 2.156909).  Saving model ...

Epoch 84/99
----------
train Loss: 1.5169 LRAP: 0.1244 NDCG: 0.3675
val Loss: 2.1550 LRAP: 0.1868 NDCG: 0.4088
Validation loss decreased (2.156909 --> 2.154951).  Saving model ...

Epoch 85/99
----------
train Loss: 1.5132 LRAP: 0.1201 NDCG: 0.3668
val Loss: 2.1518 LRAP: 0.1842 NDCG: 0.4100
Validation loss decreased (2.154951 --> 2.151807).  Saving model ...

Epoch 86/99
----------
train Loss: 1.5122 LRAP: 0.1214 NDCG: 0.3663
val Loss: 2.1521 LRAP: 0.1893 NDCG: 0.4089
EarlyStopping counter: 1 out of 50

Epoch 87/99
----------
train Loss: 1.5025 LRAP: 0.1212 NDCG: 0.3684
val Loss: 2.1565 LRAP: 0.1881 NDCG: 0.4080
EarlyStopping counter: 2 out of 50

Epoch 88/99
----------
train Loss: 1.5200 LRAP: 0.1299 NDCG: 0.3683
val Loss: 2.1572 LRAP: 0.1817 NDCG: 0.4091
EarlyStopping counter: 3 out of 50

Epoch 89/99
----------
train Loss: 1.5049 LRAP: 0.1198 NDCG: 0.3675
val Loss: 2.1558 LRAP: 0.1842 NDCG: 0.4072
EarlyStopping counter: 4 out of 50

Epoch 90/99
----------
train Loss: 1.5005 LRAP: 0.1247 NDCG: 0.3695
val Loss: 2.1501 LRAP: 0.1830 NDCG: 0.4076
Validation loss decreased (2.151807 --> 2.150111).  Saving model ...

Epoch 91/99
----------
train Loss: 1.5078 LRAP: 0.1225 NDCG: 0.3685
val Loss: 2.1522 LRAP: 0.1842 NDCG: 0.4094
EarlyStopping counter: 1 out of 50

Epoch 92/99
----------
train Loss: 1.4959 LRAP: 0.1171 NDCG: 0.3683
val Loss: 2.1617 LRAP: 0.1842 NDCG: 0.4085
EarlyStopping counter: 2 out of 50

Epoch 93/99
----------
train Loss: 1.5139 LRAP: 0.1269 NDCG: 0.3681
val Loss: 2.1596 LRAP: 0.1830 NDCG: 0.4031
EarlyStopping counter: 3 out of 50

Epoch 94/99
----------
train Loss: 1.4991 LRAP: 0.1190 NDCG: 0.3685
val Loss: 2.1588 LRAP: 0.1830 NDCG: 0.4067
EarlyStopping counter: 4 out of 50

Epoch 95/99
----------
train Loss: 1.5010 LRAP: 0.1258 NDCG: 0.3705
val Loss: 2.1536 LRAP: 0.1842 NDCG: 0.4090
EarlyStopping counter: 5 out of 50

Epoch 96/99
----------
train Loss: 1.5048 LRAP: 0.1176 NDCG: 0.3712
val Loss: 2.1526 LRAP: 0.1855 NDCG: 0.4120
EarlyStopping counter: 6 out of 50

Epoch 97/99
----------
train Loss: 1.4995 LRAP: 0.1233 NDCG: 0.3678
val Loss: 2.1523 LRAP: 0.1855 NDCG: 0.4095
EarlyStopping counter: 7 out of 50

Epoch 98/99
----------
train Loss: 1.5032 LRAP: 0.1288 NDCG: 0.3691
val Loss: 2.1519 LRAP: 0.1842 NDCG: 0.4104
EarlyStopping counter: 8 out of 50

Epoch 99/99
----------
train Loss: 1.4941 LRAP: 0.1214 NDCG: 0.3686
val Loss: 2.1506 LRAP: 0.1842 NDCG: 0.4110
EarlyStopping counter: 9 out of 50

Training complete in 2m 26s
Best val loss: 2.150111, best LRAP score: 0.8076

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5676 LRAP: 0.0000 NDCG: 0.1649
val Loss: 9.7881 LRAP: 0.0000 NDCG: 0.1273
Validation loss decreased (0.000000 --> 9.788138).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0213 LRAP: 0.0000 NDCG: 0.1958
val Loss: 11.6619 LRAP: 0.0000 NDCG: 0.1535
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.8369 LRAP: 0.0005 NDCG: 0.2143
val Loss: 4.2206 LRAP: 0.0000 NDCG: 0.1810
Validation loss decreased (9.788138 --> 4.220620).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7419 LRAP: 0.0033 NDCG: 0.2173
val Loss: 6.0597 LRAP: 0.0000 NDCG: 0.1517
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.6905 LRAP: 0.0044 NDCG: 0.2195
val Loss: 4.0579 LRAP: 0.0000 NDCG: 0.1851
Validation loss decreased (4.220620 --> 4.057886).  Saving model ...

Epoch 5/99
----------
train Loss: 3.6187 LRAP: 0.0068 NDCG: 0.2212
val Loss: 4.4017 LRAP: 0.0076 NDCG: 0.2213
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.5751 LRAP: 0.0079 NDCG: 0.2248
val Loss: 3.7751 LRAP: 0.0051 NDCG: 0.2179
Validation loss decreased (4.057886 --> 3.775063).  Saving model ...

Epoch 7/99
----------
train Loss: 3.5286 LRAP: 0.0071 NDCG: 0.2281
val Loss: 3.5341 LRAP: 0.0076 NDCG: 0.2257
Validation loss decreased (3.775063 --> 3.534122).  Saving model ...

Epoch 8/99
----------
train Loss: 3.5176 LRAP: 0.0084 NDCG: 0.2293
val Loss: 3.6131 LRAP: 0.0064 NDCG: 0.2256
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.4875 LRAP: 0.0114 NDCG: 0.2311
val Loss: 4.0402 LRAP: 0.0076 NDCG: 0.2164
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.4381 LRAP: 0.0125 NDCG: 0.2344
val Loss: 5.5216 LRAP: 0.0000 NDCG: 0.1912
EarlyStopping counter: 3 out of 50

Epoch 11/99
----------
train Loss: 3.4183 LRAP: 0.0147 NDCG: 0.2346
val Loss: 3.7777 LRAP: 0.0064 NDCG: 0.2218
EarlyStopping counter: 4 out of 50

Epoch 12/99
----------
train Loss: 3.3694 LRAP: 0.0182 NDCG: 0.2406
val Loss: 4.1981 LRAP: 0.0203 NDCG: 0.2051
EarlyStopping counter: 5 out of 50

Epoch 13/99
----------
train Loss: 3.3313 LRAP: 0.0177 NDCG: 0.2443
val Loss: 3.3651 LRAP: 0.0114 NDCG: 0.2394
Validation loss decreased (3.534122 --> 3.365066).  Saving model ...

Epoch 14/99
----------
train Loss: 3.2990 LRAP: 0.0237 NDCG: 0.2449
val Loss: 3.5390 LRAP: 0.0102 NDCG: 0.2202
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 3.2792 LRAP: 0.0270 NDCG: 0.2451
val Loss: 3.4939 LRAP: 0.0025 NDCG: 0.2428
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 3.2757 LRAP: 0.0259 NDCG: 0.2463
val Loss: 3.5618 LRAP: 0.0305 NDCG: 0.2226
EarlyStopping counter: 3 out of 50

Epoch 17/99
----------
train Loss: 3.2577 LRAP: 0.0280 NDCG: 0.2471
val Loss: 3.7670 LRAP: 0.0292 NDCG: 0.2080
EarlyStopping counter: 4 out of 50

Epoch 18/99
----------
train Loss: 3.2446 LRAP: 0.0291 NDCG: 0.2484
val Loss: 3.7710 LRAP: 0.0191 NDCG: 0.2532
EarlyStopping counter: 5 out of 50

Epoch 19/99
----------
train Loss: 3.2129 LRAP: 0.0335 NDCG: 0.2486
val Loss: 3.2200 LRAP: 0.0445 NDCG: 0.2475
Validation loss decreased (3.365066 --> 3.220018).  Saving model ...

Epoch 20/99
----------
train Loss: 3.2191 LRAP: 0.0308 NDCG: 0.2486
val Loss: 3.2039 LRAP: 0.0419 NDCG: 0.2483
Validation loss decreased (3.220018 --> 3.203928).  Saving model ...

Epoch 21/99
----------
train Loss: 3.2116 LRAP: 0.0338 NDCG: 0.2511
val Loss: 3.2446 LRAP: 0.0432 NDCG: 0.2446
EarlyStopping counter: 1 out of 50

Epoch 22/99
----------
train Loss: 3.2261 LRAP: 0.0324 NDCG: 0.2490
val Loss: 3.1966 LRAP: 0.0368 NDCG: 0.2512
Validation loss decreased (3.203928 --> 3.196568).  Saving model ...

Epoch 23/99
----------
train Loss: 3.2154 LRAP: 0.0338 NDCG: 0.2522
val Loss: 3.2216 LRAP: 0.0394 NDCG: 0.2496
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 3.2194 LRAP: 0.0321 NDCG: 0.2509
val Loss: 3.2136 LRAP: 0.0394 NDCG: 0.2448
EarlyStopping counter: 2 out of 50

Epoch 25/99
----------
train Loss: 3.1928 LRAP: 0.0329 NDCG: 0.2515
val Loss: 3.1729 LRAP: 0.0470 NDCG: 0.2532
Validation loss decreased (3.196568 --> 3.172891).  Saving model ...

Epoch 26/99
----------
train Loss: 3.2096 LRAP: 0.0319 NDCG: 0.2523
val Loss: 3.2583 LRAP: 0.0534 NDCG: 0.2389
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.1895 LRAP: 0.0294 NDCG: 0.2501
val Loss: 3.1864 LRAP: 0.0305 NDCG: 0.2520
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 3.2031 LRAP: 0.0310 NDCG: 0.2508
val Loss: 3.2236 LRAP: 0.0445 NDCG: 0.2436
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 3.1940 LRAP: 0.0343 NDCG: 0.2518
val Loss: 3.1671 LRAP: 0.0292 NDCG: 0.2561
Validation loss decreased (3.172891 --> 3.167101).  Saving model ...

Epoch 30/99
----------
train Loss: 3.1880 LRAP: 0.0370 NDCG: 0.2512
val Loss: 3.1937 LRAP: 0.0432 NDCG: 0.2455
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 3.1927 LRAP: 0.0359 NDCG: 0.2516
val Loss: 3.1862 LRAP: 0.0457 NDCG: 0.2467
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 3.1898 LRAP: 0.0373 NDCG: 0.2534
val Loss: 3.1526 LRAP: 0.0330 NDCG: 0.2563
Validation loss decreased (3.167101 --> 3.152630).  Saving model ...

Epoch 33/99
----------
train Loss: 3.1766 LRAP: 0.0359 NDCG: 0.2515
val Loss: 3.1488 LRAP: 0.0419 NDCG: 0.2536
Validation loss decreased (3.152630 --> 3.148821).  Saving model ...

Epoch 34/99
----------
train Loss: 3.1783 LRAP: 0.0376 NDCG: 0.2524
val Loss: 3.1801 LRAP: 0.0661 NDCG: 0.2526
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.1617 LRAP: 0.0400 NDCG: 0.2527
val Loss: 3.2076 LRAP: 0.0737 NDCG: 0.2497
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 3.1759 LRAP: 0.0376 NDCG: 0.2542
val Loss: 3.1603 LRAP: 0.0267 NDCG: 0.2552
EarlyStopping counter: 3 out of 50

Epoch 37/99
----------
train Loss: 3.1765 LRAP: 0.0384 NDCG: 0.2530
val Loss: 3.1600 LRAP: 0.0432 NDCG: 0.2546
EarlyStopping counter: 4 out of 50

Epoch 38/99
----------
train Loss: 3.1627 LRAP: 0.0389 NDCG: 0.2547
val Loss: 3.1308 LRAP: 0.0508 NDCG: 0.2539
Validation loss decreased (3.148821 --> 3.130753).  Saving model ...

Epoch 39/99
----------
train Loss: 3.1584 LRAP: 0.0378 NDCG: 0.2548
val Loss: 3.2437 LRAP: 0.0648 NDCG: 0.2479
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 3.1648 LRAP: 0.0370 NDCG: 0.2537
val Loss: 3.1552 LRAP: 0.0165 NDCG: 0.2588
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 3.1620 LRAP: 0.0384 NDCG: 0.2544
val Loss: 3.1643 LRAP: 0.0648 NDCG: 0.2511
EarlyStopping counter: 3 out of 50

Epoch 42/99
----------
train Loss: 3.1605 LRAP: 0.0419 NDCG: 0.2552
val Loss: 3.1514 LRAP: 0.0470 NDCG: 0.2519
EarlyStopping counter: 4 out of 50

Epoch 43/99
----------
train Loss: 3.1520 LRAP: 0.0400 NDCG: 0.2550
val Loss: 3.1524 LRAP: 0.0496 NDCG: 0.2548
EarlyStopping counter: 5 out of 50

Epoch 44/99
----------
train Loss: 3.1412 LRAP: 0.0436 NDCG: 0.2554
val Loss: 3.1138 LRAP: 0.0432 NDCG: 0.2556
Validation loss decreased (3.130753 --> 3.113763).  Saving model ...

Epoch 45/99
----------
train Loss: 3.1577 LRAP: 0.0368 NDCG: 0.2535
val Loss: 3.1141 LRAP: 0.0457 NDCG: 0.2558
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 3.1430 LRAP: 0.0387 NDCG: 0.2557
val Loss: 3.1110 LRAP: 0.0432 NDCG: 0.2560
Validation loss decreased (3.113763 --> 3.111029).  Saving model ...

Epoch 47/99
----------
train Loss: 3.1490 LRAP: 0.0436 NDCG: 0.2551
val Loss: 3.1100 LRAP: 0.0483 NDCG: 0.2559
Validation loss decreased (3.111029 --> 3.110018).  Saving model ...

Epoch 48/99
----------
train Loss: 3.1395 LRAP: 0.0436 NDCG: 0.2549
val Loss: 3.1125 LRAP: 0.0521 NDCG: 0.2544
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 3.1455 LRAP: 0.0411 NDCG: 0.2555
val Loss: 3.1118 LRAP: 0.0496 NDCG: 0.2556
EarlyStopping counter: 2 out of 50

Epoch 50/99
----------
train Loss: 3.1557 LRAP: 0.0406 NDCG: 0.2541
val Loss: 3.1104 LRAP: 0.0470 NDCG: 0.2561
EarlyStopping counter: 3 out of 50

Epoch 51/99
----------
train Loss: 3.1506 LRAP: 0.0389 NDCG: 0.2553
val Loss: 3.1087 LRAP: 0.0368 NDCG: 0.2562
Validation loss decreased (3.110018 --> 3.108744).  Saving model ...

Epoch 52/99
----------
train Loss: 3.1391 LRAP: 0.0376 NDCG: 0.2559
val Loss: 3.1181 LRAP: 0.0521 NDCG: 0.2532
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 3.1482 LRAP: 0.0411 NDCG: 0.2545
val Loss: 3.1103 LRAP: 0.0483 NDCG: 0.2566
EarlyStopping counter: 2 out of 50

Epoch 54/99
----------
train Loss: 3.1389 LRAP: 0.0387 NDCG: 0.2565
val Loss: 3.1078 LRAP: 0.0496 NDCG: 0.2559
Validation loss decreased (3.108744 --> 3.107834).  Saving model ...

Epoch 55/99
----------
train Loss: 3.1449 LRAP: 0.0408 NDCG: 0.2559
val Loss: 3.1195 LRAP: 0.0572 NDCG: 0.2546
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 3.1370 LRAP: 0.0362 NDCG: 0.2553
val Loss: 3.1075 LRAP: 0.0534 NDCG: 0.2562
Validation loss decreased (3.107834 --> 3.107461).  Saving model ...

Epoch 57/99
----------
train Loss: 3.1329 LRAP: 0.0436 NDCG: 0.2546
val Loss: 3.1070 LRAP: 0.0534 NDCG: 0.2557
Validation loss decreased (3.107461 --> 3.107023).  Saving model ...

Epoch 58/99
----------
train Loss: 3.1436 LRAP: 0.0381 NDCG: 0.2561
val Loss: 3.1067 LRAP: 0.0546 NDCG: 0.2564
Validation loss decreased (3.107023 --> 3.106659).  Saving model ...

Epoch 59/99
----------
train Loss: 3.1319 LRAP: 0.0411 NDCG: 0.2548
val Loss: 3.1033 LRAP: 0.0534 NDCG: 0.2561
Validation loss decreased (3.106659 --> 3.103322).  Saving model ...

Epoch 60/99
----------
train Loss: 3.1302 LRAP: 0.0422 NDCG: 0.2558
val Loss: 3.1051 LRAP: 0.0445 NDCG: 0.2554
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 3.1403 LRAP: 0.0414 NDCG: 0.2548
val Loss: 3.1008 LRAP: 0.0559 NDCG: 0.2570
Validation loss decreased (3.103322 --> 3.100776).  Saving model ...

Epoch 62/99
----------
train Loss: 3.1405 LRAP: 0.0417 NDCG: 0.2552
val Loss: 3.1024 LRAP: 0.0546 NDCG: 0.2577
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 3.1393 LRAP: 0.0441 NDCG: 0.2565
val Loss: 3.1069 LRAP: 0.0546 NDCG: 0.2577
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 3.1343 LRAP: 0.0425 NDCG: 0.2561
val Loss: 3.1009 LRAP: 0.0483 NDCG: 0.2581
EarlyStopping counter: 3 out of 50

Epoch 65/99
----------
train Loss: 3.1345 LRAP: 0.0447 NDCG: 0.2578
val Loss: 3.1000 LRAP: 0.0508 NDCG: 0.2579
Validation loss decreased (3.100776 --> 3.100009).  Saving model ...

Epoch 66/99
----------
train Loss: 3.1308 LRAP: 0.0395 NDCG: 0.2591
val Loss: 3.1064 LRAP: 0.0572 NDCG: 0.2574
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 3.1428 LRAP: 0.0441 NDCG: 0.2551
val Loss: 3.0977 LRAP: 0.0457 NDCG: 0.2585
Validation loss decreased (3.100009 --> 3.097652).  Saving model ...

Epoch 68/99
----------
train Loss: 3.1306 LRAP: 0.0417 NDCG: 0.2570
val Loss: 3.0971 LRAP: 0.0508 NDCG: 0.2582
Validation loss decreased (3.097652 --> 3.097111).  Saving model ...

Epoch 69/99
----------
train Loss: 3.1348 LRAP: 0.0406 NDCG: 0.2573
val Loss: 3.1001 LRAP: 0.0546 NDCG: 0.2571
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 3.1215 LRAP: 0.0406 NDCG: 0.2575
val Loss: 3.1022 LRAP: 0.0559 NDCG: 0.2566
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 3.1290 LRAP: 0.0425 NDCG: 0.2569
val Loss: 3.1016 LRAP: 0.0546 NDCG: 0.2570
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 3.1286 LRAP: 0.0430 NDCG: 0.2567
val Loss: 3.0979 LRAP: 0.0584 NDCG: 0.2571
EarlyStopping counter: 4 out of 50

Epoch 73/99
----------
train Loss: 3.1196 LRAP: 0.0438 NDCG: 0.2571
val Loss: 3.1019 LRAP: 0.0572 NDCG: 0.2573
EarlyStopping counter: 5 out of 50

Epoch 74/99
----------
train Loss: 3.1298 LRAP: 0.0408 NDCG: 0.2568
val Loss: 3.0948 LRAP: 0.0572 NDCG: 0.2573
Validation loss decreased (3.097111 --> 3.094757).  Saving model ...

Epoch 75/99
----------
train Loss: 3.1216 LRAP: 0.0419 NDCG: 0.2577
val Loss: 3.0967 LRAP: 0.0559 NDCG: 0.2569
EarlyStopping counter: 1 out of 50

Epoch 76/99
----------
train Loss: 3.1440 LRAP: 0.0419 NDCG: 0.2571
val Loss: 3.0975 LRAP: 0.0496 NDCG: 0.2582
EarlyStopping counter: 2 out of 50

Epoch 77/99
----------
train Loss: 3.1321 LRAP: 0.0509 NDCG: 0.2580
val Loss: 3.0990 LRAP: 0.0521 NDCG: 0.2582
EarlyStopping counter: 3 out of 50

Epoch 78/99
----------
train Loss: 3.1309 LRAP: 0.0400 NDCG: 0.2577
val Loss: 3.0944 LRAP: 0.0521 NDCG: 0.2585
Validation loss decreased (3.094757 --> 3.094425).  Saving model ...

Epoch 79/99
----------
train Loss: 3.1427 LRAP: 0.0403 NDCG: 0.2562
val Loss: 3.0942 LRAP: 0.0546 NDCG: 0.2571
Validation loss decreased (3.094425 --> 3.094242).  Saving model ...

Epoch 80/99
----------
train Loss: 3.1290 LRAP: 0.0447 NDCG: 0.2559
val Loss: 3.0982 LRAP: 0.0572 NDCG: 0.2570
EarlyStopping counter: 1 out of 50

Epoch 81/99
----------
train Loss: 3.1319 LRAP: 0.0417 NDCG: 0.2565
val Loss: 3.0955 LRAP: 0.0572 NDCG: 0.2575
EarlyStopping counter: 2 out of 50

Epoch 82/99
----------
train Loss: 3.1238 LRAP: 0.0438 NDCG: 0.2574
val Loss: 3.0935 LRAP: 0.0534 NDCG: 0.2584
Validation loss decreased (3.094242 --> 3.093451).  Saving model ...

Epoch 83/99
----------
train Loss: 3.1119 LRAP: 0.0422 NDCG: 0.2589
val Loss: 3.0954 LRAP: 0.0559 NDCG: 0.2580
EarlyStopping counter: 1 out of 50

Epoch 84/99
----------
train Loss: 3.1294 LRAP: 0.0422 NDCG: 0.2575
val Loss: 3.0949 LRAP: 0.0572 NDCG: 0.2582
EarlyStopping counter: 2 out of 50

Epoch 85/99
----------
train Loss: 3.1288 LRAP: 0.0457 NDCG: 0.2569
val Loss: 3.0977 LRAP: 0.0559 NDCG: 0.2574
EarlyStopping counter: 3 out of 50

Epoch 86/99
----------
train Loss: 3.1194 LRAP: 0.0449 NDCG: 0.2601
val Loss: 3.0941 LRAP: 0.0559 NDCG: 0.2585
EarlyStopping counter: 4 out of 50

Epoch 87/99
----------
train Loss: 3.1349 LRAP: 0.0403 NDCG: 0.2563
val Loss: 3.0943 LRAP: 0.0559 NDCG: 0.2583
EarlyStopping counter: 5 out of 50

Epoch 88/99
----------
train Loss: 3.1254 LRAP: 0.0506 NDCG: 0.2583
val Loss: 3.0935 LRAP: 0.0508 NDCG: 0.2582
EarlyStopping counter: 6 out of 50

Epoch 89/99
----------
train Loss: 3.1233 LRAP: 0.0433 NDCG: 0.2582
val Loss: 3.0909 LRAP: 0.0470 NDCG: 0.2586
Validation loss decreased (3.093451 --> 3.090917).  Saving model ...

Epoch 90/99
----------
train Loss: 3.1109 LRAP: 0.0490 NDCG: 0.2581
val Loss: 3.0946 LRAP: 0.0584 NDCG: 0.2585
EarlyStopping counter: 1 out of 50

Epoch 91/99
----------
train Loss: 3.1272 LRAP: 0.0411 NDCG: 0.2573
val Loss: 3.0977 LRAP: 0.0572 NDCG: 0.2572
EarlyStopping counter: 2 out of 50

Epoch 92/99
----------
train Loss: 3.1263 LRAP: 0.0414 NDCG: 0.2587
val Loss: 3.0942 LRAP: 0.0559 NDCG: 0.2579
EarlyStopping counter: 3 out of 50

Epoch 93/99
----------
train Loss: 3.1153 LRAP: 0.0444 NDCG: 0.2581
val Loss: 3.0936 LRAP: 0.0597 NDCG: 0.2584
EarlyStopping counter: 4 out of 50

Epoch 94/99
----------
train Loss: 3.1205 LRAP: 0.0468 NDCG: 0.2567
val Loss: 3.0947 LRAP: 0.0559 NDCG: 0.2576
EarlyStopping counter: 5 out of 50

Epoch 95/99
----------
train Loss: 3.1298 LRAP: 0.0430 NDCG: 0.2571
val Loss: 3.0944 LRAP: 0.0559 NDCG: 0.2588
EarlyStopping counter: 6 out of 50

Epoch 96/99
----------
train Loss: 3.1339 LRAP: 0.0438 NDCG: 0.2583
val Loss: 3.0936 LRAP: 0.0572 NDCG: 0.2582
EarlyStopping counter: 7 out of 50

Epoch 97/99
----------
train Loss: 3.1206 LRAP: 0.0430 NDCG: 0.2575
val Loss: 3.0944 LRAP: 0.0559 NDCG: 0.2587
EarlyStopping counter: 8 out of 50

Epoch 98/99
----------
train Loss: 3.1343 LRAP: 0.0463 NDCG: 0.2588
val Loss: 3.0916 LRAP: 0.0559 NDCG: 0.2586
EarlyStopping counter: 9 out of 50

Epoch 99/99
----------
train Loss: 3.1371 LRAP: 0.0427 NDCG: 0.2562
val Loss: 3.0927 LRAP: 0.0572 NDCG: 0.2580
EarlyStopping counter: 10 out of 50

Training complete in 2m 28s
Best val loss: 3.090917, best LRAP score: 0.6013

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.5588 LRAP: 0.0000 NDCG: 0.1647
val Loss: 11.2428 LRAP: 0.0000 NDCG: 0.1201
Validation loss decreased (0.000000 --> 11.242772).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9951 LRAP: 0.0003 NDCG: 0.1948
val Loss: 3.9240 LRAP: 0.0038 NDCG: 0.2087
Validation loss decreased (11.242772 --> 3.923965).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8806 LRAP: 0.0057 NDCG: 0.2121
val Loss: 4.9416 LRAP: 0.0089 NDCG: 0.2217
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.8089 LRAP: 0.0057 NDCG: 0.2119
val Loss: 3.9815 LRAP: 0.0076 NDCG: 0.2286
EarlyStopping counter: 2 out of 50

Epoch 4/99
----------
train Loss: 3.7686 LRAP: 0.0079 NDCG: 0.2174
val Loss: 3.8134 LRAP: 0.0076 NDCG: 0.2274
Validation loss decreased (3.923965 --> 3.813412).  Saving model ...

Epoch 5/99
----------
train Loss: 3.7351 LRAP: 0.0084 NDCG: 0.2192
val Loss: 4.5369 LRAP: 0.0076 NDCG: 0.1928
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.6954 LRAP: 0.0120 NDCG: 0.2212
val Loss: 4.7603 LRAP: 0.0051 NDCG: 0.1845
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.6559 LRAP: 0.0120 NDCG: 0.2223
val Loss: 4.6388 LRAP: 0.0051 NDCG: 0.1969
EarlyStopping counter: 3 out of 50

Epoch 8/99
----------
train Loss: 3.6400 LRAP: 0.0218 NDCG: 0.2273
val Loss: 5.5672 LRAP: 0.0000 NDCG: 0.1568
EarlyStopping counter: 4 out of 50

Epoch 9/99
----------
train Loss: 3.6270 LRAP: 0.0155 NDCG: 0.2272
val Loss: 4.3291 LRAP: 0.0064 NDCG: 0.2037
EarlyStopping counter: 5 out of 50

Epoch 10/99
----------
train Loss: 3.5596 LRAP: 0.0264 NDCG: 0.2330
val Loss: 3.9775 LRAP: 0.0076 NDCG: 0.1944
EarlyStopping counter: 6 out of 50

Epoch 11/99
----------
train Loss: 3.5339 LRAP: 0.0212 NDCG: 0.2324
val Loss: 3.9223 LRAP: 0.0076 NDCG: 0.2167
EarlyStopping counter: 7 out of 50

Epoch 12/99
----------
train Loss: 3.5266 LRAP: 0.0218 NDCG: 0.2335
val Loss: 3.5807 LRAP: 0.0076 NDCG: 0.2202
Validation loss decreased (3.813412 --> 3.580735).  Saving model ...

Epoch 13/99
----------
train Loss: 3.5066 LRAP: 0.0218 NDCG: 0.2343
val Loss: 3.6984 LRAP: 0.0318 NDCG: 0.2283
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.5159 LRAP: 0.0327 NDCG: 0.2328
val Loss: 3.6224 LRAP: 0.0292 NDCG: 0.2217
EarlyStopping counter: 2 out of 50

Epoch 15/99
----------
train Loss: 3.4972 LRAP: 0.0351 NDCG: 0.2351
val Loss: 4.1732 LRAP: 0.0038 NDCG: 0.1989
EarlyStopping counter: 3 out of 50

Epoch 16/99
----------
train Loss: 3.4885 LRAP: 0.0313 NDCG: 0.2342
val Loss: 3.6906 LRAP: 0.0432 NDCG: 0.2170
EarlyStopping counter: 4 out of 50

Epoch 17/99
----------
train Loss: 3.4729 LRAP: 0.0332 NDCG: 0.2378
val Loss: 3.9314 LRAP: 0.0673 NDCG: 0.1984
EarlyStopping counter: 5 out of 50

Epoch 18/99
----------
train Loss: 3.4635 LRAP: 0.0321 NDCG: 0.2379
val Loss: 3.5195 LRAP: 0.0076 NDCG: 0.2335
Validation loss decreased (3.580735 --> 3.519454).  Saving model ...

Epoch 19/99
----------
train Loss: 3.4578 LRAP: 0.0346 NDCG: 0.2368
val Loss: 3.4519 LRAP: 0.0318 NDCG: 0.2360
Validation loss decreased (3.519454 --> 3.451880).  Saving model ...

Epoch 20/99
----------
train Loss: 3.4470 LRAP: 0.0324 NDCG: 0.2374
val Loss: 3.4295 LRAP: 0.0241 NDCG: 0.2394
Validation loss decreased (3.451880 --> 3.429525).  Saving model ...

Epoch 21/99
----------
train Loss: 3.4540 LRAP: 0.0335 NDCG: 0.2379
val Loss: 3.4249 LRAP: 0.0203 NDCG: 0.2392
Validation loss decreased (3.429525 --> 3.424863).  Saving model ...

Epoch 22/99
----------
train Loss: 3.4497 LRAP: 0.0332 NDCG: 0.2388
val Loss: 3.4362 LRAP: 0.0229 NDCG: 0.2396
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 3.4314 LRAP: 0.0346 NDCG: 0.2393
val Loss: 3.4407 LRAP: 0.0216 NDCG: 0.2343
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 3.4421 LRAP: 0.0316 NDCG: 0.2385
val Loss: 3.5322 LRAP: 0.0572 NDCG: 0.2351
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 3.4422 LRAP: 0.0403 NDCG: 0.2391
val Loss: 3.4181 LRAP: 0.0229 NDCG: 0.2413
Validation loss decreased (3.424863 --> 3.418120).  Saving model ...

Epoch 26/99
----------
train Loss: 3.4235 LRAP: 0.0447 NDCG: 0.2395
val Loss: 3.4336 LRAP: 0.0191 NDCG: 0.2401
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.4329 LRAP: 0.0403 NDCG: 0.2390
val Loss: 3.4252 LRAP: 0.0241 NDCG: 0.2378
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 3.4399 LRAP: 0.0406 NDCG: 0.2389
val Loss: 3.4437 LRAP: 0.0432 NDCG: 0.2340
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 3.4362 LRAP: 0.0436 NDCG: 0.2389
val Loss: 3.4534 LRAP: 0.0559 NDCG: 0.2370
EarlyStopping counter: 4 out of 50

Epoch 30/99
----------
train Loss: 3.4253 LRAP: 0.0392 NDCG: 0.2396
val Loss: 3.4404 LRAP: 0.0165 NDCG: 0.2380
EarlyStopping counter: 5 out of 50

Epoch 31/99
----------
train Loss: 3.4142 LRAP: 0.0422 NDCG: 0.2390
val Loss: 3.4069 LRAP: 0.0496 NDCG: 0.2406
Validation loss decreased (3.418120 --> 3.406941).  Saving model ...

Epoch 32/99
----------
train Loss: 3.4257 LRAP: 0.0419 NDCG: 0.2403
val Loss: 3.4046 LRAP: 0.0381 NDCG: 0.2421
Validation loss decreased (3.406941 --> 3.404624).  Saving model ...

Epoch 33/99
----------
train Loss: 3.4128 LRAP: 0.0444 NDCG: 0.2423
val Loss: 3.4013 LRAP: 0.0407 NDCG: 0.2420
Validation loss decreased (3.404624 --> 3.401342).  Saving model ...

Epoch 34/99
----------
train Loss: 3.4198 LRAP: 0.0427 NDCG: 0.2419
val Loss: 3.4064 LRAP: 0.0419 NDCG: 0.2409
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.4131 LRAP: 0.0403 NDCG: 0.2409
val Loss: 3.4006 LRAP: 0.0419 NDCG: 0.2406
Validation loss decreased (3.401342 --> 3.400642).  Saving model ...

Epoch 36/99
----------
train Loss: 3.4155 LRAP: 0.0436 NDCG: 0.2402
val Loss: 3.4051 LRAP: 0.0483 NDCG: 0.2420
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 3.4201 LRAP: 0.0397 NDCG: 0.2399
val Loss: 3.3987 LRAP: 0.0445 NDCG: 0.2397
Validation loss decreased (3.400642 --> 3.398696).  Saving model ...

Epoch 38/99
----------
train Loss: 3.4230 LRAP: 0.0476 NDCG: 0.2413
val Loss: 3.3999 LRAP: 0.0356 NDCG: 0.2418
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 3.4245 LRAP: 0.0485 NDCG: 0.2397
val Loss: 3.3987 LRAP: 0.0419 NDCG: 0.2404
Validation loss decreased (3.398696 --> 3.398652).  Saving model ...

Epoch 40/99
----------
train Loss: 3.4001 LRAP: 0.0427 NDCG: 0.2409
val Loss: 3.3987 LRAP: 0.0368 NDCG: 0.2418
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 3.4120 LRAP: 0.0457 NDCG: 0.2389
val Loss: 3.3997 LRAP: 0.0381 NDCG: 0.2421
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 3.4052 LRAP: 0.0449 NDCG: 0.2405
val Loss: 3.3962 LRAP: 0.0343 NDCG: 0.2408
Validation loss decreased (3.398652 --> 3.396165).  Saving model ...

Epoch 43/99
----------
train Loss: 3.4178 LRAP: 0.0417 NDCG: 0.2414
val Loss: 3.3987 LRAP: 0.0445 NDCG: 0.2398
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.4280 LRAP: 0.0436 NDCG: 0.2393
val Loss: 3.3984 LRAP: 0.0343 NDCG: 0.2423
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 3.4073 LRAP: 0.0425 NDCG: 0.2413
val Loss: 3.3970 LRAP: 0.0407 NDCG: 0.2418
EarlyStopping counter: 3 out of 50

Epoch 46/99
----------
train Loss: 3.4114 LRAP: 0.0433 NDCG: 0.2417
val Loss: 3.3962 LRAP: 0.0343 NDCG: 0.2428
EarlyStopping counter: 4 out of 50

Epoch 47/99
----------
train Loss: 3.4010 LRAP: 0.0436 NDCG: 0.2407
val Loss: 3.3959 LRAP: 0.0381 NDCG: 0.2404
Validation loss decreased (3.396165 --> 3.395921).  Saving model ...

Epoch 48/99
----------
train Loss: 3.4162 LRAP: 0.0466 NDCG: 0.2422
val Loss: 3.3939 LRAP: 0.0368 NDCG: 0.2420
Validation loss decreased (3.395921 --> 3.393942).  Saving model ...

Epoch 49/99
----------
train Loss: 3.4250 LRAP: 0.0425 NDCG: 0.2399
val Loss: 3.3930 LRAP: 0.0356 NDCG: 0.2410
Validation loss decreased (3.393942 --> 3.392953).  Saving model ...

Epoch 50/99
----------
train Loss: 3.4163 LRAP: 0.0471 NDCG: 0.2406
val Loss: 3.3964 LRAP: 0.0407 NDCG: 0.2422
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 3.4060 LRAP: 0.0457 NDCG: 0.2408
val Loss: 3.3937 LRAP: 0.0445 NDCG: 0.2412
EarlyStopping counter: 2 out of 50

Epoch 52/99
----------
train Loss: 3.3952 LRAP: 0.0482 NDCG: 0.2420
val Loss: 3.3947 LRAP: 0.0394 NDCG: 0.2424
EarlyStopping counter: 3 out of 50

Epoch 53/99
----------
train Loss: 3.4080 LRAP: 0.0433 NDCG: 0.2402
val Loss: 3.3936 LRAP: 0.0394 NDCG: 0.2398
EarlyStopping counter: 4 out of 50

Epoch 54/99
----------
train Loss: 3.4120 LRAP: 0.0452 NDCG: 0.2411
val Loss: 3.3946 LRAP: 0.0381 NDCG: 0.2430
EarlyStopping counter: 5 out of 50

Epoch 55/99
----------
train Loss: 3.4083 LRAP: 0.0397 NDCG: 0.2401
val Loss: 3.3922 LRAP: 0.0368 NDCG: 0.2422
Validation loss decreased (3.392953 --> 3.392242).  Saving model ...

Epoch 56/99
----------
train Loss: 3.4096 LRAP: 0.0422 NDCG: 0.2414
val Loss: 3.3932 LRAP: 0.0432 NDCG: 0.2417
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 3.4157 LRAP: 0.0449 NDCG: 0.2422
val Loss: 3.3935 LRAP: 0.0445 NDCG: 0.2422
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 3.4102 LRAP: 0.0457 NDCG: 0.2411
val Loss: 3.3939 LRAP: 0.0343 NDCG: 0.2419
EarlyStopping counter: 3 out of 50

Epoch 59/99
----------
train Loss: 3.4170 LRAP: 0.0452 NDCG: 0.2402
val Loss: 3.3946 LRAP: 0.0445 NDCG: 0.2419
EarlyStopping counter: 4 out of 50

Epoch 60/99
----------
train Loss: 3.4047 LRAP: 0.0506 NDCG: 0.2400
val Loss: 3.3924 LRAP: 0.0445 NDCG: 0.2415
EarlyStopping counter: 5 out of 50

Epoch 61/99
----------
train Loss: 3.4175 LRAP: 0.0460 NDCG: 0.2408
val Loss: 3.3948 LRAP: 0.0445 NDCG: 0.2409
EarlyStopping counter: 6 out of 50

Epoch 62/99
----------
train Loss: 3.4192 LRAP: 0.0422 NDCG: 0.2407
val Loss: 3.3927 LRAP: 0.0381 NDCG: 0.2406
EarlyStopping counter: 7 out of 50

Epoch 63/99
----------
train Loss: 3.4092 LRAP: 0.0452 NDCG: 0.2404
val Loss: 3.3948 LRAP: 0.0394 NDCG: 0.2424
EarlyStopping counter: 8 out of 50

Epoch 64/99
----------
train Loss: 3.4164 LRAP: 0.0436 NDCG: 0.2395
val Loss: 3.3949 LRAP: 0.0584 NDCG: 0.2415
EarlyStopping counter: 9 out of 50

Epoch 65/99
----------
train Loss: 3.4194 LRAP: 0.0433 NDCG: 0.2420
val Loss: 3.3936 LRAP: 0.0496 NDCG: 0.2401
EarlyStopping counter: 10 out of 50

Epoch 66/99
----------
train Loss: 3.4192 LRAP: 0.0417 NDCG: 0.2408
val Loss: 3.3923 LRAP: 0.0445 NDCG: 0.2410
EarlyStopping counter: 11 out of 50

Epoch 67/99
----------
train Loss: 3.3978 LRAP: 0.0455 NDCG: 0.2400
val Loss: 3.3924 LRAP: 0.0445 NDCG: 0.2419
EarlyStopping counter: 12 out of 50

Epoch 68/99
----------
train Loss: 3.4033 LRAP: 0.0441 NDCG: 0.2411
val Loss: 3.3938 LRAP: 0.0368 NDCG: 0.2416
EarlyStopping counter: 13 out of 50

Epoch 69/99
----------
train Loss: 3.4106 LRAP: 0.0438 NDCG: 0.2409
val Loss: 3.3926 LRAP: 0.0343 NDCG: 0.2417
EarlyStopping counter: 14 out of 50

Epoch 70/99
----------
train Loss: 3.4105 LRAP: 0.0496 NDCG: 0.2402
val Loss: 3.3939 LRAP: 0.0546 NDCG: 0.2413
EarlyStopping counter: 15 out of 50

Epoch 71/99
----------
train Loss: 3.4156 LRAP: 0.0474 NDCG: 0.2396
val Loss: 3.3934 LRAP: 0.0432 NDCG: 0.2413
EarlyStopping counter: 16 out of 50

Epoch 72/99
----------
train Loss: 3.4109 LRAP: 0.0433 NDCG: 0.2414
val Loss: 3.3933 LRAP: 0.0330 NDCG: 0.2426
EarlyStopping counter: 17 out of 50

Epoch 73/99
----------
train Loss: 3.4097 LRAP: 0.0427 NDCG: 0.2406
val Loss: 3.3946 LRAP: 0.0445 NDCG: 0.2415
EarlyStopping counter: 18 out of 50

Epoch 74/99
----------
train Loss: 3.3954 LRAP: 0.0496 NDCG: 0.2421
val Loss: 3.3948 LRAP: 0.0381 NDCG: 0.2408
EarlyStopping counter: 19 out of 50

Epoch 75/99
----------
train Loss: 3.4048 LRAP: 0.0411 NDCG: 0.2407
val Loss: 3.3934 LRAP: 0.0407 NDCG: 0.2412
EarlyStopping counter: 20 out of 50

Epoch 76/99
----------
train Loss: 3.4008 LRAP: 0.0444 NDCG: 0.2412
val Loss: 3.3928 LRAP: 0.0445 NDCG: 0.2422
EarlyStopping counter: 21 out of 50

Epoch 77/99
----------
train Loss: 3.4066 LRAP: 0.0468 NDCG: 0.2406
val Loss: 3.3932 LRAP: 0.0407 NDCG: 0.2416
EarlyStopping counter: 22 out of 50

Epoch 78/99
----------
train Loss: 3.4072 LRAP: 0.0441 NDCG: 0.2390
val Loss: 3.3944 LRAP: 0.0445 NDCG: 0.2425
EarlyStopping counter: 23 out of 50

Epoch 79/99
----------
train Loss: 3.4267 LRAP: 0.0455 NDCG: 0.2402
val Loss: 3.3930 LRAP: 0.0368 NDCG: 0.2413
EarlyStopping counter: 24 out of 50

Epoch 80/99
----------
train Loss: 3.4071 LRAP: 0.0433 NDCG: 0.2399
val Loss: 3.3947 LRAP: 0.0368 NDCG: 0.2414
EarlyStopping counter: 25 out of 50

Epoch 81/99
----------
train Loss: 3.3867 LRAP: 0.0460 NDCG: 0.2405
val Loss: 3.3915 LRAP: 0.0445 NDCG: 0.2407
Validation loss decreased (3.392242 --> 3.391525).  Saving model ...

Epoch 82/99
----------
train Loss: 3.4112 LRAP: 0.0381 NDCG: 0.2420
val Loss: 3.3925 LRAP: 0.0356 NDCG: 0.2407
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.4124 LRAP: 0.0463 NDCG: 0.2417
val Loss: 3.3928 LRAP: 0.0343 NDCG: 0.2413
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.4071 LRAP: 0.0425 NDCG: 0.2394
val Loss: 3.3959 LRAP: 0.0356 NDCG: 0.2431
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.4117 LRAP: 0.0460 NDCG: 0.2410
val Loss: 3.3944 LRAP: 0.0356 NDCG: 0.2421
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.4122 LRAP: 0.0466 NDCG: 0.2415
val Loss: 3.3937 LRAP: 0.0394 NDCG: 0.2416
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 3.4041 LRAP: 0.0455 NDCG: 0.2405
val Loss: 3.3925 LRAP: 0.0394 NDCG: 0.2425
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 3.4092 LRAP: 0.0457 NDCG: 0.2417
val Loss: 3.3931 LRAP: 0.0381 NDCG: 0.2426
EarlyStopping counter: 7 out of 50

Epoch 89/99
----------
train Loss: 3.4163 LRAP: 0.0474 NDCG: 0.2414
val Loss: 3.3922 LRAP: 0.0381 NDCG: 0.2410
EarlyStopping counter: 8 out of 50

Epoch 90/99
----------
train Loss: 3.4061 LRAP: 0.0444 NDCG: 0.2396
val Loss: 3.3934 LRAP: 0.0343 NDCG: 0.2416
EarlyStopping counter: 9 out of 50

Epoch 91/99
----------
train Loss: 3.4149 LRAP: 0.0406 NDCG: 0.2402
val Loss: 3.3943 LRAP: 0.0445 NDCG: 0.2408
EarlyStopping counter: 10 out of 50

Epoch 92/99
----------
train Loss: 3.4129 LRAP: 0.0463 NDCG: 0.2411
val Loss: 3.3943 LRAP: 0.0445 NDCG: 0.2429
EarlyStopping counter: 11 out of 50

Epoch 93/99
----------
train Loss: 3.4075 LRAP: 0.0438 NDCG: 0.2404
val Loss: 3.3956 LRAP: 0.0368 NDCG: 0.2422
EarlyStopping counter: 12 out of 50

Epoch 94/99
----------
train Loss: 3.3995 LRAP: 0.0430 NDCG: 0.2416
val Loss: 3.3923 LRAP: 0.0343 NDCG: 0.2415
EarlyStopping counter: 13 out of 50

Epoch 95/99
----------
train Loss: 3.4131 LRAP: 0.0476 NDCG: 0.2397
val Loss: 3.3925 LRAP: 0.0368 NDCG: 0.2415
EarlyStopping counter: 14 out of 50

Epoch 96/99
----------
train Loss: 3.4064 LRAP: 0.0430 NDCG: 0.2410
val Loss: 3.3932 LRAP: 0.0381 NDCG: 0.2418
EarlyStopping counter: 15 out of 50

Epoch 97/99
----------
train Loss: 3.4089 LRAP: 0.0427 NDCG: 0.2404
val Loss: 3.3952 LRAP: 0.0356 NDCG: 0.2421
EarlyStopping counter: 16 out of 50

Epoch 98/99
----------
train Loss: 3.4093 LRAP: 0.0466 NDCG: 0.2411
val Loss: 3.3929 LRAP: 0.0356 NDCG: 0.2411
EarlyStopping counter: 17 out of 50

Epoch 99/99
----------
train Loss: 3.4053 LRAP: 0.0457 NDCG: 0.2413
val Loss: 3.3943 LRAP: 0.0330 NDCG: 0.2425
EarlyStopping counter: 18 out of 50

Training complete in 2m 26s
Best val loss: 3.391525, best LRAP score: 0.5475

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 7/10

All random seeds set to: 48
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.4611 LRAP: 0.0000 NDCG: 0.1662
val Loss: 4.4642 LRAP: 0.0000 NDCG: 0.1932
Validation loss decreased (0.000000 --> 4.464191).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9435 LRAP: 0.0025 NDCG: 0.1977
val Loss: 4.0644 LRAP: 0.0889 NDCG: 0.2288
Validation loss decreased (4.464191 --> 4.064432).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8183 LRAP: 0.0087 NDCG: 0.2133
val Loss: 3.8318 LRAP: 0.0064 NDCG: 0.2173
Validation loss decreased (4.064432 --> 3.831792).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6717 LRAP: 0.0057 NDCG: 0.2217
val Loss: 3.9405 LRAP: 0.0064 NDCG: 0.2071
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.5877 LRAP: 0.0136 NDCG: 0.2260
val Loss: 3.7381 LRAP: 0.0064 NDCG: 0.2088
Validation loss decreased (3.831792 --> 3.738148).  Saving model ...

Epoch 5/99
----------
train Loss: 3.5033 LRAP: 0.0368 NDCG: 0.2282
val Loss: 3.5440 LRAP: 0.0572 NDCG: 0.2191
Validation loss decreased (3.738148 --> 3.543952).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4520 LRAP: 0.0365 NDCG: 0.2295
val Loss: 4.0526 LRAP: 0.0457 NDCG: 0.2203
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.3489 LRAP: 0.0490 NDCG: 0.2380
val Loss: 3.7403 LRAP: 0.0584 NDCG: 0.2313
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.3099 LRAP: 0.0599 NDCG: 0.2412
val Loss: 3.3569 LRAP: 0.1080 NDCG: 0.2547
Validation loss decreased (3.543952 --> 3.356942).  Saving model ...

Epoch 9/99
----------
train Loss: 3.2577 LRAP: 0.0629 NDCG: 0.2476
val Loss: 3.4887 LRAP: 0.0521 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.1929 LRAP: 0.0596 NDCG: 0.2513
val Loss: 3.2406 LRAP: 0.1105 NDCG: 0.2534
Validation loss decreased (3.356942 --> 3.240552).  Saving model ...

Epoch 11/99
----------
train Loss: 3.1364 LRAP: 0.0574 NDCG: 0.2548
val Loss: 3.1894 LRAP: 0.0788 NDCG: 0.2747
Validation loss decreased (3.240552 --> 3.189379).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0891 LRAP: 0.0713 NDCG: 0.2628
val Loss: 3.2329 LRAP: 0.1067 NDCG: 0.2570
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0423 LRAP: 0.0792 NDCG: 0.2642
val Loss: 3.2116 LRAP: 0.1118 NDCG: 0.2717
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 3.0047 LRAP: 0.0874 NDCG: 0.2669
val Loss: 3.1116 LRAP: 0.1131 NDCG: 0.2550
Validation loss decreased (3.189379 --> 3.111626).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9456 LRAP: 0.0849 NDCG: 0.2721
val Loss: 3.0099 LRAP: 0.1144 NDCG: 0.2668
Validation loss decreased (3.111626 --> 3.009870).  Saving model ...

Epoch 16/99
----------
train Loss: 2.9203 LRAP: 0.0749 NDCG: 0.2712
val Loss: 3.0348 LRAP: 0.1029 NDCG: 0.2760
EarlyStopping counter: 1 out of 50

Epoch 17/99
----------
train Loss: 2.8613 LRAP: 0.0847 NDCG: 0.2778
val Loss: 2.9295 LRAP: 0.0953 NDCG: 0.2822
Validation loss decreased (3.009870 --> 2.929500).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8581 LRAP: 0.0858 NDCG: 0.2783
val Loss: 3.2343 LRAP: 0.0915 NDCG: 0.2872
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.8211 LRAP: 0.0819 NDCG: 0.2805
val Loss: 2.9219 LRAP: 0.1067 NDCG: 0.2833
Validation loss decreased (2.929500 --> 2.921933).  Saving model ...

Epoch 20/99
----------
train Loss: 2.7684 LRAP: 0.0918 NDCG: 0.2881
val Loss: 2.8609 LRAP: 0.1169 NDCG: 0.2835
Validation loss decreased (2.921933 --> 2.860917).  Saving model ...

Epoch 21/99
----------
train Loss: 2.7316 LRAP: 0.0904 NDCG: 0.2852
val Loss: 2.8180 LRAP: 0.1017 NDCG: 0.2889
Validation loss decreased (2.860917 --> 2.817956).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7003 LRAP: 0.0953 NDCG: 0.2922
val Loss: 2.9098 LRAP: 0.1182 NDCG: 0.2999
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.6774 LRAP: 0.0893 NDCG: 0.2952
val Loss: 2.7863 LRAP: 0.1080 NDCG: 0.2994
Validation loss decreased (2.817956 --> 2.786281).  Saving model ...

Epoch 24/99
----------
train Loss: 2.6320 LRAP: 0.0904 NDCG: 0.2988
val Loss: 2.7910 LRAP: 0.1258 NDCG: 0.3009
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.5964 LRAP: 0.0912 NDCG: 0.3017
val Loss: 2.7505 LRAP: 0.0648 NDCG: 0.3038
Validation loss decreased (2.786281 --> 2.750461).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5827 LRAP: 0.0841 NDCG: 0.3026
val Loss: 2.7088 LRAP: 0.1093 NDCG: 0.3054
Validation loss decreased (2.750461 --> 2.708828).  Saving model ...

Epoch 27/99
----------
train Loss: 2.5295 LRAP: 0.0939 NDCG: 0.3066
val Loss: 2.7114 LRAP: 0.1042 NDCG: 0.3222
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 2.4956 LRAP: 0.0896 NDCG: 0.3110
val Loss: 2.6609 LRAP: 0.1233 NDCG: 0.3109
Validation loss decreased (2.708828 --> 2.660855).  Saving model ...

Epoch 29/99
----------
train Loss: 2.4771 LRAP: 0.0958 NDCG: 0.3128
val Loss: 2.6338 LRAP: 0.1271 NDCG: 0.3247
Validation loss decreased (2.660855 --> 2.633839).  Saving model ...

Epoch 30/99
----------
train Loss: 2.4539 LRAP: 0.0937 NDCG: 0.3148
val Loss: 2.6598 LRAP: 0.1156 NDCG: 0.3155
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 2.4100 LRAP: 0.0961 NDCG: 0.3154
val Loss: 2.7116 LRAP: 0.1017 NDCG: 0.3042
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 2.3757 LRAP: 0.0969 NDCG: 0.3162
val Loss: 2.6769 LRAP: 0.1131 NDCG: 0.3345
EarlyStopping counter: 3 out of 50

Epoch 33/99
----------
train Loss: 2.3628 LRAP: 0.0975 NDCG: 0.3223
val Loss: 2.5821 LRAP: 0.1207 NDCG: 0.3306
Validation loss decreased (2.633839 --> 2.582138).  Saving model ...

Epoch 34/99
----------
train Loss: 2.3279 LRAP: 0.1032 NDCG: 0.3231
val Loss: 2.5999 LRAP: 0.0889 NDCG: 0.3382
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 2.3062 LRAP: 0.1032 NDCG: 0.3269
val Loss: 2.6128 LRAP: 0.1207 NDCG: 0.3221
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 2.2574 LRAP: 0.0999 NDCG: 0.3281
val Loss: 2.5644 LRAP: 0.1144 NDCG: 0.3419
Validation loss decreased (2.582138 --> 2.564440).  Saving model ...

Epoch 37/99
----------
train Loss: 2.2659 LRAP: 0.1005 NDCG: 0.3296
val Loss: 2.6021 LRAP: 0.1258 NDCG: 0.3344
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 2.2110 LRAP: 0.1026 NDCG: 0.3323
val Loss: 2.5015 LRAP: 0.1283 NDCG: 0.3427
Validation loss decreased (2.564440 --> 2.501537).  Saving model ...

Epoch 39/99
----------
train Loss: 2.1957 LRAP: 0.1081 NDCG: 0.3300
val Loss: 2.5024 LRAP: 0.1334 NDCG: 0.3536
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.1813 LRAP: 0.1013 NDCG: 0.3332
val Loss: 2.4851 LRAP: 0.1398 NDCG: 0.3609
Validation loss decreased (2.501537 --> 2.485141).  Saving model ...

Epoch 41/99
----------
train Loss: 2.1348 LRAP: 0.1018 NDCG: 0.3381
val Loss: 2.4598 LRAP: 0.1347 NDCG: 0.3527
Validation loss decreased (2.485141 --> 2.459780).  Saving model ...

Epoch 42/99
----------
train Loss: 2.1230 LRAP: 0.1111 NDCG: 0.3384
val Loss: 2.4947 LRAP: 0.1334 NDCG: 0.3503
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 2.0604 LRAP: 0.1078 NDCG: 0.3398
val Loss: 2.4767 LRAP: 0.1423 NDCG: 0.3550
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 2.0751 LRAP: 0.1056 NDCG: 0.3400
val Loss: 2.5313 LRAP: 0.1347 NDCG: 0.3672
EarlyStopping counter: 3 out of 50

Epoch 45/99
----------
train Loss: 2.0359 LRAP: 0.1108 NDCG: 0.3435
val Loss: 2.4615 LRAP: 0.1398 NDCG: 0.3722
EarlyStopping counter: 4 out of 50

Epoch 46/99
----------
train Loss: 2.0318 LRAP: 0.1086 NDCG: 0.3443
val Loss: 2.4626 LRAP: 0.1512 NDCG: 0.3600
EarlyStopping counter: 5 out of 50

Epoch 47/99
----------
train Loss: 1.9186 LRAP: 0.1217 NDCG: 0.3499
val Loss: 2.3735 LRAP: 0.1398 NDCG: 0.3737
Validation loss decreased (2.459780 --> 2.373495).  Saving model ...

Epoch 48/99
----------
train Loss: 1.8781 LRAP: 0.1160 NDCG: 0.3541
val Loss: 2.3839 LRAP: 0.1385 NDCG: 0.3727
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 1.8609 LRAP: 0.1165 NDCG: 0.3526
val Loss: 2.3708 LRAP: 0.1372 NDCG: 0.3720
Validation loss decreased (2.373495 --> 2.370799).  Saving model ...

Epoch 50/99
----------
train Loss: 1.8375 LRAP: 0.1182 NDCG: 0.3516
val Loss: 2.3567 LRAP: 0.1461 NDCG: 0.3785
Validation loss decreased (2.370799 --> 2.356695).  Saving model ...

Epoch 51/99
----------
train Loss: 1.8304 LRAP: 0.1209 NDCG: 0.3524
val Loss: 2.3586 LRAP: 0.1487 NDCG: 0.3789
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 1.8073 LRAP: 0.1192 NDCG: 0.3573
val Loss: 2.3625 LRAP: 0.1512 NDCG: 0.3795
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 1.8166 LRAP: 0.1163 NDCG: 0.3557
val Loss: 2.3497 LRAP: 0.1449 NDCG: 0.3768
Validation loss decreased (2.356695 --> 2.349746).  Saving model ...

Epoch 54/99
----------
train Loss: 1.7957 LRAP: 0.1212 NDCG: 0.3578
val Loss: 2.3572 LRAP: 0.1512 NDCG: 0.3793
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.7787 LRAP: 0.1157 NDCG: 0.3566
val Loss: 2.3462 LRAP: 0.1525 NDCG: 0.3803
Validation loss decreased (2.349746 --> 2.346245).  Saving model ...

Epoch 56/99
----------
train Loss: 1.7758 LRAP: 0.1203 NDCG: 0.3581
val Loss: 2.3567 LRAP: 0.1487 NDCG: 0.3814
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 1.7663 LRAP: 0.1217 NDCG: 0.3591
val Loss: 2.3497 LRAP: 0.1563 NDCG: 0.3834
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 1.7706 LRAP: 0.1228 NDCG: 0.3594
val Loss: 2.3550 LRAP: 0.1512 NDCG: 0.3867
EarlyStopping counter: 3 out of 50

Epoch 59/99
----------
train Loss: 1.7597 LRAP: 0.1231 NDCG: 0.3579
val Loss: 2.3565 LRAP: 0.1614 NDCG: 0.3895
EarlyStopping counter: 4 out of 50

Epoch 60/99
----------
train Loss: 1.7386 LRAP: 0.1228 NDCG: 0.3607
val Loss: 2.3390 LRAP: 0.1576 NDCG: 0.3883
Validation loss decreased (2.346245 --> 2.338953).  Saving model ...

Epoch 61/99
----------
train Loss: 1.7298 LRAP: 0.1212 NDCG: 0.3604
val Loss: 2.3459 LRAP: 0.1576 NDCG: 0.3831
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 1.7367 LRAP: 0.1198 NDCG: 0.3603
val Loss: 2.3582 LRAP: 0.1588 NDCG: 0.3861
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 1.7180 LRAP: 0.1195 NDCG: 0.3615
val Loss: 2.3343 LRAP: 0.1601 NDCG: 0.3948
Validation loss decreased (2.338953 --> 2.334256).  Saving model ...

Epoch 64/99
----------
train Loss: 1.7069 LRAP: 0.1214 NDCG: 0.3635
val Loss: 2.3617 LRAP: 0.1639 NDCG: 0.3897
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 1.7099 LRAP: 0.1220 NDCG: 0.3621
val Loss: 2.3651 LRAP: 0.1576 NDCG: 0.3931
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 1.7090 LRAP: 0.1225 NDCG: 0.3645
val Loss: 2.3425 LRAP: 0.1639 NDCG: 0.3906
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 1.7007 LRAP: 0.1296 NDCG: 0.3663
val Loss: 2.3519 LRAP: 0.1614 NDCG: 0.3917
EarlyStopping counter: 4 out of 50

Epoch 68/99
----------
train Loss: 1.6911 LRAP: 0.1247 NDCG: 0.3654
val Loss: 2.3406 LRAP: 0.1588 NDCG: 0.3949
EarlyStopping counter: 5 out of 50

Epoch 69/99
----------
train Loss: 1.6578 LRAP: 0.1261 NDCG: 0.3643
val Loss: 2.3450 LRAP: 0.1626 NDCG: 0.3927
EarlyStopping counter: 6 out of 50

Epoch 70/99
----------
train Loss: 1.6646 LRAP: 0.1233 NDCG: 0.3670
val Loss: 2.3386 LRAP: 0.1614 NDCG: 0.3937
EarlyStopping counter: 7 out of 50

Epoch 71/99
----------
train Loss: 1.6506 LRAP: 0.1201 NDCG: 0.3675
val Loss: 2.3333 LRAP: 0.1626 NDCG: 0.3924
Validation loss decreased (2.334256 --> 2.333270).  Saving model ...

Epoch 72/99
----------
train Loss: 1.6514 LRAP: 0.1269 NDCG: 0.3657
val Loss: 2.3348 LRAP: 0.1626 NDCG: 0.3948
EarlyStopping counter: 1 out of 50

Epoch 73/99
----------
train Loss: 1.6526 LRAP: 0.1255 NDCG: 0.3660
val Loss: 2.3330 LRAP: 0.1626 NDCG: 0.3931
Validation loss decreased (2.333270 --> 2.332999).  Saving model ...

Epoch 74/99
----------
train Loss: 1.6560 LRAP: 0.1258 NDCG: 0.3676
val Loss: 2.3348 LRAP: 0.1639 NDCG: 0.3919
EarlyStopping counter: 1 out of 50

Epoch 75/99
----------
train Loss: 1.6278 LRAP: 0.1255 NDCG: 0.3673
val Loss: 2.3358 LRAP: 0.1690 NDCG: 0.3963
EarlyStopping counter: 2 out of 50

Epoch 76/99
----------
train Loss: 1.6401 LRAP: 0.1255 NDCG: 0.3668
val Loss: 2.3318 LRAP: 0.1665 NDCG: 0.3950
Validation loss decreased (2.332999 --> 2.331752).  Saving model ...

Epoch 77/99
----------
train Loss: 1.6381 LRAP: 0.1285 NDCG: 0.3682
val Loss: 2.3297 LRAP: 0.1652 NDCG: 0.3962
Validation loss decreased (2.331752 --> 2.329683).  Saving model ...

Epoch 78/99
----------
train Loss: 1.6455 LRAP: 0.1263 NDCG: 0.3683
val Loss: 2.3288 LRAP: 0.1614 NDCG: 0.3931
Validation loss decreased (2.329683 --> 2.328757).  Saving model ...

Epoch 79/99
----------
train Loss: 1.6282 LRAP: 0.1258 NDCG: 0.3696
val Loss: 2.3292 LRAP: 0.1639 NDCG: 0.3953
EarlyStopping counter: 1 out of 50

Epoch 80/99
----------
train Loss: 1.6303 LRAP: 0.1252 NDCG: 0.3692
val Loss: 2.3285 LRAP: 0.1626 NDCG: 0.3964
Validation loss decreased (2.328757 --> 2.328488).  Saving model ...

Epoch 81/99
----------
train Loss: 1.6302 LRAP: 0.1261 NDCG: 0.3670
val Loss: 2.3217 LRAP: 0.1665 NDCG: 0.3963
Validation loss decreased (2.328488 --> 2.321722).  Saving model ...

Epoch 82/99
----------
train Loss: 1.6329 LRAP: 0.1304 NDCG: 0.3693
val Loss: 2.3326 LRAP: 0.1677 NDCG: 0.3968
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 1.6252 LRAP: 0.1310 NDCG: 0.3687
val Loss: 2.3369 LRAP: 0.1677 NDCG: 0.3938
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 1.6263 LRAP: 0.1304 NDCG: 0.3688
val Loss: 2.3288 LRAP: 0.1677 NDCG: 0.3960
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 1.6384 LRAP: 0.1236 NDCG: 0.3670
val Loss: 2.3387 LRAP: 0.1677 NDCG: 0.3974
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 1.6256 LRAP: 0.1231 NDCG: 0.3681
val Loss: 2.3265 LRAP: 0.1652 NDCG: 0.3965
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 1.6105 LRAP: 0.1304 NDCG: 0.3696
val Loss: 2.3295 LRAP: 0.1665 NDCG: 0.3961
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 1.6187 LRAP: 0.1318 NDCG: 0.3704
val Loss: 2.3308 LRAP: 0.1665 NDCG: 0.3956
EarlyStopping counter: 7 out of 50

Epoch 89/99
----------
train Loss: 1.6204 LRAP: 0.1231 NDCG: 0.3692
val Loss: 2.3291 LRAP: 0.1652 NDCG: 0.3959
EarlyStopping counter: 8 out of 50

Epoch 90/99
----------
train Loss: 1.6126 LRAP: 0.1263 NDCG: 0.3690
val Loss: 2.3328 LRAP: 0.1665 NDCG: 0.3951
EarlyStopping counter: 9 out of 50

Epoch 91/99
----------
train Loss: 1.6330 LRAP: 0.1247 NDCG: 0.3682
val Loss: 2.3340 LRAP: 0.1665 NDCG: 0.3955
EarlyStopping counter: 10 out of 50

Epoch 92/99
----------
train Loss: 1.6170 LRAP: 0.1266 NDCG: 0.3692
val Loss: 2.3330 LRAP: 0.1690 NDCG: 0.3948
EarlyStopping counter: 11 out of 50

Epoch 93/99
----------
train Loss: 1.6097 LRAP: 0.1280 NDCG: 0.3702
val Loss: 2.3327 LRAP: 0.1665 NDCG: 0.3953
EarlyStopping counter: 12 out of 50

Epoch 94/99
----------
train Loss: 1.6179 LRAP: 0.1258 NDCG: 0.3677
val Loss: 2.3348 LRAP: 0.1677 NDCG: 0.3979
EarlyStopping counter: 13 out of 50

Epoch 95/99
----------
train Loss: 1.6362 LRAP: 0.1274 NDCG: 0.3679
val Loss: 2.3367 LRAP: 0.1690 NDCG: 0.3990
EarlyStopping counter: 14 out of 50

Epoch 96/99
----------
train Loss: 1.6236 LRAP: 0.1282 NDCG: 0.3694
val Loss: 2.3331 LRAP: 0.1690 NDCG: 0.3966
EarlyStopping counter: 15 out of 50

Epoch 97/99
----------
train Loss: 1.6145 LRAP: 0.1329 NDCG: 0.3696
val Loss: 2.3372 LRAP: 0.1665 NDCG: 0.3980
EarlyStopping counter: 16 out of 50

Epoch 98/99
----------
train Loss: 1.6091 LRAP: 0.1274 NDCG: 0.3685
val Loss: 2.3306 LRAP: 0.1677 NDCG: 0.3965
EarlyStopping counter: 17 out of 50

Epoch 99/99
----------
train Loss: 1.6217 LRAP: 0.1244 NDCG: 0.3678
val Loss: 2.3277 LRAP: 0.1652 NDCG: 0.3966
EarlyStopping counter: 18 out of 50

Training complete in 2m 27s
Best val loss: 2.321722, best LRAP score: 0.7732

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4902 LRAP: 0.0000 NDCG: 0.1787
val Loss: 4.1444 LRAP: 0.0000 NDCG: 0.1961
Validation loss decreased (0.000000 --> 4.144352).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9304 LRAP: 0.0003 NDCG: 0.2137
val Loss: 3.8770 LRAP: 0.0000 NDCG: 0.2167
Validation loss decreased (4.144352 --> 3.877014).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7710 LRAP: 0.0011 NDCG: 0.2250
val Loss: 3.7416 LRAP: 0.0064 NDCG: 0.2371
Validation loss decreased (3.877014 --> 3.741612).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6797 LRAP: 0.0041 NDCG: 0.2250
val Loss: 3.7006 LRAP: 0.0051 NDCG: 0.2263
Validation loss decreased (3.741612 --> 3.700596).  Saving model ...

Epoch 4/99
----------
train Loss: 3.6137 LRAP: 0.0079 NDCG: 0.2322
val Loss: 4.1687 LRAP: 0.0114 NDCG: 0.2068
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.5475 LRAP: 0.0174 NDCG: 0.2337
val Loss: 3.5671 LRAP: 0.0051 NDCG: 0.2320
Validation loss decreased (3.700596 --> 3.567085).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4648 LRAP: 0.0180 NDCG: 0.2385
val Loss: 3.6008 LRAP: 0.0254 NDCG: 0.2461
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.3858 LRAP: 0.0340 NDCG: 0.2424
val Loss: 3.5710 LRAP: 0.0851 NDCG: 0.2522
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.3380 LRAP: 0.0525 NDCG: 0.2458
val Loss: 3.7458 LRAP: 0.0419 NDCG: 0.2346
EarlyStopping counter: 3 out of 50

Epoch 9/99
----------
train Loss: 3.2701 LRAP: 0.0523 NDCG: 0.2522
val Loss: 3.4670 LRAP: 0.0877 NDCG: 0.2549
Validation loss decreased (3.567085 --> 3.467043).  Saving model ...

Epoch 10/99
----------
train Loss: 3.2292 LRAP: 0.0604 NDCG: 0.2529
val Loss: 3.2310 LRAP: 0.0762 NDCG: 0.2504
Validation loss decreased (3.467043 --> 3.230990).  Saving model ...

Epoch 11/99
----------
train Loss: 3.1507 LRAP: 0.0607 NDCG: 0.2589
val Loss: 3.2303 LRAP: 0.0470 NDCG: 0.2573
Validation loss decreased (3.230990 --> 3.230336).  Saving model ...

Epoch 12/99
----------
train Loss: 3.1200 LRAP: 0.0773 NDCG: 0.2637
val Loss: 3.5560 LRAP: 0.1055 NDCG: 0.2722
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.0691 LRAP: 0.0719 NDCG: 0.2680
val Loss: 3.1722 LRAP: 0.1131 NDCG: 0.2652
Validation loss decreased (3.230336 --> 3.172188).  Saving model ...

Epoch 14/99
----------
train Loss: 3.0346 LRAP: 0.0847 NDCG: 0.2681
val Loss: 3.2626 LRAP: 0.1144 NDCG: 0.2530
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 2.9798 LRAP: 0.0882 NDCG: 0.2765
val Loss: 3.1107 LRAP: 0.0775 NDCG: 0.2625
Validation loss decreased (3.172188 --> 3.110676).  Saving model ...

Epoch 16/99
----------
train Loss: 2.9289 LRAP: 0.0806 NDCG: 0.2727
val Loss: 2.9986 LRAP: 0.1055 NDCG: 0.2827
Validation loss decreased (3.110676 --> 2.998634).  Saving model ...

Epoch 17/99
----------
train Loss: 2.8921 LRAP: 0.0849 NDCG: 0.2787
val Loss: 3.3659 LRAP: 0.0216 NDCG: 0.2862
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 2.8704 LRAP: 0.0795 NDCG: 0.2803
val Loss: 3.1501 LRAP: 0.1144 NDCG: 0.3035
EarlyStopping counter: 2 out of 50

Epoch 19/99
----------
train Loss: 2.8307 LRAP: 0.0792 NDCG: 0.2828
val Loss: 2.8980 LRAP: 0.1029 NDCG: 0.2829
Validation loss decreased (2.998634 --> 2.897971).  Saving model ...

Epoch 20/99
----------
train Loss: 2.7767 LRAP: 0.0871 NDCG: 0.2880
val Loss: 3.0499 LRAP: 0.0902 NDCG: 0.2664
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.7638 LRAP: 0.0863 NDCG: 0.2878
val Loss: 2.9185 LRAP: 0.1080 NDCG: 0.2833
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 2.7139 LRAP: 0.0885 NDCG: 0.2915
val Loss: 2.9111 LRAP: 0.0750 NDCG: 0.3112
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 2.7114 LRAP: 0.0920 NDCG: 0.2945
val Loss: 2.8849 LRAP: 0.0813 NDCG: 0.2964
Validation loss decreased (2.897971 --> 2.884897).  Saving model ...

Epoch 24/99
----------
train Loss: 2.6450 LRAP: 0.0863 NDCG: 0.2965
val Loss: 2.9930 LRAP: 0.1118 NDCG: 0.3097
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.6139 LRAP: 0.0942 NDCG: 0.2991
val Loss: 2.8277 LRAP: 0.1156 NDCG: 0.3131
Validation loss decreased (2.884897 --> 2.827651).  Saving model ...

Epoch 26/99
----------
train Loss: 2.6070 LRAP: 0.0909 NDCG: 0.3016
val Loss: 2.8330 LRAP: 0.1042 NDCG: 0.3093
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 2.5584 LRAP: 0.0855 NDCG: 0.3020
val Loss: 2.8270 LRAP: 0.1169 NDCG: 0.3079
Validation loss decreased (2.827651 --> 2.826967).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5491 LRAP: 0.0882 NDCG: 0.3073
val Loss: 2.8864 LRAP: 0.1156 NDCG: 0.3104
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 2.5227 LRAP: 0.0912 NDCG: 0.3081
val Loss: 2.7440 LRAP: 0.1169 NDCG: 0.3207
Validation loss decreased (2.826967 --> 2.743995).  Saving model ...

Epoch 30/99
----------
train Loss: 2.4829 LRAP: 0.0972 NDCG: 0.3106
val Loss: 2.7677 LRAP: 0.1093 NDCG: 0.3067
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 2.4634 LRAP: 0.0983 NDCG: 0.3128
val Loss: 2.7119 LRAP: 0.1042 NDCG: 0.3176
Validation loss decreased (2.743995 --> 2.711890).  Saving model ...

Epoch 32/99
----------
train Loss: 2.4192 LRAP: 0.0937 NDCG: 0.3153
val Loss: 2.7721 LRAP: 0.1017 NDCG: 0.3237
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.4286 LRAP: 0.0931 NDCG: 0.3159
val Loss: 2.7118 LRAP: 0.0813 NDCG: 0.3061
Validation loss decreased (2.711890 --> 2.711806).  Saving model ...

Epoch 34/99
----------
train Loss: 2.3601 LRAP: 0.0947 NDCG: 0.3229
val Loss: 2.6570 LRAP: 0.1156 NDCG: 0.3170
Validation loss decreased (2.711806 --> 2.657011).  Saving model ...

Epoch 35/99
----------
train Loss: 2.3448 LRAP: 0.0888 NDCG: 0.3203
val Loss: 2.8960 LRAP: 0.1017 NDCG: 0.3331
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 2.3302 LRAP: 0.0988 NDCG: 0.3234
val Loss: 2.7736 LRAP: 0.0928 NDCG: 0.3137
EarlyStopping counter: 2 out of 50

Epoch 37/99
----------
train Loss: 2.3176 LRAP: 0.1002 NDCG: 0.3246
val Loss: 2.6667 LRAP: 0.1233 NDCG: 0.3319
EarlyStopping counter: 3 out of 50

Epoch 38/99
----------
train Loss: 2.2653 LRAP: 0.0972 NDCG: 0.3291
val Loss: 2.6619 LRAP: 0.0775 NDCG: 0.3415
EarlyStopping counter: 4 out of 50

Epoch 39/99
----------
train Loss: 2.2201 LRAP: 0.0956 NDCG: 0.3296
val Loss: 2.6673 LRAP: 0.1271 NDCG: 0.3418
EarlyStopping counter: 5 out of 50

Epoch 40/99
----------
train Loss: 2.1555 LRAP: 0.1103 NDCG: 0.3316
val Loss: 2.4901 LRAP: 0.1233 NDCG: 0.3384
Validation loss decreased (2.657011 --> 2.490064).  Saving model ...

Epoch 41/99
----------
train Loss: 2.1028 LRAP: 0.1054 NDCG: 0.3350
val Loss: 2.4769 LRAP: 0.1258 NDCG: 0.3451
Validation loss decreased (2.490064 --> 2.476878).  Saving model ...

Epoch 42/99
----------
train Loss: 2.0725 LRAP: 0.1114 NDCG: 0.3375
val Loss: 2.4555 LRAP: 0.1283 NDCG: 0.3491
Validation loss decreased (2.476878 --> 2.455509).  Saving model ...

Epoch 43/99
----------
train Loss: 2.0703 LRAP: 0.1086 NDCG: 0.3386
val Loss: 2.4561 LRAP: 0.1258 NDCG: 0.3497
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 2.0389 LRAP: 0.1078 NDCG: 0.3382
val Loss: 2.4519 LRAP: 0.1283 NDCG: 0.3522
Validation loss decreased (2.455509 --> 2.451939).  Saving model ...

Epoch 45/99
----------
train Loss: 2.0306 LRAP: 0.1133 NDCG: 0.3387
val Loss: 2.4437 LRAP: 0.1334 NDCG: 0.3582
Validation loss decreased (2.451939 --> 2.443727).  Saving model ...

Epoch 46/99
----------
train Loss: 2.0171 LRAP: 0.1094 NDCG: 0.3429
val Loss: 2.4425 LRAP: 0.1283 NDCG: 0.3557
Validation loss decreased (2.443727 --> 2.442458).  Saving model ...

Epoch 47/99
----------
train Loss: 1.9951 LRAP: 0.1105 NDCG: 0.3413
val Loss: 2.4522 LRAP: 0.1321 NDCG: 0.3530
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 1.9875 LRAP: 0.1171 NDCG: 0.3428
val Loss: 2.4337 LRAP: 0.1334 NDCG: 0.3546
Validation loss decreased (2.442458 --> 2.433732).  Saving model ...

Epoch 49/99
----------
train Loss: 1.9852 LRAP: 0.1157 NDCG: 0.3455
val Loss: 2.4525 LRAP: 0.1347 NDCG: 0.3611
EarlyStopping counter: 1 out of 50

Epoch 50/99
----------
train Loss: 1.9667 LRAP: 0.1135 NDCG: 0.3455
val Loss: 2.4304 LRAP: 0.1296 NDCG: 0.3580
Validation loss decreased (2.433732 --> 2.430357).  Saving model ...

Epoch 51/99
----------
train Loss: 1.9558 LRAP: 0.1133 NDCG: 0.3488
val Loss: 2.4240 LRAP: 0.1334 NDCG: 0.3594
Validation loss decreased (2.430357 --> 2.424047).  Saving model ...

Epoch 52/99
----------
train Loss: 1.9548 LRAP: 0.1173 NDCG: 0.3457
val Loss: 2.4223 LRAP: 0.1321 NDCG: 0.3596
Validation loss decreased (2.424047 --> 2.422279).  Saving model ...

Epoch 53/99
----------
train Loss: 1.9370 LRAP: 0.1212 NDCG: 0.3446
val Loss: 2.4120 LRAP: 0.1334 NDCG: 0.3576
Validation loss decreased (2.422279 --> 2.412007).  Saving model ...

Epoch 54/99
----------
train Loss: 1.9322 LRAP: 0.1146 NDCG: 0.3470
val Loss: 2.4042 LRAP: 0.1347 NDCG: 0.3612
Validation loss decreased (2.412007 --> 2.404208).  Saving model ...

Epoch 55/99
----------
train Loss: 1.9381 LRAP: 0.1176 NDCG: 0.3471
val Loss: 2.4381 LRAP: 0.1360 NDCG: 0.3598
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 1.9375 LRAP: 0.1163 NDCG: 0.3475
val Loss: 2.4111 LRAP: 0.1436 NDCG: 0.3606
EarlyStopping counter: 2 out of 50

Epoch 57/99
----------
train Loss: 1.8964 LRAP: 0.1173 NDCG: 0.3505
val Loss: 2.4199 LRAP: 0.1423 NDCG: 0.3681
EarlyStopping counter: 3 out of 50

Epoch 58/99
----------
train Loss: 1.9017 LRAP: 0.1184 NDCG: 0.3509
val Loss: 2.4170 LRAP: 0.1360 NDCG: 0.3653
EarlyStopping counter: 4 out of 50

Epoch 59/99
----------
train Loss: 1.8991 LRAP: 0.1165 NDCG: 0.3521
val Loss: 2.4035 LRAP: 0.1423 NDCG: 0.3680
Validation loss decreased (2.404208 --> 2.403489).  Saving model ...

Epoch 60/99
----------
train Loss: 1.8553 LRAP: 0.1203 NDCG: 0.3534
val Loss: 2.4173 LRAP: 0.1372 NDCG: 0.3712
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 1.8720 LRAP: 0.1179 NDCG: 0.3518
val Loss: 2.4129 LRAP: 0.1423 NDCG: 0.3687
EarlyStopping counter: 2 out of 50

Epoch 62/99
----------
train Loss: 1.8601 LRAP: 0.1182 NDCG: 0.3507
val Loss: 2.3953 LRAP: 0.1410 NDCG: 0.3715
Validation loss decreased (2.403489 --> 2.395313).  Saving model ...

Epoch 63/99
----------
train Loss: 1.8677 LRAP: 0.1163 NDCG: 0.3544
val Loss: 2.4159 LRAP: 0.1398 NDCG: 0.3664
EarlyStopping counter: 1 out of 50

Epoch 64/99
----------
train Loss: 1.8627 LRAP: 0.1184 NDCG: 0.3552
val Loss: 2.4089 LRAP: 0.1410 NDCG: 0.3776
EarlyStopping counter: 2 out of 50

Epoch 65/99
----------
train Loss: 1.8419 LRAP: 0.1231 NDCG: 0.3565
val Loss: 2.3921 LRAP: 0.1449 NDCG: 0.3801
Validation loss decreased (2.395313 --> 2.392100).  Saving model ...

Epoch 66/99
----------
train Loss: 1.8264 LRAP: 0.1214 NDCG: 0.3552
val Loss: 2.3935 LRAP: 0.1474 NDCG: 0.3790
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 1.8236 LRAP: 0.1201 NDCG: 0.3583
val Loss: 2.4060 LRAP: 0.1372 NDCG: 0.3724
EarlyStopping counter: 2 out of 50

Epoch 68/99
----------
train Loss: 1.7968 LRAP: 0.1192 NDCG: 0.3579
val Loss: 2.4147 LRAP: 0.1385 NDCG: 0.3711
EarlyStopping counter: 3 out of 50

Epoch 69/99
----------
train Loss: 1.7995 LRAP: 0.1182 NDCG: 0.3573
val Loss: 2.3688 LRAP: 0.1461 NDCG: 0.3746
Validation loss decreased (2.392100 --> 2.368791).  Saving model ...

Epoch 70/99
----------
train Loss: 1.7730 LRAP: 0.1220 NDCG: 0.3609
val Loss: 2.3650 LRAP: 0.1436 NDCG: 0.3768
Validation loss decreased (2.368791 --> 2.364983).  Saving model ...

Epoch 71/99
----------
train Loss: 1.7766 LRAP: 0.1165 NDCG: 0.3604
val Loss: 2.3814 LRAP: 0.1436 NDCG: 0.3805
EarlyStopping counter: 1 out of 50

Epoch 72/99
----------
train Loss: 1.7767 LRAP: 0.1168 NDCG: 0.3592
val Loss: 2.3939 LRAP: 0.1537 NDCG: 0.3834
EarlyStopping counter: 2 out of 50

Epoch 73/99
----------
train Loss: 1.7617 LRAP: 0.1239 NDCG: 0.3623
val Loss: 2.3877 LRAP: 0.1563 NDCG: 0.3849
EarlyStopping counter: 3 out of 50

Epoch 74/99
----------
train Loss: 1.7762 LRAP: 0.1222 NDCG: 0.3610
val Loss: 2.3930 LRAP: 0.1550 NDCG: 0.3880
EarlyStopping counter: 4 out of 50

Epoch 75/99
----------
train Loss: 1.7552 LRAP: 0.1233 NDCG: 0.3634
val Loss: 2.3897 LRAP: 0.1525 NDCG: 0.3871
EarlyStopping counter: 5 out of 50

Epoch 76/99
----------
train Loss: 1.7362 LRAP: 0.1247 NDCG: 0.3629
val Loss: 2.3516 LRAP: 0.1525 NDCG: 0.3819
Validation loss decreased (2.364983 --> 2.351626).  Saving model ...

Epoch 77/99
----------
train Loss: 1.7033 LRAP: 0.1220 NDCG: 0.3649
val Loss: 2.3581 LRAP: 0.1499 NDCG: 0.3858
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 1.7109 LRAP: 0.1220 NDCG: 0.3637
val Loss: 2.3554 LRAP: 0.1499 NDCG: 0.3862
EarlyStopping counter: 2 out of 50

Epoch 79/99
----------
train Loss: 1.7041 LRAP: 0.1290 NDCG: 0.3661
val Loss: 2.3568 LRAP: 0.1550 NDCG: 0.3851
EarlyStopping counter: 3 out of 50

Epoch 80/99
----------
train Loss: 1.7114 LRAP: 0.1195 NDCG: 0.3661
val Loss: 2.3536 LRAP: 0.1537 NDCG: 0.3876
EarlyStopping counter: 4 out of 50

Epoch 81/99
----------
train Loss: 1.6985 LRAP: 0.1225 NDCG: 0.3656
val Loss: 2.3494 LRAP: 0.1576 NDCG: 0.3883
Validation loss decreased (2.351626 --> 2.349409).  Saving model ...

Epoch 82/99
----------
train Loss: 1.6795 LRAP: 0.1266 NDCG: 0.3672
val Loss: 2.3468 LRAP: 0.1550 NDCG: 0.3854
Validation loss decreased (2.349409 --> 2.346807).  Saving model ...

Epoch 83/99
----------
train Loss: 1.6870 LRAP: 0.1203 NDCG: 0.3682
val Loss: 2.3510 LRAP: 0.1563 NDCG: 0.3884
EarlyStopping counter: 1 out of 50

Epoch 84/99
----------
train Loss: 1.6922 LRAP: 0.1304 NDCG: 0.3678
val Loss: 2.3482 LRAP: 0.1537 NDCG: 0.3887
EarlyStopping counter: 2 out of 50

Epoch 85/99
----------
train Loss: 1.6879 LRAP: 0.1250 NDCG: 0.3673
val Loss: 2.3491 LRAP: 0.1588 NDCG: 0.3895
EarlyStopping counter: 3 out of 50

Epoch 86/99
----------
train Loss: 1.6843 LRAP: 0.1214 NDCG: 0.3684
val Loss: 2.3481 LRAP: 0.1550 NDCG: 0.3931
EarlyStopping counter: 4 out of 50

Epoch 87/99
----------
train Loss: 1.6860 LRAP: 0.1244 NDCG: 0.3686
val Loss: 2.3437 LRAP: 0.1512 NDCG: 0.3892
Validation loss decreased (2.346807 --> 2.343670).  Saving model ...

Epoch 88/99
----------
train Loss: 1.6778 LRAP: 0.1255 NDCG: 0.3680
val Loss: 2.3564 LRAP: 0.1537 NDCG: 0.3914
EarlyStopping counter: 1 out of 50

Epoch 89/99
----------
train Loss: 1.6772 LRAP: 0.1269 NDCG: 0.3684
val Loss: 2.3505 LRAP: 0.1563 NDCG: 0.3891
EarlyStopping counter: 2 out of 50

Epoch 90/99
----------
train Loss: 1.6773 LRAP: 0.1274 NDCG: 0.3701
val Loss: 2.3563 LRAP: 0.1537 NDCG: 0.3902
EarlyStopping counter: 3 out of 50

Epoch 91/99
----------
train Loss: 1.6795 LRAP: 0.1263 NDCG: 0.3701
val Loss: 2.3495 LRAP: 0.1550 NDCG: 0.3894
EarlyStopping counter: 4 out of 50

Epoch 92/99
----------
train Loss: 1.6763 LRAP: 0.1277 NDCG: 0.3701
val Loss: 2.3563 LRAP: 0.1576 NDCG: 0.3914
EarlyStopping counter: 5 out of 50

Epoch 93/99
----------
train Loss: 1.6735 LRAP: 0.1209 NDCG: 0.3707
val Loss: 2.3483 LRAP: 0.1563 NDCG: 0.3909
EarlyStopping counter: 6 out of 50

Epoch 94/99
----------
train Loss: 1.6793 LRAP: 0.1252 NDCG: 0.3686
val Loss: 2.3559 LRAP: 0.1563 NDCG: 0.3900
EarlyStopping counter: 7 out of 50

Epoch 95/99
----------
train Loss: 1.6585 LRAP: 0.1239 NDCG: 0.3710
val Loss: 2.3514 LRAP: 0.1525 NDCG: 0.3905
EarlyStopping counter: 8 out of 50

Epoch 96/99
----------
train Loss: 1.6677 LRAP: 0.1258 NDCG: 0.3701
val Loss: 2.3529 LRAP: 0.1537 NDCG: 0.3915
EarlyStopping counter: 9 out of 50

Epoch 97/99
----------
train Loss: 1.6858 LRAP: 0.1280 NDCG: 0.3671
val Loss: 2.3511 LRAP: 0.1576 NDCG: 0.3911
EarlyStopping counter: 10 out of 50

Epoch 98/99
----------
train Loss: 1.6579 LRAP: 0.1233 NDCG: 0.3719
val Loss: 2.3548 LRAP: 0.1550 NDCG: 0.3915
EarlyStopping counter: 11 out of 50

Epoch 99/99
----------
train Loss: 1.6816 LRAP: 0.1250 NDCG: 0.3691
val Loss: 2.3541 LRAP: 0.1576 NDCG: 0.3912
EarlyStopping counter: 12 out of 50

Training complete in 2m 26s
Best val loss: 2.343670, best LRAP score: 0.7762

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.6240 LRAP: 0.0000 NDCG: 0.1665
val Loss: 6.9628 LRAP: 0.0000 NDCG: 0.1402
Validation loss decreased (0.000000 --> 6.962751).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0984 LRAP: 0.0000 NDCG: 0.1836
val Loss: 4.3840 LRAP: 0.0000 NDCG: 0.2243
Validation loss decreased (6.962751 --> 4.384002).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8852 LRAP: 0.0035 NDCG: 0.2079
val Loss: 4.1272 LRAP: 0.0064 NDCG: 0.2096
Validation loss decreased (4.384002 --> 4.127165).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7612 LRAP: 0.0074 NDCG: 0.2082
val Loss: 8.0670 LRAP: 0.0000 NDCG: 0.1748
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.7018 LRAP: 0.0079 NDCG: 0.2189
val Loss: 4.7902 LRAP: 0.0013 NDCG: 0.2025
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.6397 LRAP: 0.0101 NDCG: 0.2228
val Loss: 4.8169 LRAP: 0.0013 NDCG: 0.1901
EarlyStopping counter: 3 out of 50

Epoch 6/99
----------
train Loss: 3.6002 LRAP: 0.0144 NDCG: 0.2263
val Loss: 4.4810 LRAP: 0.0076 NDCG: 0.2142
EarlyStopping counter: 4 out of 50

Epoch 7/99
----------
train Loss: 3.5544 LRAP: 0.0234 NDCG: 0.2289
val Loss: 4.2839 LRAP: 0.0064 NDCG: 0.2189
EarlyStopping counter: 5 out of 50

Epoch 8/99
----------
train Loss: 3.5082 LRAP: 0.0259 NDCG: 0.2329
val Loss: 3.6541 LRAP: 0.0140 NDCG: 0.2158
Validation loss decreased (4.127165 --> 3.654101).  Saving model ...

Epoch 9/99
----------
train Loss: 3.4678 LRAP: 0.0286 NDCG: 0.2338
val Loss: 3.6103 LRAP: 0.0064 NDCG: 0.2282
Validation loss decreased (3.654101 --> 3.610256).  Saving model ...

Epoch 10/99
----------
train Loss: 3.4761 LRAP: 0.0256 NDCG: 0.2332
val Loss: 3.6460 LRAP: 0.0051 NDCG: 0.2154
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.4589 LRAP: 0.0302 NDCG: 0.2335
val Loss: 3.6034 LRAP: 0.0064 NDCG: 0.2378
Validation loss decreased (3.610256 --> 3.603370).  Saving model ...

Epoch 12/99
----------
train Loss: 3.4439 LRAP: 0.0256 NDCG: 0.2354
val Loss: 3.6034 LRAP: 0.0457 NDCG: 0.2174
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.4345 LRAP: 0.0321 NDCG: 0.2366
val Loss: 3.5472 LRAP: 0.0051 NDCG: 0.2239
Validation loss decreased (3.603370 --> 3.547152).  Saving model ...

Epoch 14/99
----------
train Loss: 3.4498 LRAP: 0.0264 NDCG: 0.2360
val Loss: 5.0936 LRAP: 0.0000 NDCG: 0.2040
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 3.4184 LRAP: 0.0316 NDCG: 0.2389
val Loss: 3.8079 LRAP: 0.0750 NDCG: 0.2069
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 3.4237 LRAP: 0.0264 NDCG: 0.2353
val Loss: 3.8682 LRAP: 0.0013 NDCG: 0.2121
EarlyStopping counter: 3 out of 50

Epoch 17/99
----------
train Loss: 3.4013 LRAP: 0.0351 NDCG: 0.2359
val Loss: 4.1349 LRAP: 0.0826 NDCG: 0.1853
EarlyStopping counter: 4 out of 50

Epoch 18/99
----------
train Loss: 3.3945 LRAP: 0.0406 NDCG: 0.2357
val Loss: 3.4995 LRAP: 0.0381 NDCG: 0.2324
Validation loss decreased (3.547152 --> 3.499485).  Saving model ...

Epoch 19/99
----------
train Loss: 3.3864 LRAP: 0.0370 NDCG: 0.2376
val Loss: 3.5819 LRAP: 0.0419 NDCG: 0.2430
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.3717 LRAP: 0.0455 NDCG: 0.2395
val Loss: 3.7246 LRAP: 0.0064 NDCG: 0.2398
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 3.3722 LRAP: 0.0392 NDCG: 0.2386
val Loss: 4.1082 LRAP: 0.0661 NDCG: 0.1794
EarlyStopping counter: 3 out of 50

Epoch 22/99
----------
train Loss: 3.3437 LRAP: 0.0417 NDCG: 0.2408
val Loss: 3.7428 LRAP: 0.0343 NDCG: 0.2250
EarlyStopping counter: 4 out of 50

Epoch 23/99
----------
train Loss: 3.3421 LRAP: 0.0400 NDCG: 0.2415
val Loss: 3.9966 LRAP: 0.0635 NDCG: 0.1915
EarlyStopping counter: 5 out of 50

Epoch 24/99
----------
train Loss: 3.3253 LRAP: 0.0512 NDCG: 0.2414
val Loss: 3.4116 LRAP: 0.0686 NDCG: 0.2365
Validation loss decreased (3.499485 --> 3.411634).  Saving model ...

Epoch 25/99
----------
train Loss: 3.3190 LRAP: 0.0498 NDCG: 0.2417
val Loss: 3.4116 LRAP: 0.0457 NDCG: 0.2384
Validation loss decreased (3.411634 --> 3.411557).  Saving model ...

Epoch 26/99
----------
train Loss: 3.3098 LRAP: 0.0542 NDCG: 0.2428
val Loss: 3.4079 LRAP: 0.0610 NDCG: 0.2337
Validation loss decreased (3.411557 --> 3.407870).  Saving model ...

Epoch 27/99
----------
train Loss: 3.3203 LRAP: 0.0498 NDCG: 0.2433
val Loss: 3.4340 LRAP: 0.0686 NDCG: 0.2301
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 3.3130 LRAP: 0.0525 NDCG: 0.2427
val Loss: 3.4421 LRAP: 0.0254 NDCG: 0.2324
EarlyStopping counter: 2 out of 50

Epoch 29/99
----------
train Loss: 3.3061 LRAP: 0.0485 NDCG: 0.2444
val Loss: 3.4208 LRAP: 0.0432 NDCG: 0.2347
EarlyStopping counter: 3 out of 50

Epoch 30/99
----------
train Loss: 3.3137 LRAP: 0.0515 NDCG: 0.2425
val Loss: 3.4400 LRAP: 0.0572 NDCG: 0.2281
EarlyStopping counter: 4 out of 50

Epoch 31/99
----------
train Loss: 3.3095 LRAP: 0.0493 NDCG: 0.2442
val Loss: 3.4181 LRAP: 0.0508 NDCG: 0.2396
EarlyStopping counter: 5 out of 50

Epoch 32/99
----------
train Loss: 3.2886 LRAP: 0.0479 NDCG: 0.2442
val Loss: 3.3928 LRAP: 0.0521 NDCG: 0.2380
Validation loss decreased (3.407870 --> 3.392848).  Saving model ...

Epoch 33/99
----------
train Loss: 3.2852 LRAP: 0.0487 NDCG: 0.2428
val Loss: 3.3970 LRAP: 0.0483 NDCG: 0.2382
EarlyStopping counter: 1 out of 50

Epoch 34/99
----------
train Loss: 3.2937 LRAP: 0.0487 NDCG: 0.2438
val Loss: 3.3911 LRAP: 0.0635 NDCG: 0.2380
Validation loss decreased (3.392848 --> 3.391136).  Saving model ...

Epoch 35/99
----------
train Loss: 3.2907 LRAP: 0.0553 NDCG: 0.2451
val Loss: 3.3935 LRAP: 0.0661 NDCG: 0.2379
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 3.2903 LRAP: 0.0542 NDCG: 0.2458
val Loss: 3.3906 LRAP: 0.0648 NDCG: 0.2381
Validation loss decreased (3.391136 --> 3.390559).  Saving model ...

Epoch 37/99
----------
train Loss: 3.2965 LRAP: 0.0496 NDCG: 0.2444
val Loss: 3.3912 LRAP: 0.0648 NDCG: 0.2379
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 3.2838 LRAP: 0.0536 NDCG: 0.2447
val Loss: 3.3888 LRAP: 0.0635 NDCG: 0.2394
Validation loss decreased (3.390559 --> 3.388841).  Saving model ...

Epoch 39/99
----------
train Loss: 3.2865 LRAP: 0.0534 NDCG: 0.2440
val Loss: 3.3890 LRAP: 0.0635 NDCG: 0.2384
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 3.2993 LRAP: 0.0547 NDCG: 0.2441
val Loss: 3.3891 LRAP: 0.0610 NDCG: 0.2386
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 3.2848 LRAP: 0.0542 NDCG: 0.2446
val Loss: 3.3875 LRAP: 0.0635 NDCG: 0.2387
Validation loss decreased (3.388841 --> 3.387502).  Saving model ...

Epoch 42/99
----------
train Loss: 3.2788 LRAP: 0.0558 NDCG: 0.2450
val Loss: 3.3897 LRAP: 0.0610 NDCG: 0.2395
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 3.2942 LRAP: 0.0566 NDCG: 0.2447
val Loss: 3.3873 LRAP: 0.0610 NDCG: 0.2403
Validation loss decreased (3.387502 --> 3.387288).  Saving model ...

Epoch 44/99
----------
train Loss: 3.2787 LRAP: 0.0577 NDCG: 0.2451
val Loss: 3.3881 LRAP: 0.0623 NDCG: 0.2412
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 3.2768 LRAP: 0.0520 NDCG: 0.2461
val Loss: 3.3884 LRAP: 0.0724 NDCG: 0.2375
EarlyStopping counter: 2 out of 50

Epoch 46/99
----------
train Loss: 3.2884 LRAP: 0.0531 NDCG: 0.2429
val Loss: 3.3863 LRAP: 0.0750 NDCG: 0.2389
Validation loss decreased (3.387288 --> 3.386326).  Saving model ...

Epoch 47/99
----------
train Loss: 3.2826 LRAP: 0.0525 NDCG: 0.2454
val Loss: 3.3881 LRAP: 0.0724 NDCG: 0.2391
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.2983 LRAP: 0.0594 NDCG: 0.2453
val Loss: 3.3874 LRAP: 0.0648 NDCG: 0.2393
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.2746 LRAP: 0.0496 NDCG: 0.2439
val Loss: 3.3855 LRAP: 0.0686 NDCG: 0.2388
Validation loss decreased (3.386326 --> 3.385516).  Saving model ...

Epoch 50/99
----------
train Loss: 3.2823 LRAP: 0.0493 NDCG: 0.2433
val Loss: 3.3881 LRAP: 0.0712 NDCG: 0.2393
EarlyStopping counter: 1 out of 50

Epoch 51/99
----------
train Loss: 3.2801 LRAP: 0.0561 NDCG: 0.2464
val Loss: 3.3850 LRAP: 0.0750 NDCG: 0.2390
Validation loss decreased (3.385516 --> 3.384977).  Saving model ...

Epoch 52/99
----------
train Loss: 3.3025 LRAP: 0.0558 NDCG: 0.2454
val Loss: 3.3929 LRAP: 0.0762 NDCG: 0.2366
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 3.2763 LRAP: 0.0555 NDCG: 0.2444
val Loss: 3.3868 LRAP: 0.0572 NDCG: 0.2388
EarlyStopping counter: 2 out of 50

Epoch 54/99
----------
train Loss: 3.2927 LRAP: 0.0525 NDCG: 0.2449
val Loss: 3.3941 LRAP: 0.0788 NDCG: 0.2406
EarlyStopping counter: 3 out of 50

Epoch 55/99
----------
train Loss: 3.2901 LRAP: 0.0569 NDCG: 0.2455
val Loss: 3.3860 LRAP: 0.0762 NDCG: 0.2389
EarlyStopping counter: 4 out of 50

Epoch 56/99
----------
train Loss: 3.2875 LRAP: 0.0525 NDCG: 0.2450
val Loss: 3.3847 LRAP: 0.0661 NDCG: 0.2395
Validation loss decreased (3.384977 --> 3.384698).  Saving model ...

Epoch 57/99
----------
train Loss: 3.2802 LRAP: 0.0561 NDCG: 0.2445
val Loss: 3.3832 LRAP: 0.0686 NDCG: 0.2398
Validation loss decreased (3.384698 --> 3.383171).  Saving model ...

Epoch 58/99
----------
train Loss: 3.2752 LRAP: 0.0558 NDCG: 0.2455
val Loss: 3.3844 LRAP: 0.0762 NDCG: 0.2409
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 3.2855 LRAP: 0.0528 NDCG: 0.2460
val Loss: 3.3830 LRAP: 0.0724 NDCG: 0.2399
Validation loss decreased (3.383171 --> 3.383050).  Saving model ...

Epoch 60/99
----------
train Loss: 3.2789 LRAP: 0.0577 NDCG: 0.2460
val Loss: 3.3828 LRAP: 0.0673 NDCG: 0.2391
Validation loss decreased (3.383050 --> 3.382821).  Saving model ...

Epoch 61/99
----------
train Loss: 3.2762 LRAP: 0.0536 NDCG: 0.2462
val Loss: 3.3848 LRAP: 0.0762 NDCG: 0.2398
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 3.2822 LRAP: 0.0569 NDCG: 0.2458
val Loss: 3.3834 LRAP: 0.0762 NDCG: 0.2409
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 3.2931 LRAP: 0.0583 NDCG: 0.2447
val Loss: 3.3817 LRAP: 0.0699 NDCG: 0.2407
Validation loss decreased (3.382821 --> 3.381745).  Saving model ...

Epoch 64/99
----------
train Loss: 3.2716 LRAP: 0.0594 NDCG: 0.2458
val Loss: 3.3831 LRAP: 0.0737 NDCG: 0.2410
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 3.2835 LRAP: 0.0566 NDCG: 0.2441
val Loss: 3.3827 LRAP: 0.0762 NDCG: 0.2405
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 3.2763 LRAP: 0.0547 NDCG: 0.2446
val Loss: 3.3838 LRAP: 0.0762 NDCG: 0.2405
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 3.2863 LRAP: 0.0528 NDCG: 0.2468
val Loss: 3.3845 LRAP: 0.0737 NDCG: 0.2369
EarlyStopping counter: 4 out of 50

Epoch 68/99
----------
train Loss: 3.2755 LRAP: 0.0553 NDCG: 0.2456
val Loss: 3.3807 LRAP: 0.0648 NDCG: 0.2404
Validation loss decreased (3.381745 --> 3.380720).  Saving model ...

Epoch 69/99
----------
train Loss: 3.2950 LRAP: 0.0561 NDCG: 0.2448
val Loss: 3.3820 LRAP: 0.0750 NDCG: 0.2395
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 3.2719 LRAP: 0.0550 NDCG: 0.2457
val Loss: 3.3808 LRAP: 0.0686 NDCG: 0.2397
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 3.2747 LRAP: 0.0558 NDCG: 0.2451
val Loss: 3.3817 LRAP: 0.0750 NDCG: 0.2402
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 3.2794 LRAP: 0.0555 NDCG: 0.2437
val Loss: 3.3805 LRAP: 0.0737 NDCG: 0.2414
Validation loss decreased (3.380720 --> 3.380540).  Saving model ...

Epoch 73/99
----------
train Loss: 3.2824 LRAP: 0.0580 NDCG: 0.2459
val Loss: 3.3849 LRAP: 0.0762 NDCG: 0.2404
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 3.2856 LRAP: 0.0515 NDCG: 0.2450
val Loss: 3.3812 LRAP: 0.0737 NDCG: 0.2400
EarlyStopping counter: 2 out of 50

Epoch 75/99
----------
train Loss: 3.2787 LRAP: 0.0564 NDCG: 0.2457
val Loss: 3.3837 LRAP: 0.0762 NDCG: 0.2401
EarlyStopping counter: 3 out of 50

Epoch 76/99
----------
train Loss: 3.2782 LRAP: 0.0523 NDCG: 0.2460
val Loss: 3.3817 LRAP: 0.0762 NDCG: 0.2407
EarlyStopping counter: 4 out of 50

Epoch 77/99
----------
train Loss: 3.2773 LRAP: 0.0577 NDCG: 0.2461
val Loss: 3.3811 LRAP: 0.0686 NDCG: 0.2405
EarlyStopping counter: 5 out of 50

Epoch 78/99
----------
train Loss: 3.2976 LRAP: 0.0553 NDCG: 0.2440
val Loss: 3.3815 LRAP: 0.0623 NDCG: 0.2405
EarlyStopping counter: 6 out of 50

Epoch 79/99
----------
train Loss: 3.2854 LRAP: 0.0558 NDCG: 0.2446
val Loss: 3.3827 LRAP: 0.0762 NDCG: 0.2404
EarlyStopping counter: 7 out of 50

Epoch 80/99
----------
train Loss: 3.2717 LRAP: 0.0536 NDCG: 0.2454
val Loss: 3.3818 LRAP: 0.0686 NDCG: 0.2398
EarlyStopping counter: 8 out of 50

Epoch 81/99
----------
train Loss: 3.2852 LRAP: 0.0613 NDCG: 0.2437
val Loss: 3.3801 LRAP: 0.0712 NDCG: 0.2402
Validation loss decreased (3.380540 --> 3.380051).  Saving model ...

Epoch 82/99
----------
train Loss: 3.2775 LRAP: 0.0566 NDCG: 0.2439
val Loss: 3.3804 LRAP: 0.0686 NDCG: 0.2391
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.2711 LRAP: 0.0509 NDCG: 0.2457
val Loss: 3.3811 LRAP: 0.0737 NDCG: 0.2396
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.2879 LRAP: 0.0547 NDCG: 0.2446
val Loss: 3.3843 LRAP: 0.0762 NDCG: 0.2392
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.2721 LRAP: 0.0574 NDCG: 0.2446
val Loss: 3.3831 LRAP: 0.0762 NDCG: 0.2417
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.2831 LRAP: 0.0523 NDCG: 0.2460
val Loss: 3.3815 LRAP: 0.0737 NDCG: 0.2407
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 3.2793 LRAP: 0.0553 NDCG: 0.2461
val Loss: 3.3806 LRAP: 0.0737 NDCG: 0.2402
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 3.2702 LRAP: 0.0534 NDCG: 0.2459
val Loss: 3.3812 LRAP: 0.0762 NDCG: 0.2409
EarlyStopping counter: 7 out of 50

Epoch 89/99
----------
train Loss: 3.2801 LRAP: 0.0621 NDCG: 0.2458
val Loss: 3.3805 LRAP: 0.0712 NDCG: 0.2396
EarlyStopping counter: 8 out of 50

Epoch 90/99
----------
train Loss: 3.2856 LRAP: 0.0577 NDCG: 0.2449
val Loss: 3.3816 LRAP: 0.0750 NDCG: 0.2400
EarlyStopping counter: 9 out of 50

Epoch 91/99
----------
train Loss: 3.2895 LRAP: 0.0585 NDCG: 0.2433
val Loss: 3.3800 LRAP: 0.0737 NDCG: 0.2404
Validation loss decreased (3.380051 --> 3.379971).  Saving model ...

Epoch 92/99
----------
train Loss: 3.2704 LRAP: 0.0536 NDCG: 0.2450
val Loss: 3.3836 LRAP: 0.0762 NDCG: 0.2410
EarlyStopping counter: 1 out of 50

Epoch 93/99
----------
train Loss: 3.2703 LRAP: 0.0577 NDCG: 0.2448
val Loss: 3.3816 LRAP: 0.0737 NDCG: 0.2403
EarlyStopping counter: 2 out of 50

Epoch 94/99
----------
train Loss: 3.2757 LRAP: 0.0539 NDCG: 0.2455
val Loss: 3.3807 LRAP: 0.0686 NDCG: 0.2394
EarlyStopping counter: 3 out of 50

Epoch 95/99
----------
train Loss: 3.2857 LRAP: 0.0574 NDCG: 0.2446
val Loss: 3.3815 LRAP: 0.0750 NDCG: 0.2409
EarlyStopping counter: 4 out of 50

Epoch 96/99
----------
train Loss: 3.2751 LRAP: 0.0545 NDCG: 0.2448
val Loss: 3.3822 LRAP: 0.0737 NDCG: 0.2408
EarlyStopping counter: 5 out of 50

Epoch 97/99
----------
train Loss: 3.2857 LRAP: 0.0585 NDCG: 0.2451
val Loss: 3.3827 LRAP: 0.0699 NDCG: 0.2386
EarlyStopping counter: 6 out of 50

Epoch 98/99
----------
train Loss: 3.2848 LRAP: 0.0534 NDCG: 0.2456
val Loss: 3.3819 LRAP: 0.0737 NDCG: 0.2400
EarlyStopping counter: 7 out of 50

Epoch 99/99
----------
train Loss: 3.2796 LRAP: 0.0564 NDCG: 0.2464
val Loss: 3.3815 LRAP: 0.0762 NDCG: 0.2399
EarlyStopping counter: 8 out of 50

Training complete in 2m 29s
Best val loss: 3.379971, best LRAP score: 0.5449

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.5220 LRAP: 0.0000 NDCG: 0.1695
val Loss: 4.5803 LRAP: 0.0000 NDCG: 0.1702
Validation loss decreased (0.000000 --> 4.580263).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0052 LRAP: 0.0000 NDCG: 0.1956
val Loss: 4.4879 LRAP: 0.0025 NDCG: 0.2136
Validation loss decreased (4.580263 --> 4.487936).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8568 LRAP: 0.0014 NDCG: 0.2103
val Loss: 4.2374 LRAP: 0.0038 NDCG: 0.1992
Validation loss decreased (4.487936 --> 4.237371).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7882 LRAP: 0.0044 NDCG: 0.2137
val Loss: 4.6195 LRAP: 0.0064 NDCG: 0.1981
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.7567 LRAP: 0.0063 NDCG: 0.2127
val Loss: 4.5343 LRAP: 0.0064 NDCG: 0.2077
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.7034 LRAP: 0.0076 NDCG: 0.2136
val Loss: 4.7605 LRAP: 0.0064 NDCG: 0.1505
EarlyStopping counter: 3 out of 50

Epoch 6/99
----------
train Loss: 3.6739 LRAP: 0.0082 NDCG: 0.2181
val Loss: 4.2922 LRAP: 0.0051 NDCG: 0.2130
EarlyStopping counter: 4 out of 50

Epoch 7/99
----------
train Loss: 3.6509 LRAP: 0.0103 NDCG: 0.2187
val Loss: 4.5638 LRAP: 0.0178 NDCG: 0.1802
EarlyStopping counter: 5 out of 50

Epoch 8/99
----------
train Loss: 3.5904 LRAP: 0.0150 NDCG: 0.2230
val Loss: 4.4722 LRAP: 0.0305 NDCG: 0.1821
EarlyStopping counter: 6 out of 50

Epoch 9/99
----------
train Loss: 3.5732 LRAP: 0.0112 NDCG: 0.2221
val Loss: 3.8953 LRAP: 0.0191 NDCG: 0.2016
Validation loss decreased (4.237371 --> 3.895313).  Saving model ...

Epoch 10/99
----------
train Loss: 3.5512 LRAP: 0.0174 NDCG: 0.2242
val Loss: 3.6596 LRAP: 0.0064 NDCG: 0.2178
Validation loss decreased (3.895313 --> 3.659585).  Saving model ...

Epoch 11/99
----------
train Loss: 3.5539 LRAP: 0.0128 NDCG: 0.2230
val Loss: 3.8619 LRAP: 0.0038 NDCG: 0.2184
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.5350 LRAP: 0.0172 NDCG: 0.2238
val Loss: 3.7211 LRAP: 0.0305 NDCG: 0.2148
EarlyStopping counter: 2 out of 50

Epoch 13/99
----------
train Loss: 3.5225 LRAP: 0.0169 NDCG: 0.2244
val Loss: 3.6627 LRAP: 0.0051 NDCG: 0.2201
EarlyStopping counter: 3 out of 50

Epoch 14/99
----------
train Loss: 3.5032 LRAP: 0.0221 NDCG: 0.2252
val Loss: 3.9749 LRAP: 0.0038 NDCG: 0.1821
EarlyStopping counter: 4 out of 50

Epoch 15/99
----------
train Loss: 3.5174 LRAP: 0.0174 NDCG: 0.2255
val Loss: 3.7981 LRAP: 0.0064 NDCG: 0.2068
EarlyStopping counter: 5 out of 50

Epoch 16/99
----------
train Loss: 3.5143 LRAP: 0.0218 NDCG: 0.2252
val Loss: 3.6932 LRAP: 0.0241 NDCG: 0.2203
EarlyStopping counter: 6 out of 50

Epoch 17/99
----------
train Loss: 3.4844 LRAP: 0.0199 NDCG: 0.2273
val Loss: 3.5443 LRAP: 0.0114 NDCG: 0.2275
Validation loss decreased (3.659585 --> 3.544282).  Saving model ...

Epoch 18/99
----------
train Loss: 3.4860 LRAP: 0.0240 NDCG: 0.2252
val Loss: 3.5883 LRAP: 0.0178 NDCG: 0.2319
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 3.4950 LRAP: 0.0253 NDCG: 0.2280
val Loss: 3.5456 LRAP: 0.0114 NDCG: 0.2243
EarlyStopping counter: 2 out of 50

Epoch 20/99
----------
train Loss: 3.4984 LRAP: 0.0226 NDCG: 0.2253
val Loss: 3.5960 LRAP: 0.0102 NDCG: 0.2209
EarlyStopping counter: 3 out of 50

Epoch 21/99
----------
train Loss: 3.4740 LRAP: 0.0272 NDCG: 0.2276
val Loss: 3.5349 LRAP: 0.0305 NDCG: 0.2255
Validation loss decreased (3.544282 --> 3.534899).  Saving model ...

Epoch 22/99
----------
train Loss: 3.4658 LRAP: 0.0272 NDCG: 0.2273
val Loss: 3.5474 LRAP: 0.0165 NDCG: 0.2231
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 3.4737 LRAP: 0.0264 NDCG: 0.2283
val Loss: 3.5400 LRAP: 0.0203 NDCG: 0.2273
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 3.4867 LRAP: 0.0267 NDCG: 0.2281
val Loss: 3.5463 LRAP: 0.0152 NDCG: 0.2223
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 3.4723 LRAP: 0.0310 NDCG: 0.2273
val Loss: 3.5845 LRAP: 0.0089 NDCG: 0.2220
EarlyStopping counter: 4 out of 50

Epoch 26/99
----------
train Loss: 3.4616 LRAP: 0.0348 NDCG: 0.2298
val Loss: 3.7539 LRAP: 0.0623 NDCG: 0.2227
EarlyStopping counter: 5 out of 50

Epoch 27/99
----------
train Loss: 3.4635 LRAP: 0.0327 NDCG: 0.2296
val Loss: 3.5291 LRAP: 0.0330 NDCG: 0.2250
Validation loss decreased (3.534899 --> 3.529128).  Saving model ...

Epoch 28/99
----------
train Loss: 3.4641 LRAP: 0.0302 NDCG: 0.2288
val Loss: 3.5199 LRAP: 0.0229 NDCG: 0.2269
Validation loss decreased (3.529128 --> 3.519872).  Saving model ...

Epoch 29/99
----------
train Loss: 3.4644 LRAP: 0.0267 NDCG: 0.2298
val Loss: 3.5198 LRAP: 0.0254 NDCG: 0.2292
Validation loss decreased (3.519872 --> 3.519793).  Saving model ...

Epoch 30/99
----------
train Loss: 3.4563 LRAP: 0.0332 NDCG: 0.2280
val Loss: 3.5219 LRAP: 0.0330 NDCG: 0.2266
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 3.4653 LRAP: 0.0283 NDCG: 0.2288
val Loss: 3.5209 LRAP: 0.0216 NDCG: 0.2277
EarlyStopping counter: 2 out of 50

Epoch 32/99
----------
train Loss: 3.4666 LRAP: 0.0308 NDCG: 0.2282
val Loss: 3.5205 LRAP: 0.0343 NDCG: 0.2293
EarlyStopping counter: 3 out of 50

Epoch 33/99
----------
train Loss: 3.4568 LRAP: 0.0280 NDCG: 0.2289
val Loss: 3.5183 LRAP: 0.0356 NDCG: 0.2283
Validation loss decreased (3.519793 --> 3.518335).  Saving model ...

Epoch 34/99
----------
train Loss: 3.4569 LRAP: 0.0294 NDCG: 0.2296
val Loss: 3.5276 LRAP: 0.0305 NDCG: 0.2247
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.4552 LRAP: 0.0343 NDCG: 0.2280
val Loss: 3.5178 LRAP: 0.0280 NDCG: 0.2289
Validation loss decreased (3.518335 --> 3.517831).  Saving model ...

Epoch 36/99
----------
train Loss: 3.4534 LRAP: 0.0327 NDCG: 0.2291
val Loss: 3.5186 LRAP: 0.0381 NDCG: 0.2275
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 3.4626 LRAP: 0.0338 NDCG: 0.2282
val Loss: 3.5169 LRAP: 0.0216 NDCG: 0.2278
Validation loss decreased (3.517831 --> 3.516854).  Saving model ...

Epoch 38/99
----------
train Loss: 3.4626 LRAP: 0.0319 NDCG: 0.2295
val Loss: 3.5164 LRAP: 0.0216 NDCG: 0.2283
Validation loss decreased (3.516854 --> 3.516354).  Saving model ...

Epoch 39/99
----------
train Loss: 3.4487 LRAP: 0.0329 NDCG: 0.2285
val Loss: 3.5167 LRAP: 0.0356 NDCG: 0.2276
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 3.4543 LRAP: 0.0299 NDCG: 0.2292
val Loss: 3.5168 LRAP: 0.0343 NDCG: 0.2264
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 3.4529 LRAP: 0.0321 NDCG: 0.2294
val Loss: 3.5143 LRAP: 0.0343 NDCG: 0.2279
Validation loss decreased (3.516354 --> 3.514281).  Saving model ...

Epoch 42/99
----------
train Loss: 3.4439 LRAP: 0.0343 NDCG: 0.2303
val Loss: 3.5155 LRAP: 0.0343 NDCG: 0.2267
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 3.4428 LRAP: 0.0316 NDCG: 0.2298
val Loss: 3.5152 LRAP: 0.0356 NDCG: 0.2286
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 3.4494 LRAP: 0.0354 NDCG: 0.2289
val Loss: 3.5136 LRAP: 0.0381 NDCG: 0.2270
Validation loss decreased (3.514281 --> 3.513621).  Saving model ...

Epoch 45/99
----------
train Loss: 3.4460 LRAP: 0.0329 NDCG: 0.2287
val Loss: 3.5125 LRAP: 0.0330 NDCG: 0.2287
Validation loss decreased (3.513621 --> 3.512519).  Saving model ...

Epoch 46/99
----------
train Loss: 3.4500 LRAP: 0.0335 NDCG: 0.2289
val Loss: 3.5122 LRAP: 0.0343 NDCG: 0.2286
Validation loss decreased (3.512519 --> 3.512221).  Saving model ...

Epoch 47/99
----------
train Loss: 3.4471 LRAP: 0.0332 NDCG: 0.2293
val Loss: 3.5127 LRAP: 0.0330 NDCG: 0.2261
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.4464 LRAP: 0.0343 NDCG: 0.2280
val Loss: 3.5166 LRAP: 0.0419 NDCG: 0.2286
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.4380 LRAP: 0.0324 NDCG: 0.2290
val Loss: 3.5148 LRAP: 0.0330 NDCG: 0.2273
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 3.4421 LRAP: 0.0321 NDCG: 0.2289
val Loss: 3.5156 LRAP: 0.0470 NDCG: 0.2275
EarlyStopping counter: 4 out of 50

Epoch 51/99
----------
train Loss: 3.4430 LRAP: 0.0319 NDCG: 0.2296
val Loss: 3.5109 LRAP: 0.0318 NDCG: 0.2291
Validation loss decreased (3.512221 --> 3.510895).  Saving model ...

Epoch 52/99
----------
train Loss: 3.4348 LRAP: 0.0340 NDCG: 0.2293
val Loss: 3.5100 LRAP: 0.0292 NDCG: 0.2296
Validation loss decreased (3.510895 --> 3.510025).  Saving model ...

Epoch 53/99
----------
train Loss: 3.4332 LRAP: 0.0346 NDCG: 0.2298
val Loss: 3.5096 LRAP: 0.0343 NDCG: 0.2281
Validation loss decreased (3.510025 --> 3.509584).  Saving model ...

Epoch 54/99
----------
train Loss: 3.4495 LRAP: 0.0362 NDCG: 0.2307
val Loss: 3.5119 LRAP: 0.0343 NDCG: 0.2274
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 3.4406 LRAP: 0.0346 NDCG: 0.2304
val Loss: 3.5094 LRAP: 0.0343 NDCG: 0.2280
Validation loss decreased (3.509584 --> 3.509441).  Saving model ...

Epoch 56/99
----------
train Loss: 3.4565 LRAP: 0.0302 NDCG: 0.2292
val Loss: 3.5107 LRAP: 0.0343 NDCG: 0.2278
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 3.4429 LRAP: 0.0395 NDCG: 0.2292
val Loss: 3.5102 LRAP: 0.0356 NDCG: 0.2285
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 3.4401 LRAP: 0.0381 NDCG: 0.2297
val Loss: 3.5095 LRAP: 0.0343 NDCG: 0.2284
EarlyStopping counter: 3 out of 50

Epoch 59/99
----------
train Loss: 3.4424 LRAP: 0.0329 NDCG: 0.2303
val Loss: 3.5090 LRAP: 0.0343 NDCG: 0.2287
Validation loss decreased (3.509441 --> 3.508971).  Saving model ...

Epoch 60/99
----------
train Loss: 3.4420 LRAP: 0.0338 NDCG: 0.2296
val Loss: 3.5077 LRAP: 0.0216 NDCG: 0.2295
Validation loss decreased (3.508971 --> 3.507656).  Saving model ...

Epoch 61/99
----------
train Loss: 3.4410 LRAP: 0.0310 NDCG: 0.2301
val Loss: 3.5093 LRAP: 0.0343 NDCG: 0.2275
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 3.4478 LRAP: 0.0335 NDCG: 0.2299
val Loss: 3.5088 LRAP: 0.0343 NDCG: 0.2278
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 3.4482 LRAP: 0.0340 NDCG: 0.2290
val Loss: 3.5090 LRAP: 0.0343 NDCG: 0.2273
EarlyStopping counter: 3 out of 50

Epoch 64/99
----------
train Loss: 3.4517 LRAP: 0.0378 NDCG: 0.2284
val Loss: 3.5094 LRAP: 0.0343 NDCG: 0.2291
EarlyStopping counter: 4 out of 50

Epoch 65/99
----------
train Loss: 3.4426 LRAP: 0.0327 NDCG: 0.2287
val Loss: 3.5111 LRAP: 0.0407 NDCG: 0.2280
EarlyStopping counter: 5 out of 50

Epoch 66/99
----------
train Loss: 3.4504 LRAP: 0.0329 NDCG: 0.2296
val Loss: 3.5091 LRAP: 0.0343 NDCG: 0.2290
EarlyStopping counter: 6 out of 50

Epoch 67/99
----------
train Loss: 3.4458 LRAP: 0.0332 NDCG: 0.2310
val Loss: 3.5093 LRAP: 0.0330 NDCG: 0.2280
EarlyStopping counter: 7 out of 50

Epoch 68/99
----------
train Loss: 3.4471 LRAP: 0.0335 NDCG: 0.2302
val Loss: 3.5095 LRAP: 0.0318 NDCG: 0.2291
EarlyStopping counter: 8 out of 50

Epoch 69/99
----------
train Loss: 3.4398 LRAP: 0.0329 NDCG: 0.2310
val Loss: 3.5088 LRAP: 0.0343 NDCG: 0.2294
EarlyStopping counter: 9 out of 50

Epoch 70/99
----------
train Loss: 3.4472 LRAP: 0.0319 NDCG: 0.2310
val Loss: 3.5080 LRAP: 0.0229 NDCG: 0.2283
EarlyStopping counter: 10 out of 50

Epoch 71/99
----------
train Loss: 3.4397 LRAP: 0.0354 NDCG: 0.2303
val Loss: 3.5077 LRAP: 0.0330 NDCG: 0.2274
EarlyStopping counter: 11 out of 50

Epoch 72/99
----------
train Loss: 3.4348 LRAP: 0.0368 NDCG: 0.2309
val Loss: 3.5121 LRAP: 0.0407 NDCG: 0.2281
EarlyStopping counter: 12 out of 50

Epoch 73/99
----------
train Loss: 3.4522 LRAP: 0.0406 NDCG: 0.2300
val Loss: 3.5089 LRAP: 0.0343 NDCG: 0.2289
EarlyStopping counter: 13 out of 50

Epoch 74/99
----------
train Loss: 3.4549 LRAP: 0.0381 NDCG: 0.2292
val Loss: 3.5097 LRAP: 0.0356 NDCG: 0.2274
EarlyStopping counter: 14 out of 50

Epoch 75/99
----------
train Loss: 3.4486 LRAP: 0.0305 NDCG: 0.2298
val Loss: 3.5112 LRAP: 0.0457 NDCG: 0.2281
EarlyStopping counter: 15 out of 50

Epoch 76/99
----------
train Loss: 3.4498 LRAP: 0.0313 NDCG: 0.2296
val Loss: 3.5108 LRAP: 0.0432 NDCG: 0.2280
EarlyStopping counter: 16 out of 50

Epoch 77/99
----------
train Loss: 3.4449 LRAP: 0.0305 NDCG: 0.2308
val Loss: 3.5081 LRAP: 0.0318 NDCG: 0.2286
EarlyStopping counter: 17 out of 50

Epoch 78/99
----------
train Loss: 3.4382 LRAP: 0.0392 NDCG: 0.2304
val Loss: 3.5104 LRAP: 0.0356 NDCG: 0.2275
EarlyStopping counter: 18 out of 50

Epoch 79/99
----------
train Loss: 3.4461 LRAP: 0.0335 NDCG: 0.2296
val Loss: 3.5080 LRAP: 0.0343 NDCG: 0.2275
EarlyStopping counter: 19 out of 50

Epoch 80/99
----------
train Loss: 3.4343 LRAP: 0.0368 NDCG: 0.2310
val Loss: 3.5083 LRAP: 0.0343 NDCG: 0.2277
EarlyStopping counter: 20 out of 50

Epoch 81/99
----------
train Loss: 3.4424 LRAP: 0.0362 NDCG: 0.2299
val Loss: 3.5077 LRAP: 0.0241 NDCG: 0.2284
Validation loss decreased (3.507656 --> 3.507653).  Saving model ...

Epoch 82/99
----------
train Loss: 3.4399 LRAP: 0.0299 NDCG: 0.2290
val Loss: 3.5093 LRAP: 0.0343 NDCG: 0.2280
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.4366 LRAP: 0.0329 NDCG: 0.2314
val Loss: 3.5080 LRAP: 0.0229 NDCG: 0.2291
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.4479 LRAP: 0.0319 NDCG: 0.2308
val Loss: 3.5088 LRAP: 0.0305 NDCG: 0.2293
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.4388 LRAP: 0.0346 NDCG: 0.2306
val Loss: 3.5083 LRAP: 0.0305 NDCG: 0.2284
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.4380 LRAP: 0.0359 NDCG: 0.2302
val Loss: 3.5099 LRAP: 0.0343 NDCG: 0.2296
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 3.4468 LRAP: 0.0362 NDCG: 0.2290
val Loss: 3.5074 LRAP: 0.0241 NDCG: 0.2282
Validation loss decreased (3.507653 --> 3.507390).  Saving model ...

Epoch 88/99
----------
train Loss: 3.4379 LRAP: 0.0346 NDCG: 0.2295
val Loss: 3.5089 LRAP: 0.0343 NDCG: 0.2283
EarlyStopping counter: 1 out of 50

Epoch 89/99
----------
train Loss: 3.4400 LRAP: 0.0346 NDCG: 0.2299
val Loss: 3.5093 LRAP: 0.0381 NDCG: 0.2285
EarlyStopping counter: 2 out of 50

Epoch 90/99
----------
train Loss: 3.4529 LRAP: 0.0329 NDCG: 0.2309
val Loss: 3.5100 LRAP: 0.0356 NDCG: 0.2280
EarlyStopping counter: 3 out of 50

Epoch 91/99
----------
train Loss: 3.4377 LRAP: 0.0357 NDCG: 0.2312
val Loss: 3.5120 LRAP: 0.0356 NDCG: 0.2279
EarlyStopping counter: 4 out of 50

Epoch 92/99
----------
train Loss: 3.4571 LRAP: 0.0327 NDCG: 0.2286
val Loss: 3.5093 LRAP: 0.0368 NDCG: 0.2294
EarlyStopping counter: 5 out of 50

Epoch 93/99
----------
train Loss: 3.4371 LRAP: 0.0373 NDCG: 0.2289
val Loss: 3.5096 LRAP: 0.0343 NDCG: 0.2285
EarlyStopping counter: 6 out of 50

Epoch 94/99
----------
train Loss: 3.4517 LRAP: 0.0362 NDCG: 0.2288
val Loss: 3.5087 LRAP: 0.0343 NDCG: 0.2280
EarlyStopping counter: 7 out of 50

Epoch 95/99
----------
train Loss: 3.4361 LRAP: 0.0365 NDCG: 0.2293
val Loss: 3.5081 LRAP: 0.0343 NDCG: 0.2282
EarlyStopping counter: 8 out of 50

Epoch 96/99
----------
train Loss: 3.4420 LRAP: 0.0378 NDCG: 0.2315
val Loss: 3.5087 LRAP: 0.0216 NDCG: 0.2295
EarlyStopping counter: 9 out of 50

Epoch 97/99
----------
train Loss: 3.4440 LRAP: 0.0324 NDCG: 0.2308
val Loss: 3.5080 LRAP: 0.0216 NDCG: 0.2291
EarlyStopping counter: 10 out of 50

Epoch 98/99
----------
train Loss: 3.4352 LRAP: 0.0348 NDCG: 0.2314
val Loss: 3.5090 LRAP: 0.0343 NDCG: 0.2297
EarlyStopping counter: 11 out of 50

Epoch 99/99
----------
train Loss: 3.4330 LRAP: 0.0397 NDCG: 0.2282
val Loss: 3.5089 LRAP: 0.0343 NDCG: 0.2274
EarlyStopping counter: 12 out of 50

Training complete in 2m 26s
Best val loss: 3.507390, best LRAP score: 0.5251

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 8/10

All random seeds set to: 49
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.4613 LRAP: 0.0000 NDCG: 0.1637
val Loss: 4.8140 LRAP: 0.0000 NDCG: 0.1628
Validation loss decreased (0.000000 --> 4.813994).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0239 LRAP: 0.0000 NDCG: 0.1884
val Loss: 4.5630 LRAP: 0.0000 NDCG: 0.2286
Validation loss decreased (4.813994 --> 4.562952).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8622 LRAP: 0.0005 NDCG: 0.2042
val Loss: 3.8073 LRAP: 0.0025 NDCG: 0.2119
Validation loss decreased (4.562952 --> 3.807285).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7690 LRAP: 0.0068 NDCG: 0.2106
val Loss: 3.9170 LRAP: 0.0038 NDCG: 0.2185
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.6774 LRAP: 0.0049 NDCG: 0.2149
val Loss: 3.7451 LRAP: 0.0038 NDCG: 0.2097
Validation loss decreased (3.807285 --> 3.745073).  Saving model ...

Epoch 5/99
----------
train Loss: 3.6317 LRAP: 0.0079 NDCG: 0.2176
val Loss: 3.8155 LRAP: 0.0089 NDCG: 0.1904
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.5612 LRAP: 0.0065 NDCG: 0.2176
val Loss: 3.6514 LRAP: 0.0064 NDCG: 0.2228
Validation loss decreased (3.745073 --> 3.651444).  Saving model ...

Epoch 7/99
----------
train Loss: 3.5034 LRAP: 0.0117 NDCG: 0.2266
val Loss: 3.8800 LRAP: 0.0089 NDCG: 0.2056
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.4513 LRAP: 0.0270 NDCG: 0.2287
val Loss: 3.7253 LRAP: 0.0038 NDCG: 0.2324
EarlyStopping counter: 2 out of 50

Epoch 9/99
----------
train Loss: 3.4014 LRAP: 0.0207 NDCG: 0.2309
val Loss: 3.5034 LRAP: 0.0076 NDCG: 0.2270
Validation loss decreased (3.651444 --> 3.503360).  Saving model ...

Epoch 10/99
----------
train Loss: 3.3416 LRAP: 0.0193 NDCG: 0.2331
val Loss: 3.3799 LRAP: 0.0051 NDCG: 0.2474
Validation loss decreased (3.503360 --> 3.379855).  Saving model ...

Epoch 11/99
----------
train Loss: 3.2790 LRAP: 0.0191 NDCG: 0.2401
val Loss: 3.8798 LRAP: 0.0089 NDCG: 0.2091
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.2475 LRAP: 0.0427 NDCG: 0.2441
val Loss: 3.2751 LRAP: 0.0241 NDCG: 0.2397
Validation loss decreased (3.379855 --> 3.275091).  Saving model ...

Epoch 13/99
----------
train Loss: 3.1722 LRAP: 0.0378 NDCG: 0.2498
val Loss: 3.3691 LRAP: 0.0457 NDCG: 0.2288
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.1253 LRAP: 0.0506 NDCG: 0.2511
val Loss: 3.2222 LRAP: 0.0737 NDCG: 0.2498
Validation loss decreased (3.275091 --> 3.222214).  Saving model ...

Epoch 15/99
----------
train Loss: 3.0860 LRAP: 0.0561 NDCG: 0.2538
val Loss: 3.2587 LRAP: 0.0902 NDCG: 0.2621
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 3.0336 LRAP: 0.0607 NDCG: 0.2619
val Loss: 3.0571 LRAP: 0.0724 NDCG: 0.2737
Validation loss decreased (3.222214 --> 3.057054).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9743 LRAP: 0.0509 NDCG: 0.2638
val Loss: 3.0619 LRAP: 0.0343 NDCG: 0.2733
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 2.9523 LRAP: 0.0558 NDCG: 0.2698
val Loss: 3.0530 LRAP: 0.0839 NDCG: 0.2623
Validation loss decreased (3.057054 --> 3.053000).  Saving model ...

Epoch 19/99
----------
train Loss: 2.8878 LRAP: 0.0569 NDCG: 0.2713
val Loss: 2.9862 LRAP: 0.0699 NDCG: 0.2733
Validation loss decreased (3.053000 --> 2.986180).  Saving model ...

Epoch 20/99
----------
train Loss: 2.8393 LRAP: 0.0517 NDCG: 0.2729
val Loss: 2.9532 LRAP: 0.0712 NDCG: 0.2766
Validation loss decreased (2.986180 --> 2.953229).  Saving model ...

Epoch 21/99
----------
train Loss: 2.7883 LRAP: 0.0651 NDCG: 0.2766
val Loss: 2.8170 LRAP: 0.1080 NDCG: 0.2822
Validation loss decreased (2.953229 --> 2.816962).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7521 LRAP: 0.0746 NDCG: 0.2815
val Loss: 2.8940 LRAP: 0.1144 NDCG: 0.2969
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.7203 LRAP: 0.0768 NDCG: 0.2807
val Loss: 2.8038 LRAP: 0.1080 NDCG: 0.2974
Validation loss decreased (2.816962 --> 2.803784).  Saving model ...

Epoch 24/99
----------
train Loss: 2.7023 LRAP: 0.0784 NDCG: 0.2831
val Loss: 2.9054 LRAP: 0.1017 NDCG: 0.2856
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.6338 LRAP: 0.0743 NDCG: 0.2897
val Loss: 2.8999 LRAP: 0.0635 NDCG: 0.2748
EarlyStopping counter: 2 out of 50

Epoch 26/99
----------
train Loss: 2.6027 LRAP: 0.0721 NDCG: 0.2903
val Loss: 2.8812 LRAP: 0.0902 NDCG: 0.2829
EarlyStopping counter: 3 out of 50

Epoch 27/99
----------
train Loss: 2.5902 LRAP: 0.0762 NDCG: 0.2931
val Loss: 2.6958 LRAP: 0.0953 NDCG: 0.2907
Validation loss decreased (2.803784 --> 2.695758).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5550 LRAP: 0.0765 NDCG: 0.2965
val Loss: 2.6576 LRAP: 0.1105 NDCG: 0.3130
Validation loss decreased (2.695758 --> 2.657617).  Saving model ...

Epoch 29/99
----------
train Loss: 2.5217 LRAP: 0.0719 NDCG: 0.2974
val Loss: 2.7632 LRAP: 0.1118 NDCG: 0.3069
EarlyStopping counter: 1 out of 50

Epoch 30/99
----------
train Loss: 2.4875 LRAP: 0.0779 NDCG: 0.3024
val Loss: 2.6180 LRAP: 0.0864 NDCG: 0.3142
Validation loss decreased (2.657617 --> 2.617970).  Saving model ...

Epoch 31/99
----------
train Loss: 2.4459 LRAP: 0.0762 NDCG: 0.3041
val Loss: 2.5890 LRAP: 0.1004 NDCG: 0.3216
Validation loss decreased (2.617970 --> 2.589031).  Saving model ...

Epoch 32/99
----------
train Loss: 2.4361 LRAP: 0.0800 NDCG: 0.3066
val Loss: 2.6510 LRAP: 0.1144 NDCG: 0.3179
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.4030 LRAP: 0.0800 NDCG: 0.3085
val Loss: 2.5821 LRAP: 0.1055 NDCG: 0.3231
Validation loss decreased (2.589031 --> 2.582067).  Saving model ...

Epoch 34/99
----------
train Loss: 2.3701 LRAP: 0.0779 NDCG: 0.3094
val Loss: 2.4976 LRAP: 0.1067 NDCG: 0.3219
Validation loss decreased (2.582067 --> 2.497632).  Saving model ...

Epoch 35/99
----------
train Loss: 2.3569 LRAP: 0.0770 NDCG: 0.3118
val Loss: 2.5270 LRAP: 0.0775 NDCG: 0.3279
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 2.3080 LRAP: 0.0822 NDCG: 0.3157
val Loss: 2.5110 LRAP: 0.0775 NDCG: 0.3254
EarlyStopping counter: 2 out of 50

Epoch 37/99
----------
train Loss: 2.2814 LRAP: 0.0754 NDCG: 0.3159
val Loss: 2.5040 LRAP: 0.0991 NDCG: 0.3387
EarlyStopping counter: 3 out of 50

Epoch 38/99
----------
train Loss: 2.2483 LRAP: 0.0792 NDCG: 0.3197
val Loss: 2.5352 LRAP: 0.0839 NDCG: 0.3307
EarlyStopping counter: 4 out of 50

Epoch 39/99
----------
train Loss: 2.2316 LRAP: 0.0776 NDCG: 0.3194
val Loss: 2.5192 LRAP: 0.0889 NDCG: 0.3232
EarlyStopping counter: 5 out of 50

Epoch 40/99
----------
train Loss: 2.1263 LRAP: 0.0806 NDCG: 0.3260
val Loss: 2.3579 LRAP: 0.1131 NDCG: 0.3432
Validation loss decreased (2.497632 --> 2.357941).  Saving model ...

Epoch 41/99
----------
train Loss: 2.0939 LRAP: 0.0855 NDCG: 0.3269
val Loss: 2.3429 LRAP: 0.1042 NDCG: 0.3438
Validation loss decreased (2.357941 --> 2.342858).  Saving model ...

Epoch 42/99
----------
train Loss: 2.0635 LRAP: 0.0855 NDCG: 0.3267
val Loss: 2.3405 LRAP: 0.1067 NDCG: 0.3441
Validation loss decreased (2.342858 --> 2.340465).  Saving model ...

Epoch 43/99
----------
train Loss: 2.0468 LRAP: 0.0836 NDCG: 0.3296
val Loss: 2.3350 LRAP: 0.0991 NDCG: 0.3449
Validation loss decreased (2.340465 --> 2.334965).  Saving model ...

Epoch 44/99
----------
train Loss: 2.0356 LRAP: 0.0849 NDCG: 0.3312
val Loss: 2.3338 LRAP: 0.0978 NDCG: 0.3456
Validation loss decreased (2.334965 --> 2.333765).  Saving model ...

Epoch 45/99
----------
train Loss: 2.0258 LRAP: 0.0860 NDCG: 0.3292
val Loss: 2.3165 LRAP: 0.1017 NDCG: 0.3467
Validation loss decreased (2.333765 --> 2.316520).  Saving model ...

Epoch 46/99
----------
train Loss: 2.0025 LRAP: 0.0863 NDCG: 0.3302
val Loss: 2.3247 LRAP: 0.1080 NDCG: 0.3481
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 2.0033 LRAP: 0.0874 NDCG: 0.3314
val Loss: 2.3100 LRAP: 0.1042 NDCG: 0.3529
Validation loss decreased (2.316520 --> 2.310049).  Saving model ...

Epoch 48/99
----------
train Loss: 1.9790 LRAP: 0.0866 NDCG: 0.3333
val Loss: 2.3085 LRAP: 0.1042 NDCG: 0.3491
Validation loss decreased (2.310049 --> 2.308531).  Saving model ...

Epoch 49/99
----------
train Loss: 1.9765 LRAP: 0.0839 NDCG: 0.3340
val Loss: 2.3044 LRAP: 0.1105 NDCG: 0.3520
Validation loss decreased (2.308531 --> 2.304389).  Saving model ...

Epoch 50/99
----------
train Loss: 1.9681 LRAP: 0.0836 NDCG: 0.3341
val Loss: 2.2992 LRAP: 0.0991 NDCG: 0.3556
Validation loss decreased (2.304389 --> 2.299191).  Saving model ...

Epoch 51/99
----------
train Loss: 1.9415 LRAP: 0.0860 NDCG: 0.3364
val Loss: 2.3010 LRAP: 0.1093 NDCG: 0.3518
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 1.9376 LRAP: 0.0849 NDCG: 0.3364
val Loss: 2.3090 LRAP: 0.1042 NDCG: 0.3590
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 1.9413 LRAP: 0.0844 NDCG: 0.3368
val Loss: 2.3151 LRAP: 0.1144 NDCG: 0.3558
EarlyStopping counter: 3 out of 50

Epoch 54/99
----------
train Loss: 1.9350 LRAP: 0.0828 NDCG: 0.3347
val Loss: 2.2873 LRAP: 0.1118 NDCG: 0.3551
Validation loss decreased (2.299191 --> 2.287340).  Saving model ...

Epoch 55/99
----------
train Loss: 1.9239 LRAP: 0.0863 NDCG: 0.3383
val Loss: 2.2846 LRAP: 0.1067 NDCG: 0.3542
Validation loss decreased (2.287340 --> 2.284594).  Saving model ...

Epoch 56/99
----------
train Loss: 1.9149 LRAP: 0.0866 NDCG: 0.3377
val Loss: 2.2748 LRAP: 0.1080 NDCG: 0.3555
Validation loss decreased (2.284594 --> 2.274788).  Saving model ...

Epoch 57/99
----------
train Loss: 1.9039 LRAP: 0.0915 NDCG: 0.3403
val Loss: 2.2872 LRAP: 0.1042 NDCG: 0.3588
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 1.8874 LRAP: 0.0877 NDCG: 0.3409
val Loss: 2.2781 LRAP: 0.1055 NDCG: 0.3569
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 1.8838 LRAP: 0.0893 NDCG: 0.3436
val Loss: 2.2678 LRAP: 0.1131 NDCG: 0.3672
Validation loss decreased (2.274788 --> 2.267832).  Saving model ...

Epoch 60/99
----------
train Loss: 1.8785 LRAP: 0.0882 NDCG: 0.3425
val Loss: 2.2767 LRAP: 0.1131 NDCG: 0.3594
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 1.8527 LRAP: 0.0860 NDCG: 0.3443
val Loss: 2.2762 LRAP: 0.1118 NDCG: 0.3662
EarlyStopping counter: 2 out of 50

Epoch 62/99
----------
train Loss: 1.8524 LRAP: 0.0950 NDCG: 0.3451
val Loss: 2.2696 LRAP: 0.1169 NDCG: 0.3693
EarlyStopping counter: 3 out of 50

Epoch 63/99
----------
train Loss: 1.8384 LRAP: 0.0847 NDCG: 0.3457
val Loss: 2.2662 LRAP: 0.1207 NDCG: 0.3690
Validation loss decreased (2.267832 --> 2.266220).  Saving model ...

Epoch 64/99
----------
train Loss: 1.8382 LRAP: 0.0885 NDCG: 0.3457
val Loss: 2.2658 LRAP: 0.1258 NDCG: 0.3674
Validation loss decreased (2.266220 --> 2.265770).  Saving model ...

Epoch 65/99
----------
train Loss: 1.8392 LRAP: 0.0942 NDCG: 0.3459
val Loss: 2.2849 LRAP: 0.1220 NDCG: 0.3721
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 1.8334 LRAP: 0.0901 NDCG: 0.3485
val Loss: 2.2886 LRAP: 0.1156 NDCG: 0.3699
EarlyStopping counter: 2 out of 50

Epoch 67/99
----------
train Loss: 1.8046 LRAP: 0.0904 NDCG: 0.3471
val Loss: 2.2568 LRAP: 0.1220 NDCG: 0.3695
Validation loss decreased (2.265770 --> 2.256812).  Saving model ...

Epoch 68/99
----------
train Loss: 1.7966 LRAP: 0.0934 NDCG: 0.3495
val Loss: 2.2606 LRAP: 0.1233 NDCG: 0.3804
EarlyStopping counter: 1 out of 50

Epoch 69/99
----------
train Loss: 1.7903 LRAP: 0.0909 NDCG: 0.3486
val Loss: 2.2540 LRAP: 0.1258 NDCG: 0.3716
Validation loss decreased (2.256812 --> 2.254003).  Saving model ...

Epoch 70/99
----------
train Loss: 1.7863 LRAP: 0.0855 NDCG: 0.3516
val Loss: 2.2624 LRAP: 0.1182 NDCG: 0.3703
EarlyStopping counter: 1 out of 50

Epoch 71/99
----------
train Loss: 1.7786 LRAP: 0.0882 NDCG: 0.3523
val Loss: 2.2462 LRAP: 0.1245 NDCG: 0.3787
Validation loss decreased (2.254003 --> 2.246241).  Saving model ...

Epoch 72/99
----------
train Loss: 1.7751 LRAP: 0.0915 NDCG: 0.3521
val Loss: 2.2522 LRAP: 0.1194 NDCG: 0.3829
EarlyStopping counter: 1 out of 50

Epoch 73/99
----------
train Loss: 1.7541 LRAP: 0.0868 NDCG: 0.3535
val Loss: 2.2505 LRAP: 0.1220 NDCG: 0.3693
EarlyStopping counter: 2 out of 50

Epoch 74/99
----------
train Loss: 1.7582 LRAP: 0.0958 NDCG: 0.3545
val Loss: 2.2587 LRAP: 0.1283 NDCG: 0.3819
EarlyStopping counter: 3 out of 50

Epoch 75/99
----------
train Loss: 1.7551 LRAP: 0.0964 NDCG: 0.3565
val Loss: 2.2629 LRAP: 0.1271 NDCG: 0.3832
EarlyStopping counter: 4 out of 50

Epoch 76/99
----------
train Loss: 1.7187 LRAP: 0.0939 NDCG: 0.3555
val Loss: 2.2436 LRAP: 0.1245 NDCG: 0.3796
Validation loss decreased (2.246241 --> 2.243569).  Saving model ...

Epoch 77/99
----------
train Loss: 1.7091 LRAP: 0.0928 NDCG: 0.3557
val Loss: 2.2509 LRAP: 0.1283 NDCG: 0.3870
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 1.7218 LRAP: 0.0939 NDCG: 0.3565
val Loss: 2.2580 LRAP: 0.1296 NDCG: 0.3832
EarlyStopping counter: 2 out of 50

Epoch 79/99
----------
train Loss: 1.7188 LRAP: 0.0923 NDCG: 0.3558
val Loss: 2.2347 LRAP: 0.1283 NDCG: 0.3877
Validation loss decreased (2.243569 --> 2.234735).  Saving model ...

Epoch 80/99
----------
train Loss: 1.7062 LRAP: 0.0950 NDCG: 0.3570
val Loss: 2.2444 LRAP: 0.1207 NDCG: 0.3896
EarlyStopping counter: 1 out of 50

Epoch 81/99
----------
train Loss: 1.7030 LRAP: 0.0961 NDCG: 0.3592
val Loss: 2.2354 LRAP: 0.1283 NDCG: 0.3862
EarlyStopping counter: 2 out of 50

Epoch 82/99
----------
train Loss: 1.6803 LRAP: 0.0964 NDCG: 0.3600
val Loss: 2.2647 LRAP: 0.1321 NDCG: 0.3843
EarlyStopping counter: 3 out of 50

Epoch 83/99
----------
train Loss: 1.6848 LRAP: 0.0967 NDCG: 0.3587
val Loss: 2.2415 LRAP: 0.1245 NDCG: 0.3903
EarlyStopping counter: 4 out of 50

Epoch 84/99
----------
train Loss: 1.6735 LRAP: 0.0945 NDCG: 0.3587
val Loss: 2.2625 LRAP: 0.1334 NDCG: 0.3895
EarlyStopping counter: 5 out of 50

Epoch 85/99
----------
train Loss: 1.6399 LRAP: 0.0999 NDCG: 0.3645
val Loss: 2.2339 LRAP: 0.1321 NDCG: 0.3905
Validation loss decreased (2.234735 --> 2.233905).  Saving model ...

Epoch 86/99
----------
train Loss: 1.6313 LRAP: 0.0986 NDCG: 0.3618
val Loss: 2.2365 LRAP: 0.1334 NDCG: 0.3905
EarlyStopping counter: 1 out of 50

Epoch 87/99
----------
train Loss: 1.6268 LRAP: 0.0977 NDCG: 0.3639
val Loss: 2.2299 LRAP: 0.1334 NDCG: 0.3912
Validation loss decreased (2.233905 --> 2.229885).  Saving model ...

Epoch 88/99
----------
train Loss: 1.6335 LRAP: 0.0980 NDCG: 0.3660
val Loss: 2.2293 LRAP: 0.1321 NDCG: 0.3915
Validation loss decreased (2.229885 --> 2.229292).  Saving model ...

Epoch 89/99
----------
train Loss: 1.6179 LRAP: 0.0986 NDCG: 0.3639
val Loss: 2.2177 LRAP: 0.1347 NDCG: 0.3957
Validation loss decreased (2.229292 --> 2.217659).  Saving model ...

Epoch 90/99
----------
train Loss: 1.6125 LRAP: 0.0983 NDCG: 0.3655
val Loss: 2.2215 LRAP: 0.1309 NDCG: 0.3920
EarlyStopping counter: 1 out of 50

Epoch 91/99
----------
train Loss: 1.6275 LRAP: 0.1056 NDCG: 0.3641
val Loss: 2.2209 LRAP: 0.1309 NDCG: 0.3930
EarlyStopping counter: 2 out of 50

Epoch 92/99
----------
train Loss: 1.6213 LRAP: 0.1021 NDCG: 0.3642
val Loss: 2.2204 LRAP: 0.1321 NDCG: 0.3946
EarlyStopping counter: 3 out of 50

Epoch 93/99
----------
train Loss: 1.6184 LRAP: 0.0980 NDCG: 0.3671
val Loss: 2.2209 LRAP: 0.1309 NDCG: 0.3931
EarlyStopping counter: 4 out of 50

Epoch 94/99
----------
train Loss: 1.6146 LRAP: 0.1018 NDCG: 0.3633
val Loss: 2.2242 LRAP: 0.1321 NDCG: 0.3939
EarlyStopping counter: 5 out of 50

Epoch 95/99
----------
train Loss: 1.6026 LRAP: 0.0953 NDCG: 0.3662
val Loss: 2.2222 LRAP: 0.1334 NDCG: 0.3948
EarlyStopping counter: 6 out of 50

Epoch 96/99
----------
train Loss: 1.6248 LRAP: 0.0969 NDCG: 0.3646
val Loss: 2.2239 LRAP: 0.1360 NDCG: 0.3963
EarlyStopping counter: 7 out of 50

Epoch 97/99
----------
train Loss: 1.6072 LRAP: 0.0950 NDCG: 0.3653
val Loss: 2.2228 LRAP: 0.1309 NDCG: 0.3946
EarlyStopping counter: 8 out of 50

Epoch 98/99
----------
train Loss: 1.5974 LRAP: 0.0980 NDCG: 0.3633
val Loss: 2.2232 LRAP: 0.1334 NDCG: 0.3967
EarlyStopping counter: 9 out of 50

Epoch 99/99
----------
train Loss: 1.6126 LRAP: 0.0939 NDCG: 0.3650
val Loss: 2.2215 LRAP: 0.1309 NDCG: 0.3945
EarlyStopping counter: 10 out of 50

Training complete in 2m 29s
Best val loss: 2.217659, best LRAP score: 0.7829

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4451 LRAP: 0.0000 NDCG: 0.1735
val Loss: 5.4078 LRAP: 0.0000 NDCG: 0.1993
Validation loss decreased (0.000000 --> 5.407770).  Saving model ...

Epoch 1/99
----------
train Loss: 3.8962 LRAP: 0.0005 NDCG: 0.2112
val Loss: 3.8585 LRAP: 0.0038 NDCG: 0.2398
Validation loss decreased (5.407770 --> 3.858532).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7335 LRAP: 0.0044 NDCG: 0.2215
val Loss: 3.8578 LRAP: 0.0076 NDCG: 0.2235
Validation loss decreased (3.858532 --> 3.857815).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6315 LRAP: 0.0125 NDCG: 0.2321
val Loss: 4.0061 LRAP: 0.0203 NDCG: 0.2289
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.5524 LRAP: 0.0433 NDCG: 0.2340
val Loss: 3.5566 LRAP: 0.0762 NDCG: 0.2514
Validation loss decreased (3.857815 --> 3.556615).  Saving model ...

Epoch 5/99
----------
train Loss: 3.4809 LRAP: 0.0504 NDCG: 0.2390
val Loss: 3.5394 LRAP: 0.0089 NDCG: 0.2482
Validation loss decreased (3.556615 --> 3.539436).  Saving model ...

Epoch 6/99
----------
train Loss: 3.4138 LRAP: 0.0506 NDCG: 0.2440
val Loss: 3.9540 LRAP: 0.0216 NDCG: 0.2493
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.3888 LRAP: 0.0653 NDCG: 0.2451
val Loss: 3.5600 LRAP: 0.0978 NDCG: 0.2313
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.3004 LRAP: 0.0651 NDCG: 0.2491
val Loss: 3.6044 LRAP: 0.1156 NDCG: 0.2550
EarlyStopping counter: 3 out of 50

Epoch 9/99
----------
train Loss: 3.2645 LRAP: 0.0678 NDCG: 0.2542
val Loss: 3.4764 LRAP: 0.1271 NDCG: 0.2620
Validation loss decreased (3.539436 --> 3.476409).  Saving model ...

Epoch 10/99
----------
train Loss: 3.2411 LRAP: 0.0525 NDCG: 0.2549
val Loss: 3.3564 LRAP: 0.1004 NDCG: 0.2589
Validation loss decreased (3.476409 --> 3.356356).  Saving model ...

Epoch 11/99
----------
train Loss: 3.2098 LRAP: 0.0515 NDCG: 0.2603
val Loss: 3.3465 LRAP: 0.0559 NDCG: 0.2452
Validation loss decreased (3.356356 --> 3.346455).  Saving model ...

Epoch 12/99
----------
train Loss: 3.1497 LRAP: 0.0662 NDCG: 0.2640
val Loss: 3.1672 LRAP: 0.0280 NDCG: 0.2695
Validation loss decreased (3.346455 --> 3.167157).  Saving model ...

Epoch 13/99
----------
train Loss: 3.0971 LRAP: 0.0629 NDCG: 0.2651
val Loss: 3.2726 LRAP: 0.1220 NDCG: 0.2653
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.0958 LRAP: 0.0664 NDCG: 0.2654
val Loss: 3.0860 LRAP: 0.1029 NDCG: 0.2671
Validation loss decreased (3.167157 --> 3.086032).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9997 LRAP: 0.0809 NDCG: 0.2756
val Loss: 3.3341 LRAP: 0.1131 NDCG: 0.2804
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 3.0012 LRAP: 0.0817 NDCG: 0.2758
val Loss: 3.0593 LRAP: 0.1118 NDCG: 0.2687
Validation loss decreased (3.086032 --> 3.059285).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9504 LRAP: 0.0743 NDCG: 0.2774
val Loss: 2.9746 LRAP: 0.0584 NDCG: 0.2773
Validation loss decreased (3.059285 --> 2.974570).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8977 LRAP: 0.0735 NDCG: 0.2800
val Loss: 3.0104 LRAP: 0.1131 NDCG: 0.2756
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.8776 LRAP: 0.0800 NDCG: 0.2840
val Loss: 2.8819 LRAP: 0.1182 NDCG: 0.2890
Validation loss decreased (2.974570 --> 2.881906).  Saving model ...

Epoch 20/99
----------
train Loss: 2.8212 LRAP: 0.0879 NDCG: 0.2913
val Loss: 2.8905 LRAP: 0.1042 NDCG: 0.2920
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.7939 LRAP: 0.0749 NDCG: 0.2899
val Loss: 3.1411 LRAP: 0.1144 NDCG: 0.2906
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 2.7719 LRAP: 0.0768 NDCG: 0.2893
val Loss: 2.9117 LRAP: 0.0813 NDCG: 0.2810
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 2.7241 LRAP: 0.0841 NDCG: 0.2946
val Loss: 2.7935 LRAP: 0.0915 NDCG: 0.2912
Validation loss decreased (2.881906 --> 2.793479).  Saving model ...

Epoch 24/99
----------
train Loss: 2.7051 LRAP: 0.0896 NDCG: 0.2944
val Loss: 2.8499 LRAP: 0.0940 NDCG: 0.2933
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.7001 LRAP: 0.0909 NDCG: 0.2996
val Loss: 2.8929 LRAP: 0.0928 NDCG: 0.3038
EarlyStopping counter: 2 out of 50

Epoch 26/99
----------
train Loss: 2.6498 LRAP: 0.0868 NDCG: 0.3014
val Loss: 3.0130 LRAP: 0.1169 NDCG: 0.3111
EarlyStopping counter: 3 out of 50

Epoch 27/99
----------
train Loss: 2.6178 LRAP: 0.0847 NDCG: 0.3028
val Loss: 2.9148 LRAP: 0.1004 NDCG: 0.3100
EarlyStopping counter: 4 out of 50

Epoch 28/99
----------
train Loss: 2.5994 LRAP: 0.0945 NDCG: 0.3057
val Loss: 2.7671 LRAP: 0.1207 NDCG: 0.3113
Validation loss decreased (2.793479 --> 2.767145).  Saving model ...

Epoch 29/99
----------
train Loss: 2.5532 LRAP: 0.0928 NDCG: 0.3054
val Loss: 2.7124 LRAP: 0.1207 NDCG: 0.3073
Validation loss decreased (2.767145 --> 2.712413).  Saving model ...

Epoch 30/99
----------
train Loss: 2.5354 LRAP: 0.0896 NDCG: 0.3070
val Loss: 2.7569 LRAP: 0.1067 NDCG: 0.3116
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 2.5209 LRAP: 0.0901 NDCG: 0.3096
val Loss: 2.6757 LRAP: 0.1220 NDCG: 0.3269
Validation loss decreased (2.712413 --> 2.675740).  Saving model ...

Epoch 32/99
----------
train Loss: 2.5013 LRAP: 0.0882 NDCG: 0.3135
val Loss: 2.6362 LRAP: 0.1258 NDCG: 0.3234
Validation loss decreased (2.675740 --> 2.636194).  Saving model ...

Epoch 33/99
----------
train Loss: 2.4531 LRAP: 0.0950 NDCG: 0.3138
val Loss: 2.6160 LRAP: 0.1220 NDCG: 0.3121
Validation loss decreased (2.636194 --> 2.615971).  Saving model ...

Epoch 34/99
----------
train Loss: 2.4418 LRAP: 0.1002 NDCG: 0.3141
val Loss: 2.6663 LRAP: 0.1207 NDCG: 0.3183
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 2.4236 LRAP: 0.1026 NDCG: 0.3170
val Loss: 2.6473 LRAP: 0.1245 NDCG: 0.3091
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 2.3684 LRAP: 0.0988 NDCG: 0.3216
val Loss: 2.6021 LRAP: 0.1144 NDCG: 0.3287
Validation loss decreased (2.615971 --> 2.602070).  Saving model ...

Epoch 37/99
----------
train Loss: 2.3351 LRAP: 0.1035 NDCG: 0.3231
val Loss: 2.5617 LRAP: 0.1309 NDCG: 0.3362
Validation loss decreased (2.602070 --> 2.561727).  Saving model ...

Epoch 38/99
----------
train Loss: 2.3109 LRAP: 0.1010 NDCG: 0.3229
val Loss: 2.5116 LRAP: 0.1105 NDCG: 0.3331
Validation loss decreased (2.561727 --> 2.511579).  Saving model ...

Epoch 39/99
----------
train Loss: 2.2937 LRAP: 0.0977 NDCG: 0.3268
val Loss: 2.5477 LRAP: 0.1283 NDCG: 0.3295
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.2679 LRAP: 0.1024 NDCG: 0.3288
val Loss: 2.7145 LRAP: 0.1080 NDCG: 0.3348
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 2.2482 LRAP: 0.1054 NDCG: 0.3331
val Loss: 2.5033 LRAP: 0.1385 NDCG: 0.3418
Validation loss decreased (2.511579 --> 2.503349).  Saving model ...

Epoch 42/99
----------
train Loss: 2.2211 LRAP: 0.1073 NDCG: 0.3328
val Loss: 2.6056 LRAP: 0.1385 NDCG: 0.3439
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 2.2298 LRAP: 0.1021 NDCG: 0.3332
val Loss: 2.4615 LRAP: 0.1398 NDCG: 0.3442
Validation loss decreased (2.503349 --> 2.461532).  Saving model ...

Epoch 44/99
----------
train Loss: 2.1786 LRAP: 0.1084 NDCG: 0.3365
val Loss: 2.5829 LRAP: 0.1271 NDCG: 0.3426
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 2.1630 LRAP: 0.1108 NDCG: 0.3377
val Loss: 2.4928 LRAP: 0.1423 NDCG: 0.3596
EarlyStopping counter: 2 out of 50

Epoch 46/99
----------
train Loss: 2.1478 LRAP: 0.1059 NDCG: 0.3399
val Loss: 2.4663 LRAP: 0.1245 NDCG: 0.3586
EarlyStopping counter: 3 out of 50

Epoch 47/99
----------
train Loss: 2.1511 LRAP: 0.0994 NDCG: 0.3415
val Loss: 2.4609 LRAP: 0.1283 NDCG: 0.3519
Validation loss decreased (2.461532 --> 2.460920).  Saving model ...

Epoch 48/99
----------
train Loss: 2.1156 LRAP: 0.1114 NDCG: 0.3439
val Loss: 2.5464 LRAP: 0.1385 NDCG: 0.3515
EarlyStopping counter: 1 out of 50

Epoch 49/99
----------
train Loss: 2.0829 LRAP: 0.1094 NDCG: 0.3435
val Loss: 2.4432 LRAP: 0.1423 NDCG: 0.3678
Validation loss decreased (2.460920 --> 2.443237).  Saving model ...

Epoch 50/99
----------
train Loss: 2.0537 LRAP: 0.1092 NDCG: 0.3482
val Loss: 2.4124 LRAP: 0.1410 NDCG: 0.3586
Validation loss decreased (2.443237 --> 2.412425).  Saving model ...

Epoch 51/99
----------
train Loss: 2.0235 LRAP: 0.1097 NDCG: 0.3460
val Loss: 2.5174 LRAP: 0.1283 NDCG: 0.3615
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 2.0307 LRAP: 0.1114 NDCG: 0.3460
val Loss: 2.5005 LRAP: 0.1563 NDCG: 0.3720
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 1.9843 LRAP: 0.1111 NDCG: 0.3478
val Loss: 2.5061 LRAP: 0.1321 NDCG: 0.3503
EarlyStopping counter: 3 out of 50

Epoch 54/99
----------
train Loss: 1.9556 LRAP: 0.1108 NDCG: 0.3530
val Loss: 2.3644 LRAP: 0.1588 NDCG: 0.3746
Validation loss decreased (2.412425 --> 2.364393).  Saving model ...

Epoch 55/99
----------
train Loss: 1.9393 LRAP: 0.1081 NDCG: 0.3542
val Loss: 2.4265 LRAP: 0.1436 NDCG: 0.3752
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 1.9291 LRAP: 0.1122 NDCG: 0.3516
val Loss: 2.4283 LRAP: 0.1487 NDCG: 0.3823
EarlyStopping counter: 2 out of 50

Epoch 57/99
----------
train Loss: 1.9088 LRAP: 0.1124 NDCG: 0.3560
val Loss: 2.4930 LRAP: 0.1588 NDCG: 0.3829
EarlyStopping counter: 3 out of 50

Epoch 58/99
----------
train Loss: 1.8980 LRAP: 0.1100 NDCG: 0.3554
val Loss: 2.4826 LRAP: 0.1410 NDCG: 0.3854
EarlyStopping counter: 4 out of 50

Epoch 59/99
----------
train Loss: 1.8662 LRAP: 0.1100 NDCG: 0.3610
val Loss: 2.3905 LRAP: 0.1512 NDCG: 0.3776
EarlyStopping counter: 5 out of 50

Epoch 60/99
----------
train Loss: 1.7917 LRAP: 0.1146 NDCG: 0.3648
val Loss: 2.2975 LRAP: 0.1639 NDCG: 0.3926
Validation loss decreased (2.364393 --> 2.297455).  Saving model ...

Epoch 61/99
----------
train Loss: 1.7599 LRAP: 0.1154 NDCG: 0.3634
val Loss: 2.3029 LRAP: 0.1652 NDCG: 0.3974
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 1.7271 LRAP: 0.1165 NDCG: 0.3646
val Loss: 2.2954 LRAP: 0.1576 NDCG: 0.3913
Validation loss decreased (2.297455 --> 2.295370).  Saving model ...

Epoch 63/99
----------
train Loss: 1.7138 LRAP: 0.1179 NDCG: 0.3667
val Loss: 2.3097 LRAP: 0.1563 NDCG: 0.3949
EarlyStopping counter: 1 out of 50

Epoch 64/99
----------
train Loss: 1.6864 LRAP: 0.1195 NDCG: 0.3655
val Loss: 2.3125 LRAP: 0.1576 NDCG: 0.3957
EarlyStopping counter: 2 out of 50

Epoch 65/99
----------
train Loss: 1.6828 LRAP: 0.1154 NDCG: 0.3681
val Loss: 2.3113 LRAP: 0.1588 NDCG: 0.3990
EarlyStopping counter: 3 out of 50

Epoch 66/99
----------
train Loss: 1.6799 LRAP: 0.1157 NDCG: 0.3670
val Loss: 2.3104 LRAP: 0.1614 NDCG: 0.3985
EarlyStopping counter: 4 out of 50

Epoch 67/99
----------
train Loss: 1.6732 LRAP: 0.1152 NDCG: 0.3666
val Loss: 2.3089 LRAP: 0.1652 NDCG: 0.3977
EarlyStopping counter: 5 out of 50

Epoch 68/99
----------
train Loss: 1.6301 LRAP: 0.1222 NDCG: 0.3700
val Loss: 2.3043 LRAP: 0.1601 NDCG: 0.3986
EarlyStopping counter: 6 out of 50

Epoch 69/99
----------
train Loss: 1.6518 LRAP: 0.1192 NDCG: 0.3686
val Loss: 2.3006 LRAP: 0.1614 NDCG: 0.3951
EarlyStopping counter: 7 out of 50

Epoch 70/99
----------
train Loss: 1.6390 LRAP: 0.1203 NDCG: 0.3698
val Loss: 2.2982 LRAP: 0.1601 NDCG: 0.3956
EarlyStopping counter: 8 out of 50

Epoch 71/99
----------
train Loss: 1.6354 LRAP: 0.1239 NDCG: 0.3691
val Loss: 2.2988 LRAP: 0.1614 NDCG: 0.3977
EarlyStopping counter: 9 out of 50

Epoch 72/99
----------
train Loss: 1.6331 LRAP: 0.1209 NDCG: 0.3698
val Loss: 2.3038 LRAP: 0.1601 NDCG: 0.3970
EarlyStopping counter: 10 out of 50

Epoch 73/99
----------
train Loss: 1.6424 LRAP: 0.1217 NDCG: 0.3685
val Loss: 2.2994 LRAP: 0.1614 NDCG: 0.3967
EarlyStopping counter: 11 out of 50

Epoch 74/99
----------
train Loss: 1.6328 LRAP: 0.1214 NDCG: 0.3709
val Loss: 2.2982 LRAP: 0.1614 NDCG: 0.3959
EarlyStopping counter: 12 out of 50

Epoch 75/99
----------
train Loss: 1.6195 LRAP: 0.1152 NDCG: 0.3694
val Loss: 2.2996 LRAP: 0.1601 NDCG: 0.3975
EarlyStopping counter: 13 out of 50

Epoch 76/99
----------
train Loss: 1.6234 LRAP: 0.1236 NDCG: 0.3685
val Loss: 2.3011 LRAP: 0.1576 NDCG: 0.3954
EarlyStopping counter: 14 out of 50

Epoch 77/99
----------
train Loss: 1.6334 LRAP: 0.1214 NDCG: 0.3704
val Loss: 2.3017 LRAP: 0.1601 NDCG: 0.3977
EarlyStopping counter: 15 out of 50

Epoch 78/99
----------
train Loss: 1.6287 LRAP: 0.1198 NDCG: 0.3673
val Loss: 2.3005 LRAP: 0.1601 NDCG: 0.3967
EarlyStopping counter: 16 out of 50

Epoch 79/99
----------
train Loss: 1.6346 LRAP: 0.1198 NDCG: 0.3703
val Loss: 2.2995 LRAP: 0.1601 NDCG: 0.3960
EarlyStopping counter: 17 out of 50

Epoch 80/99
----------
train Loss: 1.6435 LRAP: 0.1252 NDCG: 0.3704
val Loss: 2.2993 LRAP: 0.1614 NDCG: 0.3973
EarlyStopping counter: 18 out of 50

Epoch 81/99
----------
train Loss: 1.6349 LRAP: 0.1247 NDCG: 0.3701
val Loss: 2.2995 LRAP: 0.1614 NDCG: 0.3971
EarlyStopping counter: 19 out of 50

Epoch 82/99
----------
train Loss: 1.6140 LRAP: 0.1241 NDCG: 0.3698
val Loss: 2.3002 LRAP: 0.1614 NDCG: 0.3955
EarlyStopping counter: 20 out of 50

Epoch 83/99
----------
train Loss: 1.6280 LRAP: 0.1192 NDCG: 0.3699
val Loss: 2.3000 LRAP: 0.1626 NDCG: 0.3970
EarlyStopping counter: 21 out of 50

Epoch 84/99
----------
train Loss: 1.6315 LRAP: 0.1157 NDCG: 0.3721
val Loss: 2.3042 LRAP: 0.1601 NDCG: 0.3988
EarlyStopping counter: 22 out of 50

Epoch 85/99
----------
train Loss: 1.6128 LRAP: 0.1184 NDCG: 0.3703
val Loss: 2.3030 LRAP: 0.1626 NDCG: 0.3974
EarlyStopping counter: 23 out of 50

Epoch 86/99
----------
train Loss: 1.6314 LRAP: 0.1203 NDCG: 0.3706
val Loss: 2.3007 LRAP: 0.1588 NDCG: 0.3969
EarlyStopping counter: 24 out of 50

Epoch 87/99
----------
train Loss: 1.6154 LRAP: 0.1233 NDCG: 0.3709
val Loss: 2.2959 LRAP: 0.1614 NDCG: 0.3969
EarlyStopping counter: 25 out of 50

Epoch 88/99
----------
train Loss: 1.6339 LRAP: 0.1198 NDCG: 0.3684
val Loss: 2.2997 LRAP: 0.1601 NDCG: 0.3966
EarlyStopping counter: 26 out of 50

Epoch 89/99
----------
train Loss: 1.6154 LRAP: 0.1182 NDCG: 0.3683
val Loss: 2.2991 LRAP: 0.1601 NDCG: 0.3955
EarlyStopping counter: 27 out of 50

Epoch 90/99
----------
train Loss: 1.6170 LRAP: 0.1187 NDCG: 0.3679
val Loss: 2.2995 LRAP: 0.1601 NDCG: 0.3948
EarlyStopping counter: 28 out of 50

Epoch 91/99
----------
train Loss: 1.6243 LRAP: 0.1201 NDCG: 0.3695
val Loss: 2.3027 LRAP: 0.1576 NDCG: 0.3950
EarlyStopping counter: 29 out of 50

Epoch 92/99
----------
train Loss: 1.6397 LRAP: 0.1149 NDCG: 0.3697
val Loss: 2.3010 LRAP: 0.1626 NDCG: 0.3971
EarlyStopping counter: 30 out of 50

Epoch 93/99
----------
train Loss: 1.6274 LRAP: 0.1231 NDCG: 0.3695
val Loss: 2.3016 LRAP: 0.1588 NDCG: 0.3969
EarlyStopping counter: 31 out of 50

Epoch 94/99
----------
train Loss: 1.6166 LRAP: 0.1233 NDCG: 0.3710
val Loss: 2.3019 LRAP: 0.1588 NDCG: 0.3974
EarlyStopping counter: 32 out of 50

Epoch 95/99
----------
train Loss: 1.6132 LRAP: 0.1192 NDCG: 0.3701
val Loss: 2.3020 LRAP: 0.1588 NDCG: 0.3983
EarlyStopping counter: 33 out of 50

Epoch 96/99
----------
train Loss: 1.6232 LRAP: 0.1231 NDCG: 0.3704
val Loss: 2.3043 LRAP: 0.1563 NDCG: 0.3958
EarlyStopping counter: 34 out of 50

Epoch 97/99
----------
train Loss: 1.6274 LRAP: 0.1263 NDCG: 0.3692
val Loss: 2.3008 LRAP: 0.1614 NDCG: 0.3979
EarlyStopping counter: 35 out of 50

Epoch 98/99
----------
train Loss: 1.6309 LRAP: 0.1206 NDCG: 0.3693
val Loss: 2.3008 LRAP: 0.1601 NDCG: 0.3979
EarlyStopping counter: 36 out of 50

Epoch 99/99
----------
train Loss: 1.6256 LRAP: 0.1214 NDCG: 0.3710
val Loss: 2.3005 LRAP: 0.1601 NDCG: 0.3961
EarlyStopping counter: 37 out of 50

Training complete in 2m 26s
Best val loss: 2.295370, best LRAP score: 0.7807

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.6611 LRAP: 0.0000 NDCG: 0.1600
val Loss: 5.2488 LRAP: 0.0000 NDCG: 0.1387
Validation loss decreased (0.000000 --> 5.248751).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1141 LRAP: 0.0000 NDCG: 0.1927
val Loss: 6.3833 LRAP: 0.0038 NDCG: 0.1595
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.8833 LRAP: 0.0019 NDCG: 0.2080
val Loss: 4.0512 LRAP: 0.0076 NDCG: 0.2034
Validation loss decreased (5.248751 --> 4.051170).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7666 LRAP: 0.0052 NDCG: 0.2123
val Loss: 6.1562 LRAP: 0.0064 NDCG: 0.1855
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.6874 LRAP: 0.0071 NDCG: 0.2161
val Loss: 4.3285 LRAP: 0.0064 NDCG: 0.1640
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.6359 LRAP: 0.0076 NDCG: 0.2200
val Loss: 11.3722 LRAP: 0.0000 NDCG: 0.1372
EarlyStopping counter: 3 out of 50

Epoch 6/99
----------
train Loss: 3.5776 LRAP: 0.0090 NDCG: 0.2227
val Loss: 7.2865 LRAP: 0.0038 NDCG: 0.1484
EarlyStopping counter: 4 out of 50

Epoch 7/99
----------
train Loss: 3.5543 LRAP: 0.0120 NDCG: 0.2237
val Loss: 5.4136 LRAP: 0.0000 NDCG: 0.1670
EarlyStopping counter: 5 out of 50

Epoch 8/99
----------
train Loss: 3.4950 LRAP: 0.0152 NDCG: 0.2280
val Loss: 3.7471 LRAP: 0.0102 NDCG: 0.2208
Validation loss decreased (4.051170 --> 3.747141).  Saving model ...

Epoch 9/99
----------
train Loss: 3.4659 LRAP: 0.0169 NDCG: 0.2263
val Loss: 3.6228 LRAP: 0.0127 NDCG: 0.2143
Validation loss decreased (3.747141 --> 3.622778).  Saving model ...

Epoch 10/99
----------
train Loss: 3.4471 LRAP: 0.0191 NDCG: 0.2284
val Loss: 3.5512 LRAP: 0.0114 NDCG: 0.2306
Validation loss decreased (3.622778 --> 3.551180).  Saving model ...

Epoch 11/99
----------
train Loss: 3.4380 LRAP: 0.0169 NDCG: 0.2270
val Loss: 3.9417 LRAP: 0.0140 NDCG: 0.2026
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.4289 LRAP: 0.0191 NDCG: 0.2299
val Loss: 3.7520 LRAP: 0.0064 NDCG: 0.2043
EarlyStopping counter: 2 out of 50

Epoch 13/99
----------
train Loss: 3.4105 LRAP: 0.0199 NDCG: 0.2295
val Loss: 3.6684 LRAP: 0.0064 NDCG: 0.2404
EarlyStopping counter: 3 out of 50

Epoch 14/99
----------
train Loss: 3.3973 LRAP: 0.0210 NDCG: 0.2301
val Loss: 4.1921 LRAP: 0.0064 NDCG: 0.2244
EarlyStopping counter: 4 out of 50

Epoch 15/99
----------
train Loss: 3.3915 LRAP: 0.0226 NDCG: 0.2321
val Loss: 3.8251 LRAP: 0.0114 NDCG: 0.1975
EarlyStopping counter: 5 out of 50

Epoch 16/99
----------
train Loss: 3.3729 LRAP: 0.0223 NDCG: 0.2335
val Loss: 3.4223 LRAP: 0.0102 NDCG: 0.2309
Validation loss decreased (3.551180 --> 3.422336).  Saving model ...

Epoch 17/99
----------
train Loss: 3.3736 LRAP: 0.0253 NDCG: 0.2338
val Loss: 3.4060 LRAP: 0.0216 NDCG: 0.2349
Validation loss decreased (3.422336 --> 3.405969).  Saving model ...

Epoch 18/99
----------
train Loss: 3.3714 LRAP: 0.0272 NDCG: 0.2343
val Loss: 3.3704 LRAP: 0.0165 NDCG: 0.2330
Validation loss decreased (3.405969 --> 3.370384).  Saving model ...

Epoch 19/99
----------
train Loss: 3.3543 LRAP: 0.0289 NDCG: 0.2336
val Loss: 3.4046 LRAP: 0.0089 NDCG: 0.2323
EarlyStopping counter: 1 out of 50

Epoch 20/99
----------
train Loss: 3.3509 LRAP: 0.0291 NDCG: 0.2340
val Loss: 3.3747 LRAP: 0.0140 NDCG: 0.2340
EarlyStopping counter: 2 out of 50

Epoch 21/99
----------
train Loss: 3.3474 LRAP: 0.0245 NDCG: 0.2354
val Loss: 3.3735 LRAP: 0.0280 NDCG: 0.2326
EarlyStopping counter: 3 out of 50

Epoch 22/99
----------
train Loss: 3.3526 LRAP: 0.0275 NDCG: 0.2350
val Loss: 3.3858 LRAP: 0.0152 NDCG: 0.2370
EarlyStopping counter: 4 out of 50

Epoch 23/99
----------
train Loss: 3.3362 LRAP: 0.0289 NDCG: 0.2346
val Loss: 3.3608 LRAP: 0.0178 NDCG: 0.2332
Validation loss decreased (3.370384 --> 3.360763).  Saving model ...

Epoch 24/99
----------
train Loss: 3.3418 LRAP: 0.0310 NDCG: 0.2330
val Loss: 3.3983 LRAP: 0.0343 NDCG: 0.2319
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 3.3526 LRAP: 0.0310 NDCG: 0.2357
val Loss: 3.3557 LRAP: 0.0330 NDCG: 0.2351
Validation loss decreased (3.360763 --> 3.355699).  Saving model ...

Epoch 26/99
----------
train Loss: 3.3374 LRAP: 0.0294 NDCG: 0.2350
val Loss: 3.4209 LRAP: 0.0381 NDCG: 0.2270
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.3323 LRAP: 0.0272 NDCG: 0.2356
val Loss: 3.4002 LRAP: 0.0241 NDCG: 0.2267
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 3.3381 LRAP: 0.0278 NDCG: 0.2355
val Loss: 3.3568 LRAP: 0.0203 NDCG: 0.2387
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 3.3290 LRAP: 0.0316 NDCG: 0.2371
val Loss: 3.4643 LRAP: 0.0470 NDCG: 0.2241
EarlyStopping counter: 4 out of 50

Epoch 30/99
----------
train Loss: 3.3393 LRAP: 0.0261 NDCG: 0.2341
val Loss: 3.4585 LRAP: 0.0496 NDCG: 0.2248
EarlyStopping counter: 5 out of 50

Epoch 31/99
----------
train Loss: 3.3416 LRAP: 0.0302 NDCG: 0.2355
val Loss: 3.3370 LRAP: 0.0241 NDCG: 0.2374
Validation loss decreased (3.355699 --> 3.336963).  Saving model ...

Epoch 32/99
----------
train Loss: 3.3163 LRAP: 0.0329 NDCG: 0.2347
val Loss: 3.3384 LRAP: 0.0254 NDCG: 0.2343
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 3.3205 LRAP: 0.0316 NDCG: 0.2363
val Loss: 3.3367 LRAP: 0.0280 NDCG: 0.2360
Validation loss decreased (3.336963 --> 3.336746).  Saving model ...

Epoch 34/99
----------
train Loss: 3.3245 LRAP: 0.0270 NDCG: 0.2367
val Loss: 3.3363 LRAP: 0.0292 NDCG: 0.2356
Validation loss decreased (3.336746 --> 3.336276).  Saving model ...

Epoch 35/99
----------
train Loss: 3.3214 LRAP: 0.0332 NDCG: 0.2362
val Loss: 3.3349 LRAP: 0.0318 NDCG: 0.2363
Validation loss decreased (3.336276 --> 3.334918).  Saving model ...

Epoch 36/99
----------
train Loss: 3.3301 LRAP: 0.0302 NDCG: 0.2360
val Loss: 3.3360 LRAP: 0.0241 NDCG: 0.2367
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 3.3254 LRAP: 0.0305 NDCG: 0.2344
val Loss: 3.3322 LRAP: 0.0280 NDCG: 0.2358
Validation loss decreased (3.334918 --> 3.332208).  Saving model ...

Epoch 38/99
----------
train Loss: 3.3127 LRAP: 0.0305 NDCG: 0.2368
val Loss: 3.3422 LRAP: 0.0356 NDCG: 0.2333
EarlyStopping counter: 1 out of 50

Epoch 39/99
----------
train Loss: 3.3195 LRAP: 0.0286 NDCG: 0.2360
val Loss: 3.3335 LRAP: 0.0343 NDCG: 0.2362
EarlyStopping counter: 2 out of 50

Epoch 40/99
----------
train Loss: 3.3220 LRAP: 0.0310 NDCG: 0.2359
val Loss: 3.3316 LRAP: 0.0356 NDCG: 0.2370
Validation loss decreased (3.332208 --> 3.331603).  Saving model ...

Epoch 41/99
----------
train Loss: 3.3088 LRAP: 0.0305 NDCG: 0.2365
val Loss: 3.3324 LRAP: 0.0267 NDCG: 0.2350
EarlyStopping counter: 1 out of 50

Epoch 42/99
----------
train Loss: 3.3225 LRAP: 0.0310 NDCG: 0.2353
val Loss: 3.3292 LRAP: 0.0318 NDCG: 0.2367
Validation loss decreased (3.331603 --> 3.329246).  Saving model ...

Epoch 43/99
----------
train Loss: 3.3265 LRAP: 0.0313 NDCG: 0.2376
val Loss: 3.3328 LRAP: 0.0229 NDCG: 0.2371
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.3216 LRAP: 0.0297 NDCG: 0.2362
val Loss: 3.3291 LRAP: 0.0280 NDCG: 0.2368
Validation loss decreased (3.329246 --> 3.329150).  Saving model ...

Epoch 45/99
----------
train Loss: 3.3261 LRAP: 0.0313 NDCG: 0.2372
val Loss: 3.3293 LRAP: 0.0330 NDCG: 0.2375
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 3.3144 LRAP: 0.0283 NDCG: 0.2352
val Loss: 3.3274 LRAP: 0.0381 NDCG: 0.2376
Validation loss decreased (3.329150 --> 3.327407).  Saving model ...

Epoch 47/99
----------
train Loss: 3.3177 LRAP: 0.0294 NDCG: 0.2376
val Loss: 3.3319 LRAP: 0.0318 NDCG: 0.2365
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.3155 LRAP: 0.0348 NDCG: 0.2372
val Loss: 3.3253 LRAP: 0.0318 NDCG: 0.2376
Validation loss decreased (3.327407 --> 3.325316).  Saving model ...

Epoch 49/99
----------
train Loss: 3.3204 LRAP: 0.0340 NDCG: 0.2357
val Loss: 3.3294 LRAP: 0.0330 NDCG: 0.2363
EarlyStopping counter: 1 out of 50

Epoch 50/99
----------
train Loss: 3.3172 LRAP: 0.0289 NDCG: 0.2368
val Loss: 3.3300 LRAP: 0.0280 NDCG: 0.2365
EarlyStopping counter: 2 out of 50

Epoch 51/99
----------
train Loss: 3.3039 LRAP: 0.0313 NDCG: 0.2364
val Loss: 3.3272 LRAP: 0.0318 NDCG: 0.2369
EarlyStopping counter: 3 out of 50

Epoch 52/99
----------
train Loss: 3.3146 LRAP: 0.0308 NDCG: 0.2360
val Loss: 3.3242 LRAP: 0.0330 NDCG: 0.2383
Validation loss decreased (3.325316 --> 3.324187).  Saving model ...

Epoch 53/99
----------
train Loss: 3.3249 LRAP: 0.0338 NDCG: 0.2356
val Loss: 3.3213 LRAP: 0.0318 NDCG: 0.2408
Validation loss decreased (3.324187 --> 3.321262).  Saving model ...

Epoch 54/99
----------
train Loss: 3.3111 LRAP: 0.0370 NDCG: 0.2367
val Loss: 3.3264 LRAP: 0.0356 NDCG: 0.2375
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 3.3169 LRAP: 0.0329 NDCG: 0.2366
val Loss: 3.3306 LRAP: 0.0419 NDCG: 0.2367
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 3.3082 LRAP: 0.0316 NDCG: 0.2366
val Loss: 3.3272 LRAP: 0.0318 NDCG: 0.2366
EarlyStopping counter: 3 out of 50

Epoch 57/99
----------
train Loss: 3.3201 LRAP: 0.0329 NDCG: 0.2372
val Loss: 3.3322 LRAP: 0.0343 NDCG: 0.2356
EarlyStopping counter: 4 out of 50

Epoch 58/99
----------
train Loss: 3.3072 LRAP: 0.0346 NDCG: 0.2372
val Loss: 3.3265 LRAP: 0.0318 NDCG: 0.2367
EarlyStopping counter: 5 out of 50

Epoch 59/99
----------
train Loss: 3.3113 LRAP: 0.0354 NDCG: 0.2364
val Loss: 3.3201 LRAP: 0.0318 NDCG: 0.2392
Validation loss decreased (3.321262 --> 3.320060).  Saving model ...

Epoch 60/99
----------
train Loss: 3.3112 LRAP: 0.0335 NDCG: 0.2367
val Loss: 3.3218 LRAP: 0.0407 NDCG: 0.2377
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 3.3220 LRAP: 0.0343 NDCG: 0.2363
val Loss: 3.3208 LRAP: 0.0330 NDCG: 0.2379
EarlyStopping counter: 2 out of 50

Epoch 62/99
----------
train Loss: 3.3094 LRAP: 0.0338 NDCG: 0.2388
val Loss: 3.3222 LRAP: 0.0394 NDCG: 0.2375
EarlyStopping counter: 3 out of 50

Epoch 63/99
----------
train Loss: 3.3142 LRAP: 0.0310 NDCG: 0.2374
val Loss: 3.3211 LRAP: 0.0368 NDCG: 0.2374
EarlyStopping counter: 4 out of 50

Epoch 64/99
----------
train Loss: 3.3061 LRAP: 0.0316 NDCG: 0.2380
val Loss: 3.3220 LRAP: 0.0356 NDCG: 0.2374
EarlyStopping counter: 5 out of 50

Epoch 65/99
----------
train Loss: 3.3179 LRAP: 0.0324 NDCG: 0.2384
val Loss: 3.3214 LRAP: 0.0356 NDCG: 0.2381
EarlyStopping counter: 6 out of 50

Epoch 66/99
----------
train Loss: 3.3050 LRAP: 0.0321 NDCG: 0.2365
val Loss: 3.3188 LRAP: 0.0368 NDCG: 0.2379
Validation loss decreased (3.320060 --> 3.318780).  Saving model ...

Epoch 67/99
----------
train Loss: 3.3007 LRAP: 0.0327 NDCG: 0.2382
val Loss: 3.3209 LRAP: 0.0368 NDCG: 0.2381
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 3.3127 LRAP: 0.0313 NDCG: 0.2368
val Loss: 3.3195 LRAP: 0.0356 NDCG: 0.2394
EarlyStopping counter: 2 out of 50

Epoch 69/99
----------
train Loss: 3.3095 LRAP: 0.0376 NDCG: 0.2360
val Loss: 3.3190 LRAP: 0.0343 NDCG: 0.2399
EarlyStopping counter: 3 out of 50

Epoch 70/99
----------
train Loss: 3.3114 LRAP: 0.0321 NDCG: 0.2375
val Loss: 3.3214 LRAP: 0.0381 NDCG: 0.2373
EarlyStopping counter: 4 out of 50

Epoch 71/99
----------
train Loss: 3.3040 LRAP: 0.0338 NDCG: 0.2379
val Loss: 3.3202 LRAP: 0.0356 NDCG: 0.2386
EarlyStopping counter: 5 out of 50

Epoch 72/99
----------
train Loss: 3.3164 LRAP: 0.0332 NDCG: 0.2375
val Loss: 3.3208 LRAP: 0.0356 NDCG: 0.2368
EarlyStopping counter: 6 out of 50

Epoch 73/99
----------
train Loss: 3.3152 LRAP: 0.0392 NDCG: 0.2368
val Loss: 3.3223 LRAP: 0.0343 NDCG: 0.2382
EarlyStopping counter: 7 out of 50

Epoch 74/99
----------
train Loss: 3.3067 LRAP: 0.0362 NDCG: 0.2358
val Loss: 3.3198 LRAP: 0.0356 NDCG: 0.2381
EarlyStopping counter: 8 out of 50

Epoch 75/99
----------
train Loss: 3.3220 LRAP: 0.0319 NDCG: 0.2362
val Loss: 3.3225 LRAP: 0.0419 NDCG: 0.2387
EarlyStopping counter: 9 out of 50

Epoch 76/99
----------
train Loss: 3.3011 LRAP: 0.0348 NDCG: 0.2379
val Loss: 3.3207 LRAP: 0.0368 NDCG: 0.2382
EarlyStopping counter: 10 out of 50

Epoch 77/99
----------
train Loss: 3.2962 LRAP: 0.0329 NDCG: 0.2386
val Loss: 3.3214 LRAP: 0.0318 NDCG: 0.2376
EarlyStopping counter: 11 out of 50

Epoch 78/99
----------
train Loss: 3.3024 LRAP: 0.0327 NDCG: 0.2354
val Loss: 3.3187 LRAP: 0.0343 NDCG: 0.2377
Validation loss decreased (3.318780 --> 3.318706).  Saving model ...

Epoch 79/99
----------
train Loss: 3.3205 LRAP: 0.0335 NDCG: 0.2370
val Loss: 3.3192 LRAP: 0.0356 NDCG: 0.2381
EarlyStopping counter: 1 out of 50

Epoch 80/99
----------
train Loss: 3.3054 LRAP: 0.0332 NDCG: 0.2388
val Loss: 3.3215 LRAP: 0.0394 NDCG: 0.2377
EarlyStopping counter: 2 out of 50

Epoch 81/99
----------
train Loss: 3.3157 LRAP: 0.0351 NDCG: 0.2371
val Loss: 3.3232 LRAP: 0.0432 NDCG: 0.2360
EarlyStopping counter: 3 out of 50

Epoch 82/99
----------
train Loss: 3.3214 LRAP: 0.0313 NDCG: 0.2378
val Loss: 3.3182 LRAP: 0.0318 NDCG: 0.2383
Validation loss decreased (3.318706 --> 3.318153).  Saving model ...

Epoch 83/99
----------
train Loss: 3.3072 LRAP: 0.0348 NDCG: 0.2365
val Loss: 3.3188 LRAP: 0.0330 NDCG: 0.2388
EarlyStopping counter: 1 out of 50

Epoch 84/99
----------
train Loss: 3.3085 LRAP: 0.0335 NDCG: 0.2386
val Loss: 3.3195 LRAP: 0.0356 NDCG: 0.2384
EarlyStopping counter: 2 out of 50

Epoch 85/99
----------
train Loss: 3.3054 LRAP: 0.0351 NDCG: 0.2373
val Loss: 3.3185 LRAP: 0.0330 NDCG: 0.2387
EarlyStopping counter: 3 out of 50

Epoch 86/99
----------
train Loss: 3.3131 LRAP: 0.0338 NDCG: 0.2374
val Loss: 3.3208 LRAP: 0.0407 NDCG: 0.2372
EarlyStopping counter: 4 out of 50

Epoch 87/99
----------
train Loss: 3.3098 LRAP: 0.0338 NDCG: 0.2363
val Loss: 3.3210 LRAP: 0.0381 NDCG: 0.2372
EarlyStopping counter: 5 out of 50

Epoch 88/99
----------
train Loss: 3.3045 LRAP: 0.0346 NDCG: 0.2381
val Loss: 3.3210 LRAP: 0.0381 NDCG: 0.2395
EarlyStopping counter: 6 out of 50

Epoch 89/99
----------
train Loss: 3.3044 LRAP: 0.0327 NDCG: 0.2380
val Loss: 3.3194 LRAP: 0.0343 NDCG: 0.2373
EarlyStopping counter: 7 out of 50

Epoch 90/99
----------
train Loss: 3.3094 LRAP: 0.0368 NDCG: 0.2366
val Loss: 3.3178 LRAP: 0.0356 NDCG: 0.2392
Validation loss decreased (3.318153 --> 3.317794).  Saving model ...

Epoch 91/99
----------
train Loss: 3.3010 LRAP: 0.0373 NDCG: 0.2393
val Loss: 3.3239 LRAP: 0.0432 NDCG: 0.2375
EarlyStopping counter: 1 out of 50

Epoch 92/99
----------
train Loss: 3.3041 LRAP: 0.0365 NDCG: 0.2378
val Loss: 3.3221 LRAP: 0.0432 NDCG: 0.2380
EarlyStopping counter: 2 out of 50

Epoch 93/99
----------
train Loss: 3.3074 LRAP: 0.0319 NDCG: 0.2373
val Loss: 3.3253 LRAP: 0.0445 NDCG: 0.2372
EarlyStopping counter: 3 out of 50

Epoch 94/99
----------
train Loss: 3.2959 LRAP: 0.0392 NDCG: 0.2396
val Loss: 3.3194 LRAP: 0.0356 NDCG: 0.2381
EarlyStopping counter: 4 out of 50

Epoch 95/99
----------
train Loss: 3.3023 LRAP: 0.0414 NDCG: 0.2381
val Loss: 3.3222 LRAP: 0.0432 NDCG: 0.2375
EarlyStopping counter: 5 out of 50

Epoch 96/99
----------
train Loss: 3.2998 LRAP: 0.0340 NDCG: 0.2372
val Loss: 3.3200 LRAP: 0.0407 NDCG: 0.2385
EarlyStopping counter: 6 out of 50

Epoch 97/99
----------
train Loss: 3.3164 LRAP: 0.0348 NDCG: 0.2372
val Loss: 3.3184 LRAP: 0.0356 NDCG: 0.2377
EarlyStopping counter: 7 out of 50

Epoch 98/99
----------
train Loss: 3.3015 LRAP: 0.0291 NDCG: 0.2371
val Loss: 3.3192 LRAP: 0.0356 NDCG: 0.2383
EarlyStopping counter: 8 out of 50

Epoch 99/99
----------
train Loss: 3.3038 LRAP: 0.0335 NDCG: 0.2377
val Loss: 3.3206 LRAP: 0.0318 NDCG: 0.2376
EarlyStopping counter: 9 out of 50

Training complete in 2m 28s
Best val loss: 3.317794, best LRAP score: 0.5585

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.5888 LRAP: 0.0000 NDCG: 0.1655
val Loss: 5.1879 LRAP: 0.0000 NDCG: 0.1395
Validation loss decreased (0.000000 --> 5.187875).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1672 LRAP: 0.0000 NDCG: 0.1860
val Loss: 4.3884 LRAP: 0.0025 NDCG: 0.1886
Validation loss decreased (5.187875 --> 4.388442).  Saving model ...

Epoch 2/99
----------
train Loss: 4.0362 LRAP: 0.0014 NDCG: 0.1982
val Loss: 4.2196 LRAP: 0.0000 NDCG: 0.1796
Validation loss decreased (4.388442 --> 4.219621).  Saving model ...

Epoch 3/99
----------
train Loss: 3.9194 LRAP: 0.0033 NDCG: 0.2010
val Loss: 4.7129 LRAP: 0.0051 NDCG: 0.2096
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.8532 LRAP: 0.0057 NDCG: 0.2049
val Loss: 4.6435 LRAP: 0.0064 NDCG: 0.1790
EarlyStopping counter: 2 out of 50

Epoch 5/99
----------
train Loss: 3.7942 LRAP: 0.0071 NDCG: 0.2080
val Loss: 3.9360 LRAP: 0.0089 NDCG: 0.2162
Validation loss decreased (4.219621 --> 3.936032).  Saving model ...

Epoch 6/99
----------
train Loss: 3.7526 LRAP: 0.0065 NDCG: 0.2101
val Loss: 4.0456 LRAP: 0.0089 NDCG: 0.2025
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.7237 LRAP: 0.0090 NDCG: 0.2131
val Loss: 3.9222 LRAP: 0.0064 NDCG: 0.1945
Validation loss decreased (3.936032 --> 3.922165).  Saving model ...

Epoch 8/99
----------
train Loss: 3.6707 LRAP: 0.0079 NDCG: 0.2131
val Loss: 4.4024 LRAP: 0.0089 NDCG: 0.1983
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.6512 LRAP: 0.0155 NDCG: 0.2173
val Loss: 4.4754 LRAP: 0.0140 NDCG: 0.1627
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.6319 LRAP: 0.0174 NDCG: 0.2196
val Loss: 4.5357 LRAP: 0.0013 NDCG: 0.1967
EarlyStopping counter: 3 out of 50

Epoch 11/99
----------
train Loss: 3.5946 LRAP: 0.0378 NDCG: 0.2202
val Loss: 3.7260 LRAP: 0.0191 NDCG: 0.2027
Validation loss decreased (3.922165 --> 3.725964).  Saving model ...

Epoch 12/99
----------
train Loss: 3.5523 LRAP: 0.0223 NDCG: 0.2230
val Loss: 3.6684 LRAP: 0.0102 NDCG: 0.2241
Validation loss decreased (3.725964 --> 3.668429).  Saving model ...

Epoch 13/99
----------
train Loss: 3.5260 LRAP: 0.0305 NDCG: 0.2255
val Loss: 3.6733 LRAP: 0.0140 NDCG: 0.2238
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.5096 LRAP: 0.0466 NDCG: 0.2249
val Loss: 3.9989 LRAP: 0.0839 NDCG: 0.2182
EarlyStopping counter: 2 out of 50

Epoch 15/99
----------
train Loss: 3.4832 LRAP: 0.0354 NDCG: 0.2278
val Loss: 4.2856 LRAP: 0.0102 NDCG: 0.1879
EarlyStopping counter: 3 out of 50

Epoch 16/99
----------
train Loss: 3.4645 LRAP: 0.0425 NDCG: 0.2320
val Loss: 3.8034 LRAP: 0.0064 NDCG: 0.2202
EarlyStopping counter: 4 out of 50

Epoch 17/99
----------
train Loss: 3.4308 LRAP: 0.0457 NDCG: 0.2348
val Loss: 3.9196 LRAP: 0.0305 NDCG: 0.1887
EarlyStopping counter: 5 out of 50

Epoch 18/99
----------
train Loss: 3.3762 LRAP: 0.0455 NDCG: 0.2350
val Loss: 3.4768 LRAP: 0.0762 NDCG: 0.2362
Validation loss decreased (3.668429 --> 3.476804).  Saving model ...

Epoch 19/99
----------
train Loss: 3.3360 LRAP: 0.0430 NDCG: 0.2370
val Loss: 3.4330 LRAP: 0.0712 NDCG: 0.2366
Validation loss decreased (3.476804 --> 3.432966).  Saving model ...

Epoch 20/99
----------
train Loss: 3.3361 LRAP: 0.0501 NDCG: 0.2399
val Loss: 3.5809 LRAP: 0.0788 NDCG: 0.2326
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.3180 LRAP: 0.0615 NDCG: 0.2403
val Loss: 3.4286 LRAP: 0.0750 NDCG: 0.2308
Validation loss decreased (3.432966 --> 3.428621).  Saving model ...

Epoch 22/99
----------
train Loss: 3.3002 LRAP: 0.0566 NDCG: 0.2414
val Loss: 3.5614 LRAP: 0.0826 NDCG: 0.2278
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 3.2854 LRAP: 0.0629 NDCG: 0.2401
val Loss: 3.4566 LRAP: 0.0699 NDCG: 0.2274
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 3.2893 LRAP: 0.0599 NDCG: 0.2416
val Loss: 3.3106 LRAP: 0.0635 NDCG: 0.2442
Validation loss decreased (3.428621 --> 3.310610).  Saving model ...

Epoch 25/99
----------
train Loss: 3.2878 LRAP: 0.0599 NDCG: 0.2443
val Loss: 3.5869 LRAP: 0.0915 NDCG: 0.2286
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 3.2747 LRAP: 0.0678 NDCG: 0.2426
val Loss: 3.5184 LRAP: 0.0915 NDCG: 0.2379
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 3.2627 LRAP: 0.0607 NDCG: 0.2429
val Loss: 3.3144 LRAP: 0.0623 NDCG: 0.2450
EarlyStopping counter: 3 out of 50

Epoch 28/99
----------
train Loss: 3.2590 LRAP: 0.0651 NDCG: 0.2429
val Loss: 3.3274 LRAP: 0.0775 NDCG: 0.2420
EarlyStopping counter: 4 out of 50

Epoch 29/99
----------
train Loss: 3.2326 LRAP: 0.0683 NDCG: 0.2449
val Loss: 3.4698 LRAP: 0.0635 NDCG: 0.2376
EarlyStopping counter: 5 out of 50

Epoch 30/99
----------
train Loss: 3.2197 LRAP: 0.0700 NDCG: 0.2465
val Loss: 3.3214 LRAP: 0.0953 NDCG: 0.2492
EarlyStopping counter: 6 out of 50

Epoch 31/99
----------
train Loss: 3.2351 LRAP: 0.0702 NDCG: 0.2465
val Loss: 3.2794 LRAP: 0.0775 NDCG: 0.2443
Validation loss decreased (3.310610 --> 3.279413).  Saving model ...

Epoch 32/99
----------
train Loss: 3.2215 LRAP: 0.0618 NDCG: 0.2463
val Loss: 3.2464 LRAP: 0.0940 NDCG: 0.2513
Validation loss decreased (3.279413 --> 3.246377).  Saving model ...

Epoch 33/99
----------
train Loss: 3.2124 LRAP: 0.0664 NDCG: 0.2465
val Loss: 3.2425 LRAP: 0.0839 NDCG: 0.2494
Validation loss decreased (3.246377 --> 3.242523).  Saving model ...

Epoch 34/99
----------
train Loss: 3.2054 LRAP: 0.0648 NDCG: 0.2477
val Loss: 3.2411 LRAP: 0.0839 NDCG: 0.2509
Validation loss decreased (3.242523 --> 3.241083).  Saving model ...

Epoch 35/99
----------
train Loss: 3.1948 LRAP: 0.0637 NDCG: 0.2479
val Loss: 3.2416 LRAP: 0.0826 NDCG: 0.2492
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 3.2025 LRAP: 0.0648 NDCG: 0.2467
val Loss: 3.2374 LRAP: 0.0889 NDCG: 0.2511
Validation loss decreased (3.241083 --> 3.237412).  Saving model ...

Epoch 37/99
----------
train Loss: 3.2106 LRAP: 0.0667 NDCG: 0.2467
val Loss: 3.2330 LRAP: 0.0864 NDCG: 0.2532
Validation loss decreased (3.237412 --> 3.232998).  Saving model ...

Epoch 38/99
----------
train Loss: 3.2061 LRAP: 0.0697 NDCG: 0.2497
val Loss: 3.2321 LRAP: 0.0851 NDCG: 0.2534
Validation loss decreased (3.232998 --> 3.232138).  Saving model ...

Epoch 39/99
----------
train Loss: 3.1986 LRAP: 0.0662 NDCG: 0.2493
val Loss: 3.2243 LRAP: 0.0826 NDCG: 0.2521
Validation loss decreased (3.232138 --> 3.224315).  Saving model ...

Epoch 40/99
----------
train Loss: 3.1894 LRAP: 0.0700 NDCG: 0.2483
val Loss: 3.2349 LRAP: 0.0877 NDCG: 0.2539
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 3.2013 LRAP: 0.0776 NDCG: 0.2488
val Loss: 3.2280 LRAP: 0.0801 NDCG: 0.2495
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 3.1860 LRAP: 0.0702 NDCG: 0.2488
val Loss: 3.2282 LRAP: 0.0839 NDCG: 0.2519
EarlyStopping counter: 3 out of 50

Epoch 43/99
----------
train Loss: 3.1954 LRAP: 0.0711 NDCG: 0.2482
val Loss: 3.2188 LRAP: 0.0801 NDCG: 0.2512
Validation loss decreased (3.224315 --> 3.218779).  Saving model ...

Epoch 44/99
----------
train Loss: 3.1806 LRAP: 0.0724 NDCG: 0.2507
val Loss: 3.2318 LRAP: 0.0991 NDCG: 0.2519
EarlyStopping counter: 1 out of 50

Epoch 45/99
----------
train Loss: 3.1942 LRAP: 0.0711 NDCG: 0.2494
val Loss: 3.2096 LRAP: 0.0839 NDCG: 0.2539
Validation loss decreased (3.218779 --> 3.209567).  Saving model ...

Epoch 46/99
----------
train Loss: 3.1957 LRAP: 0.0730 NDCG: 0.2506
val Loss: 3.2284 LRAP: 0.0940 NDCG: 0.2562
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 3.1800 LRAP: 0.0727 NDCG: 0.2489
val Loss: 3.2115 LRAP: 0.0915 NDCG: 0.2544
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 3.1782 LRAP: 0.0672 NDCG: 0.2505
val Loss: 3.2375 LRAP: 0.0788 NDCG: 0.2521
EarlyStopping counter: 3 out of 50

Epoch 49/99
----------
train Loss: 3.1642 LRAP: 0.0784 NDCG: 0.2525
val Loss: 3.2218 LRAP: 0.0915 NDCG: 0.2529
EarlyStopping counter: 4 out of 50

Epoch 50/99
----------
train Loss: 3.1639 LRAP: 0.0702 NDCG: 0.2509
val Loss: 3.2381 LRAP: 0.0953 NDCG: 0.2539
EarlyStopping counter: 5 out of 50

Epoch 51/99
----------
train Loss: 3.1725 LRAP: 0.0795 NDCG: 0.2512
val Loss: 3.2036 LRAP: 0.0928 NDCG: 0.2547
Validation loss decreased (3.209567 --> 3.203580).  Saving model ...

Epoch 52/99
----------
train Loss: 3.1640 LRAP: 0.0773 NDCG: 0.2495
val Loss: 3.1985 LRAP: 0.0902 NDCG: 0.2549
Validation loss decreased (3.203580 --> 3.198539).  Saving model ...

Epoch 53/99
----------
train Loss: 3.1764 LRAP: 0.0741 NDCG: 0.2525
val Loss: 3.1953 LRAP: 0.0902 NDCG: 0.2542
Validation loss decreased (3.198539 --> 3.195345).  Saving model ...

Epoch 54/99
----------
train Loss: 3.1613 LRAP: 0.0760 NDCG: 0.2511
val Loss: 3.2005 LRAP: 0.0953 NDCG: 0.2548
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 3.1700 LRAP: 0.0779 NDCG: 0.2509
val Loss: 3.1947 LRAP: 0.0940 NDCG: 0.2547
Validation loss decreased (3.195345 --> 3.194706).  Saving model ...

Epoch 56/99
----------
train Loss: 3.1576 LRAP: 0.0751 NDCG: 0.2510
val Loss: 3.1931 LRAP: 0.0915 NDCG: 0.2550
Validation loss decreased (3.194706 --> 3.193095).  Saving model ...

Epoch 57/99
----------
train Loss: 3.1586 LRAP: 0.0768 NDCG: 0.2498
val Loss: 3.1951 LRAP: 0.0915 NDCG: 0.2552
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 3.1711 LRAP: 0.0692 NDCG: 0.2500
val Loss: 3.1947 LRAP: 0.0902 NDCG: 0.2554
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 3.1636 LRAP: 0.0749 NDCG: 0.2523
val Loss: 3.1969 LRAP: 0.0940 NDCG: 0.2572
EarlyStopping counter: 3 out of 50

Epoch 60/99
----------
train Loss: 3.1702 LRAP: 0.0741 NDCG: 0.2518
val Loss: 3.1952 LRAP: 0.0940 NDCG: 0.2557
EarlyStopping counter: 4 out of 50

Epoch 61/99
----------
train Loss: 3.1721 LRAP: 0.0730 NDCG: 0.2523
val Loss: 3.1949 LRAP: 0.0915 NDCG: 0.2555
EarlyStopping counter: 5 out of 50

Epoch 62/99
----------
train Loss: 3.1626 LRAP: 0.0760 NDCG: 0.2518
val Loss: 3.1926 LRAP: 0.0928 NDCG: 0.2563
Validation loss decreased (3.193095 --> 3.192649).  Saving model ...

Epoch 63/99
----------
train Loss: 3.1734 LRAP: 0.0738 NDCG: 0.2514
val Loss: 3.1920 LRAP: 0.0889 NDCG: 0.2561
Validation loss decreased (3.192649 --> 3.192032).  Saving model ...

Epoch 64/99
----------
train Loss: 3.1704 LRAP: 0.0762 NDCG: 0.2513
val Loss: 3.1949 LRAP: 0.0915 NDCG: 0.2555
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 3.1756 LRAP: 0.0776 NDCG: 0.2513
val Loss: 3.1933 LRAP: 0.0889 NDCG: 0.2558
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 3.1623 LRAP: 0.0751 NDCG: 0.2532
val Loss: 3.1937 LRAP: 0.0928 NDCG: 0.2559
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 3.1588 LRAP: 0.0779 NDCG: 0.2504
val Loss: 3.1951 LRAP: 0.0940 NDCG: 0.2570
EarlyStopping counter: 4 out of 50

Epoch 68/99
----------
train Loss: 3.1604 LRAP: 0.0724 NDCG: 0.2517
val Loss: 3.1934 LRAP: 0.0889 NDCG: 0.2560
EarlyStopping counter: 5 out of 50

Epoch 69/99
----------
train Loss: 3.1725 LRAP: 0.0746 NDCG: 0.2507
val Loss: 3.1966 LRAP: 0.0953 NDCG: 0.2557
EarlyStopping counter: 6 out of 50

Epoch 70/99
----------
train Loss: 3.1400 LRAP: 0.0746 NDCG: 0.2529
val Loss: 3.1930 LRAP: 0.0940 NDCG: 0.2559
EarlyStopping counter: 7 out of 50

Epoch 71/99
----------
train Loss: 3.1622 LRAP: 0.0732 NDCG: 0.2501
val Loss: 3.1931 LRAP: 0.0940 NDCG: 0.2555
EarlyStopping counter: 8 out of 50

Epoch 72/99
----------
train Loss: 3.1402 LRAP: 0.0762 NDCG: 0.2535
val Loss: 3.1935 LRAP: 0.0940 NDCG: 0.2560
EarlyStopping counter: 9 out of 50

Epoch 73/99
----------
train Loss: 3.1629 LRAP: 0.0719 NDCG: 0.2516
val Loss: 3.1958 LRAP: 0.0940 NDCG: 0.2566
EarlyStopping counter: 10 out of 50

Epoch 74/99
----------
train Loss: 3.1500 LRAP: 0.0762 NDCG: 0.2520
val Loss: 3.1930 LRAP: 0.0940 NDCG: 0.2560
EarlyStopping counter: 11 out of 50

Epoch 75/99
----------
train Loss: 3.1612 LRAP: 0.0730 NDCG: 0.2534
val Loss: 3.1947 LRAP: 0.0940 NDCG: 0.2566
EarlyStopping counter: 12 out of 50

Epoch 76/99
----------
train Loss: 3.1607 LRAP: 0.0795 NDCG: 0.2522
val Loss: 3.1933 LRAP: 0.0940 NDCG: 0.2565
EarlyStopping counter: 13 out of 50

Epoch 77/99
----------
train Loss: 3.1524 LRAP: 0.0757 NDCG: 0.2533
val Loss: 3.1936 LRAP: 0.0889 NDCG: 0.2566
EarlyStopping counter: 14 out of 50

Epoch 78/99
----------
train Loss: 3.1714 LRAP: 0.0768 NDCG: 0.2508
val Loss: 3.1920 LRAP: 0.0928 NDCG: 0.2552
Validation loss decreased (3.192032 --> 3.191993).  Saving model ...

Epoch 79/99
----------
train Loss: 3.1627 LRAP: 0.0732 NDCG: 0.2524
val Loss: 3.1926 LRAP: 0.0940 NDCG: 0.2556
EarlyStopping counter: 1 out of 50

Epoch 80/99
----------
train Loss: 3.1592 LRAP: 0.0754 NDCG: 0.2519
val Loss: 3.1933 LRAP: 0.0940 NDCG: 0.2566
EarlyStopping counter: 2 out of 50

Epoch 81/99
----------
train Loss: 3.1585 LRAP: 0.0792 NDCG: 0.2508
val Loss: 3.1907 LRAP: 0.0902 NDCG: 0.2556
Validation loss decreased (3.191993 --> 3.190696).  Saving model ...

Epoch 82/99
----------
train Loss: 3.1497 LRAP: 0.0732 NDCG: 0.2521
val Loss: 3.1918 LRAP: 0.0940 NDCG: 0.2560
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.1603 LRAP: 0.0762 NDCG: 0.2536
val Loss: 3.1909 LRAP: 0.0889 NDCG: 0.2562
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.1691 LRAP: 0.0768 NDCG: 0.2530
val Loss: 3.1926 LRAP: 0.0915 NDCG: 0.2554
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.1689 LRAP: 0.0762 NDCG: 0.2505
val Loss: 3.1928 LRAP: 0.0877 NDCG: 0.2563
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.1584 LRAP: 0.0719 NDCG: 0.2515
val Loss: 3.1920 LRAP: 0.0902 NDCG: 0.2555
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 3.1749 LRAP: 0.0779 NDCG: 0.2513
val Loss: 3.1927 LRAP: 0.0928 NDCG: 0.2552
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 3.1608 LRAP: 0.0735 NDCG: 0.2510
val Loss: 3.1940 LRAP: 0.0915 NDCG: 0.2565
EarlyStopping counter: 7 out of 50

Epoch 89/99
----------
train Loss: 3.1724 LRAP: 0.0776 NDCG: 0.2521
val Loss: 3.1929 LRAP: 0.0915 NDCG: 0.2566
EarlyStopping counter: 8 out of 50

Epoch 90/99
----------
train Loss: 3.1641 LRAP: 0.0749 NDCG: 0.2525
val Loss: 3.1925 LRAP: 0.0902 NDCG: 0.2550
EarlyStopping counter: 9 out of 50

Epoch 91/99
----------
train Loss: 3.1638 LRAP: 0.0806 NDCG: 0.2530
val Loss: 3.1938 LRAP: 0.0902 NDCG: 0.2570
EarlyStopping counter: 10 out of 50

Epoch 92/99
----------
train Loss: 3.1765 LRAP: 0.0732 NDCG: 0.2518
val Loss: 3.1914 LRAP: 0.0889 NDCG: 0.2562
EarlyStopping counter: 11 out of 50

Epoch 93/99
----------
train Loss: 3.1639 LRAP: 0.0765 NDCG: 0.2518
val Loss: 3.1938 LRAP: 0.0928 NDCG: 0.2560
EarlyStopping counter: 12 out of 50

Epoch 94/99
----------
train Loss: 3.1536 LRAP: 0.0800 NDCG: 0.2514
val Loss: 3.1932 LRAP: 0.0940 NDCG: 0.2560
EarlyStopping counter: 13 out of 50

Epoch 95/99
----------
train Loss: 3.1597 LRAP: 0.0765 NDCG: 0.2519
val Loss: 3.1928 LRAP: 0.0940 NDCG: 0.2558
EarlyStopping counter: 14 out of 50

Epoch 96/99
----------
train Loss: 3.1577 LRAP: 0.0692 NDCG: 0.2523
val Loss: 3.1964 LRAP: 0.0953 NDCG: 0.2560
EarlyStopping counter: 15 out of 50

Epoch 97/99
----------
train Loss: 3.1579 LRAP: 0.0751 NDCG: 0.2532
val Loss: 3.1926 LRAP: 0.0902 NDCG: 0.2557
EarlyStopping counter: 16 out of 50

Epoch 98/99
----------
train Loss: 3.1578 LRAP: 0.0773 NDCG: 0.2519
val Loss: 3.1927 LRAP: 0.0902 NDCG: 0.2566
EarlyStopping counter: 17 out of 50

Epoch 99/99
----------
train Loss: 3.1750 LRAP: 0.0790 NDCG: 0.2515
val Loss: 3.1937 LRAP: 0.0940 NDCG: 0.2561
EarlyStopping counter: 18 out of 50

Training complete in 2m 26s
Best val loss: 3.190696, best LRAP score: 0.5827

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 9/10

All random seeds set to: 50
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5186 LRAP: 0.0000 NDCG: 0.1668
val Loss: 4.5967 LRAP: 0.0000 NDCG: 0.1579
Validation loss decreased (0.000000 --> 4.596658).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0170 LRAP: 0.0003 NDCG: 0.1894
val Loss: 4.2297 LRAP: 0.0025 NDCG: 0.2125
Validation loss decreased (4.596658 --> 4.229706).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8434 LRAP: 0.0019 NDCG: 0.2076
val Loss: 4.0080 LRAP: 0.0064 NDCG: 0.2278
Validation loss decreased (4.229706 --> 4.007998).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7081 LRAP: 0.0071 NDCG: 0.2165
val Loss: 4.0592 LRAP: 0.0089 NDCG: 0.2362
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.6166 LRAP: 0.0079 NDCG: 0.2259
val Loss: 3.6242 LRAP: 0.0089 NDCG: 0.2261
Validation loss decreased (4.007998 --> 3.624236).  Saving model ...

Epoch 5/99
----------
train Loss: 3.5180 LRAP: 0.0144 NDCG: 0.2285
val Loss: 4.4311 LRAP: 0.0051 NDCG: 0.2290
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.4501 LRAP: 0.0286 NDCG: 0.2309
val Loss: 3.5739 LRAP: 0.0801 NDCG: 0.2384
Validation loss decreased (3.624236 --> 3.573905).  Saving model ...

Epoch 7/99
----------
train Loss: 3.4107 LRAP: 0.0278 NDCG: 0.2339
val Loss: 3.6236 LRAP: 0.0673 NDCG: 0.2332
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.3279 LRAP: 0.0397 NDCG: 0.2363
val Loss: 3.4833 LRAP: 0.0635 NDCG: 0.2311
Validation loss decreased (3.573905 --> 3.483297).  Saving model ...

Epoch 9/99
----------
train Loss: 3.2878 LRAP: 0.0294 NDCG: 0.2353
val Loss: 3.6079 LRAP: 0.0737 NDCG: 0.2173
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.2482 LRAP: 0.0471 NDCG: 0.2397
val Loss: 3.4644 LRAP: 0.0839 NDCG: 0.2285
Validation loss decreased (3.483297 --> 3.464402).  Saving model ...

Epoch 11/99
----------
train Loss: 3.1878 LRAP: 0.0634 NDCG: 0.2489
val Loss: 3.5524 LRAP: 0.0915 NDCG: 0.2472
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.1485 LRAP: 0.0457 NDCG: 0.2495
val Loss: 3.3471 LRAP: 0.0699 NDCG: 0.2459
Validation loss decreased (3.464402 --> 3.347077).  Saving model ...

Epoch 13/99
----------
train Loss: 3.0805 LRAP: 0.0651 NDCG: 0.2530
val Loss: 3.5360 LRAP: 0.0851 NDCG: 0.2320
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.0569 LRAP: 0.0621 NDCG: 0.2576
val Loss: 3.3008 LRAP: 0.0559 NDCG: 0.2644
Validation loss decreased (3.347077 --> 3.300762).  Saving model ...

Epoch 15/99
----------
train Loss: 3.0110 LRAP: 0.0588 NDCG: 0.2616
val Loss: 3.3122 LRAP: 0.0877 NDCG: 0.2525
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.9861 LRAP: 0.0672 NDCG: 0.2624
val Loss: 3.1964 LRAP: 0.0991 NDCG: 0.2566
Validation loss decreased (3.300762 --> 3.196433).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9363 LRAP: 0.0732 NDCG: 0.2660
val Loss: 3.1035 LRAP: 0.0534 NDCG: 0.2622
Validation loss decreased (3.196433 --> 3.103542).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8780 LRAP: 0.0713 NDCG: 0.2667
val Loss: 3.1889 LRAP: 0.1144 NDCG: 0.2738
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.8498 LRAP: 0.0708 NDCG: 0.2711
val Loss: 3.0720 LRAP: 0.1093 NDCG: 0.2814
Validation loss decreased (3.103542 --> 3.071986).  Saving model ...

Epoch 20/99
----------
train Loss: 2.8405 LRAP: 0.0659 NDCG: 0.2721
val Loss: 2.9216 LRAP: 0.1042 NDCG: 0.2762
Validation loss decreased (3.071986 --> 2.921587).  Saving model ...

Epoch 21/99
----------
train Loss: 2.8107 LRAP: 0.0833 NDCG: 0.2771
val Loss: 2.9689 LRAP: 0.1067 NDCG: 0.2753
EarlyStopping counter: 1 out of 50

Epoch 22/99
----------
train Loss: 2.7665 LRAP: 0.0746 NDCG: 0.2792
val Loss: 2.9679 LRAP: 0.1144 NDCG: 0.2771
EarlyStopping counter: 2 out of 50

Epoch 23/99
----------
train Loss: 2.7234 LRAP: 0.0885 NDCG: 0.2830
val Loss: 2.9704 LRAP: 0.0978 NDCG: 0.2820
EarlyStopping counter: 3 out of 50

Epoch 24/99
----------
train Loss: 2.7284 LRAP: 0.0868 NDCG: 0.2848
val Loss: 3.0124 LRAP: 0.1144 NDCG: 0.2703
EarlyStopping counter: 4 out of 50

Epoch 25/99
----------
train Loss: 2.6999 LRAP: 0.0784 NDCG: 0.2852
val Loss: 2.9184 LRAP: 0.1169 NDCG: 0.2781
Validation loss decreased (2.921587 --> 2.918426).  Saving model ...

Epoch 26/99
----------
train Loss: 2.6628 LRAP: 0.0866 NDCG: 0.2857
val Loss: 2.8983 LRAP: 0.1067 NDCG: 0.2868
Validation loss decreased (2.918426 --> 2.898257).  Saving model ...

Epoch 27/99
----------
train Loss: 2.6273 LRAP: 0.0863 NDCG: 0.2912
val Loss: 2.8428 LRAP: 0.1131 NDCG: 0.3005
Validation loss decreased (2.898257 --> 2.842758).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5852 LRAP: 0.0904 NDCG: 0.2941
val Loss: 2.8826 LRAP: 0.1093 NDCG: 0.2722
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 2.5792 LRAP: 0.0994 NDCG: 0.2945
val Loss: 2.9081 LRAP: 0.1194 NDCG: 0.2930
EarlyStopping counter: 2 out of 50

Epoch 30/99
----------
train Loss: 2.5513 LRAP: 0.0928 NDCG: 0.2956
val Loss: 2.7265 LRAP: 0.1029 NDCG: 0.3038
Validation loss decreased (2.842758 --> 2.726549).  Saving model ...

Epoch 31/99
----------
train Loss: 2.5321 LRAP: 0.0975 NDCG: 0.2989
val Loss: 2.8115 LRAP: 0.1093 NDCG: 0.2955
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.5037 LRAP: 0.0999 NDCG: 0.3009
val Loss: 2.8036 LRAP: 0.0699 NDCG: 0.2864
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 2.4697 LRAP: 0.0907 NDCG: 0.3018
val Loss: 2.7227 LRAP: 0.1131 NDCG: 0.3058
Validation loss decreased (2.726549 --> 2.722667).  Saving model ...

Epoch 34/99
----------
train Loss: 2.4336 LRAP: 0.0977 NDCG: 0.3055
val Loss: 2.6489 LRAP: 0.1118 NDCG: 0.3045
Validation loss decreased (2.722667 --> 2.648856).  Saving model ...

Epoch 35/99
----------
train Loss: 2.4311 LRAP: 0.1007 NDCG: 0.3070
val Loss: 2.6929 LRAP: 0.1144 NDCG: 0.3146
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 2.3867 LRAP: 0.0980 NDCG: 0.3084
val Loss: 2.7232 LRAP: 0.1017 NDCG: 0.3017
EarlyStopping counter: 2 out of 50

Epoch 37/99
----------
train Loss: 2.3657 LRAP: 0.0939 NDCG: 0.3115
val Loss: 2.6604 LRAP: 0.1207 NDCG: 0.3160
EarlyStopping counter: 3 out of 50

Epoch 38/99
----------
train Loss: 2.3684 LRAP: 0.1016 NDCG: 0.3142
val Loss: 2.8112 LRAP: 0.1169 NDCG: 0.3058
EarlyStopping counter: 4 out of 50

Epoch 39/99
----------
train Loss: 2.3031 LRAP: 0.1051 NDCG: 0.3148
val Loss: 2.6817 LRAP: 0.1283 NDCG: 0.3223
EarlyStopping counter: 5 out of 50

Epoch 40/99
----------
train Loss: 2.2158 LRAP: 0.1045 NDCG: 0.3211
val Loss: 2.5338 LRAP: 0.1194 NDCG: 0.3242
Validation loss decreased (2.648856 --> 2.533824).  Saving model ...

Epoch 41/99
----------
train Loss: 2.1832 LRAP: 0.0988 NDCG: 0.3212
val Loss: 2.5070 LRAP: 0.1144 NDCG: 0.3278
Validation loss decreased (2.533824 --> 2.506995).  Saving model ...

Epoch 42/99
----------
train Loss: 2.1605 LRAP: 0.1026 NDCG: 0.3219
val Loss: 2.5068 LRAP: 0.1182 NDCG: 0.3317
Validation loss decreased (2.506995 --> 2.506841).  Saving model ...

Epoch 43/99
----------
train Loss: 2.1374 LRAP: 0.1045 NDCG: 0.3249
val Loss: 2.5071 LRAP: 0.1194 NDCG: 0.3295
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 2.1369 LRAP: 0.0980 NDCG: 0.3231
val Loss: 2.4832 LRAP: 0.1220 NDCG: 0.3289
Validation loss decreased (2.506841 --> 2.483207).  Saving model ...

Epoch 45/99
----------
train Loss: 2.1224 LRAP: 0.1045 NDCG: 0.3253
val Loss: 2.4947 LRAP: 0.1258 NDCG: 0.3367
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 2.0993 LRAP: 0.1029 NDCG: 0.3253
val Loss: 2.4964 LRAP: 0.1245 NDCG: 0.3351
EarlyStopping counter: 2 out of 50

Epoch 47/99
----------
train Loss: 2.1058 LRAP: 0.1016 NDCG: 0.3247
val Loss: 2.5057 LRAP: 0.1258 NDCG: 0.3381
EarlyStopping counter: 3 out of 50

Epoch 48/99
----------
train Loss: 2.0875 LRAP: 0.1065 NDCG: 0.3237
val Loss: 2.4979 LRAP: 0.1169 NDCG: 0.3334
EarlyStopping counter: 4 out of 50

Epoch 49/99
----------
train Loss: 2.0753 LRAP: 0.1018 NDCG: 0.3268
val Loss: 2.4908 LRAP: 0.1309 NDCG: 0.3372
EarlyStopping counter: 5 out of 50

Epoch 50/99
----------
train Loss: 2.0580 LRAP: 0.1018 NDCG: 0.3286
val Loss: 2.4723 LRAP: 0.1233 NDCG: 0.3369
Validation loss decreased (2.483207 --> 2.472348).  Saving model ...

Epoch 51/99
----------
train Loss: 2.0413 LRAP: 0.0969 NDCG: 0.3283
val Loss: 2.4759 LRAP: 0.1233 NDCG: 0.3381
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 2.0189 LRAP: 0.1075 NDCG: 0.3288
val Loss: 2.4770 LRAP: 0.1258 NDCG: 0.3396
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 2.0452 LRAP: 0.1045 NDCG: 0.3296
val Loss: 2.4697 LRAP: 0.1207 NDCG: 0.3398
Validation loss decreased (2.472348 --> 2.469746).  Saving model ...

Epoch 54/99
----------
train Loss: 2.0519 LRAP: 0.1037 NDCG: 0.3277
val Loss: 2.4691 LRAP: 0.1245 NDCG: 0.3401
Validation loss decreased (2.469746 --> 2.469117).  Saving model ...

Epoch 55/99
----------
train Loss: 2.0196 LRAP: 0.1018 NDCG: 0.3299
val Loss: 2.4724 LRAP: 0.1220 NDCG: 0.3402
EarlyStopping counter: 1 out of 50

Epoch 56/99
----------
train Loss: 2.0309 LRAP: 0.1045 NDCG: 0.3297
val Loss: 2.4758 LRAP: 0.1258 NDCG: 0.3405
EarlyStopping counter: 2 out of 50

Epoch 57/99
----------
train Loss: 2.0158 LRAP: 0.1005 NDCG: 0.3310
val Loss: 2.4763 LRAP: 0.1245 NDCG: 0.3408
EarlyStopping counter: 3 out of 50

Epoch 58/99
----------
train Loss: 2.0223 LRAP: 0.1018 NDCG: 0.3301
val Loss: 2.4756 LRAP: 0.1233 NDCG: 0.3413
EarlyStopping counter: 4 out of 50

Epoch 59/99
----------
train Loss: 2.0244 LRAP: 0.1026 NDCG: 0.3292
val Loss: 2.4684 LRAP: 0.1220 NDCG: 0.3390
Validation loss decreased (2.469117 --> 2.468436).  Saving model ...

Epoch 60/99
----------
train Loss: 2.0173 LRAP: 0.0991 NDCG: 0.3306
val Loss: 2.4732 LRAP: 0.1245 NDCG: 0.3397
EarlyStopping counter: 1 out of 50

Epoch 61/99
----------
train Loss: 2.0130 LRAP: 0.1029 NDCG: 0.3305
val Loss: 2.4672 LRAP: 0.1233 NDCG: 0.3381
Validation loss decreased (2.468436 --> 2.467215).  Saving model ...

Epoch 62/99
----------
train Loss: 2.0197 LRAP: 0.1056 NDCG: 0.3309
val Loss: 2.4759 LRAP: 0.1245 NDCG: 0.3386
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 2.0054 LRAP: 0.1037 NDCG: 0.3294
val Loss: 2.4706 LRAP: 0.1245 NDCG: 0.3401
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 2.0111 LRAP: 0.1005 NDCG: 0.3301
val Loss: 2.4659 LRAP: 0.1233 NDCG: 0.3417
Validation loss decreased (2.467215 --> 2.465901).  Saving model ...

Epoch 65/99
----------
train Loss: 1.9949 LRAP: 0.1040 NDCG: 0.3310
val Loss: 2.4684 LRAP: 0.1258 NDCG: 0.3396
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 1.9966 LRAP: 0.1051 NDCG: 0.3330
val Loss: 2.4740 LRAP: 0.1245 NDCG: 0.3433
EarlyStopping counter: 2 out of 50

Epoch 67/99
----------
train Loss: 2.0021 LRAP: 0.1045 NDCG: 0.3315
val Loss: 2.4714 LRAP: 0.1245 NDCG: 0.3420
EarlyStopping counter: 3 out of 50

Epoch 68/99
----------
train Loss: 1.9985 LRAP: 0.1016 NDCG: 0.3329
val Loss: 2.4650 LRAP: 0.1271 NDCG: 0.3433
Validation loss decreased (2.465901 --> 2.464984).  Saving model ...

Epoch 69/99
----------
train Loss: 1.9934 LRAP: 0.1040 NDCG: 0.3311
val Loss: 2.4670 LRAP: 0.1309 NDCG: 0.3406
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 1.9910 LRAP: 0.1078 NDCG: 0.3322
val Loss: 2.4660 LRAP: 0.1271 NDCG: 0.3400
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 1.9892 LRAP: 0.1114 NDCG: 0.3315
val Loss: 2.4655 LRAP: 0.1296 NDCG: 0.3415
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 1.9865 LRAP: 0.1056 NDCG: 0.3330
val Loss: 2.4619 LRAP: 0.1220 NDCG: 0.3419
Validation loss decreased (2.464984 --> 2.461940).  Saving model ...

Epoch 73/99
----------
train Loss: 1.9885 LRAP: 0.1037 NDCG: 0.3335
val Loss: 2.4632 LRAP: 0.1233 NDCG: 0.3418
EarlyStopping counter: 1 out of 50

Epoch 74/99
----------
train Loss: 1.9855 LRAP: 0.1065 NDCG: 0.3324
val Loss: 2.4605 LRAP: 0.1233 NDCG: 0.3417
Validation loss decreased (2.461940 --> 2.460549).  Saving model ...

Epoch 75/99
----------
train Loss: 1.9856 LRAP: 0.1035 NDCG: 0.3333
val Loss: 2.4612 LRAP: 0.1220 NDCG: 0.3400
EarlyStopping counter: 1 out of 50

Epoch 76/99
----------
train Loss: 1.9754 LRAP: 0.1070 NDCG: 0.3341
val Loss: 2.4644 LRAP: 0.1245 NDCG: 0.3452
EarlyStopping counter: 2 out of 50

Epoch 77/99
----------
train Loss: 1.9916 LRAP: 0.1067 NDCG: 0.3343
val Loss: 2.4680 LRAP: 0.1321 NDCG: 0.3433
EarlyStopping counter: 3 out of 50

Epoch 78/99
----------
train Loss: 1.9769 LRAP: 0.1043 NDCG: 0.3335
val Loss: 2.4656 LRAP: 0.1271 NDCG: 0.3438
EarlyStopping counter: 4 out of 50

Epoch 79/99
----------
train Loss: 1.9780 LRAP: 0.1054 NDCG: 0.3337
val Loss: 2.4693 LRAP: 0.1283 NDCG: 0.3417
EarlyStopping counter: 5 out of 50

Epoch 80/99
----------
train Loss: 1.9606 LRAP: 0.1037 NDCG: 0.3350
val Loss: 2.4666 LRAP: 0.1296 NDCG: 0.3432
EarlyStopping counter: 6 out of 50

Epoch 81/99
----------
train Loss: 1.9761 LRAP: 0.1051 NDCG: 0.3335
val Loss: 2.4675 LRAP: 0.1296 NDCG: 0.3428
EarlyStopping counter: 7 out of 50

Epoch 82/99
----------
train Loss: 1.9772 LRAP: 0.1094 NDCG: 0.3351
val Loss: 2.4610 LRAP: 0.1296 NDCG: 0.3441
EarlyStopping counter: 8 out of 50

Epoch 83/99
----------
train Loss: 1.9792 LRAP: 0.1075 NDCG: 0.3342
val Loss: 2.4680 LRAP: 0.1296 NDCG: 0.3453
EarlyStopping counter: 9 out of 50

Epoch 84/99
----------
train Loss: 1.9515 LRAP: 0.1059 NDCG: 0.3346
val Loss: 2.4623 LRAP: 0.1271 NDCG: 0.3441
EarlyStopping counter: 10 out of 50

Epoch 85/99
----------
train Loss: 1.9618 LRAP: 0.1105 NDCG: 0.3351
val Loss: 2.4658 LRAP: 0.1296 NDCG: 0.3439
EarlyStopping counter: 11 out of 50

Epoch 86/99
----------
train Loss: 1.9590 LRAP: 0.1048 NDCG: 0.3354
val Loss: 2.4627 LRAP: 0.1258 NDCG: 0.3446
EarlyStopping counter: 12 out of 50

Epoch 87/99
----------
train Loss: 1.9659 LRAP: 0.1084 NDCG: 0.3331
val Loss: 2.4622 LRAP: 0.1296 NDCG: 0.3450
EarlyStopping counter: 13 out of 50

Epoch 88/99
----------
train Loss: 1.9527 LRAP: 0.1073 NDCG: 0.3344
val Loss: 2.4611 LRAP: 0.1245 NDCG: 0.3432
EarlyStopping counter: 14 out of 50

Epoch 89/99
----------
train Loss: 1.9658 LRAP: 0.1048 NDCG: 0.3365
val Loss: 2.4653 LRAP: 0.1321 NDCG: 0.3445
EarlyStopping counter: 15 out of 50

Epoch 90/99
----------
train Loss: 1.9690 LRAP: 0.1056 NDCG: 0.3341
val Loss: 2.4649 LRAP: 0.1296 NDCG: 0.3446
EarlyStopping counter: 16 out of 50

Epoch 91/99
----------
train Loss: 1.9712 LRAP: 0.1054 NDCG: 0.3330
val Loss: 2.4674 LRAP: 0.1283 NDCG: 0.3435
EarlyStopping counter: 17 out of 50

Epoch 92/99
----------
train Loss: 1.9656 LRAP: 0.1141 NDCG: 0.3342
val Loss: 2.4673 LRAP: 0.1321 NDCG: 0.3448
EarlyStopping counter: 18 out of 50

Epoch 93/99
----------
train Loss: 1.9588 LRAP: 0.1032 NDCG: 0.3356
val Loss: 2.4620 LRAP: 0.1258 NDCG: 0.3416
EarlyStopping counter: 19 out of 50

Epoch 94/99
----------
train Loss: 1.9791 LRAP: 0.1081 NDCG: 0.3340
val Loss: 2.4659 LRAP: 0.1321 NDCG: 0.3449
EarlyStopping counter: 20 out of 50

Epoch 95/99
----------
train Loss: 1.9757 LRAP: 0.1070 NDCG: 0.3345
val Loss: 2.4651 LRAP: 0.1309 NDCG: 0.3437
EarlyStopping counter: 21 out of 50

Epoch 96/99
----------
train Loss: 1.9778 LRAP: 0.1108 NDCG: 0.3349
val Loss: 2.4654 LRAP: 0.1296 NDCG: 0.3460
EarlyStopping counter: 22 out of 50

Epoch 97/99
----------
train Loss: 1.9756 LRAP: 0.1043 NDCG: 0.3347
val Loss: 2.4645 LRAP: 0.1296 NDCG: 0.3442
EarlyStopping counter: 23 out of 50

Epoch 98/99
----------
train Loss: 1.9623 LRAP: 0.1075 NDCG: 0.3341
val Loss: 2.4648 LRAP: 0.1271 NDCG: 0.3446
EarlyStopping counter: 24 out of 50

Epoch 99/99
----------
train Loss: 1.9703 LRAP: 0.1073 NDCG: 0.3347
val Loss: 2.4663 LRAP: 0.1334 NDCG: 0.3457
EarlyStopping counter: 25 out of 50

Training complete in 2m 29s
Best val loss: 2.460549, best LRAP score: 0.7286

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4883 LRAP: 0.0000 NDCG: 0.1688
val Loss: 4.4131 LRAP: 0.0000 NDCG: 0.1734
Validation loss decreased (0.000000 --> 4.413118).  Saving model ...

Epoch 1/99
----------
train Loss: 3.8694 LRAP: 0.0003 NDCG: 0.2006
val Loss: 5.5870 LRAP: 0.0000 NDCG: 0.2044
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.6933 LRAP: 0.0000 NDCG: 0.2166
val Loss: 3.9764 LRAP: 0.0000 NDCG: 0.2091
Validation loss decreased (4.413118 --> 3.976382).  Saving model ...

Epoch 3/99
----------
train Loss: 3.5924 LRAP: 0.0011 NDCG: 0.2285
val Loss: 3.8166 LRAP: 0.0025 NDCG: 0.2269
Validation loss decreased (3.976382 --> 3.816565).  Saving model ...

Epoch 4/99
----------
train Loss: 3.4898 LRAP: 0.0087 NDCG: 0.2372
val Loss: 4.6014 LRAP: 0.0025 NDCG: 0.2277
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.3982 LRAP: 0.0182 NDCG: 0.2452
val Loss: 3.7618 LRAP: 0.0864 NDCG: 0.2398
Validation loss decreased (3.816565 --> 3.761789).  Saving model ...

Epoch 6/99
----------
train Loss: 3.3232 LRAP: 0.0332 NDCG: 0.2502
val Loss: 3.6700 LRAP: 0.0394 NDCG: 0.2463
Validation loss decreased (3.761789 --> 3.669971).  Saving model ...

Epoch 7/99
----------
train Loss: 3.2505 LRAP: 0.0422 NDCG: 0.2551
val Loss: 3.4386 LRAP: 0.0991 NDCG: 0.2377
Validation loss decreased (3.669971 --> 3.438595).  Saving model ...

Epoch 8/99
----------
train Loss: 3.1942 LRAP: 0.0596 NDCG: 0.2614
val Loss: 3.6369 LRAP: 0.0470 NDCG: 0.2473
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.1679 LRAP: 0.0512 NDCG: 0.2624
val Loss: 3.7547 LRAP: 0.0826 NDCG: 0.2457
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.1060 LRAP: 0.0719 NDCG: 0.2675
val Loss: 3.2345 LRAP: 0.0712 NDCG: 0.2737
Validation loss decreased (3.438595 --> 3.234531).  Saving model ...

Epoch 11/99
----------
train Loss: 3.0575 LRAP: 0.0773 NDCG: 0.2691
val Loss: 3.7360 LRAP: 0.0775 NDCG: 0.2395
EarlyStopping counter: 1 out of 50

Epoch 12/99
----------
train Loss: 3.0515 LRAP: 0.0866 NDCG: 0.2753
val Loss: 3.4509 LRAP: 0.0864 NDCG: 0.2450
EarlyStopping counter: 2 out of 50

Epoch 13/99
----------
train Loss: 2.9872 LRAP: 0.0830 NDCG: 0.2821
val Loss: 3.5414 LRAP: 0.0902 NDCG: 0.2848
EarlyStopping counter: 3 out of 50

Epoch 14/99
----------
train Loss: 2.9548 LRAP: 0.0841 NDCG: 0.2786
val Loss: 3.1645 LRAP: 0.0521 NDCG: 0.2555
Validation loss decreased (3.234531 --> 3.164537).  Saving model ...

Epoch 15/99
----------
train Loss: 2.9000 LRAP: 0.0790 NDCG: 0.2844
val Loss: 3.2108 LRAP: 0.1194 NDCG: 0.2873
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.8741 LRAP: 0.0874 NDCG: 0.2872
val Loss: 3.0679 LRAP: 0.1004 NDCG: 0.2961
Validation loss decreased (3.164537 --> 3.067883).  Saving model ...

Epoch 17/99
----------
train Loss: 2.8250 LRAP: 0.0735 NDCG: 0.2892
val Loss: 2.9929 LRAP: 0.0813 NDCG: 0.2781
Validation loss decreased (3.067883 --> 2.992897).  Saving model ...

Epoch 18/99
----------
train Loss: 2.8034 LRAP: 0.0839 NDCG: 0.2916
val Loss: 3.3566 LRAP: 0.0648 NDCG: 0.2770
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.7661 LRAP: 0.0937 NDCG: 0.2948
val Loss: 2.9389 LRAP: 0.1055 NDCG: 0.2883
Validation loss decreased (2.992897 --> 2.938917).  Saving model ...

Epoch 20/99
----------
train Loss: 2.7505 LRAP: 0.0904 NDCG: 0.2951
val Loss: 2.9428 LRAP: 0.0902 NDCG: 0.2900
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.6898 LRAP: 0.0779 NDCG: 0.2991
val Loss: 2.9190 LRAP: 0.0991 NDCG: 0.2820
Validation loss decreased (2.938917 --> 2.918978).  Saving model ...

Epoch 22/99
----------
train Loss: 2.6631 LRAP: 0.0901 NDCG: 0.3014
val Loss: 3.1095 LRAP: 0.1093 NDCG: 0.3115
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 2.6488 LRAP: 0.0847 NDCG: 0.3036
val Loss: 2.9057 LRAP: 0.0877 NDCG: 0.2789
Validation loss decreased (2.918978 --> 2.905717).  Saving model ...

Epoch 24/99
----------
train Loss: 2.5968 LRAP: 0.0915 NDCG: 0.3068
val Loss: 2.7687 LRAP: 0.1207 NDCG: 0.2980
Validation loss decreased (2.905717 --> 2.768719).  Saving model ...

Epoch 25/99
----------
train Loss: 2.5684 LRAP: 0.0896 NDCG: 0.3101
val Loss: 2.8955 LRAP: 0.1207 NDCG: 0.3005
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 2.5174 LRAP: 0.0961 NDCG: 0.3082
val Loss: 2.8246 LRAP: 0.0966 NDCG: 0.3335
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 2.4944 LRAP: 0.0877 NDCG: 0.3149
val Loss: 2.7835 LRAP: 0.0978 NDCG: 0.3248
EarlyStopping counter: 3 out of 50

Epoch 28/99
----------
train Loss: 2.4621 LRAP: 0.0937 NDCG: 0.3157
val Loss: 2.8353 LRAP: 0.0826 NDCG: 0.3226
EarlyStopping counter: 4 out of 50

Epoch 29/99
----------
train Loss: 2.4490 LRAP: 0.0975 NDCG: 0.3199
val Loss: 2.7587 LRAP: 0.0928 NDCG: 0.3135
Validation loss decreased (2.768719 --> 2.758726).  Saving model ...

Epoch 30/99
----------
train Loss: 2.4233 LRAP: 0.0964 NDCG: 0.3184
val Loss: 2.7473 LRAP: 0.1067 NDCG: 0.3075
Validation loss decreased (2.758726 --> 2.747306).  Saving model ...

Epoch 31/99
----------
train Loss: 2.3833 LRAP: 0.0956 NDCG: 0.3214
val Loss: 2.8530 LRAP: 0.1042 NDCG: 0.3151
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.3514 LRAP: 0.1021 NDCG: 0.3244
val Loss: 2.6855 LRAP: 0.1271 NDCG: 0.3325
Validation loss decreased (2.747306 --> 2.685524).  Saving model ...

Epoch 33/99
----------
train Loss: 2.3533 LRAP: 0.0994 NDCG: 0.3269
val Loss: 2.6788 LRAP: 0.1258 NDCG: 0.3388
Validation loss decreased (2.685524 --> 2.678764).  Saving model ...

Epoch 34/99
----------
train Loss: 2.2996 LRAP: 0.1089 NDCG: 0.3294
val Loss: 2.6500 LRAP: 0.1131 NDCG: 0.3199
Validation loss decreased (2.678764 --> 2.650043).  Saving model ...

Epoch 35/99
----------
train Loss: 2.2949 LRAP: 0.1056 NDCG: 0.3289
val Loss: 2.7034 LRAP: 0.0928 NDCG: 0.3120
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 2.2551 LRAP: 0.1045 NDCG: 0.3328
val Loss: 2.6127 LRAP: 0.1321 NDCG: 0.3397
Validation loss decreased (2.650043 --> 2.612746).  Saving model ...

Epoch 37/99
----------
train Loss: 2.2128 LRAP: 0.1103 NDCG: 0.3363
val Loss: 2.7084 LRAP: 0.1055 NDCG: 0.3140
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 2.2077 LRAP: 0.1103 NDCG: 0.3362
val Loss: 2.5143 LRAP: 0.1207 NDCG: 0.3408
Validation loss decreased (2.612746 --> 2.514304).  Saving model ...

Epoch 39/99
----------
train Loss: 2.1666 LRAP: 0.1037 NDCG: 0.3407
val Loss: 2.7205 LRAP: 0.1245 NDCG: 0.3245
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.1297 LRAP: 0.1097 NDCG: 0.3409
val Loss: 2.5851 LRAP: 0.1449 NDCG: 0.3460
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 2.1172 LRAP: 0.1133 NDCG: 0.3455
val Loss: 2.6514 LRAP: 0.1321 NDCG: 0.3392
EarlyStopping counter: 3 out of 50

Epoch 42/99
----------
train Loss: 2.0922 LRAP: 0.1138 NDCG: 0.3466
val Loss: 2.7120 LRAP: 0.1360 NDCG: 0.3720
EarlyStopping counter: 4 out of 50

Epoch 43/99
----------
train Loss: 2.1016 LRAP: 0.1081 NDCG: 0.3446
val Loss: 2.5994 LRAP: 0.1258 NDCG: 0.3421
EarlyStopping counter: 5 out of 50

Epoch 44/99
----------
train Loss: 1.9777 LRAP: 0.1163 NDCG: 0.3492
val Loss: 2.4631 LRAP: 0.1347 NDCG: 0.3628
Validation loss decreased (2.514304 --> 2.463150).  Saving model ...

Epoch 45/99
----------
train Loss: 1.9413 LRAP: 0.1160 NDCG: 0.3515
val Loss: 2.4752 LRAP: 0.1296 NDCG: 0.3630
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 1.9148 LRAP: 0.1160 NDCG: 0.3540
val Loss: 2.4610 LRAP: 0.1296 NDCG: 0.3573
Validation loss decreased (2.463150 --> 2.460972).  Saving model ...

Epoch 47/99
----------
train Loss: 1.9104 LRAP: 0.1103 NDCG: 0.3536
val Loss: 2.4671 LRAP: 0.1360 NDCG: 0.3621
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 1.8768 LRAP: 0.1236 NDCG: 0.3553
val Loss: 2.4689 LRAP: 0.1372 NDCG: 0.3606
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 1.8616 LRAP: 0.1179 NDCG: 0.3560
val Loss: 2.4655 LRAP: 0.1398 NDCG: 0.3660
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 1.8527 LRAP: 0.1192 NDCG: 0.3578
val Loss: 2.4711 LRAP: 0.1410 NDCG: 0.3622
EarlyStopping counter: 4 out of 50

Epoch 51/99
----------
train Loss: 1.8350 LRAP: 0.1231 NDCG: 0.3580
val Loss: 2.4737 LRAP: 0.1372 NDCG: 0.3581
EarlyStopping counter: 5 out of 50

Epoch 52/99
----------
train Loss: 1.8275 LRAP: 0.1143 NDCG: 0.3586
val Loss: 2.4695 LRAP: 0.1436 NDCG: 0.3677
EarlyStopping counter: 6 out of 50

Epoch 53/99
----------
train Loss: 1.8189 LRAP: 0.1233 NDCG: 0.3609
val Loss: 2.4684 LRAP: 0.1436 NDCG: 0.3658
EarlyStopping counter: 7 out of 50

Epoch 54/99
----------
train Loss: 1.8271 LRAP: 0.1220 NDCG: 0.3571
val Loss: 2.4648 LRAP: 0.1423 NDCG: 0.3647
EarlyStopping counter: 8 out of 50

Epoch 55/99
----------
train Loss: 1.7898 LRAP: 0.1263 NDCG: 0.3583
val Loss: 2.4653 LRAP: 0.1436 NDCG: 0.3662
EarlyStopping counter: 9 out of 50

Epoch 56/99
----------
train Loss: 1.8061 LRAP: 0.1206 NDCG: 0.3583
val Loss: 2.4627 LRAP: 0.1410 NDCG: 0.3655
EarlyStopping counter: 10 out of 50

Epoch 57/99
----------
train Loss: 1.7929 LRAP: 0.1274 NDCG: 0.3599
val Loss: 2.4662 LRAP: 0.1410 NDCG: 0.3637
EarlyStopping counter: 11 out of 50

Epoch 58/99
----------
train Loss: 1.8038 LRAP: 0.1274 NDCG: 0.3585
val Loss: 2.4630 LRAP: 0.1423 NDCG: 0.3674
EarlyStopping counter: 12 out of 50

Epoch 59/99
----------
train Loss: 1.7957 LRAP: 0.1163 NDCG: 0.3602
val Loss: 2.4672 LRAP: 0.1436 NDCG: 0.3657
EarlyStopping counter: 13 out of 50

Epoch 60/99
----------
train Loss: 1.7984 LRAP: 0.1271 NDCG: 0.3588
val Loss: 2.4666 LRAP: 0.1423 NDCG: 0.3664
EarlyStopping counter: 14 out of 50

Epoch 61/99
----------
train Loss: 1.7916 LRAP: 0.1201 NDCG: 0.3612
val Loss: 2.4649 LRAP: 0.1423 NDCG: 0.3659
EarlyStopping counter: 15 out of 50

Epoch 62/99
----------
train Loss: 1.7984 LRAP: 0.1247 NDCG: 0.3603
val Loss: 2.4616 LRAP: 0.1449 NDCG: 0.3676
EarlyStopping counter: 16 out of 50

Epoch 63/99
----------
train Loss: 1.8043 LRAP: 0.1209 NDCG: 0.3575
val Loss: 2.4665 LRAP: 0.1423 NDCG: 0.3654
EarlyStopping counter: 17 out of 50

Epoch 64/99
----------
train Loss: 1.8028 LRAP: 0.1250 NDCG: 0.3612
val Loss: 2.4637 LRAP: 0.1410 NDCG: 0.3665
EarlyStopping counter: 18 out of 50

Epoch 65/99
----------
train Loss: 1.7898 LRAP: 0.1250 NDCG: 0.3605
val Loss: 2.4636 LRAP: 0.1449 NDCG: 0.3684
EarlyStopping counter: 19 out of 50

Epoch 66/99
----------
train Loss: 1.8012 LRAP: 0.1231 NDCG: 0.3598
val Loss: 2.4649 LRAP: 0.1436 NDCG: 0.3663
EarlyStopping counter: 20 out of 50

Epoch 67/99
----------
train Loss: 1.7895 LRAP: 0.1252 NDCG: 0.3591
val Loss: 2.4627 LRAP: 0.1423 NDCG: 0.3658
EarlyStopping counter: 21 out of 50

Epoch 68/99
----------
train Loss: 1.7984 LRAP: 0.1239 NDCG: 0.3576
val Loss: 2.4659 LRAP: 0.1436 NDCG: 0.3658
EarlyStopping counter: 22 out of 50

Epoch 69/99
----------
train Loss: 1.7980 LRAP: 0.1165 NDCG: 0.3598
val Loss: 2.4667 LRAP: 0.1436 NDCG: 0.3671
EarlyStopping counter: 23 out of 50

Epoch 70/99
----------
train Loss: 1.7989 LRAP: 0.1225 NDCG: 0.3589
val Loss: 2.4620 LRAP: 0.1423 NDCG: 0.3657
EarlyStopping counter: 24 out of 50

Epoch 71/99
----------
train Loss: 1.8050 LRAP: 0.1171 NDCG: 0.3598
val Loss: 2.4665 LRAP: 0.1436 NDCG: 0.3658
EarlyStopping counter: 25 out of 50

Epoch 72/99
----------
train Loss: 1.8001 LRAP: 0.1255 NDCG: 0.3574
val Loss: 2.4657 LRAP: 0.1436 NDCG: 0.3667
EarlyStopping counter: 26 out of 50

Epoch 73/99
----------
train Loss: 1.8073 LRAP: 0.1231 NDCG: 0.3593
val Loss: 2.4632 LRAP: 0.1423 NDCG: 0.3676
EarlyStopping counter: 27 out of 50

Epoch 74/99
----------
train Loss: 1.7826 LRAP: 0.1236 NDCG: 0.3598
val Loss: 2.4678 LRAP: 0.1436 NDCG: 0.3666
EarlyStopping counter: 28 out of 50

Epoch 75/99
----------
train Loss: 1.7995 LRAP: 0.1179 NDCG: 0.3610
val Loss: 2.4674 LRAP: 0.1423 NDCG: 0.3653
EarlyStopping counter: 29 out of 50

Epoch 76/99
----------
train Loss: 1.7826 LRAP: 0.1206 NDCG: 0.3594
val Loss: 2.4673 LRAP: 0.1436 NDCG: 0.3674
EarlyStopping counter: 30 out of 50

Epoch 77/99
----------
train Loss: 1.7958 LRAP: 0.1290 NDCG: 0.3590
val Loss: 2.4631 LRAP: 0.1423 NDCG: 0.3670
EarlyStopping counter: 31 out of 50

Epoch 78/99
----------
train Loss: 1.8005 LRAP: 0.1236 NDCG: 0.3606
val Loss: 2.4644 LRAP: 0.1423 NDCG: 0.3638
EarlyStopping counter: 32 out of 50

Epoch 79/99
----------
train Loss: 1.7902 LRAP: 0.1203 NDCG: 0.3586
val Loss: 2.4619 LRAP: 0.1423 NDCG: 0.3657
EarlyStopping counter: 33 out of 50

Epoch 80/99
----------
train Loss: 1.7937 LRAP: 0.1239 NDCG: 0.3605
val Loss: 2.4638 LRAP: 0.1423 NDCG: 0.3663
EarlyStopping counter: 34 out of 50

Epoch 81/99
----------
train Loss: 1.7845 LRAP: 0.1263 NDCG: 0.3593
val Loss: 2.4663 LRAP: 0.1436 NDCG: 0.3682
EarlyStopping counter: 35 out of 50

Epoch 82/99
----------
train Loss: 1.7877 LRAP: 0.1236 NDCG: 0.3602
val Loss: 2.4664 LRAP: 0.1423 NDCG: 0.3665
EarlyStopping counter: 36 out of 50

Epoch 83/99
----------
train Loss: 1.7894 LRAP: 0.1247 NDCG: 0.3593
val Loss: 2.4689 LRAP: 0.1436 NDCG: 0.3660
EarlyStopping counter: 37 out of 50

Epoch 84/99
----------
train Loss: 1.7951 LRAP: 0.1212 NDCG: 0.3568
val Loss: 2.4660 LRAP: 0.1423 NDCG: 0.3663
EarlyStopping counter: 38 out of 50

Epoch 85/99
----------
train Loss: 1.8062 LRAP: 0.1228 NDCG: 0.3582
val Loss: 2.4621 LRAP: 0.1436 NDCG: 0.3668
EarlyStopping counter: 39 out of 50

Epoch 86/99
----------
train Loss: 1.7862 LRAP: 0.1209 NDCG: 0.3576
val Loss: 2.4710 LRAP: 0.1436 NDCG: 0.3673
EarlyStopping counter: 40 out of 50

Epoch 87/99
----------
train Loss: 1.7840 LRAP: 0.1187 NDCG: 0.3587
val Loss: 2.4667 LRAP: 0.1423 NDCG: 0.3670
EarlyStopping counter: 41 out of 50

Epoch 88/99
----------
train Loss: 1.8062 LRAP: 0.1206 NDCG: 0.3576
val Loss: 2.4634 LRAP: 0.1410 NDCG: 0.3643
EarlyStopping counter: 42 out of 50

Epoch 89/99
----------
train Loss: 1.7770 LRAP: 0.1187 NDCG: 0.3595
val Loss: 2.4619 LRAP: 0.1423 NDCG: 0.3665
EarlyStopping counter: 43 out of 50

Epoch 90/99
----------
train Loss: 1.7926 LRAP: 0.1173 NDCG: 0.3594
val Loss: 2.4650 LRAP: 0.1436 NDCG: 0.3680
EarlyStopping counter: 44 out of 50

Epoch 91/99
----------
train Loss: 1.7900 LRAP: 0.1261 NDCG: 0.3606
val Loss: 2.4657 LRAP: 0.1436 NDCG: 0.3666
EarlyStopping counter: 45 out of 50

Epoch 92/99
----------
train Loss: 1.7916 LRAP: 0.1222 NDCG: 0.3593
val Loss: 2.4642 LRAP: 0.1436 NDCG: 0.3667
EarlyStopping counter: 46 out of 50

Epoch 93/99
----------
train Loss: 1.8085 LRAP: 0.1252 NDCG: 0.3598
val Loss: 2.4636 LRAP: 0.1436 NDCG: 0.3649
EarlyStopping counter: 47 out of 50

Epoch 94/99
----------
train Loss: 1.8001 LRAP: 0.1203 NDCG: 0.3578
val Loss: 2.4645 LRAP: 0.1436 NDCG: 0.3659
EarlyStopping counter: 48 out of 50

Epoch 95/99
----------
train Loss: 1.7958 LRAP: 0.1258 NDCG: 0.3609
val Loss: 2.4657 LRAP: 0.1449 NDCG: 0.3662
EarlyStopping counter: 49 out of 50

Epoch 96/99
----------
train Loss: 1.7964 LRAP: 0.1241 NDCG: 0.3602
val Loss: 2.4646 LRAP: 0.1436 NDCG: 0.3655
EarlyStopping counter: 50 out of 50
Early stopping
Training complete in 2m 22s
Best val loss: 2.460972, best LRAP score: 0.7343

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5960 LRAP: 0.0000 NDCG: 0.1640
val Loss: 6.7723 LRAP: 0.0000 NDCG: 0.1188
Validation loss decreased (0.000000 --> 6.772295).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0485 LRAP: 0.0003 NDCG: 0.1850
val Loss: 6.2802 LRAP: 0.0064 NDCG: 0.1668
Validation loss decreased (6.772295 --> 6.280194).  Saving model ...

Epoch 2/99
----------
train Loss: 3.8470 LRAP: 0.0030 NDCG: 0.2062
val Loss: 5.5802 LRAP: 0.0000 NDCG: 0.1455
Validation loss decreased (6.280194 --> 5.580210).  Saving model ...

Epoch 3/99
----------
train Loss: 3.7420 LRAP: 0.0052 NDCG: 0.2118
val Loss: 4.5594 LRAP: 0.0076 NDCG: 0.1863
Validation loss decreased (5.580210 --> 4.559420).  Saving model ...

Epoch 4/99
----------
train Loss: 3.6747 LRAP: 0.0090 NDCG: 0.2151
val Loss: 5.6827 LRAP: 0.0000 NDCG: 0.1513
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.6133 LRAP: 0.0074 NDCG: 0.2188
val Loss: 4.4114 LRAP: 0.0051 NDCG: 0.2088
Validation loss decreased (4.559420 --> 4.411381).  Saving model ...

Epoch 6/99
----------
train Loss: 3.5583 LRAP: 0.0128 NDCG: 0.2227
val Loss: 4.7765 LRAP: 0.0038 NDCG: 0.1957
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.5208 LRAP: 0.0144 NDCG: 0.2231
val Loss: 5.3135 LRAP: 0.0013 NDCG: 0.1923
EarlyStopping counter: 2 out of 50

Epoch 8/99
----------
train Loss: 3.4820 LRAP: 0.0155 NDCG: 0.2255
val Loss: 6.1377 LRAP: 0.0051 NDCG: 0.1042
EarlyStopping counter: 3 out of 50

Epoch 9/99
----------
train Loss: 3.4555 LRAP: 0.0169 NDCG: 0.2293
val Loss: 4.1328 LRAP: 0.0038 NDCG: 0.2119
Validation loss decreased (4.411381 --> 4.132785).  Saving model ...

Epoch 10/99
----------
train Loss: 3.4087 LRAP: 0.0267 NDCG: 0.2288
val Loss: 5.2856 LRAP: 0.0127 NDCG: 0.1707
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.3761 LRAP: 0.0305 NDCG: 0.2321
val Loss: 3.9311 LRAP: 0.0368 NDCG: 0.1991
Validation loss decreased (4.132785 --> 3.931071).  Saving model ...

Epoch 12/99
----------
train Loss: 3.3676 LRAP: 0.0343 NDCG: 0.2328
val Loss: 4.3056 LRAP: 0.0102 NDCG: 0.2017
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 3.3340 LRAP: 0.0302 NDCG: 0.2343
val Loss: 3.7065 LRAP: 0.0178 NDCG: 0.2174
Validation loss decreased (3.931071 --> 3.706516).  Saving model ...

Epoch 14/99
----------
train Loss: 3.3195 LRAP: 0.0476 NDCG: 0.2358
val Loss: 4.2417 LRAP: 0.0165 NDCG: 0.2135
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 3.2639 LRAP: 0.0411 NDCG: 0.2386
val Loss: 5.2867 LRAP: 0.0140 NDCG: 0.1819
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 3.2502 LRAP: 0.0441 NDCG: 0.2409
val Loss: 4.3210 LRAP: 0.0165 NDCG: 0.1780
EarlyStopping counter: 3 out of 50

Epoch 17/99
----------
train Loss: 3.2405 LRAP: 0.0534 NDCG: 0.2403
val Loss: 4.6868 LRAP: 0.0318 NDCG: 0.1689
EarlyStopping counter: 4 out of 50

Epoch 18/99
----------
train Loss: 3.2294 LRAP: 0.0460 NDCG: 0.2440
val Loss: 4.7500 LRAP: 0.0025 NDCG: 0.1648
EarlyStopping counter: 5 out of 50

Epoch 19/99
----------
train Loss: 3.1608 LRAP: 0.0523 NDCG: 0.2490
val Loss: 3.3454 LRAP: 0.0673 NDCG: 0.2396
Validation loss decreased (3.706516 --> 3.345443).  Saving model ...

Epoch 20/99
----------
train Loss: 3.1220 LRAP: 0.0493 NDCG: 0.2496
val Loss: 3.2072 LRAP: 0.0521 NDCG: 0.2529
Validation loss decreased (3.345443 --> 3.207154).  Saving model ...

Epoch 21/99
----------
train Loss: 3.0952 LRAP: 0.0569 NDCG: 0.2532
val Loss: 3.2493 LRAP: 0.0775 NDCG: 0.2548
EarlyStopping counter: 1 out of 50

Epoch 22/99
----------
train Loss: 3.0848 LRAP: 0.0629 NDCG: 0.2529
val Loss: 3.1982 LRAP: 0.0851 NDCG: 0.2563
Validation loss decreased (3.207154 --> 3.198191).  Saving model ...

Epoch 23/99
----------
train Loss: 3.0730 LRAP: 0.0536 NDCG: 0.2534
val Loss: 3.2430 LRAP: 0.0762 NDCG: 0.2498
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 3.0596 LRAP: 0.0618 NDCG: 0.2562
val Loss: 3.2335 LRAP: 0.0851 NDCG: 0.2482
EarlyStopping counter: 2 out of 50

Epoch 25/99
----------
train Loss: 3.0624 LRAP: 0.0599 NDCG: 0.2544
val Loss: 3.5284 LRAP: 0.0457 NDCG: 0.2623
EarlyStopping counter: 3 out of 50

Epoch 26/99
----------
train Loss: 3.0584 LRAP: 0.0577 NDCG: 0.2559
val Loss: 3.2826 LRAP: 0.0928 NDCG: 0.2380
EarlyStopping counter: 4 out of 50

Epoch 27/99
----------
train Loss: 3.0451 LRAP: 0.0621 NDCG: 0.2576
val Loss: 3.3501 LRAP: 0.0635 NDCG: 0.2309
EarlyStopping counter: 5 out of 50

Epoch 28/99
----------
train Loss: 3.0274 LRAP: 0.0594 NDCG: 0.2562
val Loss: 3.0808 LRAP: 0.0750 NDCG: 0.2656
Validation loss decreased (3.198191 --> 3.080799).  Saving model ...

Epoch 29/99
----------
train Loss: 3.0322 LRAP: 0.0626 NDCG: 0.2574
val Loss: 3.0778 LRAP: 0.0737 NDCG: 0.2650
Validation loss decreased (3.080799 --> 3.077815).  Saving model ...

Epoch 30/99
----------
train Loss: 2.9942 LRAP: 0.0613 NDCG: 0.2576
val Loss: 3.0774 LRAP: 0.0877 NDCG: 0.2636
Validation loss decreased (3.077815 --> 3.077354).  Saving model ...

Epoch 31/99
----------
train Loss: 3.0216 LRAP: 0.0656 NDCG: 0.2570
val Loss: 3.1180 LRAP: 0.0839 NDCG: 0.2546
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.9982 LRAP: 0.0692 NDCG: 0.2598
val Loss: 3.0784 LRAP: 0.0826 NDCG: 0.2662
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 2.9977 LRAP: 0.0610 NDCG: 0.2571
val Loss: 3.0794 LRAP: 0.0673 NDCG: 0.2607
EarlyStopping counter: 3 out of 50

Epoch 34/99
----------
train Loss: 2.9850 LRAP: 0.0672 NDCG: 0.2607
val Loss: 3.0726 LRAP: 0.0940 NDCG: 0.2622
Validation loss decreased (3.077354 --> 3.072598).  Saving model ...

Epoch 35/99
----------
train Loss: 2.9792 LRAP: 0.0615 NDCG: 0.2603
val Loss: 3.0671 LRAP: 0.0661 NDCG: 0.2657
Validation loss decreased (3.072598 --> 3.067095).  Saving model ...

Epoch 36/99
----------
train Loss: 3.0001 LRAP: 0.0610 NDCG: 0.2610
val Loss: 3.0640 LRAP: 0.0775 NDCG: 0.2658
Validation loss decreased (3.067095 --> 3.063972).  Saving model ...

Epoch 37/99
----------
train Loss: 2.9875 LRAP: 0.0667 NDCG: 0.2583
val Loss: 3.0807 LRAP: 0.0724 NDCG: 0.2584
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 2.9827 LRAP: 0.0667 NDCG: 0.2622
val Loss: 3.0788 LRAP: 0.0839 NDCG: 0.2625
EarlyStopping counter: 2 out of 50

Epoch 39/99
----------
train Loss: 2.9775 LRAP: 0.0645 NDCG: 0.2593
val Loss: 3.0559 LRAP: 0.0724 NDCG: 0.2640
Validation loss decreased (3.063972 --> 3.055928).  Saving model ...

Epoch 40/99
----------
train Loss: 2.9806 LRAP: 0.0653 NDCG: 0.2605
val Loss: 3.0669 LRAP: 0.0902 NDCG: 0.2608
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 2.9685 LRAP: 0.0667 NDCG: 0.2613
val Loss: 3.0539 LRAP: 0.0813 NDCG: 0.2648
Validation loss decreased (3.055928 --> 3.053907).  Saving model ...

Epoch 42/99
----------
train Loss: 2.9639 LRAP: 0.0697 NDCG: 0.2624
val Loss: 3.0572 LRAP: 0.0877 NDCG: 0.2645
EarlyStopping counter: 1 out of 50

Epoch 43/99
----------
train Loss: 2.9684 LRAP: 0.0651 NDCG: 0.2615
val Loss: 3.0739 LRAP: 0.0597 NDCG: 0.2636
EarlyStopping counter: 2 out of 50

Epoch 44/99
----------
train Loss: 2.9910 LRAP: 0.0664 NDCG: 0.2625
val Loss: 3.0633 LRAP: 0.0699 NDCG: 0.2629
EarlyStopping counter: 3 out of 50

Epoch 45/99
----------
train Loss: 2.9718 LRAP: 0.0689 NDCG: 0.2623
val Loss: 3.0443 LRAP: 0.0940 NDCG: 0.2664
Validation loss decreased (3.053907 --> 3.044317).  Saving model ...

Epoch 46/99
----------
train Loss: 2.9700 LRAP: 0.0700 NDCG: 0.2618
val Loss: 3.0627 LRAP: 0.0788 NDCG: 0.2618
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 2.9615 LRAP: 0.0697 NDCG: 0.2621
val Loss: 3.0590 LRAP: 0.0737 NDCG: 0.2644
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 2.9637 LRAP: 0.0702 NDCG: 0.2632
val Loss: 3.0408 LRAP: 0.0813 NDCG: 0.2695
Validation loss decreased (3.044317 --> 3.040797).  Saving model ...

Epoch 49/99
----------
train Loss: 2.9639 LRAP: 0.0643 NDCG: 0.2619
val Loss: 3.0380 LRAP: 0.0902 NDCG: 0.2666
Validation loss decreased (3.040797 --> 3.037977).  Saving model ...

Epoch 50/99
----------
train Loss: 2.9774 LRAP: 0.0653 NDCG: 0.2621
val Loss: 3.0367 LRAP: 0.0724 NDCG: 0.2714
Validation loss decreased (3.037977 --> 3.036734).  Saving model ...

Epoch 51/99
----------
train Loss: 2.9534 LRAP: 0.0697 NDCG: 0.2640
val Loss: 3.0401 LRAP: 0.0877 NDCG: 0.2690
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 2.9477 LRAP: 0.0675 NDCG: 0.2634
val Loss: 3.0435 LRAP: 0.0902 NDCG: 0.2651
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 2.9510 LRAP: 0.0672 NDCG: 0.2634
val Loss: 3.0413 LRAP: 0.0788 NDCG: 0.2685
EarlyStopping counter: 3 out of 50

Epoch 54/99
----------
train Loss: 2.9609 LRAP: 0.0667 NDCG: 0.2634
val Loss: 3.0461 LRAP: 0.0851 NDCG: 0.2689
EarlyStopping counter: 4 out of 50

Epoch 55/99
----------
train Loss: 2.9445 LRAP: 0.0683 NDCG: 0.2661
val Loss: 3.0245 LRAP: 0.0928 NDCG: 0.2698
Validation loss decreased (3.036734 --> 3.024464).  Saving model ...

Epoch 56/99
----------
train Loss: 2.9484 LRAP: 0.0692 NDCG: 0.2652
val Loss: 3.0314 LRAP: 0.0851 NDCG: 0.2658
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 2.9289 LRAP: 0.0716 NDCG: 0.2663
val Loss: 3.0285 LRAP: 0.0775 NDCG: 0.2681
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 2.9349 LRAP: 0.0708 NDCG: 0.2652
val Loss: 3.0241 LRAP: 0.0928 NDCG: 0.2721
Validation loss decreased (3.024464 --> 3.024107).  Saving model ...

Epoch 59/99
----------
train Loss: 2.9346 LRAP: 0.0686 NDCG: 0.2667
val Loss: 3.0226 LRAP: 0.0762 NDCG: 0.2682
Validation loss decreased (3.024107 --> 3.022585).  Saving model ...

Epoch 60/99
----------
train Loss: 2.9246 LRAP: 0.0694 NDCG: 0.2656
val Loss: 3.0211 LRAP: 0.0839 NDCG: 0.2678
Validation loss decreased (3.022585 --> 3.021124).  Saving model ...

Epoch 61/99
----------
train Loss: 2.9301 LRAP: 0.0762 NDCG: 0.2657
val Loss: 3.0315 LRAP: 0.0978 NDCG: 0.2705
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 2.9301 LRAP: 0.0727 NDCG: 0.2669
val Loss: 3.0396 LRAP: 0.0864 NDCG: 0.2676
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 2.9313 LRAP: 0.0708 NDCG: 0.2683
val Loss: 3.0034 LRAP: 0.0826 NDCG: 0.2713
Validation loss decreased (3.021124 --> 3.003389).  Saving model ...

Epoch 64/99
----------
train Loss: 2.9234 LRAP: 0.0727 NDCG: 0.2683
val Loss: 3.0021 LRAP: 0.0877 NDCG: 0.2696
Validation loss decreased (3.003389 --> 3.002142).  Saving model ...

Epoch 65/99
----------
train Loss: 2.9290 LRAP: 0.0716 NDCG: 0.2675
val Loss: 3.0223 LRAP: 0.0966 NDCG: 0.2717
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 2.9082 LRAP: 0.0705 NDCG: 0.2681
val Loss: 3.0159 LRAP: 0.0864 NDCG: 0.2722
EarlyStopping counter: 2 out of 50

Epoch 67/99
----------
train Loss: 2.9214 LRAP: 0.0757 NDCG: 0.2676
val Loss: 3.0127 LRAP: 0.0940 NDCG: 0.2666
EarlyStopping counter: 3 out of 50

Epoch 68/99
----------
train Loss: 2.9101 LRAP: 0.0724 NDCG: 0.2677
val Loss: 2.9885 LRAP: 0.0851 NDCG: 0.2741
Validation loss decreased (3.002142 --> 2.988481).  Saving model ...

Epoch 69/99
----------
train Loss: 2.9048 LRAP: 0.0757 NDCG: 0.2686
val Loss: 3.0267 LRAP: 0.0902 NDCG: 0.2651
EarlyStopping counter: 1 out of 50

Epoch 70/99
----------
train Loss: 2.9027 LRAP: 0.0746 NDCG: 0.2684
val Loss: 3.0021 LRAP: 0.0940 NDCG: 0.2720
EarlyStopping counter: 2 out of 50

Epoch 71/99
----------
train Loss: 2.9133 LRAP: 0.0705 NDCG: 0.2689
val Loss: 2.9949 LRAP: 0.0902 NDCG: 0.2769
EarlyStopping counter: 3 out of 50

Epoch 72/99
----------
train Loss: 2.8965 LRAP: 0.0757 NDCG: 0.2696
val Loss: 2.9965 LRAP: 0.0864 NDCG: 0.2754
EarlyStopping counter: 4 out of 50

Epoch 73/99
----------
train Loss: 2.8915 LRAP: 0.0746 NDCG: 0.2690
val Loss: 2.9979 LRAP: 0.0864 NDCG: 0.2701
EarlyStopping counter: 5 out of 50

Epoch 74/99
----------
train Loss: 2.8857 LRAP: 0.0702 NDCG: 0.2707
val Loss: 2.9793 LRAP: 0.0889 NDCG: 0.2711
Validation loss decreased (2.988481 --> 2.979264).  Saving model ...

Epoch 75/99
----------
train Loss: 2.8997 LRAP: 0.0694 NDCG: 0.2689
val Loss: 2.9781 LRAP: 0.0877 NDCG: 0.2748
Validation loss decreased (2.979264 --> 2.978060).  Saving model ...

Epoch 76/99
----------
train Loss: 2.8945 LRAP: 0.0746 NDCG: 0.2693
val Loss: 2.9739 LRAP: 0.0889 NDCG: 0.2754
Validation loss decreased (2.978060 --> 2.973948).  Saving model ...

Epoch 77/99
----------
train Loss: 2.8810 LRAP: 0.0765 NDCG: 0.2694
val Loss: 2.9750 LRAP: 0.0902 NDCG: 0.2738
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 2.8836 LRAP: 0.0743 NDCG: 0.2700
val Loss: 2.9770 LRAP: 0.0877 NDCG: 0.2737
EarlyStopping counter: 2 out of 50

Epoch 79/99
----------
train Loss: 2.8862 LRAP: 0.0738 NDCG: 0.2688
val Loss: 2.9769 LRAP: 0.0864 NDCG: 0.2732
EarlyStopping counter: 3 out of 50

Epoch 80/99
----------
train Loss: 2.8764 LRAP: 0.0727 NDCG: 0.2707
val Loss: 2.9735 LRAP: 0.0864 NDCG: 0.2752
Validation loss decreased (2.973948 --> 2.973528).  Saving model ...

Epoch 81/99
----------
train Loss: 2.9019 LRAP: 0.0719 NDCG: 0.2692
val Loss: 2.9745 LRAP: 0.0877 NDCG: 0.2743
EarlyStopping counter: 1 out of 50

Epoch 82/99
----------
train Loss: 2.8854 LRAP: 0.0760 NDCG: 0.2697
val Loss: 2.9726 LRAP: 0.0877 NDCG: 0.2734
Validation loss decreased (2.973528 --> 2.972583).  Saving model ...

Epoch 83/99
----------
train Loss: 2.8729 LRAP: 0.0792 NDCG: 0.2716
val Loss: 2.9730 LRAP: 0.0889 NDCG: 0.2745
EarlyStopping counter: 1 out of 50

Epoch 84/99
----------
train Loss: 2.8768 LRAP: 0.0770 NDCG: 0.2710
val Loss: 2.9711 LRAP: 0.0889 NDCG: 0.2755
Validation loss decreased (2.972583 --> 2.971058).  Saving model ...

Epoch 85/99
----------
train Loss: 2.8703 LRAP: 0.0708 NDCG: 0.2717
val Loss: 2.9706 LRAP: 0.0889 NDCG: 0.2770
Validation loss decreased (2.971058 --> 2.970587).  Saving model ...

Epoch 86/99
----------
train Loss: 2.8732 LRAP: 0.0776 NDCG: 0.2704
val Loss: 2.9725 LRAP: 0.0902 NDCG: 0.2763
EarlyStopping counter: 1 out of 50

Epoch 87/99
----------
train Loss: 2.8802 LRAP: 0.0781 NDCG: 0.2717
val Loss: 2.9713 LRAP: 0.0889 NDCG: 0.2737
EarlyStopping counter: 2 out of 50

Epoch 88/99
----------
train Loss: 2.8870 LRAP: 0.0702 NDCG: 0.2700
val Loss: 2.9694 LRAP: 0.0928 NDCG: 0.2738
Validation loss decreased (2.970587 --> 2.969404).  Saving model ...

Epoch 89/99
----------
train Loss: 2.8757 LRAP: 0.0738 NDCG: 0.2692
val Loss: 2.9682 LRAP: 0.0915 NDCG: 0.2768
Validation loss decreased (2.969404 --> 2.968246).  Saving model ...

Epoch 90/99
----------
train Loss: 2.8669 LRAP: 0.0762 NDCG: 0.2714
val Loss: 2.9699 LRAP: 0.0928 NDCG: 0.2771
EarlyStopping counter: 1 out of 50

Epoch 91/99
----------
train Loss: 2.8842 LRAP: 0.0809 NDCG: 0.2701
val Loss: 2.9661 LRAP: 0.0889 NDCG: 0.2769
Validation loss decreased (2.968246 --> 2.966059).  Saving model ...

Epoch 92/99
----------
train Loss: 2.8850 LRAP: 0.0770 NDCG: 0.2712
val Loss: 2.9678 LRAP: 0.0889 NDCG: 0.2750
EarlyStopping counter: 1 out of 50

Epoch 93/99
----------
train Loss: 2.8692 LRAP: 0.0749 NDCG: 0.2706
val Loss: 2.9652 LRAP: 0.0928 NDCG: 0.2770
Validation loss decreased (2.966059 --> 2.965208).  Saving model ...

Epoch 94/99
----------
train Loss: 2.8864 LRAP: 0.0790 NDCG: 0.2702
val Loss: 2.9680 LRAP: 0.0889 NDCG: 0.2753
EarlyStopping counter: 1 out of 50

Epoch 95/99
----------
train Loss: 2.8732 LRAP: 0.0787 NDCG: 0.2706
val Loss: 2.9672 LRAP: 0.0915 NDCG: 0.2730
EarlyStopping counter: 2 out of 50

Epoch 96/99
----------
train Loss: 2.8630 LRAP: 0.0770 NDCG: 0.2713
val Loss: 2.9657 LRAP: 0.0889 NDCG: 0.2750
EarlyStopping counter: 3 out of 50

Epoch 97/99
----------
train Loss: 2.8583 LRAP: 0.0749 NDCG: 0.2714
val Loss: 2.9656 LRAP: 0.0902 NDCG: 0.2762
EarlyStopping counter: 4 out of 50

Epoch 98/99
----------
train Loss: 2.8842 LRAP: 0.0721 NDCG: 0.2715
val Loss: 2.9645 LRAP: 0.0889 NDCG: 0.2745
Validation loss decreased (2.965208 --> 2.964466).  Saving model ...

Epoch 99/99
----------
train Loss: 2.8789 LRAP: 0.0730 NDCG: 0.2708
val Loss: 2.9662 LRAP: 0.0902 NDCG: 0.2769
EarlyStopping counter: 1 out of 50

Training complete in 2m 29s
Best val loss: 2.964466, best LRAP score: 0.6216

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.5703 LRAP: 0.0000 NDCG: 0.1703
val Loss: 7.1130 LRAP: 0.0000 NDCG: 0.1349
Validation loss decreased (0.000000 --> 7.112982).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1085 LRAP: 0.0000 NDCG: 0.1871
val Loss: 6.4857 LRAP: 0.0051 NDCG: 0.1433
Validation loss decreased (7.112982 --> 6.485742).  Saving model ...

Epoch 2/99
----------
train Loss: 3.9752 LRAP: 0.0030 NDCG: 0.1996
val Loss: 4.0662 LRAP: 0.0025 NDCG: 0.1863
Validation loss decreased (6.485742 --> 4.066219).  Saving model ...

Epoch 3/99
----------
train Loss: 3.9024 LRAP: 0.0098 NDCG: 0.1980
val Loss: 4.4704 LRAP: 0.0089 NDCG: 0.1468
EarlyStopping counter: 1 out of 50

Epoch 4/99
----------
train Loss: 3.8447 LRAP: 0.0060 NDCG: 0.2052
val Loss: 4.0625 LRAP: 0.0076 NDCG: 0.1745
Validation loss decreased (4.066219 --> 4.062523).  Saving model ...

Epoch 5/99
----------
train Loss: 3.7915 LRAP: 0.0098 NDCG: 0.2056
val Loss: 5.7847 LRAP: 0.0076 NDCG: 0.1641
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.7751 LRAP: 0.0180 NDCG: 0.2084
val Loss: 4.8507 LRAP: 0.0089 NDCG: 0.2163
EarlyStopping counter: 2 out of 50

Epoch 7/99
----------
train Loss: 3.7319 LRAP: 0.0182 NDCG: 0.2094
val Loss: 4.0634 LRAP: 0.0076 NDCG: 0.1902
EarlyStopping counter: 3 out of 50

Epoch 8/99
----------
train Loss: 3.7072 LRAP: 0.0215 NDCG: 0.2132
val Loss: 4.5786 LRAP: 0.0038 NDCG: 0.1521
EarlyStopping counter: 4 out of 50

Epoch 9/99
----------
train Loss: 3.6454 LRAP: 0.0319 NDCG: 0.2164
val Loss: 3.8532 LRAP: 0.0089 NDCG: 0.2099
Validation loss decreased (4.062523 --> 3.853156).  Saving model ...

Epoch 10/99
----------
train Loss: 3.6177 LRAP: 0.0278 NDCG: 0.2201
val Loss: 4.2132 LRAP: 0.0089 NDCG: 0.2242
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.5880 LRAP: 0.0340 NDCG: 0.2202
val Loss: 4.3378 LRAP: 0.0102 NDCG: 0.1583
EarlyStopping counter: 2 out of 50

Epoch 12/99
----------
train Loss: 3.5630 LRAP: 0.0332 NDCG: 0.2224
val Loss: 4.0159 LRAP: 0.0966 NDCG: 0.1983
EarlyStopping counter: 3 out of 50

Epoch 13/99
----------
train Loss: 3.5255 LRAP: 0.0376 NDCG: 0.2246
val Loss: 3.7530 LRAP: 0.0445 NDCG: 0.2320
Validation loss decreased (3.853156 --> 3.753023).  Saving model ...

Epoch 14/99
----------
train Loss: 3.4874 LRAP: 0.0403 NDCG: 0.2267
val Loss: 3.7917 LRAP: 0.0483 NDCG: 0.2113
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 3.4595 LRAP: 0.0476 NDCG: 0.2284
val Loss: 4.1457 LRAP: 0.0038 NDCG: 0.1967
EarlyStopping counter: 2 out of 50

Epoch 16/99
----------
train Loss: 3.4276 LRAP: 0.0602 NDCG: 0.2318
val Loss: 3.8170 LRAP: 0.0254 NDCG: 0.2342
EarlyStopping counter: 3 out of 50

Epoch 17/99
----------
train Loss: 3.4240 LRAP: 0.0542 NDCG: 0.2315
val Loss: 3.8510 LRAP: 0.0013 NDCG: 0.1994
EarlyStopping counter: 4 out of 50

Epoch 18/99
----------
train Loss: 3.4058 LRAP: 0.0485 NDCG: 0.2317
val Loss: 4.0517 LRAP: 0.0013 NDCG: 0.1869
EarlyStopping counter: 5 out of 50

Epoch 19/99
----------
train Loss: 3.3532 LRAP: 0.0640 NDCG: 0.2358
val Loss: 3.5901 LRAP: 0.1004 NDCG: 0.2294
Validation loss decreased (3.753023 --> 3.590138).  Saving model ...

Epoch 20/99
----------
train Loss: 3.3050 LRAP: 0.0604 NDCG: 0.2366
val Loss: 3.5583 LRAP: 0.0623 NDCG: 0.2191
Validation loss decreased (3.590138 --> 3.558325).  Saving model ...

Epoch 21/99
----------
train Loss: 3.2854 LRAP: 0.0596 NDCG: 0.2385
val Loss: 3.4821 LRAP: 0.0572 NDCG: 0.2260
Validation loss decreased (3.558325 --> 3.482111).  Saving model ...

Epoch 22/99
----------
train Loss: 3.2847 LRAP: 0.0708 NDCG: 0.2405
val Loss: 3.4455 LRAP: 0.0877 NDCG: 0.2266
Validation loss decreased (3.482111 --> 3.445542).  Saving model ...

Epoch 23/99
----------
train Loss: 3.2823 LRAP: 0.0632 NDCG: 0.2402
val Loss: 3.4635 LRAP: 0.0928 NDCG: 0.2361
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 3.2901 LRAP: 0.0705 NDCG: 0.2405
val Loss: 3.8576 LRAP: 0.1067 NDCG: 0.2430
EarlyStopping counter: 2 out of 50

Epoch 25/99
----------
train Loss: 3.2578 LRAP: 0.0656 NDCG: 0.2414
val Loss: 3.4278 LRAP: 0.0953 NDCG: 0.2285
Validation loss decreased (3.445542 --> 3.427760).  Saving model ...

Epoch 26/99
----------
train Loss: 3.2392 LRAP: 0.0741 NDCG: 0.2422
val Loss: 3.4762 LRAP: 0.0775 NDCG: 0.2275
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 3.2477 LRAP: 0.0683 NDCG: 0.2435
val Loss: 3.8039 LRAP: 0.1055 NDCG: 0.2334
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 3.2311 LRAP: 0.0730 NDCG: 0.2450
val Loss: 3.6204 LRAP: 0.0254 NDCG: 0.2278
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 3.2152 LRAP: 0.0702 NDCG: 0.2476
val Loss: 3.5066 LRAP: 0.0775 NDCG: 0.2385
EarlyStopping counter: 4 out of 50

Epoch 30/99
----------
train Loss: 3.2061 LRAP: 0.0790 NDCG: 0.2453
val Loss: 3.6332 LRAP: 0.0966 NDCG: 0.2205
EarlyStopping counter: 5 out of 50

Epoch 31/99
----------
train Loss: 3.1856 LRAP: 0.0716 NDCG: 0.2445
val Loss: 3.3464 LRAP: 0.0826 NDCG: 0.2440
Validation loss decreased (3.427760 --> 3.346427).  Saving model ...

Epoch 32/99
----------
train Loss: 3.1881 LRAP: 0.0721 NDCG: 0.2480
val Loss: 3.3280 LRAP: 0.0889 NDCG: 0.2436
Validation loss decreased (3.346427 --> 3.328019).  Saving model ...

Epoch 33/99
----------
train Loss: 3.1734 LRAP: 0.0743 NDCG: 0.2491
val Loss: 3.3144 LRAP: 0.0864 NDCG: 0.2445
Validation loss decreased (3.328019 --> 3.314382).  Saving model ...

Epoch 34/99
----------
train Loss: 3.1737 LRAP: 0.0749 NDCG: 0.2486
val Loss: 3.3303 LRAP: 0.1029 NDCG: 0.2427
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.1829 LRAP: 0.0819 NDCG: 0.2492
val Loss: 3.3390 LRAP: 0.0864 NDCG: 0.2410
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 3.1867 LRAP: 0.0721 NDCG: 0.2494
val Loss: 3.3906 LRAP: 0.1093 NDCG: 0.2474
EarlyStopping counter: 3 out of 50

Epoch 37/99
----------
train Loss: 3.1740 LRAP: 0.0754 NDCG: 0.2493
val Loss: 3.3591 LRAP: 0.0801 NDCG: 0.2422
EarlyStopping counter: 4 out of 50

Epoch 38/99
----------
train Loss: 3.1888 LRAP: 0.0784 NDCG: 0.2492
val Loss: 3.3469 LRAP: 0.1029 NDCG: 0.2473
EarlyStopping counter: 5 out of 50

Epoch 39/99
----------
train Loss: 3.1737 LRAP: 0.0749 NDCG: 0.2490
val Loss: 3.3058 LRAP: 0.0902 NDCG: 0.2459
Validation loss decreased (3.314382 --> 3.305792).  Saving model ...

Epoch 40/99
----------
train Loss: 3.1786 LRAP: 0.0790 NDCG: 0.2486
val Loss: 3.3063 LRAP: 0.0953 NDCG: 0.2460
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 3.1672 LRAP: 0.0749 NDCG: 0.2512
val Loss: 3.3063 LRAP: 0.0966 NDCG: 0.2453
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 3.1552 LRAP: 0.0839 NDCG: 0.2507
val Loss: 3.3046 LRAP: 0.0915 NDCG: 0.2446
Validation loss decreased (3.305792 --> 3.304553).  Saving model ...

Epoch 43/99
----------
train Loss: 3.1590 LRAP: 0.0765 NDCG: 0.2489
val Loss: 3.3052 LRAP: 0.0928 NDCG: 0.2443
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.1645 LRAP: 0.0819 NDCG: 0.2509
val Loss: 3.3042 LRAP: 0.0953 NDCG: 0.2460
Validation loss decreased (3.304553 --> 3.304212).  Saving model ...

Epoch 45/99
----------
train Loss: 3.1646 LRAP: 0.0749 NDCG: 0.2501
val Loss: 3.3085 LRAP: 0.0978 NDCG: 0.2454
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 3.1675 LRAP: 0.0836 NDCG: 0.2490
val Loss: 3.3051 LRAP: 0.0928 NDCG: 0.2454
EarlyStopping counter: 2 out of 50

Epoch 47/99
----------
train Loss: 3.1616 LRAP: 0.0795 NDCG: 0.2498
val Loss: 3.3048 LRAP: 0.0953 NDCG: 0.2448
EarlyStopping counter: 3 out of 50

Epoch 48/99
----------
train Loss: 3.1564 LRAP: 0.0800 NDCG: 0.2506
val Loss: 3.3023 LRAP: 0.0928 NDCG: 0.2453
Validation loss decreased (3.304212 --> 3.302278).  Saving model ...

Epoch 49/99
----------
train Loss: 3.1683 LRAP: 0.0760 NDCG: 0.2484
val Loss: 3.3020 LRAP: 0.0889 NDCG: 0.2442
Validation loss decreased (3.302278 --> 3.302018).  Saving model ...

Epoch 50/99
----------
train Loss: 3.1590 LRAP: 0.0770 NDCG: 0.2494
val Loss: 3.3013 LRAP: 0.0915 NDCG: 0.2454
Validation loss decreased (3.302018 --> 3.301301).  Saving model ...

Epoch 51/99
----------
train Loss: 3.1667 LRAP: 0.0790 NDCG: 0.2498
val Loss: 3.3023 LRAP: 0.0953 NDCG: 0.2453
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 3.1758 LRAP: 0.0743 NDCG: 0.2490
val Loss: 3.3016 LRAP: 0.0940 NDCG: 0.2447
EarlyStopping counter: 2 out of 50

Epoch 53/99
----------
train Loss: 3.1671 LRAP: 0.0863 NDCG: 0.2495
val Loss: 3.3005 LRAP: 0.0928 NDCG: 0.2450
Validation loss decreased (3.301301 --> 3.300476).  Saving model ...

Epoch 54/99
----------
train Loss: 3.1556 LRAP: 0.0811 NDCG: 0.2517
val Loss: 3.3002 LRAP: 0.0940 NDCG: 0.2453
Validation loss decreased (3.300476 --> 3.300214).  Saving model ...

Epoch 55/99
----------
train Loss: 3.1628 LRAP: 0.0817 NDCG: 0.2495
val Loss: 3.2993 LRAP: 0.0915 NDCG: 0.2442
Validation loss decreased (3.300214 --> 3.299283).  Saving model ...

Epoch 56/99
----------
train Loss: 3.1498 LRAP: 0.0762 NDCG: 0.2516
val Loss: 3.2973 LRAP: 0.0928 NDCG: 0.2467
Validation loss decreased (3.299283 --> 3.297318).  Saving model ...

Epoch 57/99
----------
train Loss: 3.1595 LRAP: 0.0741 NDCG: 0.2500
val Loss: 3.2987 LRAP: 0.0940 NDCG: 0.2461
EarlyStopping counter: 1 out of 50

Epoch 58/99
----------
train Loss: 3.1756 LRAP: 0.0746 NDCG: 0.2498
val Loss: 3.2991 LRAP: 0.0940 NDCG: 0.2450
EarlyStopping counter: 2 out of 50

Epoch 59/99
----------
train Loss: 3.1645 LRAP: 0.0779 NDCG: 0.2500
val Loss: 3.2995 LRAP: 0.0953 NDCG: 0.2464
EarlyStopping counter: 3 out of 50

Epoch 60/99
----------
train Loss: 3.1572 LRAP: 0.0754 NDCG: 0.2504
val Loss: 3.2984 LRAP: 0.0928 NDCG: 0.2462
EarlyStopping counter: 4 out of 50

Epoch 61/99
----------
train Loss: 3.1606 LRAP: 0.0795 NDCG: 0.2499
val Loss: 3.2995 LRAP: 0.0940 NDCG: 0.2459
EarlyStopping counter: 5 out of 50

Epoch 62/99
----------
train Loss: 3.1523 LRAP: 0.0795 NDCG: 0.2509
val Loss: 3.2987 LRAP: 0.0953 NDCG: 0.2465
EarlyStopping counter: 6 out of 50

Epoch 63/99
----------
train Loss: 3.1531 LRAP: 0.0819 NDCG: 0.2505
val Loss: 3.2977 LRAP: 0.0978 NDCG: 0.2457
EarlyStopping counter: 7 out of 50

Epoch 64/99
----------
train Loss: 3.1615 LRAP: 0.0800 NDCG: 0.2512
val Loss: 3.2957 LRAP: 0.0940 NDCG: 0.2460
Validation loss decreased (3.297318 --> 3.295671).  Saving model ...

Epoch 65/99
----------
train Loss: 3.1608 LRAP: 0.0779 NDCG: 0.2516
val Loss: 3.2982 LRAP: 0.0978 NDCG: 0.2451
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 3.1443 LRAP: 0.0787 NDCG: 0.2518
val Loss: 3.2963 LRAP: 0.0928 NDCG: 0.2457
EarlyStopping counter: 2 out of 50

Epoch 67/99
----------
train Loss: 3.1626 LRAP: 0.0784 NDCG: 0.2500
val Loss: 3.2958 LRAP: 0.0953 NDCG: 0.2456
EarlyStopping counter: 3 out of 50

Epoch 68/99
----------
train Loss: 3.1697 LRAP: 0.0828 NDCG: 0.2499
val Loss: 3.2961 LRAP: 0.0940 NDCG: 0.2458
EarlyStopping counter: 4 out of 50

Epoch 69/99
----------
train Loss: 3.1643 LRAP: 0.0768 NDCG: 0.2498
val Loss: 3.2959 LRAP: 0.0940 NDCG: 0.2461
EarlyStopping counter: 5 out of 50

Epoch 70/99
----------
train Loss: 3.1595 LRAP: 0.0779 NDCG: 0.2495
val Loss: 3.2981 LRAP: 0.0966 NDCG: 0.2456
EarlyStopping counter: 6 out of 50

Epoch 71/99
----------
train Loss: 3.1594 LRAP: 0.0776 NDCG: 0.2493
val Loss: 3.2967 LRAP: 0.0915 NDCG: 0.2460
EarlyStopping counter: 7 out of 50

Epoch 72/99
----------
train Loss: 3.1551 LRAP: 0.0760 NDCG: 0.2500
val Loss: 3.2973 LRAP: 0.0953 NDCG: 0.2464
EarlyStopping counter: 8 out of 50

Epoch 73/99
----------
train Loss: 3.1508 LRAP: 0.0814 NDCG: 0.2506
val Loss: 3.2963 LRAP: 0.0978 NDCG: 0.2456
EarlyStopping counter: 9 out of 50

Epoch 74/99
----------
train Loss: 3.1549 LRAP: 0.0787 NDCG: 0.2495
val Loss: 3.2998 LRAP: 0.0991 NDCG: 0.2457
EarlyStopping counter: 10 out of 50

Epoch 75/99
----------
train Loss: 3.1607 LRAP: 0.0770 NDCG: 0.2497
val Loss: 3.2969 LRAP: 0.0915 NDCG: 0.2454
EarlyStopping counter: 11 out of 50

Epoch 76/99
----------
train Loss: 3.1549 LRAP: 0.0822 NDCG: 0.2521
val Loss: 3.2993 LRAP: 0.0978 NDCG: 0.2473
EarlyStopping counter: 12 out of 50

Epoch 77/99
----------
train Loss: 3.1651 LRAP: 0.0768 NDCG: 0.2494
val Loss: 3.2965 LRAP: 0.0940 NDCG: 0.2453
EarlyStopping counter: 13 out of 50

Epoch 78/99
----------
train Loss: 3.1616 LRAP: 0.0809 NDCG: 0.2503
val Loss: 3.2954 LRAP: 0.0915 NDCG: 0.2449
Validation loss decreased (3.295671 --> 3.295361).  Saving model ...

Epoch 79/99
----------
train Loss: 3.1479 LRAP: 0.0751 NDCG: 0.2492
val Loss: 3.2959 LRAP: 0.0915 NDCG: 0.2456
EarlyStopping counter: 1 out of 50

Epoch 80/99
----------
train Loss: 3.1600 LRAP: 0.0770 NDCG: 0.2498
val Loss: 3.2952 LRAP: 0.0953 NDCG: 0.2456
Validation loss decreased (3.295361 --> 3.295157).  Saving model ...

Epoch 81/99
----------
train Loss: 3.1640 LRAP: 0.0795 NDCG: 0.2486
val Loss: 3.2953 LRAP: 0.0928 NDCG: 0.2451
EarlyStopping counter: 1 out of 50

Epoch 82/99
----------
train Loss: 3.1598 LRAP: 0.0795 NDCG: 0.2512
val Loss: 3.2972 LRAP: 0.0978 NDCG: 0.2464
EarlyStopping counter: 2 out of 50

Epoch 83/99
----------
train Loss: 3.1524 LRAP: 0.0800 NDCG: 0.2507
val Loss: 3.2958 LRAP: 0.0928 NDCG: 0.2459
EarlyStopping counter: 3 out of 50

Epoch 84/99
----------
train Loss: 3.1633 LRAP: 0.0795 NDCG: 0.2504
val Loss: 3.2975 LRAP: 0.0978 NDCG: 0.2460
EarlyStopping counter: 4 out of 50

Epoch 85/99
----------
train Loss: 3.1520 LRAP: 0.0800 NDCG: 0.2500
val Loss: 3.2977 LRAP: 0.0953 NDCG: 0.2459
EarlyStopping counter: 5 out of 50

Epoch 86/99
----------
train Loss: 3.1734 LRAP: 0.0803 NDCG: 0.2498
val Loss: 3.2955 LRAP: 0.0940 NDCG: 0.2463
EarlyStopping counter: 6 out of 50

Epoch 87/99
----------
train Loss: 3.1667 LRAP: 0.0751 NDCG: 0.2509
val Loss: 3.2946 LRAP: 0.0928 NDCG: 0.2465
Validation loss decreased (3.295157 --> 3.294569).  Saving model ...

Epoch 88/99
----------
train Loss: 3.1543 LRAP: 0.0784 NDCG: 0.2521
val Loss: 3.2959 LRAP: 0.0966 NDCG: 0.2468
EarlyStopping counter: 1 out of 50

Epoch 89/99
----------
train Loss: 3.1592 LRAP: 0.0787 NDCG: 0.2506
val Loss: 3.2959 LRAP: 0.0915 NDCG: 0.2452
EarlyStopping counter: 2 out of 50

Epoch 90/99
----------
train Loss: 3.1640 LRAP: 0.0754 NDCG: 0.2507
val Loss: 3.2976 LRAP: 0.0928 NDCG: 0.2459
EarlyStopping counter: 3 out of 50

Epoch 91/99
----------
train Loss: 3.1604 LRAP: 0.0754 NDCG: 0.2497
val Loss: 3.2971 LRAP: 0.0953 NDCG: 0.2461
EarlyStopping counter: 4 out of 50

Epoch 92/99
----------
train Loss: 3.1621 LRAP: 0.0809 NDCG: 0.2527
val Loss: 3.2958 LRAP: 0.0940 NDCG: 0.2461
EarlyStopping counter: 5 out of 50

Epoch 93/99
----------
train Loss: 3.1631 LRAP: 0.0811 NDCG: 0.2497
val Loss: 3.2961 LRAP: 0.0953 NDCG: 0.2452
EarlyStopping counter: 6 out of 50

Epoch 94/99
----------
train Loss: 3.1462 LRAP: 0.0765 NDCG: 0.2497
val Loss: 3.2969 LRAP: 0.0928 NDCG: 0.2458
EarlyStopping counter: 7 out of 50

Epoch 95/99
----------
train Loss: 3.1684 LRAP: 0.0836 NDCG: 0.2500
val Loss: 3.2952 LRAP: 0.0953 NDCG: 0.2450
EarlyStopping counter: 8 out of 50

Epoch 96/99
----------
train Loss: 3.1596 LRAP: 0.0811 NDCG: 0.2506
val Loss: 3.2961 LRAP: 0.0953 NDCG: 0.2464
EarlyStopping counter: 9 out of 50

Epoch 97/99
----------
train Loss: 3.1462 LRAP: 0.0792 NDCG: 0.2508
val Loss: 3.2963 LRAP: 0.0928 NDCG: 0.2466
EarlyStopping counter: 10 out of 50

Epoch 98/99
----------
train Loss: 3.1569 LRAP: 0.0784 NDCG: 0.2499
val Loss: 3.2961 LRAP: 0.0928 NDCG: 0.2464
EarlyStopping counter: 11 out of 50

Epoch 99/99
----------
train Loss: 3.1638 LRAP: 0.0746 NDCG: 0.2499
val Loss: 3.2964 LRAP: 0.0928 NDCG: 0.2459
EarlyStopping counter: 12 out of 50

Training complete in 2m 26s
Best val loss: 3.294569, best LRAP score: 0.5639

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv
----------------
Run 10/10

All random seeds set to: 51
Split complete!
Train set size: 3673
Validation set size: 787
Test set size: 788
----------------
Running configuration: baseline_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5035 LRAP: 0.0000 NDCG: 0.1727
val Loss: 4.1437 LRAP: 0.0000 NDCG: 0.1859
Validation loss decreased (0.000000 --> 4.143743).  Saving model ...

Epoch 1/99
----------
train Loss: 3.9116 LRAP: 0.0008 NDCG: 0.2036
val Loss: 3.9120 LRAP: 0.0025 NDCG: 0.2056
Validation loss decreased (4.143743 --> 3.911987).  Saving model ...

Epoch 2/99
----------
train Loss: 3.7207 LRAP: 0.0044 NDCG: 0.2266
val Loss: 4.0380 LRAP: 0.0064 NDCG: 0.2004
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.5884 LRAP: 0.0082 NDCG: 0.2312
val Loss: 3.7684 LRAP: 0.0064 NDCG: 0.2217
Validation loss decreased (3.911987 --> 3.768411).  Saving model ...

Epoch 4/99
----------
train Loss: 3.4760 LRAP: 0.0270 NDCG: 0.2394
val Loss: 3.6262 LRAP: 0.0356 NDCG: 0.2311
Validation loss decreased (3.768411 --> 3.626180).  Saving model ...

Epoch 5/99
----------
train Loss: 3.3931 LRAP: 0.0278 NDCG: 0.2433
val Loss: 3.7647 LRAP: 0.1029 NDCG: 0.2538
EarlyStopping counter: 1 out of 50

Epoch 6/99
----------
train Loss: 3.3253 LRAP: 0.0392 NDCG: 0.2483
val Loss: 3.6160 LRAP: 0.0508 NDCG: 0.2232
Validation loss decreased (3.626180 --> 3.616045).  Saving model ...

Epoch 7/99
----------
train Loss: 3.2520 LRAP: 0.0569 NDCG: 0.2511
val Loss: 3.6155 LRAP: 0.1169 NDCG: 0.2369
Validation loss decreased (3.616045 --> 3.615479).  Saving model ...

Epoch 8/99
----------
train Loss: 3.1852 LRAP: 0.0667 NDCG: 0.2623
val Loss: 3.3989 LRAP: 0.0280 NDCG: 0.2380
Validation loss decreased (3.615479 --> 3.398854).  Saving model ...

Epoch 9/99
----------
train Loss: 3.1292 LRAP: 0.0623 NDCG: 0.2644
val Loss: 3.6317 LRAP: 0.0801 NDCG: 0.2248
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.0742 LRAP: 0.0770 NDCG: 0.2682
val Loss: 3.2463 LRAP: 0.0953 NDCG: 0.2571
Validation loss decreased (3.398854 --> 3.246256).  Saving model ...

Epoch 11/99
----------
train Loss: 2.9989 LRAP: 0.0819 NDCG: 0.2736
val Loss: 3.1014 LRAP: 0.0826 NDCG: 0.2800
Validation loss decreased (3.246256 --> 3.101397).  Saving model ...

Epoch 12/99
----------
train Loss: 2.9617 LRAP: 0.0847 NDCG: 0.2762
val Loss: 3.2570 LRAP: 0.0686 NDCG: 0.2652
EarlyStopping counter: 1 out of 50

Epoch 13/99
----------
train Loss: 2.9452 LRAP: 0.0885 NDCG: 0.2784
val Loss: 3.1569 LRAP: 0.1118 NDCG: 0.2764
EarlyStopping counter: 2 out of 50

Epoch 14/99
----------
train Loss: 2.8719 LRAP: 0.0956 NDCG: 0.2818
val Loss: 2.9780 LRAP: 0.1055 NDCG: 0.2792
Validation loss decreased (3.101397 --> 2.977986).  Saving model ...

Epoch 15/99
----------
train Loss: 2.8897 LRAP: 0.0953 NDCG: 0.2842
val Loss: 3.1075 LRAP: 0.1017 NDCG: 0.2594
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 2.8252 LRAP: 0.1018 NDCG: 0.2868
val Loss: 3.0559 LRAP: 0.0775 NDCG: 0.2810
EarlyStopping counter: 2 out of 50

Epoch 17/99
----------
train Loss: 2.7620 LRAP: 0.0994 NDCG: 0.2922
val Loss: 2.9616 LRAP: 0.0902 NDCG: 0.2759
Validation loss decreased (2.977986 --> 2.961644).  Saving model ...

Epoch 18/99
----------
train Loss: 2.7408 LRAP: 0.1059 NDCG: 0.2952
val Loss: 3.1193 LRAP: 0.1131 NDCG: 0.2674
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 2.7194 LRAP: 0.1002 NDCG: 0.2948
val Loss: 3.1788 LRAP: 0.1080 NDCG: 0.2427
EarlyStopping counter: 2 out of 50

Epoch 20/99
----------
train Loss: 2.6900 LRAP: 0.1024 NDCG: 0.2946
val Loss: 2.8192 LRAP: 0.1093 NDCG: 0.3038
Validation loss decreased (2.961644 --> 2.819197).  Saving model ...

Epoch 21/99
----------
train Loss: 2.6772 LRAP: 0.0977 NDCG: 0.2980
val Loss: 2.9750 LRAP: 0.1144 NDCG: 0.2715
EarlyStopping counter: 1 out of 50

Epoch 22/99
----------
train Loss: 2.6429 LRAP: 0.1007 NDCG: 0.2986
val Loss: 2.8648 LRAP: 0.1080 NDCG: 0.3042
EarlyStopping counter: 2 out of 50

Epoch 23/99
----------
train Loss: 2.6009 LRAP: 0.1021 NDCG: 0.3028
val Loss: 2.7161 LRAP: 0.1042 NDCG: 0.3048
Validation loss decreased (2.819197 --> 2.716087).  Saving model ...

Epoch 24/99
----------
train Loss: 2.5615 LRAP: 0.0983 NDCG: 0.3062
val Loss: 2.7728 LRAP: 0.1220 NDCG: 0.3027
EarlyStopping counter: 1 out of 50

Epoch 25/99
----------
train Loss: 2.5453 LRAP: 0.1045 NDCG: 0.3101
val Loss: 2.6914 LRAP: 0.1156 NDCG: 0.3094
Validation loss decreased (2.716087 --> 2.691376).  Saving model ...

Epoch 26/99
----------
train Loss: 2.5239 LRAP: 0.1070 NDCG: 0.3115
val Loss: 2.7564 LRAP: 0.1207 NDCG: 0.3260
EarlyStopping counter: 1 out of 50

Epoch 27/99
----------
train Loss: 2.4856 LRAP: 0.1059 NDCG: 0.3131
val Loss: 2.7745 LRAP: 0.1118 NDCG: 0.3150
EarlyStopping counter: 2 out of 50

Epoch 28/99
----------
train Loss: 2.4540 LRAP: 0.1114 NDCG: 0.3127
val Loss: 2.8139 LRAP: 0.1220 NDCG: 0.3059
EarlyStopping counter: 3 out of 50

Epoch 29/99
----------
train Loss: 2.4371 LRAP: 0.1114 NDCG: 0.3160
val Loss: 2.7602 LRAP: 0.1105 NDCG: 0.3185
EarlyStopping counter: 4 out of 50

Epoch 30/99
----------
train Loss: 2.3927 LRAP: 0.1163 NDCG: 0.3190
val Loss: 2.6814 LRAP: 0.1296 NDCG: 0.3315
Validation loss decreased (2.691376 --> 2.681405).  Saving model ...

Epoch 31/99
----------
train Loss: 2.3588 LRAP: 0.1138 NDCG: 0.3208
val Loss: 2.5874 LRAP: 0.1283 NDCG: 0.3265
Validation loss decreased (2.681405 --> 2.587427).  Saving model ...

Epoch 32/99
----------
train Loss: 2.3577 LRAP: 0.1149 NDCG: 0.3230
val Loss: 2.6763 LRAP: 0.1245 NDCG: 0.3409
EarlyStopping counter: 1 out of 50

Epoch 33/99
----------
train Loss: 2.3377 LRAP: 0.1138 NDCG: 0.3249
val Loss: 2.6017 LRAP: 0.1334 NDCG: 0.3258
EarlyStopping counter: 2 out of 50

Epoch 34/99
----------
train Loss: 2.2983 LRAP: 0.1135 NDCG: 0.3231
val Loss: 2.6085 LRAP: 0.1194 NDCG: 0.3406
EarlyStopping counter: 3 out of 50

Epoch 35/99
----------
train Loss: 2.2655 LRAP: 0.1163 NDCG: 0.3288
val Loss: 2.5425 LRAP: 0.1283 NDCG: 0.3374
Validation loss decreased (2.587427 --> 2.542478).  Saving model ...

Epoch 36/99
----------
train Loss: 2.2649 LRAP: 0.1214 NDCG: 0.3290
val Loss: 2.6683 LRAP: 0.1283 NDCG: 0.3323
EarlyStopping counter: 1 out of 50

Epoch 37/99
----------
train Loss: 2.2434 LRAP: 0.1195 NDCG: 0.3297
val Loss: 2.5464 LRAP: 0.1321 NDCG: 0.3338
EarlyStopping counter: 2 out of 50

Epoch 38/99
----------
train Loss: 2.2156 LRAP: 0.1187 NDCG: 0.3313
val Loss: 2.5748 LRAP: 0.1385 NDCG: 0.3281
EarlyStopping counter: 3 out of 50

Epoch 39/99
----------
train Loss: 2.1826 LRAP: 0.1212 NDCG: 0.3361
val Loss: 2.5545 LRAP: 0.1372 NDCG: 0.3444
EarlyStopping counter: 4 out of 50

Epoch 40/99
----------
train Loss: 2.1448 LRAP: 0.1244 NDCG: 0.3375
val Loss: 2.5636 LRAP: 0.1207 NDCG: 0.3483
EarlyStopping counter: 5 out of 50

Epoch 41/99
----------
train Loss: 2.0713 LRAP: 0.1269 NDCG: 0.3395
val Loss: 2.3986 LRAP: 0.1474 NDCG: 0.3507
Validation loss decreased (2.542478 --> 2.398601).  Saving model ...

Epoch 42/99
----------
train Loss: 2.0403 LRAP: 0.1258 NDCG: 0.3427
val Loss: 2.3862 LRAP: 0.1474 NDCG: 0.3520
Validation loss decreased (2.398601 --> 2.386231).  Saving model ...

Epoch 43/99
----------
train Loss: 2.0278 LRAP: 0.1296 NDCG: 0.3431
val Loss: 2.3845 LRAP: 0.1410 NDCG: 0.3501
Validation loss decreased (2.386231 --> 2.384484).  Saving model ...

Epoch 44/99
----------
train Loss: 1.9981 LRAP: 0.1290 NDCG: 0.3457
val Loss: 2.3698 LRAP: 0.1449 NDCG: 0.3524
Validation loss decreased (2.384484 --> 2.369791).  Saving model ...

Epoch 45/99
----------
train Loss: 1.9962 LRAP: 0.1301 NDCG: 0.3441
val Loss: 2.3725 LRAP: 0.1512 NDCG: 0.3561
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 1.9805 LRAP: 0.1271 NDCG: 0.3454
val Loss: 2.3591 LRAP: 0.1449 NDCG: 0.3546
Validation loss decreased (2.369791 --> 2.359101).  Saving model ...

Epoch 47/99
----------
train Loss: 1.9651 LRAP: 0.1271 NDCG: 0.3461
val Loss: 2.3611 LRAP: 0.1449 NDCG: 0.3543
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 1.9523 LRAP: 0.1293 NDCG: 0.3473
val Loss: 2.3652 LRAP: 0.1410 NDCG: 0.3583
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 1.9455 LRAP: 0.1217 NDCG: 0.3468
val Loss: 2.3673 LRAP: 0.1423 NDCG: 0.3553
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 1.9361 LRAP: 0.1310 NDCG: 0.3471
val Loss: 2.3557 LRAP: 0.1499 NDCG: 0.3663
Validation loss decreased (2.359101 --> 2.355702).  Saving model ...

Epoch 51/99
----------
train Loss: 1.9321 LRAP: 0.1356 NDCG: 0.3498
val Loss: 2.3504 LRAP: 0.1436 NDCG: 0.3608
Validation loss decreased (2.355702 --> 2.350431).  Saving model ...

Epoch 52/99
----------
train Loss: 1.9243 LRAP: 0.1282 NDCG: 0.3492
val Loss: 2.3676 LRAP: 0.1436 NDCG: 0.3620
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 1.9215 LRAP: 0.1285 NDCG: 0.3497
val Loss: 2.3492 LRAP: 0.1410 NDCG: 0.3631
Validation loss decreased (2.350431 --> 2.349241).  Saving model ...

Epoch 54/99
----------
train Loss: 1.8974 LRAP: 0.1290 NDCG: 0.3517
val Loss: 2.3620 LRAP: 0.1512 NDCG: 0.3715
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.8931 LRAP: 0.1244 NDCG: 0.3529
val Loss: 2.3506 LRAP: 0.1487 NDCG: 0.3669
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 1.8946 LRAP: 0.1239 NDCG: 0.3518
val Loss: 2.3506 LRAP: 0.1487 NDCG: 0.3722
EarlyStopping counter: 3 out of 50

Epoch 57/99
----------
train Loss: 1.8877 LRAP: 0.1329 NDCG: 0.3543
val Loss: 2.3315 LRAP: 0.1474 NDCG: 0.3687
Validation loss decreased (2.349241 --> 2.331450).  Saving model ...

Epoch 58/99
----------
train Loss: 1.8636 LRAP: 0.1318 NDCG: 0.3559
val Loss: 2.3319 LRAP: 0.1499 NDCG: 0.3668
EarlyStopping counter: 1 out of 50

Epoch 59/99
----------
train Loss: 1.8573 LRAP: 0.1337 NDCG: 0.3557
val Loss: 2.3542 LRAP: 0.1487 NDCG: 0.3769
EarlyStopping counter: 2 out of 50

Epoch 60/99
----------
train Loss: 1.8545 LRAP: 0.1307 NDCG: 0.3569
val Loss: 2.3269 LRAP: 0.1474 NDCG: 0.3735
Validation loss decreased (2.331450 --> 2.326923).  Saving model ...

Epoch 61/99
----------
train Loss: 1.8687 LRAP: 0.1288 NDCG: 0.3570
val Loss: 2.3490 LRAP: 0.1487 NDCG: 0.3866
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 1.8458 LRAP: 0.1241 NDCG: 0.3578
val Loss: 2.3241 LRAP: 0.1563 NDCG: 0.3804
Validation loss decreased (2.326923 --> 2.324094).  Saving model ...

Epoch 63/99
----------
train Loss: 1.8376 LRAP: 0.1323 NDCG: 0.3582
val Loss: 2.3465 LRAP: 0.1525 NDCG: 0.3804
EarlyStopping counter: 1 out of 50

Epoch 64/99
----------
train Loss: 1.8166 LRAP: 0.1323 NDCG: 0.3618
val Loss: 2.3406 LRAP: 0.1525 NDCG: 0.3762
EarlyStopping counter: 2 out of 50

Epoch 65/99
----------
train Loss: 1.8158 LRAP: 0.1296 NDCG: 0.3619
val Loss: 2.3108 LRAP: 0.1576 NDCG: 0.3777
Validation loss decreased (2.324094 --> 2.310817).  Saving model ...

Epoch 66/99
----------
train Loss: 1.8172 LRAP: 0.1288 NDCG: 0.3628
val Loss: 2.3205 LRAP: 0.1525 NDCG: 0.3787
EarlyStopping counter: 1 out of 50

Epoch 67/99
----------
train Loss: 1.8011 LRAP: 0.1326 NDCG: 0.3620
val Loss: 2.3362 LRAP: 0.1576 NDCG: 0.3843
EarlyStopping counter: 2 out of 50

Epoch 68/99
----------
train Loss: 1.7812 LRAP: 0.1364 NDCG: 0.3637
val Loss: 2.3343 LRAP: 0.1563 NDCG: 0.3783
EarlyStopping counter: 3 out of 50

Epoch 69/99
----------
train Loss: 1.7784 LRAP: 0.1348 NDCG: 0.3638
val Loss: 2.3032 LRAP: 0.1614 NDCG: 0.3824
Validation loss decreased (2.310817 --> 2.303237).  Saving model ...

Epoch 70/99
----------
train Loss: 1.7884 LRAP: 0.1356 NDCG: 0.3634
val Loss: 2.3057 LRAP: 0.1563 NDCG: 0.3898
EarlyStopping counter: 1 out of 50

Epoch 71/99
----------
train Loss: 1.7621 LRAP: 0.1331 NDCG: 0.3675
val Loss: 2.3184 LRAP: 0.1626 NDCG: 0.3869
EarlyStopping counter: 2 out of 50

Epoch 72/99
----------
train Loss: 1.7767 LRAP: 0.1361 NDCG: 0.3637
val Loss: 2.3169 LRAP: 0.1665 NDCG: 0.3885
EarlyStopping counter: 3 out of 50

Epoch 73/99
----------
train Loss: 1.7573 LRAP: 0.1320 NDCG: 0.3651
val Loss: 2.3017 LRAP: 0.1563 NDCG: 0.3827
Validation loss decreased (2.303237 --> 2.301715).  Saving model ...

Epoch 74/99
----------
train Loss: 1.7396 LRAP: 0.1364 NDCG: 0.3671
val Loss: 2.2832 LRAP: 0.1563 NDCG: 0.3832
Validation loss decreased (2.301715 --> 2.283191).  Saving model ...

Epoch 75/99
----------
train Loss: 1.7436 LRAP: 0.1331 NDCG: 0.3686
val Loss: 2.2912 LRAP: 0.1652 NDCG: 0.3906
EarlyStopping counter: 1 out of 50

Epoch 76/99
----------
train Loss: 1.7307 LRAP: 0.1367 NDCG: 0.3696
val Loss: 2.3114 LRAP: 0.1639 NDCG: 0.3872
EarlyStopping counter: 2 out of 50

Epoch 77/99
----------
train Loss: 1.7352 LRAP: 0.1334 NDCG: 0.3676
val Loss: 2.3020 LRAP: 0.1703 NDCG: 0.3913
EarlyStopping counter: 3 out of 50

Epoch 78/99
----------
train Loss: 1.7155 LRAP: 0.1361 NDCG: 0.3705
val Loss: 2.3245 LRAP: 0.1703 NDCG: 0.3973
EarlyStopping counter: 4 out of 50

Epoch 79/99
----------
train Loss: 1.7109 LRAP: 0.1380 NDCG: 0.3713
val Loss: 2.3327 LRAP: 0.1537 NDCG: 0.3880
EarlyStopping counter: 5 out of 50

Epoch 80/99
----------
train Loss: 1.6786 LRAP: 0.1337 NDCG: 0.3711
val Loss: 2.2887 LRAP: 0.1665 NDCG: 0.3958
EarlyStopping counter: 6 out of 50

Epoch 81/99
----------
train Loss: 1.6825 LRAP: 0.1369 NDCG: 0.3716
val Loss: 2.2804 LRAP: 0.1690 NDCG: 0.4008
Validation loss decreased (2.283191 --> 2.280412).  Saving model ...

Epoch 82/99
----------
train Loss: 1.6675 LRAP: 0.1408 NDCG: 0.3732
val Loss: 2.2841 LRAP: 0.1677 NDCG: 0.4007
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 1.6881 LRAP: 0.1424 NDCG: 0.3722
val Loss: 2.2880 LRAP: 0.1677 NDCG: 0.4022
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 1.6534 LRAP: 0.1361 NDCG: 0.3739
val Loss: 2.2898 LRAP: 0.1665 NDCG: 0.4008
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 1.6563 LRAP: 0.1340 NDCG: 0.3723
val Loss: 2.2878 LRAP: 0.1728 NDCG: 0.4056
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 1.6624 LRAP: 0.1277 NDCG: 0.3725
val Loss: 2.2878 LRAP: 0.1677 NDCG: 0.4012
EarlyStopping counter: 5 out of 50

Epoch 87/99
----------
train Loss: 1.6573 LRAP: 0.1397 NDCG: 0.3740
val Loss: 2.2920 LRAP: 0.1677 NDCG: 0.4023
EarlyStopping counter: 6 out of 50

Epoch 88/99
----------
train Loss: 1.6577 LRAP: 0.1386 NDCG: 0.3720
val Loss: 2.2838 LRAP: 0.1677 NDCG: 0.4007
EarlyStopping counter: 7 out of 50

Epoch 89/99
----------
train Loss: 1.6607 LRAP: 0.1383 NDCG: 0.3724
val Loss: 2.2852 LRAP: 0.1677 NDCG: 0.3989
EarlyStopping counter: 8 out of 50

Epoch 90/99
----------
train Loss: 1.6602 LRAP: 0.1375 NDCG: 0.3720
val Loss: 2.2881 LRAP: 0.1715 NDCG: 0.4021
EarlyStopping counter: 9 out of 50

Epoch 91/99
----------
train Loss: 1.6483 LRAP: 0.1372 NDCG: 0.3751
val Loss: 2.2864 LRAP: 0.1677 NDCG: 0.3998
EarlyStopping counter: 10 out of 50

Epoch 92/99
----------
train Loss: 1.6512 LRAP: 0.1372 NDCG: 0.3751
val Loss: 2.2837 LRAP: 0.1715 NDCG: 0.4010
EarlyStopping counter: 11 out of 50

Epoch 93/99
----------
train Loss: 1.6525 LRAP: 0.1361 NDCG: 0.3738
val Loss: 2.2898 LRAP: 0.1677 NDCG: 0.4020
EarlyStopping counter: 12 out of 50

Epoch 94/99
----------
train Loss: 1.6657 LRAP: 0.1372 NDCG: 0.3709
val Loss: 2.2832 LRAP: 0.1677 NDCG: 0.3977
EarlyStopping counter: 13 out of 50

Epoch 95/99
----------
train Loss: 1.6384 LRAP: 0.1410 NDCG: 0.3748
val Loss: 2.2895 LRAP: 0.1690 NDCG: 0.4007
EarlyStopping counter: 14 out of 50

Epoch 96/99
----------
train Loss: 1.6394 LRAP: 0.1440 NDCG: 0.3725
val Loss: 2.2847 LRAP: 0.1677 NDCG: 0.4015
EarlyStopping counter: 15 out of 50

Epoch 97/99
----------
train Loss: 1.6626 LRAP: 0.1378 NDCG: 0.3726
val Loss: 2.2880 LRAP: 0.1677 NDCG: 0.4030
EarlyStopping counter: 16 out of 50

Epoch 98/99
----------
train Loss: 1.6364 LRAP: 0.1438 NDCG: 0.3765
val Loss: 2.2903 LRAP: 0.1665 NDCG: 0.4007
EarlyStopping counter: 17 out of 50

Epoch 99/99
----------
train Loss: 1.6567 LRAP: 0.1399 NDCG: 0.3768
val Loss: 2.2867 LRAP: 0.1677 NDCG: 0.4015
EarlyStopping counter: 18 out of 50

Training complete in 2m 29s
Best val loss: 2.280412, best LRAP score: 0.7729

----------------
Running configuration: baseline_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'random' initialization method (training from scratch).
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.4886 LRAP: 0.0000 NDCG: 0.1751
val Loss: 4.5479 LRAP: 0.0000 NDCG: 0.1799
Validation loss decreased (0.000000 --> 4.547896).  Saving model ...

Epoch 1/99
----------
train Loss: 3.8851 LRAP: 0.0016 NDCG: 0.1991
val Loss: 4.6873 LRAP: 0.0064 NDCG: 0.2455
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.7379 LRAP: 0.0044 NDCG: 0.2196
val Loss: 3.9797 LRAP: 0.0064 NDCG: 0.2296
Validation loss decreased (4.547896 --> 3.979695).  Saving model ...

Epoch 3/99
----------
train Loss: 3.6413 LRAP: 0.0139 NDCG: 0.2255
val Loss: 3.7182 LRAP: 0.0076 NDCG: 0.2352
Validation loss decreased (3.979695 --> 3.718171).  Saving model ...

Epoch 4/99
----------
train Loss: 3.5383 LRAP: 0.0172 NDCG: 0.2294
val Loss: 3.7603 LRAP: 0.0064 NDCG: 0.2192
EarlyStopping counter: 1 out of 50

Epoch 5/99
----------
train Loss: 3.4484 LRAP: 0.0308 NDCG: 0.2390
val Loss: 4.6034 LRAP: 0.0152 NDCG: 0.2395
EarlyStopping counter: 2 out of 50

Epoch 6/99
----------
train Loss: 3.3933 LRAP: 0.0476 NDCG: 0.2421
val Loss: 3.9192 LRAP: 0.0305 NDCG: 0.2365
EarlyStopping counter: 3 out of 50

Epoch 7/99
----------
train Loss: 3.3034 LRAP: 0.0553 NDCG: 0.2455
val Loss: 3.3864 LRAP: 0.0953 NDCG: 0.2440
Validation loss decreased (3.718171 --> 3.386417).  Saving model ...

Epoch 8/99
----------
train Loss: 3.2706 LRAP: 0.0566 NDCG: 0.2497
val Loss: 4.1811 LRAP: 0.0788 NDCG: 0.2508
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.2198 LRAP: 0.0580 NDCG: 0.2578
val Loss: 3.5004 LRAP: 0.0826 NDCG: 0.2382
EarlyStopping counter: 2 out of 50

Epoch 10/99
----------
train Loss: 3.1753 LRAP: 0.0596 NDCG: 0.2588
val Loss: 3.4265 LRAP: 0.0978 NDCG: 0.2678
EarlyStopping counter: 3 out of 50

Epoch 11/99
----------
train Loss: 3.1314 LRAP: 0.0662 NDCG: 0.2640
val Loss: 3.1204 LRAP: 0.0686 NDCG: 0.2619
Validation loss decreased (3.386417 --> 3.120418).  Saving model ...

Epoch 12/99
----------
train Loss: 3.0855 LRAP: 0.0515 NDCG: 0.2661
val Loss: 3.0721 LRAP: 0.0635 NDCG: 0.2721
Validation loss decreased (3.120418 --> 3.072088).  Saving model ...

Epoch 13/99
----------
train Loss: 3.0553 LRAP: 0.0806 NDCG: 0.2694
val Loss: 3.2139 LRAP: 0.0940 NDCG: 0.2864
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.0440 LRAP: 0.0819 NDCG: 0.2724
val Loss: 3.2769 LRAP: 0.0673 NDCG: 0.2623
EarlyStopping counter: 2 out of 50

Epoch 15/99
----------
train Loss: 2.9835 LRAP: 0.0670 NDCG: 0.2768
val Loss: 3.0872 LRAP: 0.0496 NDCG: 0.2675
EarlyStopping counter: 3 out of 50

Epoch 16/99
----------
train Loss: 2.9257 LRAP: 0.0716 NDCG: 0.2806
val Loss: 2.9922 LRAP: 0.0902 NDCG: 0.2941
Validation loss decreased (3.072088 --> 2.992227).  Saving model ...

Epoch 17/99
----------
train Loss: 2.9050 LRAP: 0.0656 NDCG: 0.2854
val Loss: 3.0655 LRAP: 0.0966 NDCG: 0.2848
EarlyStopping counter: 1 out of 50

Epoch 18/99
----------
train Loss: 2.8897 LRAP: 0.0749 NDCG: 0.2839
val Loss: 3.0307 LRAP: 0.0978 NDCG: 0.2903
EarlyStopping counter: 2 out of 50

Epoch 19/99
----------
train Loss: 2.8371 LRAP: 0.0770 NDCG: 0.2872
val Loss: 2.9799 LRAP: 0.0737 NDCG: 0.2896
Validation loss decreased (2.992227 --> 2.979915).  Saving model ...

Epoch 20/99
----------
train Loss: 2.7987 LRAP: 0.0847 NDCG: 0.2899
val Loss: 3.2841 LRAP: 0.0877 NDCG: 0.3013
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 2.7740 LRAP: 0.0798 NDCG: 0.2934
val Loss: 2.9746 LRAP: 0.0889 NDCG: 0.2913
Validation loss decreased (2.979915 --> 2.974603).  Saving model ...

Epoch 22/99
----------
train Loss: 2.7577 LRAP: 0.0844 NDCG: 0.2960
val Loss: 2.8337 LRAP: 0.1080 NDCG: 0.3088
Validation loss decreased (2.974603 --> 2.833662).  Saving model ...

Epoch 23/99
----------
train Loss: 2.7191 LRAP: 0.0787 NDCG: 0.2974
val Loss: 2.9139 LRAP: 0.1080 NDCG: 0.2891
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 2.6894 LRAP: 0.0828 NDCG: 0.3009
val Loss: 2.8087 LRAP: 0.1004 NDCG: 0.3042
Validation loss decreased (2.833662 --> 2.808716).  Saving model ...

Epoch 25/99
----------
train Loss: 2.6395 LRAP: 0.0907 NDCG: 0.3054
val Loss: 2.9966 LRAP: 0.1017 NDCG: 0.2805
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 2.6205 LRAP: 0.0912 NDCG: 0.3046
val Loss: 2.9730 LRAP: 0.0775 NDCG: 0.3012
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 2.5943 LRAP: 0.0964 NDCG: 0.3096
val Loss: 2.7894 LRAP: 0.1131 NDCG: 0.3243
Validation loss decreased (2.808716 --> 2.789425).  Saving model ...

Epoch 28/99
----------
train Loss: 2.5536 LRAP: 0.0969 NDCG: 0.3125
val Loss: 2.9345 LRAP: 0.1017 NDCG: 0.2951
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 2.5391 LRAP: 0.1005 NDCG: 0.3114
val Loss: 2.7595 LRAP: 0.1156 NDCG: 0.3165
Validation loss decreased (2.789425 --> 2.759519).  Saving model ...

Epoch 30/99
----------
train Loss: 2.4891 LRAP: 0.1026 NDCG: 0.3155
val Loss: 2.7405 LRAP: 0.1055 NDCG: 0.3189
Validation loss decreased (2.759519 --> 2.740470).  Saving model ...

Epoch 31/99
----------
train Loss: 2.4844 LRAP: 0.0975 NDCG: 0.3168
val Loss: 2.7521 LRAP: 0.1220 NDCG: 0.3202
EarlyStopping counter: 1 out of 50

Epoch 32/99
----------
train Loss: 2.4544 LRAP: 0.1018 NDCG: 0.3184
val Loss: 2.8305 LRAP: 0.1258 NDCG: 0.3138
EarlyStopping counter: 2 out of 50

Epoch 33/99
----------
train Loss: 2.4545 LRAP: 0.1029 NDCG: 0.3191
val Loss: 2.6397 LRAP: 0.1271 NDCG: 0.3237
Validation loss decreased (2.740470 --> 2.639737).  Saving model ...

Epoch 34/99
----------
train Loss: 2.3962 LRAP: 0.1021 NDCG: 0.3222
val Loss: 2.7179 LRAP: 0.1169 NDCG: 0.3381
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 2.3968 LRAP: 0.1032 NDCG: 0.3242
val Loss: 2.8256 LRAP: 0.1334 NDCG: 0.3448
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 2.3640 LRAP: 0.1084 NDCG: 0.3263
val Loss: 2.6566 LRAP: 0.1398 NDCG: 0.3398
EarlyStopping counter: 3 out of 50

Epoch 37/99
----------
train Loss: 2.3181 LRAP: 0.1024 NDCG: 0.3260
val Loss: 2.6395 LRAP: 0.1169 NDCG: 0.3327
Validation loss decreased (2.639737 --> 2.639471).  Saving model ...

Epoch 38/99
----------
train Loss: 2.3094 LRAP: 0.1078 NDCG: 0.3323
val Loss: 2.6023 LRAP: 0.1220 NDCG: 0.3350
Validation loss decreased (2.639471 --> 2.602263).  Saving model ...

Epoch 39/99
----------
train Loss: 2.2970 LRAP: 0.1056 NDCG: 0.3305
val Loss: 2.7029 LRAP: 0.1194 NDCG: 0.3306
EarlyStopping counter: 1 out of 50

Epoch 40/99
----------
train Loss: 2.2670 LRAP: 0.1127 NDCG: 0.3320
val Loss: 2.7609 LRAP: 0.1271 NDCG: 0.3490
EarlyStopping counter: 2 out of 50

Epoch 41/99
----------
train Loss: 2.2568 LRAP: 0.1143 NDCG: 0.3349
val Loss: 2.5876 LRAP: 0.1309 NDCG: 0.3411
Validation loss decreased (2.602263 --> 2.587588).  Saving model ...

Epoch 42/99
----------
train Loss: 2.2375 LRAP: 0.1092 NDCG: 0.3350
val Loss: 2.5821 LRAP: 0.1309 NDCG: 0.3417
Validation loss decreased (2.587588 --> 2.582093).  Saving model ...

Epoch 43/99
----------
train Loss: 2.1838 LRAP: 0.1067 NDCG: 0.3398
val Loss: 2.5197 LRAP: 0.1410 NDCG: 0.3627
Validation loss decreased (2.582093 --> 2.519735).  Saving model ...

Epoch 44/99
----------
train Loss: 2.1552 LRAP: 0.1051 NDCG: 0.3384
val Loss: 2.5027 LRAP: 0.1398 NDCG: 0.3630
Validation loss decreased (2.519735 --> 2.502742).  Saving model ...

Epoch 45/99
----------
train Loss: 2.1441 LRAP: 0.1105 NDCG: 0.3428
val Loss: 2.5300 LRAP: 0.1487 NDCG: 0.3586
EarlyStopping counter: 1 out of 50

Epoch 46/99
----------
train Loss: 2.1210 LRAP: 0.1086 NDCG: 0.3437
val Loss: 2.5081 LRAP: 0.1474 NDCG: 0.3655
EarlyStopping counter: 2 out of 50

Epoch 47/99
----------
train Loss: 2.0822 LRAP: 0.1122 NDCG: 0.3457
val Loss: 2.5737 LRAP: 0.1360 NDCG: 0.3552
EarlyStopping counter: 3 out of 50

Epoch 48/99
----------
train Loss: 2.0839 LRAP: 0.1097 NDCG: 0.3471
val Loss: 2.5732 LRAP: 0.1334 NDCG: 0.3630
EarlyStopping counter: 4 out of 50

Epoch 49/99
----------
train Loss: 2.0566 LRAP: 0.1165 NDCG: 0.3498
val Loss: 2.4818 LRAP: 0.1309 NDCG: 0.3648
Validation loss decreased (2.502742 --> 2.481806).  Saving model ...

Epoch 50/99
----------
train Loss: 2.0507 LRAP: 0.1094 NDCG: 0.3499
val Loss: 2.4688 LRAP: 0.1360 NDCG: 0.3650
Validation loss decreased (2.481806 --> 2.468821).  Saving model ...

Epoch 51/99
----------
train Loss: 2.0169 LRAP: 0.1157 NDCG: 0.3481
val Loss: 2.5250 LRAP: 0.1372 NDCG: 0.3561
EarlyStopping counter: 1 out of 50

Epoch 52/99
----------
train Loss: 2.0116 LRAP: 0.1163 NDCG: 0.3515
val Loss: 2.4521 LRAP: 0.1525 NDCG: 0.3763
Validation loss decreased (2.468821 --> 2.452081).  Saving model ...

Epoch 53/99
----------
train Loss: 1.9647 LRAP: 0.1135 NDCG: 0.3545
val Loss: 2.4336 LRAP: 0.1461 NDCG: 0.3725
Validation loss decreased (2.452081 --> 2.433607).  Saving model ...

Epoch 54/99
----------
train Loss: 1.9401 LRAP: 0.1111 NDCG: 0.3581
val Loss: 2.5667 LRAP: 0.1474 NDCG: 0.3899
EarlyStopping counter: 1 out of 50

Epoch 55/99
----------
train Loss: 1.9832 LRAP: 0.1116 NDCG: 0.3533
val Loss: 2.4808 LRAP: 0.1487 NDCG: 0.3575
EarlyStopping counter: 2 out of 50

Epoch 56/99
----------
train Loss: 1.9205 LRAP: 0.1184 NDCG: 0.3627
val Loss: 2.4726 LRAP: 0.1537 NDCG: 0.3813
EarlyStopping counter: 3 out of 50

Epoch 57/99
----------
train Loss: 1.9320 LRAP: 0.1133 NDCG: 0.3620
val Loss: 2.5275 LRAP: 0.1576 NDCG: 0.3607
EarlyStopping counter: 4 out of 50

Epoch 58/99
----------
train Loss: 1.9115 LRAP: 0.1168 NDCG: 0.3605
val Loss: 2.5462 LRAP: 0.1436 NDCG: 0.3684
EarlyStopping counter: 5 out of 50

Epoch 59/99
----------
train Loss: 1.8119 LRAP: 0.1176 NDCG: 0.3616
val Loss: 2.3367 LRAP: 0.1614 NDCG: 0.3913
Validation loss decreased (2.433607 --> 2.336676).  Saving model ...

Epoch 60/99
----------
train Loss: 1.7545 LRAP: 0.1195 NDCG: 0.3671
val Loss: 2.3235 LRAP: 0.1614 NDCG: 0.3881
Validation loss decreased (2.336676 --> 2.323506).  Saving model ...

Epoch 61/99
----------
train Loss: 1.7485 LRAP: 0.1244 NDCG: 0.3674
val Loss: 2.3201 LRAP: 0.1614 NDCG: 0.3914
Validation loss decreased (2.323506 --> 2.320105).  Saving model ...

Epoch 62/99
----------
train Loss: 1.7324 LRAP: 0.1252 NDCG: 0.3693
val Loss: 2.3203 LRAP: 0.1614 NDCG: 0.3932
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 1.7045 LRAP: 0.1203 NDCG: 0.3701
val Loss: 2.3219 LRAP: 0.1601 NDCG: 0.3959
EarlyStopping counter: 2 out of 50

Epoch 64/99
----------
train Loss: 1.6981 LRAP: 0.1263 NDCG: 0.3717
val Loss: 2.3180 LRAP: 0.1614 NDCG: 0.3918
Validation loss decreased (2.320105 --> 2.318015).  Saving model ...

Epoch 65/99
----------
train Loss: 1.6993 LRAP: 0.1203 NDCG: 0.3700
val Loss: 2.3239 LRAP: 0.1626 NDCG: 0.3973
EarlyStopping counter: 1 out of 50

Epoch 66/99
----------
train Loss: 1.6804 LRAP: 0.1231 NDCG: 0.3699
val Loss: 2.3139 LRAP: 0.1677 NDCG: 0.3972
Validation loss decreased (2.318015 --> 2.313891).  Saving model ...

Epoch 67/99
----------
train Loss: 1.6785 LRAP: 0.1241 NDCG: 0.3729
val Loss: 2.3274 LRAP: 0.1690 NDCG: 0.3999
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 1.6773 LRAP: 0.1307 NDCG: 0.3727
val Loss: 2.3115 LRAP: 0.1639 NDCG: 0.3998
Validation loss decreased (2.313891 --> 2.311535).  Saving model ...

Epoch 69/99
----------
train Loss: 1.6548 LRAP: 0.1258 NDCG: 0.3734
val Loss: 2.3010 LRAP: 0.1639 NDCG: 0.3978
Validation loss decreased (2.311535 --> 2.301037).  Saving model ...

Epoch 70/99
----------
train Loss: 1.6517 LRAP: 0.1258 NDCG: 0.3718
val Loss: 2.3188 LRAP: 0.1715 NDCG: 0.4032
EarlyStopping counter: 1 out of 50

Epoch 71/99
----------
train Loss: 1.6361 LRAP: 0.1258 NDCG: 0.3728
val Loss: 2.3188 LRAP: 0.1715 NDCG: 0.4018
EarlyStopping counter: 2 out of 50

Epoch 72/99
----------
train Loss: 1.6387 LRAP: 0.1269 NDCG: 0.3756
val Loss: 2.3180 LRAP: 0.1677 NDCG: 0.4061
EarlyStopping counter: 3 out of 50

Epoch 73/99
----------
train Loss: 1.6272 LRAP: 0.1206 NDCG: 0.3738
val Loss: 2.3184 LRAP: 0.1677 NDCG: 0.3999
EarlyStopping counter: 4 out of 50

Epoch 74/99
----------
train Loss: 1.6191 LRAP: 0.1312 NDCG: 0.3764
val Loss: 2.3062 LRAP: 0.1626 NDCG: 0.4101
EarlyStopping counter: 5 out of 50

Epoch 75/99
----------
train Loss: 1.6190 LRAP: 0.1296 NDCG: 0.3768
val Loss: 2.3022 LRAP: 0.1703 NDCG: 0.4096
EarlyStopping counter: 6 out of 50

Epoch 76/99
----------
train Loss: 1.6042 LRAP: 0.1231 NDCG: 0.3775
val Loss: 2.3046 LRAP: 0.1690 NDCG: 0.4058
EarlyStopping counter: 7 out of 50

Epoch 77/99
----------
train Loss: 1.6023 LRAP: 0.1228 NDCG: 0.3749
val Loss: 2.3049 LRAP: 0.1703 NDCG: 0.4065
EarlyStopping counter: 8 out of 50

Epoch 78/99
----------
train Loss: 1.5975 LRAP: 0.1274 NDCG: 0.3750
val Loss: 2.3050 LRAP: 0.1703 NDCG: 0.4058
EarlyStopping counter: 9 out of 50

Epoch 79/99
----------
train Loss: 1.5908 LRAP: 0.1329 NDCG: 0.3770
val Loss: 2.3021 LRAP: 0.1703 NDCG: 0.4067
EarlyStopping counter: 10 out of 50

Epoch 80/99
----------
train Loss: 1.5850 LRAP: 0.1326 NDCG: 0.3763
val Loss: 2.3070 LRAP: 0.1753 NDCG: 0.4072
EarlyStopping counter: 11 out of 50

Epoch 81/99
----------
train Loss: 1.5833 LRAP: 0.1304 NDCG: 0.3777
val Loss: 2.3079 LRAP: 0.1741 NDCG: 0.4081
EarlyStopping counter: 12 out of 50

Epoch 82/99
----------
train Loss: 1.5914 LRAP: 0.1296 NDCG: 0.3772
val Loss: 2.3035 LRAP: 0.1753 NDCG: 0.4107
EarlyStopping counter: 13 out of 50

Epoch 83/99
----------
train Loss: 1.5801 LRAP: 0.1266 NDCG: 0.3764
val Loss: 2.3078 LRAP: 0.1728 NDCG: 0.4079
EarlyStopping counter: 14 out of 50

Epoch 84/99
----------
train Loss: 1.5958 LRAP: 0.1269 NDCG: 0.3745
val Loss: 2.3006 LRAP: 0.1728 NDCG: 0.4112
Validation loss decreased (2.301037 --> 2.300613).  Saving model ...

Epoch 85/99
----------
train Loss: 1.6032 LRAP: 0.1217 NDCG: 0.3776
val Loss: 2.3100 LRAP: 0.1753 NDCG: 0.4094
EarlyStopping counter: 1 out of 50

Epoch 86/99
----------
train Loss: 1.5877 LRAP: 0.1236 NDCG: 0.3779
val Loss: 2.3051 LRAP: 0.1703 NDCG: 0.4078
EarlyStopping counter: 2 out of 50

Epoch 87/99
----------
train Loss: 1.5874 LRAP: 0.1214 NDCG: 0.3761
val Loss: 2.3076 LRAP: 0.1741 NDCG: 0.4090
EarlyStopping counter: 3 out of 50

Epoch 88/99
----------
train Loss: 1.5823 LRAP: 0.1269 NDCG: 0.3790
val Loss: 2.3082 LRAP: 0.1766 NDCG: 0.4111
EarlyStopping counter: 4 out of 50

Epoch 89/99
----------
train Loss: 1.5869 LRAP: 0.1304 NDCG: 0.3757
val Loss: 2.3073 LRAP: 0.1715 NDCG: 0.4072
EarlyStopping counter: 5 out of 50

Epoch 90/99
----------
train Loss: 1.5852 LRAP: 0.1261 NDCG: 0.3770
val Loss: 2.3050 LRAP: 0.1741 NDCG: 0.4108
EarlyStopping counter: 6 out of 50

Epoch 91/99
----------
train Loss: 1.5806 LRAP: 0.1290 NDCG: 0.3773
val Loss: 2.3082 LRAP: 0.1715 NDCG: 0.4095
EarlyStopping counter: 7 out of 50

Epoch 92/99
----------
train Loss: 1.5820 LRAP: 0.1290 NDCG: 0.3770
val Loss: 2.3058 LRAP: 0.1728 NDCG: 0.4087
EarlyStopping counter: 8 out of 50

Epoch 93/99
----------
train Loss: 1.5743 LRAP: 0.1323 NDCG: 0.3791
val Loss: 2.3087 LRAP: 0.1741 NDCG: 0.4115
EarlyStopping counter: 9 out of 50

Epoch 94/99
----------
train Loss: 1.5790 LRAP: 0.1182 NDCG: 0.3764
val Loss: 2.3031 LRAP: 0.1741 NDCG: 0.4123
EarlyStopping counter: 10 out of 50

Epoch 95/99
----------
train Loss: 1.5702 LRAP: 0.1285 NDCG: 0.3776
val Loss: 2.3064 LRAP: 0.1728 NDCG: 0.4104
EarlyStopping counter: 11 out of 50

Epoch 96/99
----------
train Loss: 1.5582 LRAP: 0.1296 NDCG: 0.3778
val Loss: 2.3083 LRAP: 0.1715 NDCG: 0.4077
EarlyStopping counter: 12 out of 50

Epoch 97/99
----------
train Loss: 1.5755 LRAP: 0.1301 NDCG: 0.3772
val Loss: 2.3079 LRAP: 0.1728 NDCG: 0.4094
EarlyStopping counter: 13 out of 50

Epoch 98/99
----------
train Loss: 1.5936 LRAP: 0.1220 NDCG: 0.3767
val Loss: 2.3044 LRAP: 0.1753 NDCG: 0.4104
EarlyStopping counter: 14 out of 50

Epoch 99/99
----------
train Loss: 1.5723 LRAP: 0.1263 NDCG: 0.3783
val Loss: 2.3064 LRAP: 0.1741 NDCG: 0.4104
EarlyStopping counter: 15 out of 50

Training complete in 2m 27s
Best val loss: 2.300613, best LRAP score: 0.7759

----------------
Running configuration: infused_trainable

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: True.

Epoch 0/99
----------
train Loss: 4.5937 LRAP: 0.0000 NDCG: 0.1681
val Loss: 4.5538 LRAP: 0.0000 NDCG: 0.1424
Validation loss decreased (0.000000 --> 4.553756).  Saving model ...

Epoch 1/99
----------
train Loss: 4.0066 LRAP: 0.0000 NDCG: 0.1998
val Loss: 5.3894 LRAP: 0.0000 NDCG: 0.2065
EarlyStopping counter: 1 out of 50

Epoch 2/99
----------
train Loss: 3.8625 LRAP: 0.0011 NDCG: 0.2089
val Loss: 5.7228 LRAP: 0.0038 NDCG: 0.1865
EarlyStopping counter: 2 out of 50

Epoch 3/99
----------
train Loss: 3.7742 LRAP: 0.0030 NDCG: 0.2132
val Loss: 5.1635 LRAP: 0.0000 NDCG: 0.1669
EarlyStopping counter: 3 out of 50

Epoch 4/99
----------
train Loss: 3.7020 LRAP: 0.0046 NDCG: 0.2146
val Loss: 5.1568 LRAP: 0.0076 NDCG: 0.2138
EarlyStopping counter: 4 out of 50

Epoch 5/99
----------
train Loss: 3.6398 LRAP: 0.0071 NDCG: 0.2167
val Loss: 4.7565 LRAP: 0.0038 NDCG: 0.1814
EarlyStopping counter: 5 out of 50

Epoch 6/99
----------
train Loss: 3.5582 LRAP: 0.0093 NDCG: 0.2213
val Loss: 3.6344 LRAP: 0.0038 NDCG: 0.2131
Validation loss decreased (4.553756 --> 3.634439).  Saving model ...

Epoch 7/99
----------
train Loss: 3.5424 LRAP: 0.0095 NDCG: 0.2218
val Loss: 3.8955 LRAP: 0.0064 NDCG: 0.2332
EarlyStopping counter: 1 out of 50

Epoch 8/99
----------
train Loss: 3.5238 LRAP: 0.0109 NDCG: 0.2237
val Loss: 3.6202 LRAP: 0.0064 NDCG: 0.2219
Validation loss decreased (3.634439 --> 3.620224).  Saving model ...

Epoch 9/99
----------
train Loss: 3.5154 LRAP: 0.0158 NDCG: 0.2231
val Loss: 4.3502 LRAP: 0.0038 NDCG: 0.2148
EarlyStopping counter: 1 out of 50

Epoch 10/99
----------
train Loss: 3.4919 LRAP: 0.0169 NDCG: 0.2252
val Loss: 3.7254 LRAP: 0.0051 NDCG: 0.2346
EarlyStopping counter: 2 out of 50

Epoch 11/99
----------
train Loss: 3.4878 LRAP: 0.0172 NDCG: 0.2257
val Loss: 4.0809 LRAP: 0.0102 NDCG: 0.2074
EarlyStopping counter: 3 out of 50

Epoch 12/99
----------
train Loss: 3.4682 LRAP: 0.0212 NDCG: 0.2274
val Loss: 3.5311 LRAP: 0.0280 NDCG: 0.2246
Validation loss decreased (3.620224 --> 3.531066).  Saving model ...

Epoch 13/99
----------
train Loss: 3.4589 LRAP: 0.0226 NDCG: 0.2264
val Loss: 4.0808 LRAP: 0.0140 NDCG: 0.1923
EarlyStopping counter: 1 out of 50

Epoch 14/99
----------
train Loss: 3.4347 LRAP: 0.0221 NDCG: 0.2302
val Loss: 3.7404 LRAP: 0.0038 NDCG: 0.2218
EarlyStopping counter: 2 out of 50

Epoch 15/99
----------
train Loss: 3.4309 LRAP: 0.0302 NDCG: 0.2315
val Loss: 3.7247 LRAP: 0.0178 NDCG: 0.2229
EarlyStopping counter: 3 out of 50

Epoch 16/99
----------
train Loss: 3.4172 LRAP: 0.0297 NDCG: 0.2318
val Loss: 3.5441 LRAP: 0.0368 NDCG: 0.2330
EarlyStopping counter: 4 out of 50

Epoch 17/99
----------
train Loss: 3.3973 LRAP: 0.0305 NDCG: 0.2305
val Loss: 3.5243 LRAP: 0.0152 NDCG: 0.2322
Validation loss decreased (3.531066 --> 3.524276).  Saving model ...

Epoch 18/99
----------
train Loss: 3.3927 LRAP: 0.0335 NDCG: 0.2340
val Loss: 3.6015 LRAP: 0.0483 NDCG: 0.2174
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 3.3818 LRAP: 0.0376 NDCG: 0.2352
val Loss: 3.4546 LRAP: 0.0114 NDCG: 0.2473
Validation loss decreased (3.524276 --> 3.454554).  Saving model ...

Epoch 20/99
----------
train Loss: 3.3759 LRAP: 0.0400 NDCG: 0.2353
val Loss: 3.6412 LRAP: 0.0267 NDCG: 0.2096
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 3.3538 LRAP: 0.0403 NDCG: 0.2368
val Loss: 3.7537 LRAP: 0.0991 NDCG: 0.2422
EarlyStopping counter: 2 out of 50

Epoch 22/99
----------
train Loss: 3.3481 LRAP: 0.0504 NDCG: 0.2367
val Loss: 4.9917 LRAP: 0.0610 NDCG: 0.2189
EarlyStopping counter: 3 out of 50

Epoch 23/99
----------
train Loss: 3.3439 LRAP: 0.0457 NDCG: 0.2379
val Loss: 4.0759 LRAP: 0.0013 NDCG: 0.2048
EarlyStopping counter: 4 out of 50

Epoch 24/99
----------
train Loss: 3.3442 LRAP: 0.0487 NDCG: 0.2385
val Loss: 3.7081 LRAP: 0.0140 NDCG: 0.2279
EarlyStopping counter: 5 out of 50

Epoch 25/99
----------
train Loss: 3.3198 LRAP: 0.0558 NDCG: 0.2414
val Loss: 3.4166 LRAP: 0.0902 NDCG: 0.2420
Validation loss decreased (3.454554 --> 3.416642).  Saving model ...

Epoch 26/99
----------
train Loss: 3.3163 LRAP: 0.0610 NDCG: 0.2401
val Loss: 3.3477 LRAP: 0.0584 NDCG: 0.2465
Validation loss decreased (3.416642 --> 3.347657).  Saving model ...

Epoch 27/99
----------
train Loss: 3.2949 LRAP: 0.0553 NDCG: 0.2413
val Loss: 3.3507 LRAP: 0.0737 NDCG: 0.2456
EarlyStopping counter: 1 out of 50

Epoch 28/99
----------
train Loss: 3.2949 LRAP: 0.0583 NDCG: 0.2420
val Loss: 3.3927 LRAP: 0.0381 NDCG: 0.2315
EarlyStopping counter: 2 out of 50

Epoch 29/99
----------
train Loss: 3.2909 LRAP: 0.0626 NDCG: 0.2417
val Loss: 3.3771 LRAP: 0.0394 NDCG: 0.2292
EarlyStopping counter: 3 out of 50

Epoch 30/99
----------
train Loss: 3.2974 LRAP: 0.0651 NDCG: 0.2423
val Loss: 3.3527 LRAP: 0.0470 NDCG: 0.2339
EarlyStopping counter: 4 out of 50

Epoch 31/99
----------
train Loss: 3.2955 LRAP: 0.0558 NDCG: 0.2432
val Loss: 3.3929 LRAP: 0.0902 NDCG: 0.2327
EarlyStopping counter: 5 out of 50

Epoch 32/99
----------
train Loss: 3.3046 LRAP: 0.0632 NDCG: 0.2414
val Loss: 3.3322 LRAP: 0.0826 NDCG: 0.2435
Validation loss decreased (3.347657 --> 3.332183).  Saving model ...

Epoch 33/99
----------
train Loss: 3.2852 LRAP: 0.0607 NDCG: 0.2416
val Loss: 3.3304 LRAP: 0.0699 NDCG: 0.2412
Validation loss decreased (3.332183 --> 3.330360).  Saving model ...

Epoch 34/99
----------
train Loss: 3.2801 LRAP: 0.0629 NDCG: 0.2430
val Loss: 3.3313 LRAP: 0.0610 NDCG: 0.2423
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 3.2794 LRAP: 0.0615 NDCG: 0.2430
val Loss: 3.3288 LRAP: 0.0673 NDCG: 0.2413
Validation loss decreased (3.330360 --> 3.328816).  Saving model ...

Epoch 36/99
----------
train Loss: 3.2751 LRAP: 0.0615 NDCG: 0.2436
val Loss: 3.3285 LRAP: 0.0712 NDCG: 0.2412
Validation loss decreased (3.328816 --> 3.328460).  Saving model ...

Epoch 37/99
----------
train Loss: 3.2809 LRAP: 0.0580 NDCG: 0.2424
val Loss: 3.3339 LRAP: 0.0661 NDCG: 0.2385
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 3.2756 LRAP: 0.0615 NDCG: 0.2444
val Loss: 3.3268 LRAP: 0.0712 NDCG: 0.2445
Validation loss decreased (3.328460 --> 3.326781).  Saving model ...

Epoch 39/99
----------
train Loss: 3.2746 LRAP: 0.0618 NDCG: 0.2418
val Loss: 3.3262 LRAP: 0.0699 NDCG: 0.2417
Validation loss decreased (3.326781 --> 3.326218).  Saving model ...

Epoch 40/99
----------
train Loss: 3.2771 LRAP: 0.0572 NDCG: 0.2423
val Loss: 3.3269 LRAP: 0.0699 NDCG: 0.2435
EarlyStopping counter: 1 out of 50

Epoch 41/99
----------
train Loss: 3.2892 LRAP: 0.0599 NDCG: 0.2434
val Loss: 3.3292 LRAP: 0.0661 NDCG: 0.2403
EarlyStopping counter: 2 out of 50

Epoch 42/99
----------
train Loss: 3.2777 LRAP: 0.0591 NDCG: 0.2427
val Loss: 3.3265 LRAP: 0.0712 NDCG: 0.2419
EarlyStopping counter: 3 out of 50

Epoch 43/99
----------
train Loss: 3.2756 LRAP: 0.0607 NDCG: 0.2438
val Loss: 3.3263 LRAP: 0.0712 NDCG: 0.2421
EarlyStopping counter: 4 out of 50

Epoch 44/99
----------
train Loss: 3.2744 LRAP: 0.0574 NDCG: 0.2445
val Loss: 3.3309 LRAP: 0.0712 NDCG: 0.2403
EarlyStopping counter: 5 out of 50

Epoch 45/99
----------
train Loss: 3.2928 LRAP: 0.0623 NDCG: 0.2439
val Loss: 3.3250 LRAP: 0.0699 NDCG: 0.2440
Validation loss decreased (3.326218 --> 3.325000).  Saving model ...

Epoch 46/99
----------
train Loss: 3.2762 LRAP: 0.0604 NDCG: 0.2406
val Loss: 3.3231 LRAP: 0.0712 NDCG: 0.2424
Validation loss decreased (3.325000 --> 3.323096).  Saving model ...

Epoch 47/99
----------
train Loss: 3.2685 LRAP: 0.0599 NDCG: 0.2450
val Loss: 3.3246 LRAP: 0.0686 NDCG: 0.2426
EarlyStopping counter: 1 out of 50

Epoch 48/99
----------
train Loss: 3.2875 LRAP: 0.0604 NDCG: 0.2445
val Loss: 3.3270 LRAP: 0.0686 NDCG: 0.2411
EarlyStopping counter: 2 out of 50

Epoch 49/99
----------
train Loss: 3.2685 LRAP: 0.0585 NDCG: 0.2438
val Loss: 3.3239 LRAP: 0.0724 NDCG: 0.2415
EarlyStopping counter: 3 out of 50

Epoch 50/99
----------
train Loss: 3.2596 LRAP: 0.0640 NDCG: 0.2444
val Loss: 3.3232 LRAP: 0.0724 NDCG: 0.2431
EarlyStopping counter: 4 out of 50

Epoch 51/99
----------
train Loss: 3.2678 LRAP: 0.0555 NDCG: 0.2438
val Loss: 3.3233 LRAP: 0.0712 NDCG: 0.2422
EarlyStopping counter: 5 out of 50

Epoch 52/99
----------
train Loss: 3.2743 LRAP: 0.0623 NDCG: 0.2442
val Loss: 3.3264 LRAP: 0.0813 NDCG: 0.2426
EarlyStopping counter: 6 out of 50

Epoch 53/99
----------
train Loss: 3.2712 LRAP: 0.0640 NDCG: 0.2433
val Loss: 3.3232 LRAP: 0.0712 NDCG: 0.2425
EarlyStopping counter: 7 out of 50

Epoch 54/99
----------
train Loss: 3.2725 LRAP: 0.0591 NDCG: 0.2440
val Loss: 3.3254 LRAP: 0.0686 NDCG: 0.2412
EarlyStopping counter: 8 out of 50

Epoch 55/99
----------
train Loss: 3.2693 LRAP: 0.0594 NDCG: 0.2433
val Loss: 3.3237 LRAP: 0.0724 NDCG: 0.2434
EarlyStopping counter: 9 out of 50

Epoch 56/99
----------
train Loss: 3.2654 LRAP: 0.0564 NDCG: 0.2429
val Loss: 3.3237 LRAP: 0.0712 NDCG: 0.2430
EarlyStopping counter: 10 out of 50

Epoch 57/99
----------
train Loss: 3.2755 LRAP: 0.0615 NDCG: 0.2432
val Loss: 3.3235 LRAP: 0.0712 NDCG: 0.2438
EarlyStopping counter: 11 out of 50

Epoch 58/99
----------
train Loss: 3.2793 LRAP: 0.0558 NDCG: 0.2439
val Loss: 3.3256 LRAP: 0.0813 NDCG: 0.2426
EarlyStopping counter: 12 out of 50

Epoch 59/99
----------
train Loss: 3.2771 LRAP: 0.0618 NDCG: 0.2447
val Loss: 3.3259 LRAP: 0.0699 NDCG: 0.2416
EarlyStopping counter: 13 out of 50

Epoch 60/99
----------
train Loss: 3.2776 LRAP: 0.0629 NDCG: 0.2455
val Loss: 3.3221 LRAP: 0.0712 NDCG: 0.2417
Validation loss decreased (3.323096 --> 3.322123).  Saving model ...

Epoch 61/99
----------
train Loss: 3.2778 LRAP: 0.0588 NDCG: 0.2455
val Loss: 3.3222 LRAP: 0.0712 NDCG: 0.2430
EarlyStopping counter: 1 out of 50

Epoch 62/99
----------
train Loss: 3.2738 LRAP: 0.0591 NDCG: 0.2441
val Loss: 3.3239 LRAP: 0.0699 NDCG: 0.2423
EarlyStopping counter: 2 out of 50

Epoch 63/99
----------
train Loss: 3.2751 LRAP: 0.0610 NDCG: 0.2440
val Loss: 3.3228 LRAP: 0.0724 NDCG: 0.2435
EarlyStopping counter: 3 out of 50

Epoch 64/99
----------
train Loss: 3.2778 LRAP: 0.0539 NDCG: 0.2436
val Loss: 3.3245 LRAP: 0.0699 NDCG: 0.2432
EarlyStopping counter: 4 out of 50

Epoch 65/99
----------
train Loss: 3.2536 LRAP: 0.0626 NDCG: 0.2433
val Loss: 3.3229 LRAP: 0.0712 NDCG: 0.2421
EarlyStopping counter: 5 out of 50

Epoch 66/99
----------
train Loss: 3.2842 LRAP: 0.0591 NDCG: 0.2442
val Loss: 3.3216 LRAP: 0.0673 NDCG: 0.2437
Validation loss decreased (3.322123 --> 3.321602).  Saving model ...

Epoch 67/99
----------
train Loss: 3.2702 LRAP: 0.0602 NDCG: 0.2445
val Loss: 3.3231 LRAP: 0.0673 NDCG: 0.2425
EarlyStopping counter: 1 out of 50

Epoch 68/99
----------
train Loss: 3.2851 LRAP: 0.0613 NDCG: 0.2437
val Loss: 3.3231 LRAP: 0.0712 NDCG: 0.2427
EarlyStopping counter: 2 out of 50

Epoch 69/99
----------
train Loss: 3.2841 LRAP: 0.0553 NDCG: 0.2434
val Loss: 3.3262 LRAP: 0.0699 NDCG: 0.2407
EarlyStopping counter: 3 out of 50

Epoch 70/99
----------
train Loss: 3.2662 LRAP: 0.0643 NDCG: 0.2445
val Loss: 3.3240 LRAP: 0.0712 NDCG: 0.2428
EarlyStopping counter: 4 out of 50

Epoch 71/99
----------
train Loss: 3.2693 LRAP: 0.0577 NDCG: 0.2453
val Loss: 3.3224 LRAP: 0.0712 NDCG: 0.2448
EarlyStopping counter: 5 out of 50

Epoch 72/99
----------
train Loss: 3.2693 LRAP: 0.0585 NDCG: 0.2451
val Loss: 3.3233 LRAP: 0.0762 NDCG: 0.2429
EarlyStopping counter: 6 out of 50

Epoch 73/99
----------
train Loss: 3.2619 LRAP: 0.0618 NDCG: 0.2456
val Loss: 3.3244 LRAP: 0.0712 NDCG: 0.2419
EarlyStopping counter: 7 out of 50

Epoch 74/99
----------
train Loss: 3.2637 LRAP: 0.0629 NDCG: 0.2438
val Loss: 3.3238 LRAP: 0.0699 NDCG: 0.2431
EarlyStopping counter: 8 out of 50

Epoch 75/99
----------
train Loss: 3.2706 LRAP: 0.0623 NDCG: 0.2428
val Loss: 3.3224 LRAP: 0.0712 NDCG: 0.2438
EarlyStopping counter: 9 out of 50

Epoch 76/99
----------
train Loss: 3.2845 LRAP: 0.0534 NDCG: 0.2428
val Loss: 3.3236 LRAP: 0.0712 NDCG: 0.2440
EarlyStopping counter: 10 out of 50

Epoch 77/99
----------
train Loss: 3.2853 LRAP: 0.0607 NDCG: 0.2432
val Loss: 3.3263 LRAP: 0.0801 NDCG: 0.2414
EarlyStopping counter: 11 out of 50

Epoch 78/99
----------
train Loss: 3.2766 LRAP: 0.0580 NDCG: 0.2438
val Loss: 3.3220 LRAP: 0.0712 NDCG: 0.2438
EarlyStopping counter: 12 out of 50

Epoch 79/99
----------
train Loss: 3.2680 LRAP: 0.0604 NDCG: 0.2450
val Loss: 3.3238 LRAP: 0.0673 NDCG: 0.2437
EarlyStopping counter: 13 out of 50

Epoch 80/99
----------
train Loss: 3.2746 LRAP: 0.0596 NDCG: 0.2440
val Loss: 3.3236 LRAP: 0.0712 NDCG: 0.2417
EarlyStopping counter: 14 out of 50

Epoch 81/99
----------
train Loss: 3.2573 LRAP: 0.0632 NDCG: 0.2429
val Loss: 3.3250 LRAP: 0.0699 NDCG: 0.2419
EarlyStopping counter: 15 out of 50

Epoch 82/99
----------
train Loss: 3.2679 LRAP: 0.0610 NDCG: 0.2440
val Loss: 3.3239 LRAP: 0.0712 NDCG: 0.2423
EarlyStopping counter: 16 out of 50

Epoch 83/99
----------
train Loss: 3.2720 LRAP: 0.0618 NDCG: 0.2432
val Loss: 3.3255 LRAP: 0.0737 NDCG: 0.2430
EarlyStopping counter: 17 out of 50

Epoch 84/99
----------
train Loss: 3.2778 LRAP: 0.0621 NDCG: 0.2442
val Loss: 3.3224 LRAP: 0.0712 NDCG: 0.2432
EarlyStopping counter: 18 out of 50

Epoch 85/99
----------
train Loss: 3.2636 LRAP: 0.0629 NDCG: 0.2451
val Loss: 3.3225 LRAP: 0.0673 NDCG: 0.2414
EarlyStopping counter: 19 out of 50

Epoch 86/99
----------
train Loss: 3.2728 LRAP: 0.0615 NDCG: 0.2446
val Loss: 3.3222 LRAP: 0.0673 NDCG: 0.2426
EarlyStopping counter: 20 out of 50

Epoch 87/99
----------
train Loss: 3.2695 LRAP: 0.0623 NDCG: 0.2454
val Loss: 3.3244 LRAP: 0.0737 NDCG: 0.2442
EarlyStopping counter: 21 out of 50

Epoch 88/99
----------
train Loss: 3.2692 LRAP: 0.0607 NDCG: 0.2450
val Loss: 3.3244 LRAP: 0.0801 NDCG: 0.2420
EarlyStopping counter: 22 out of 50

Epoch 89/99
----------
train Loss: 3.2764 LRAP: 0.0618 NDCG: 0.2427
val Loss: 3.3221 LRAP: 0.0699 NDCG: 0.2413
EarlyStopping counter: 23 out of 50

Epoch 90/99
----------
train Loss: 3.2839 LRAP: 0.0615 NDCG: 0.2450
val Loss: 3.3234 LRAP: 0.0699 NDCG: 0.2431
EarlyStopping counter: 24 out of 50

Epoch 91/99
----------
train Loss: 3.2799 LRAP: 0.0596 NDCG: 0.2444
val Loss: 3.3229 LRAP: 0.0712 NDCG: 0.2445
EarlyStopping counter: 25 out of 50

Epoch 92/99
----------
train Loss: 3.2686 LRAP: 0.0634 NDCG: 0.2437
val Loss: 3.3227 LRAP: 0.0801 NDCG: 0.2428
EarlyStopping counter: 26 out of 50

Epoch 93/99
----------
train Loss: 3.2757 LRAP: 0.0683 NDCG: 0.2434
val Loss: 3.3221 LRAP: 0.0699 NDCG: 0.2436
EarlyStopping counter: 27 out of 50

Epoch 94/99
----------
train Loss: 3.2844 LRAP: 0.0599 NDCG: 0.2442
val Loss: 3.3244 LRAP: 0.0712 NDCG: 0.2436
EarlyStopping counter: 28 out of 50

Epoch 95/99
----------
train Loss: 3.2676 LRAP: 0.0629 NDCG: 0.2443
val Loss: 3.3247 LRAP: 0.0737 NDCG: 0.2417
EarlyStopping counter: 29 out of 50

Epoch 96/99
----------
train Loss: 3.2787 LRAP: 0.0599 NDCG: 0.2434
val Loss: 3.3240 LRAP: 0.0712 NDCG: 0.2429
EarlyStopping counter: 30 out of 50

Epoch 97/99
----------
train Loss: 3.2679 LRAP: 0.0550 NDCG: 0.2433
val Loss: 3.3245 LRAP: 0.0750 NDCG: 0.2421
EarlyStopping counter: 31 out of 50

Epoch 98/99
----------
train Loss: 3.2696 LRAP: 0.0569 NDCG: 0.2449
val Loss: 3.3233 LRAP: 0.0699 NDCG: 0.2422
EarlyStopping counter: 32 out of 50

Epoch 99/99
----------
train Loss: 3.2731 LRAP: 0.0596 NDCG: 0.2445
val Loss: 3.3230 LRAP: 0.0673 NDCG: 0.2445
EarlyStopping counter: 33 out of 50

Training complete in 2m 28s
Best val loss: 3.321602, best LRAP score: 0.5552

----------------
Running configuration: infused_fixed

SweetNet model instantiated with lib_size=2565, num_classes=96, hidden_dim=320.
Handling 'external' initialization method.
SweetNet item_embedding layer set to trainable: False.

Epoch 0/99
----------
train Loss: 4.6678 LRAP: 0.0000 NDCG: 0.1640
val Loss: 9.0361 LRAP: 0.0000 NDCG: 0.1823
Validation loss decreased (0.000000 --> 9.036059).  Saving model ...

Epoch 1/99
----------
train Loss: 4.1176 LRAP: 0.0003 NDCG: 0.1798
val Loss: 4.8086 LRAP: 0.0000 NDCG: 0.1925
Validation loss decreased (9.036059 --> 4.808595).  Saving model ...

Epoch 2/99
----------
train Loss: 3.9663 LRAP: 0.0027 NDCG: 0.1970
val Loss: 6.1715 LRAP: 0.0000 NDCG: 0.1377
EarlyStopping counter: 1 out of 50

Epoch 3/99
----------
train Loss: 3.8926 LRAP: 0.0041 NDCG: 0.2056
val Loss: 6.5517 LRAP: 0.0076 NDCG: 0.2061
EarlyStopping counter: 2 out of 50

Epoch 4/99
----------
train Loss: 3.8192 LRAP: 0.0041 NDCG: 0.2075
val Loss: 4.9003 LRAP: 0.0013 NDCG: 0.1863
EarlyStopping counter: 3 out of 50

Epoch 5/99
----------
train Loss: 3.7644 LRAP: 0.0035 NDCG: 0.2120
val Loss: 4.2336 LRAP: 0.0051 NDCG: 0.1810
Validation loss decreased (4.808595 --> 4.233580).  Saving model ...

Epoch 6/99
----------
train Loss: 3.7468 LRAP: 0.0084 NDCG: 0.2123
val Loss: 5.9442 LRAP: 0.0000 NDCG: 0.1562
EarlyStopping counter: 1 out of 50

Epoch 7/99
----------
train Loss: 3.6824 LRAP: 0.0060 NDCG: 0.2171
val Loss: 4.1309 LRAP: 0.0000 NDCG: 0.2214
Validation loss decreased (4.233580 --> 4.130854).  Saving model ...

Epoch 8/99
----------
train Loss: 3.6432 LRAP: 0.0060 NDCG: 0.2218
val Loss: 4.2775 LRAP: 0.0000 NDCG: 0.1678
EarlyStopping counter: 1 out of 50

Epoch 9/99
----------
train Loss: 3.6046 LRAP: 0.0169 NDCG: 0.2216
val Loss: 3.7451 LRAP: 0.0013 NDCG: 0.2193
Validation loss decreased (4.130854 --> 3.745085).  Saving model ...

Epoch 10/99
----------
train Loss: 3.5678 LRAP: 0.0112 NDCG: 0.2242
val Loss: 4.0931 LRAP: 0.0000 NDCG: 0.1953
EarlyStopping counter: 1 out of 50

Epoch 11/99
----------
train Loss: 3.5379 LRAP: 0.0139 NDCG: 0.2271
val Loss: 4.1995 LRAP: 0.0318 NDCG: 0.1735
EarlyStopping counter: 2 out of 50

Epoch 12/99
----------
train Loss: 3.5052 LRAP: 0.0158 NDCG: 0.2305
val Loss: 4.7660 LRAP: 0.0013 NDCG: 0.2114
EarlyStopping counter: 3 out of 50

Epoch 13/99
----------
train Loss: 3.4445 LRAP: 0.0128 NDCG: 0.2307
val Loss: 3.7532 LRAP: 0.0000 NDCG: 0.2343
EarlyStopping counter: 4 out of 50

Epoch 14/99
----------
train Loss: 3.4241 LRAP: 0.0212 NDCG: 0.2346
val Loss: 3.6980 LRAP: 0.0254 NDCG: 0.2231
Validation loss decreased (3.745085 --> 3.698034).  Saving model ...

Epoch 15/99
----------
train Loss: 3.4035 LRAP: 0.0229 NDCG: 0.2352
val Loss: 4.0159 LRAP: 0.0330 NDCG: 0.2040
EarlyStopping counter: 1 out of 50

Epoch 16/99
----------
train Loss: 3.3752 LRAP: 0.0242 NDCG: 0.2375
val Loss: 4.2680 LRAP: 0.0013 NDCG: 0.1994
EarlyStopping counter: 2 out of 50

Epoch 17/99
----------
train Loss: 3.3578 LRAP: 0.0250 NDCG: 0.2375
val Loss: 3.9381 LRAP: 0.0064 NDCG: 0.2385
EarlyStopping counter: 3 out of 50

Epoch 18/99
----------
train Loss: 3.3363 LRAP: 0.0275 NDCG: 0.2410
val Loss: 3.7028 LRAP: 0.0368 NDCG: 0.2348
EarlyStopping counter: 4 out of 50

Epoch 19/99
----------
train Loss: 3.3039 LRAP: 0.0302 NDCG: 0.2416
val Loss: 3.7066 LRAP: 0.0025 NDCG: 0.2208
EarlyStopping counter: 5 out of 50

Epoch 20/99
----------
train Loss: 3.2510 LRAP: 0.0223 NDCG: 0.2452
val Loss: 3.4536 LRAP: 0.0051 NDCG: 0.2375
Validation loss decreased (3.698034 --> 3.453578).  Saving model ...

Epoch 21/99
----------
train Loss: 3.2190 LRAP: 0.0324 NDCG: 0.2452
val Loss: 3.3341 LRAP: 0.0407 NDCG: 0.2377
Validation loss decreased (3.453578 --> 3.334086).  Saving model ...

Epoch 22/99
----------
train Loss: 3.1835 LRAP: 0.0359 NDCG: 0.2491
val Loss: 3.3061 LRAP: 0.0254 NDCG: 0.2410
Validation loss decreased (3.334086 --> 3.306121).  Saving model ...

Epoch 23/99
----------
train Loss: 3.1910 LRAP: 0.0368 NDCG: 0.2496
val Loss: 3.3367 LRAP: 0.0267 NDCG: 0.2476
EarlyStopping counter: 1 out of 50

Epoch 24/99
----------
train Loss: 3.1691 LRAP: 0.0321 NDCG: 0.2484
val Loss: 3.2442 LRAP: 0.0394 NDCG: 0.2457
Validation loss decreased (3.306121 --> 3.244219).  Saving model ...

Epoch 25/99
----------
train Loss: 3.1570 LRAP: 0.0373 NDCG: 0.2484
val Loss: 3.3967 LRAP: 0.0470 NDCG: 0.2332
EarlyStopping counter: 1 out of 50

Epoch 26/99
----------
train Loss: 3.1528 LRAP: 0.0381 NDCG: 0.2499
val Loss: 3.2883 LRAP: 0.0813 NDCG: 0.2514
EarlyStopping counter: 2 out of 50

Epoch 27/99
----------
train Loss: 3.1537 LRAP: 0.0436 NDCG: 0.2512
val Loss: 3.3638 LRAP: 0.0623 NDCG: 0.2327
EarlyStopping counter: 3 out of 50

Epoch 28/99
----------
train Loss: 3.1352 LRAP: 0.0496 NDCG: 0.2517
val Loss: 3.3231 LRAP: 0.0356 NDCG: 0.2472
EarlyStopping counter: 4 out of 50

Epoch 29/99
----------
train Loss: 3.1400 LRAP: 0.0474 NDCG: 0.2496
val Loss: 3.3477 LRAP: 0.0724 NDCG: 0.2480
EarlyStopping counter: 5 out of 50

Epoch 30/99
----------
train Loss: 3.1129 LRAP: 0.0427 NDCG: 0.2528
val Loss: 3.1973 LRAP: 0.0572 NDCG: 0.2480
Validation loss decreased (3.244219 --> 3.197252).  Saving model ...

Epoch 31/99
----------
train Loss: 3.0957 LRAP: 0.0482 NDCG: 0.2540
val Loss: 3.1726 LRAP: 0.0762 NDCG: 0.2514
Validation loss decreased (3.197252 --> 3.172553).  Saving model ...

Epoch 32/99
----------
train Loss: 3.1047 LRAP: 0.0466 NDCG: 0.2521
val Loss: 3.1712 LRAP: 0.0750 NDCG: 0.2509
Validation loss decreased (3.172553 --> 3.171223).  Saving model ...

Epoch 33/99
----------
train Loss: 3.1132 LRAP: 0.0501 NDCG: 0.2527
val Loss: 3.1757 LRAP: 0.0839 NDCG: 0.2508
EarlyStopping counter: 1 out of 50

Epoch 34/99
----------
train Loss: 3.0964 LRAP: 0.0468 NDCG: 0.2528
val Loss: 3.1661 LRAP: 0.0750 NDCG: 0.2493
Validation loss decreased (3.171223 --> 3.166076).  Saving model ...

Epoch 35/99
----------
train Loss: 3.1047 LRAP: 0.0471 NDCG: 0.2516
val Loss: 3.1756 LRAP: 0.0775 NDCG: 0.2482
EarlyStopping counter: 1 out of 50

Epoch 36/99
----------
train Loss: 3.0956 LRAP: 0.0528 NDCG: 0.2526
val Loss: 3.1582 LRAP: 0.0712 NDCG: 0.2522
Validation loss decreased (3.166076 --> 3.158183).  Saving model ...

Epoch 37/99
----------
train Loss: 3.0971 LRAP: 0.0471 NDCG: 0.2539
val Loss: 3.1601 LRAP: 0.0635 NDCG: 0.2534
EarlyStopping counter: 1 out of 50

Epoch 38/99
----------
train Loss: 3.0937 LRAP: 0.0539 NDCG: 0.2534
val Loss: 3.1627 LRAP: 0.0788 NDCG: 0.2537
EarlyStopping counter: 2 out of 50

Epoch 39/99
----------
train Loss: 3.1100 LRAP: 0.0534 NDCG: 0.2523
val Loss: 3.1597 LRAP: 0.0839 NDCG: 0.2527
EarlyStopping counter: 3 out of 50

Epoch 40/99
----------
train Loss: 3.0988 LRAP: 0.0501 NDCG: 0.2534
val Loss: 3.1720 LRAP: 0.0788 NDCG: 0.2496
EarlyStopping counter: 4 out of 50

Epoch 41/99
----------
train Loss: 3.0623 LRAP: 0.0487 NDCG: 0.2525
val Loss: 3.1533 LRAP: 0.0775 NDCG: 0.2523
Validation loss decreased (3.158183 --> 3.153288).  Saving model ...

Epoch 42/99
----------
train Loss: 3.0869 LRAP: 0.0525 NDCG: 0.2559
val Loss: 3.1482 LRAP: 0.0750 NDCG: 0.2517
Validation loss decreased (3.153288 --> 3.148245).  Saving model ...

Epoch 43/99
----------
train Loss: 3.0777 LRAP: 0.0512 NDCG: 0.2538
val Loss: 3.1543 LRAP: 0.0673 NDCG: 0.2518
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 3.0913 LRAP: 0.0487 NDCG: 0.2530
val Loss: 3.1672 LRAP: 0.0801 NDCG: 0.2502
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 3.0761 LRAP: 0.0572 NDCG: 0.2562
val Loss: 3.1475 LRAP: 0.0801 NDCG: 0.2540
Validation loss decreased (3.148245 --> 3.147529).  Saving model ...

Epoch 46/99
----------
train Loss: 3.0681 LRAP: 0.0525 NDCG: 0.2562
val Loss: 3.1477 LRAP: 0.0788 NDCG: 0.2541
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 3.0755 LRAP: 0.0591 NDCG: 0.2550
val Loss: 3.1577 LRAP: 0.0801 NDCG: 0.2501
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 3.0762 LRAP: 0.0542 NDCG: 0.2559
val Loss: 3.1457 LRAP: 0.0775 NDCG: 0.2522
Validation loss decreased (3.147529 --> 3.145732).  Saving model ...

Epoch 49/99
----------
train Loss: 3.0708 LRAP: 0.0517 NDCG: 0.2571
val Loss: 3.1398 LRAP: 0.0762 NDCG: 0.2553
Validation loss decreased (3.145732 --> 3.139835).  Saving model ...

Epoch 50/99
----------
train Loss: 3.0543 LRAP: 0.0536 NDCG: 0.2555
val Loss: 3.1371 LRAP: 0.0813 NDCG: 0.2539
Validation loss decreased (3.139835 --> 3.137090).  Saving model ...

Epoch 51/99
----------
train Loss: 3.0788 LRAP: 0.0558 NDCG: 0.2559
val Loss: 3.1360 LRAP: 0.0813 NDCG: 0.2553
Validation loss decreased (3.137090 --> 3.136031).  Saving model ...

Epoch 52/99
----------
train Loss: 3.0731 LRAP: 0.0487 NDCG: 0.2547
val Loss: 3.1579 LRAP: 0.0813 NDCG: 0.2504
EarlyStopping counter: 1 out of 50

Epoch 53/99
----------
train Loss: 3.0675 LRAP: 0.0504 NDCG: 0.2569
val Loss: 3.1472 LRAP: 0.0864 NDCG: 0.2552
EarlyStopping counter: 2 out of 50

Epoch 54/99
----------
train Loss: 3.0718 LRAP: 0.0602 NDCG: 0.2554
val Loss: 3.1359 LRAP: 0.0813 NDCG: 0.2567
Validation loss decreased (3.136031 --> 3.135912).  Saving model ...

Epoch 55/99
----------
train Loss: 3.0661 LRAP: 0.0545 NDCG: 0.2561
val Loss: 3.1332 LRAP: 0.0826 NDCG: 0.2554
Validation loss decreased (3.135912 --> 3.133204).  Saving model ...

Epoch 56/99
----------
train Loss: 3.0616 LRAP: 0.0564 NDCG: 0.2561
val Loss: 3.1444 LRAP: 0.0839 NDCG: 0.2532
EarlyStopping counter: 1 out of 50

Epoch 57/99
----------
train Loss: 3.0508 LRAP: 0.0523 NDCG: 0.2567
val Loss: 3.1341 LRAP: 0.0813 NDCG: 0.2579
EarlyStopping counter: 2 out of 50

Epoch 58/99
----------
train Loss: 3.0591 LRAP: 0.0596 NDCG: 0.2575
val Loss: 3.1257 LRAP: 0.0775 NDCG: 0.2582
Validation loss decreased (3.133204 --> 3.125748).  Saving model ...

Epoch 59/99
----------
train Loss: 3.0447 LRAP: 0.0591 NDCG: 0.2574
val Loss: 3.1468 LRAP: 0.0864 NDCG: 0.2516
EarlyStopping counter: 1 out of 50

Epoch 60/99
----------
train Loss: 3.0422 LRAP: 0.0545 NDCG: 0.2572
val Loss: 3.1271 LRAP: 0.0813 NDCG: 0.2538
EarlyStopping counter: 2 out of 50

Epoch 61/99
----------
train Loss: 3.0492 LRAP: 0.0585 NDCG: 0.2565
val Loss: 3.1218 LRAP: 0.0839 NDCG: 0.2575
Validation loss decreased (3.125748 --> 3.121809).  Saving model ...

Epoch 62/99
----------
train Loss: 3.0422 LRAP: 0.0574 NDCG: 0.2589
val Loss: 3.1230 LRAP: 0.0864 NDCG: 0.2573
EarlyStopping counter: 1 out of 50

Epoch 63/99
----------
train Loss: 3.0420 LRAP: 0.0550 NDCG: 0.2576
val Loss: 3.1174 LRAP: 0.0762 NDCG: 0.2587
Validation loss decreased (3.121809 --> 3.117422).  Saving model ...

Epoch 64/99
----------
train Loss: 3.0479 LRAP: 0.0618 NDCG: 0.2592
val Loss: 3.1193 LRAP: 0.0864 NDCG: 0.2587
EarlyStopping counter: 1 out of 50

Epoch 65/99
----------
train Loss: 3.0391 LRAP: 0.0525 NDCG: 0.2575
val Loss: 3.1265 LRAP: 0.0826 NDCG: 0.2581
EarlyStopping counter: 2 out of 50

Epoch 66/99
----------
train Loss: 3.0260 LRAP: 0.0550 NDCG: 0.2592
val Loss: 3.1314 LRAP: 0.0826 NDCG: 0.2551
EarlyStopping counter: 3 out of 50

Epoch 67/99
----------
train Loss: 3.0423 LRAP: 0.0588 NDCG: 0.2583
val Loss: 3.1172 LRAP: 0.0826 NDCG: 0.2591
Validation loss decreased (3.117422 --> 3.117191).  Saving model ...

Epoch 68/99
----------
train Loss: 3.0368 LRAP: 0.0615 NDCG: 0.2590
val Loss: 3.1266 LRAP: 0.0826 NDCG: 0.2568
EarlyStopping counter: 1 out of 50

Epoch 69/99
----------
train Loss: 3.0208 LRAP: 0.0585 NDCG: 0.2595
val Loss: 3.1087 LRAP: 0.0813 NDCG: 0.2575
Validation loss decreased (3.117191 --> 3.108734).  Saving model ...

Epoch 70/99
----------
train Loss: 3.0230 LRAP: 0.0613 NDCG: 0.2608
val Loss: 3.1080 LRAP: 0.0864 NDCG: 0.2593
Validation loss decreased (3.108734 --> 3.107984).  Saving model ...

Epoch 71/99
----------
train Loss: 3.0241 LRAP: 0.0539 NDCG: 0.2580
val Loss: 3.1072 LRAP: 0.0839 NDCG: 0.2591
Validation loss decreased (3.107984 --> 3.107166).  Saving model ...

Epoch 72/99
----------
train Loss: 3.0220 LRAP: 0.0604 NDCG: 0.2597
val Loss: 3.1072 LRAP: 0.0813 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 73/99
----------
train Loss: 3.0317 LRAP: 0.0588 NDCG: 0.2585
val Loss: 3.1067 LRAP: 0.0813 NDCG: 0.2581
Validation loss decreased (3.107166 --> 3.106689).  Saving model ...

Epoch 74/99
----------
train Loss: 3.0250 LRAP: 0.0640 NDCG: 0.2602
val Loss: 3.1067 LRAP: 0.0813 NDCG: 0.2588
EarlyStopping counter: 1 out of 50

Epoch 75/99
----------
train Loss: 3.0151 LRAP: 0.0594 NDCG: 0.2593
val Loss: 3.1065 LRAP: 0.0813 NDCG: 0.2595
Validation loss decreased (3.106689 --> 3.106525).  Saving model ...

Epoch 76/99
----------
train Loss: 3.0346 LRAP: 0.0634 NDCG: 0.2586
val Loss: 3.1062 LRAP: 0.0813 NDCG: 0.2592
Validation loss decreased (3.106525 --> 3.106230).  Saving model ...

Epoch 77/99
----------
train Loss: 3.0159 LRAP: 0.0621 NDCG: 0.2591
val Loss: 3.1076 LRAP: 0.0813 NDCG: 0.2567
EarlyStopping counter: 1 out of 50

Epoch 78/99
----------
train Loss: 3.0126 LRAP: 0.0615 NDCG: 0.2603
val Loss: 3.1058 LRAP: 0.0839 NDCG: 0.2588
Validation loss decreased (3.106230 --> 3.105771).  Saving model ...

Epoch 79/99
----------
train Loss: 3.0028 LRAP: 0.0640 NDCG: 0.2620
val Loss: 3.1072 LRAP: 0.0889 NDCG: 0.2600
EarlyStopping counter: 1 out of 50

Epoch 80/99
----------
train Loss: 3.0333 LRAP: 0.0604 NDCG: 0.2601
val Loss: 3.1058 LRAP: 0.0877 NDCG: 0.2595
EarlyStopping counter: 2 out of 50

Epoch 81/99
----------
train Loss: 3.0209 LRAP: 0.0610 NDCG: 0.2605
val Loss: 3.1033 LRAP: 0.0839 NDCG: 0.2595
Validation loss decreased (3.105771 --> 3.103285).  Saving model ...

Epoch 82/99
----------
train Loss: 3.0156 LRAP: 0.0626 NDCG: 0.2592
val Loss: 3.1044 LRAP: 0.0813 NDCG: 0.2598
EarlyStopping counter: 1 out of 50

Epoch 83/99
----------
train Loss: 3.0240 LRAP: 0.0610 NDCG: 0.2591
val Loss: 3.1060 LRAP: 0.0813 NDCG: 0.2591
EarlyStopping counter: 2 out of 50

Epoch 84/99
----------
train Loss: 3.0228 LRAP: 0.0577 NDCG: 0.2580
val Loss: 3.1048 LRAP: 0.0813 NDCG: 0.2595
EarlyStopping counter: 3 out of 50

Epoch 85/99
----------
train Loss: 3.0141 LRAP: 0.0591 NDCG: 0.2598
val Loss: 3.1065 LRAP: 0.0864 NDCG: 0.2600
EarlyStopping counter: 4 out of 50

Epoch 86/99
----------
train Loss: 3.0258 LRAP: 0.0672 NDCG: 0.2600
val Loss: 3.1022 LRAP: 0.0851 NDCG: 0.2599
Validation loss decreased (3.103285 --> 3.102235).  Saving model ...

Epoch 87/99
----------
train Loss: 3.0061 LRAP: 0.0591 NDCG: 0.2602
val Loss: 3.1025 LRAP: 0.0813 NDCG: 0.2592
EarlyStopping counter: 1 out of 50

Epoch 88/99
----------
train Loss: 3.0232 LRAP: 0.0596 NDCG: 0.2617
val Loss: 3.1036 LRAP: 0.0864 NDCG: 0.2592
EarlyStopping counter: 2 out of 50

Epoch 89/99
----------
train Loss: 3.0186 LRAP: 0.0607 NDCG: 0.2592
val Loss: 3.1039 LRAP: 0.0864 NDCG: 0.2581
EarlyStopping counter: 3 out of 50

Epoch 90/99
----------
train Loss: 3.0183 LRAP: 0.0626 NDCG: 0.2606
val Loss: 3.1037 LRAP: 0.0826 NDCG: 0.2591
EarlyStopping counter: 4 out of 50

Epoch 91/99
----------
train Loss: 3.0161 LRAP: 0.0662 NDCG: 0.2599
val Loss: 3.1029 LRAP: 0.0839 NDCG: 0.2596
EarlyStopping counter: 5 out of 50

Epoch 92/99
----------
train Loss: 3.0284 LRAP: 0.0607 NDCG: 0.2607
val Loss: 3.1015 LRAP: 0.0864 NDCG: 0.2609
Validation loss decreased (3.102235 --> 3.101450).  Saving model ...

Epoch 93/99
----------
train Loss: 3.0273 LRAP: 0.0585 NDCG: 0.2592
val Loss: 3.1019 LRAP: 0.0813 NDCG: 0.2595
EarlyStopping counter: 1 out of 50

Epoch 94/99
----------
train Loss: 3.0262 LRAP: 0.0531 NDCG: 0.2603
val Loss: 3.1014 LRAP: 0.0826 NDCG: 0.2597
Validation loss decreased (3.101450 --> 3.101437).  Saving model ...

Epoch 95/99
----------
train Loss: 3.0072 LRAP: 0.0599 NDCG: 0.2600
val Loss: 3.1003 LRAP: 0.0813 NDCG: 0.2578
Validation loss decreased (3.101437 --> 3.100285).  Saving model ...

Epoch 96/99
----------
train Loss: 3.0173 LRAP: 0.0585 NDCG: 0.2598
val Loss: 3.0992 LRAP: 0.0813 NDCG: 0.2595
Validation loss decreased (3.100285 --> 3.099210).  Saving model ...

Epoch 97/99
----------
train Loss: 3.0206 LRAP: 0.0656 NDCG: 0.2605
val Loss: 3.1004 LRAP: 0.0813 NDCG: 0.2602
EarlyStopping counter: 1 out of 50

Epoch 98/99
----------
train Loss: 3.0255 LRAP: 0.0626 NDCG: 0.2606
val Loss: 3.1005 LRAP: 0.0864 NDCG: 0.2599
EarlyStopping counter: 2 out of 50

Epoch 99/99
----------
train Loss: 3.0196 LRAP: 0.0667 NDCG: 0.2602
val Loss: 3.1016 LRAP: 0.0813 NDCG: 0.2611
EarlyStopping counter: 3 out of 50

Training complete in 2m 27s
Best val loss: 3.099210, best LRAP score: 0.5948

Saved training histories to epoch_data_infusion_trial_tissue.pkl
Saved summary results to summary_infusion_trial_tissue.csv