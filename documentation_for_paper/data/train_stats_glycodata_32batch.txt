Epoch 0/99
----------
train Loss: 1.9418 LRAP: 0.1018 NDCG: 0.5364
val Loss: 1.3059 LRAP: 0.4947 NDCG: 0.6652
Validation loss decreased (0.000000 --> 1.305928).  Saving model ...

Epoch 1/99
----------
train Loss: 1.2915 LRAP: 0.4963 NDCG: 0.6864
val Loss: 1.1568 LRAP: 0.6066 NDCG: 0.7330
Validation loss decreased (1.305928 --> 1.156826).  Saving model ...

Epoch 2/99
----------
train Loss: 1.1996 LRAP: 0.5826 NDCG: 0.7301
val Loss: 1.1165 LRAP: 0.6395 NDCG: 0.7663
Validation loss decreased (1.156826 --> 1.116533).  Saving model ...

Epoch 3/99
----------
train Loss: 1.1480 LRAP: 0.6077 NDCG: 0.7524
val Loss: 1.0790 LRAP: 0.6740 NDCG: 0.7806
Validation loss decreased (1.116533 --> 1.078970).  Saving model ...

Epoch 4/99
----------
train Loss: 1.1096 LRAP: 0.6380 NDCG: 0.7662
val Loss: 1.0661 LRAP: 0.6886 NDCG: 0.7969
Validation loss decreased (1.078970 --> 1.066058).  Saving model ...

Epoch 5/99
----------
train Loss: 1.0867 LRAP: 0.6491 NDCG: 0.7792
val Loss: 1.0446 LRAP: 0.7051 NDCG: 0.8103
Validation loss decreased (1.066058 --> 1.044552).  Saving model ...

Epoch 6/99
----------
train Loss: 1.0639 LRAP: 0.6761 NDCG: 0.7935
val Loss: 1.0293 LRAP: 0.7137 NDCG: 0.8202
Validation loss decreased (1.044552 --> 1.029283).  Saving model ...

Epoch 7/99
----------
train Loss: 1.0403 LRAP: 0.6957 NDCG: 0.8073
val Loss: 1.0154 LRAP: 0.7522 NDCG: 0.8348
Validation loss decreased (1.029283 --> 1.015370).  Saving model ...

Epoch 8/99
----------
train Loss: 1.0247 LRAP: 0.7082 NDCG: 0.8148
val Loss: 1.0006 LRAP: 0.7574 NDCG: 0.8377
Validation loss decreased (1.015370 --> 1.000597).  Saving model ...

Epoch 9/99
----------
train Loss: 0.9998 LRAP: 0.7231 NDCG: 0.8240
val Loss: 0.9893 LRAP: 0.7850 NDCG: 0.8516
Validation loss decreased (1.000597 --> 0.989272).  Saving model ...

Epoch 10/99
----------
train Loss: 0.9807 LRAP: 0.7367 NDCG: 0.8327
val Loss: 0.9763 LRAP: 0.7859 NDCG: 0.8570
Validation loss decreased (0.989272 --> 0.976321).  Saving model ...

Epoch 11/99
----------
train Loss: 0.9708 LRAP: 0.7485 NDCG: 0.8424
val Loss: 0.9758 LRAP: 0.7862 NDCG: 0.8586
Validation loss decreased (0.976321 --> 0.975804).  Saving model ...

Epoch 12/99
----------
train Loss: 0.9556 LRAP: 0.7633 NDCG: 0.8508
val Loss: 0.9677 LRAP: 0.7950 NDCG: 0.8678
Validation loss decreased (0.975804 --> 0.967666).  Saving model ...

Epoch 13/99
----------
train Loss: 0.9496 LRAP: 0.7710 NDCG: 0.8554
val Loss: 0.9605 LRAP: 0.7936 NDCG: 0.8683
Validation loss decreased (0.967666 --> 0.960506).  Saving model ...

Epoch 14/99
----------
train Loss: 0.9343 LRAP: 0.7803 NDCG: 0.8600
val Loss: 0.9624 LRAP: 0.8087 NDCG: 0.8761
EarlyStopping counter: 1 out of 50

Epoch 15/99
----------
train Loss: 0.9270 LRAP: 0.7883 NDCG: 0.8664
val Loss: 0.9573 LRAP: 0.8144 NDCG: 0.8771
Validation loss decreased (0.960506 --> 0.957319).  Saving model ...

Epoch 16/99
----------
train Loss: 0.9212 LRAP: 0.7963 NDCG: 0.8704
val Loss: 0.9518 LRAP: 0.8222 NDCG: 0.8826
Validation loss decreased (0.957319 --> 0.951756).  Saving model ...

Epoch 17/99
----------
train Loss: 0.9155 LRAP: 0.8060 NDCG: 0.8749
val Loss: 0.9507 LRAP: 0.8319 NDCG: 0.8856
Validation loss decreased (0.951756 --> 0.950722).  Saving model ...

Epoch 18/99
----------
train Loss: 0.9066 LRAP: 0.8092 NDCG: 0.8776
val Loss: 0.9508 LRAP: 0.8256 NDCG: 0.8828
EarlyStopping counter: 1 out of 50

Epoch 19/99
----------
train Loss: 0.9034 LRAP: 0.8154 NDCG: 0.8819
val Loss: 0.9477 LRAP: 0.8316 NDCG: 0.8868
Validation loss decreased (0.950722 --> 0.947720).  Saving model ...

Epoch 20/99
----------
train Loss: 0.8993 LRAP: 0.8175 NDCG: 0.8834
val Loss: 0.9505 LRAP: 0.8438 NDCG: 0.8910
EarlyStopping counter: 1 out of 50

Epoch 21/99
----------
train Loss: 0.8924 LRAP: 0.8283 NDCG: 0.8884
val Loss: 0.9408 LRAP: 0.8301 NDCG: 0.8872
Validation loss decreased (0.947720 --> 0.940794).  Saving model ...

Epoch 22/99
----------
train Loss: 0.8841 LRAP: 0.8314 NDCG: 0.8910
val Loss: 0.9439 LRAP: 0.8516 NDCG: 0.8970
EarlyStopping counter: 1 out of 50

Epoch 23/99
----------
train Loss: 0.8838 LRAP: 0.8349 NDCG: 0.8928
val Loss: 0.9426 LRAP: 0.8578 NDCG: 0.8982
EarlyStopping counter: 2 out of 50

Epoch 24/99
----------
train Loss: 0.8766 LRAP: 0.8402 NDCG: 0.8957
val Loss: 0.9418 LRAP: 0.8433 NDCG: 0.8926
EarlyStopping counter: 3 out of 50

Epoch 25/99
----------
train Loss: 0.8719 LRAP: 0.8444 NDCG: 0.8983
val Loss: 0.9413 LRAP: 0.8521 NDCG: 0.8979
EarlyStopping counter: 4 out of 50

Epoch 26/99
----------
train Loss: 0.8708 LRAP: 0.8466 NDCG: 0.9005
val Loss: 0.9400 LRAP: 0.8638 NDCG: 0.9037
Validation loss decreased (0.940794 --> 0.940008).  Saving model ...

Epoch 27/99
----------
train Loss: 0.8641 LRAP: 0.8515 NDCG: 0.9035
val Loss: 0.9360 LRAP: 0.8516 NDCG: 0.8978
Validation loss decreased (0.940008 --> 0.935993).  Saving model ...

Epoch 28/99
----------
train Loss: 0.8610 LRAP: 0.8485 NDCG: 0.9025
val Loss: 0.9409 LRAP: 0.8604 NDCG: 0.8999
EarlyStopping counter: 1 out of 50

Epoch 29/99
----------
train Loss: 0.8544 LRAP: 0.8611 NDCG: 0.9079
val Loss: 0.9345 LRAP: 0.8744 NDCG: 0.9083
Validation loss decreased (0.935993 --> 0.934467).  Saving model ...

Epoch 30/99
----------
train Loss: 0.8526 LRAP: 0.8651 NDCG: 0.9105
val Loss: 0.9347 LRAP: 0.8710 NDCG: 0.9069
EarlyStopping counter: 1 out of 50

Epoch 31/99
----------
train Loss: 0.8483 LRAP: 0.8675 NDCG: 0.9137
val Loss: 0.9327 LRAP: 0.8693 NDCG: 0.9070
Validation loss decreased (0.934467 --> 0.932738).  Saving model ...

Epoch 32/99
----------
train Loss: 0.8442 LRAP: 0.8673 NDCG: 0.9132
val Loss: 0.9305 LRAP: 0.8747 NDCG: 0.9076
Validation loss decreased (0.932738 --> 0.930503).  Saving model ...

Epoch 33/99
----------
train Loss: 0.8409 LRAP: 0.8631 NDCG: 0.9120
val Loss: 0.9265 LRAP: 0.8690 NDCG: 0.9065
Validation loss decreased (0.930503 --> 0.926494).  Saving model ...

Epoch 34/99
----------
train Loss: 0.8354 LRAP: 0.8722 NDCG: 0.9162
val Loss: 0.9269 LRAP: 0.8801 NDCG: 0.9126
EarlyStopping counter: 1 out of 50

Epoch 35/99
----------
train Loss: 0.8340 LRAP: 0.8737 NDCG: 0.9170
val Loss: 0.9327 LRAP: 0.8704 NDCG: 0.9079
EarlyStopping counter: 2 out of 50

Epoch 36/99
----------
train Loss: 0.8281 LRAP: 0.8799 NDCG: 0.9202
val Loss: 0.9298 LRAP: 0.8647 NDCG: 0.9052
EarlyStopping counter: 3 out of 50

Epoch 37/99
----------
train Loss: 0.8280 LRAP: 0.8769 NDCG: 0.9199
val Loss: 0.9323 LRAP: 0.8738 NDCG: 0.9090
EarlyStopping counter: 4 out of 50

Epoch 38/99
----------
train Loss: 0.8242 LRAP: 0.8844 NDCG: 0.9235
val Loss: 0.9293 LRAP: 0.8733 NDCG: 0.9098
EarlyStopping counter: 5 out of 50

Epoch 39/99
----------
train Loss: 0.8165 LRAP: 0.8848 NDCG: 0.9241
val Loss: 0.9274 LRAP: 0.8787 NDCG: 0.9121
EarlyStopping counter: 6 out of 50

Epoch 40/99
----------
train Loss: 0.8131 LRAP: 0.8892 NDCG: 0.9275
val Loss: 0.9277 LRAP: 0.8804 NDCG: 0.9124
EarlyStopping counter: 7 out of 50

Epoch 41/99
----------
train Loss: 0.8107 LRAP: 0.8917 NDCG: 0.9292
val Loss: 0.9270 LRAP: 0.8807 NDCG: 0.9139
EarlyStopping counter: 8 out of 50

Epoch 42/99
----------
train Loss: 0.8095 LRAP: 0.8948 NDCG: 0.9308
val Loss: 0.9255 LRAP: 0.8778 NDCG: 0.9122
Validation loss decreased (0.926494 --> 0.925499).  Saving model ...

Epoch 43/99
----------
train Loss: 0.8074 LRAP: 0.8948 NDCG: 0.9313
val Loss: 0.9263 LRAP: 0.8835 NDCG: 0.9151
EarlyStopping counter: 1 out of 50

Epoch 44/99
----------
train Loss: 0.8091 LRAP: 0.8948 NDCG: 0.9307
val Loss: 0.9260 LRAP: 0.8770 NDCG: 0.9131
EarlyStopping counter: 2 out of 50

Epoch 45/99
----------
train Loss: 0.8063 LRAP: 0.8958 NDCG: 0.9319
val Loss: 0.9230 LRAP: 0.8844 NDCG: 0.9149
Validation loss decreased (0.925499 --> 0.923024).  Saving model ...

Epoch 46/99
----------
train Loss: 0.8059 LRAP: 0.8955 NDCG: 0.9313
val Loss: 0.9238 LRAP: 0.8824 NDCG: 0.9141
EarlyStopping counter: 1 out of 50

Epoch 47/99
----------
train Loss: 0.8032 LRAP: 0.8963 NDCG: 0.9325
val Loss: 0.9278 LRAP: 0.8835 NDCG: 0.9148
EarlyStopping counter: 2 out of 50

Epoch 48/99
----------
train Loss: 0.8014 LRAP: 0.8978 NDCG: 0.9329
val Loss: 0.9267 LRAP: 0.8832 NDCG: 0.9154
EarlyStopping counter: 3 out of 50

Epoch 49/99
----------
train Loss: 0.8042 LRAP: 0.8966 NDCG: 0.9329
val Loss: 0.9254 LRAP: 0.8810 NDCG: 0.9151
EarlyStopping counter: 4 out of 50

Epoch 50/99
----------
train Loss: 0.8010 LRAP: 0.8983 NDCG: 0.9332
val Loss: 0.9236 LRAP: 0.8815 NDCG: 0.9155
EarlyStopping counter: 5 out of 50

Epoch 51/99
----------
train Loss: 0.8004 LRAP: 0.9007 NDCG: 0.9344
val Loss: 0.9272 LRAP: 0.8824 NDCG: 0.9154
EarlyStopping counter: 6 out of 50

Epoch 52/99
----------
train Loss: 0.7992 LRAP: 0.9000 NDCG: 0.9349
val Loss: 0.9234 LRAP: 0.8864 NDCG: 0.9163
EarlyStopping counter: 7 out of 50

Epoch 53/99
----------
train Loss: 0.8012 LRAP: 0.8999 NDCG: 0.9351
val Loss: 0.9241 LRAP: 0.8824 NDCG: 0.9141
EarlyStopping counter: 8 out of 50

Epoch 54/99
----------
train Loss: 0.7965 LRAP: 0.9027 NDCG: 0.9361
val Loss: 0.9256 LRAP: 0.8841 NDCG: 0.9156
EarlyStopping counter: 9 out of 50

Epoch 55/99
----------
train Loss: 0.7965 LRAP: 0.9011 NDCG: 0.9350
val Loss: 0.9289 LRAP: 0.8810 NDCG: 0.9147
EarlyStopping counter: 10 out of 50

Epoch 56/99
----------
train Loss: 0.7968 LRAP: 0.9016 NDCG: 0.9360
val Loss: 0.9272 LRAP: 0.8832 NDCG: 0.9155
EarlyStopping counter: 11 out of 50

Epoch 57/99
----------
train Loss: 0.7980 LRAP: 0.9000 NDCG: 0.9354
val Loss: 0.9267 LRAP: 0.8787 NDCG: 0.9130
EarlyStopping counter: 12 out of 50

Epoch 58/99
----------
train Loss: 0.7976 LRAP: 0.9023 NDCG: 0.9356
val Loss: 0.9239 LRAP: 0.8844 NDCG: 0.9162
EarlyStopping counter: 13 out of 50

Epoch 59/99
----------
train Loss: 0.7980 LRAP: 0.9008 NDCG: 0.9350
val Loss: 0.9255 LRAP: 0.8852 NDCG: 0.9156
EarlyStopping counter: 14 out of 50

Epoch 60/99
----------
train Loss: 0.7986 LRAP: 0.9032 NDCG: 0.9369
val Loss: 0.9243 LRAP: 0.8850 NDCG: 0.9156
EarlyStopping counter: 15 out of 50

Epoch 61/99
----------
train Loss: 0.7970 LRAP: 0.9017 NDCG: 0.9356
val Loss: 0.9277 LRAP: 0.8835 NDCG: 0.9158
EarlyStopping counter: 16 out of 50

Epoch 62/99
----------
train Loss: 0.7970 LRAP: 0.9020 NDCG: 0.9358
val Loss: 0.9249 LRAP: 0.8858 NDCG: 0.9159
EarlyStopping counter: 17 out of 50

Epoch 63/99
----------
train Loss: 0.7974 LRAP: 0.8993 NDCG: 0.9346
val Loss: 0.9252 LRAP: 0.8810 NDCG: 0.9141
EarlyStopping counter: 18 out of 50

Epoch 64/99
----------
train Loss: 0.7976 LRAP: 0.9012 NDCG: 0.9353
val Loss: 0.9271 LRAP: 0.8827 NDCG: 0.9144
EarlyStopping counter: 19 out of 50

Epoch 65/99
----------
train Loss: 0.7951 LRAP: 0.9015 NDCG: 0.9359
val Loss: 0.9247 LRAP: 0.8818 NDCG: 0.9141
EarlyStopping counter: 20 out of 50

Epoch 66/99
----------
train Loss: 0.7974 LRAP: 0.9023 NDCG: 0.9359
val Loss: 0.9245 LRAP: 0.8804 NDCG: 0.9135
EarlyStopping counter: 21 out of 50

Epoch 67/99
----------
train Loss: 0.7978 LRAP: 0.9005 NDCG: 0.9347
val Loss: 0.9241 LRAP: 0.8821 NDCG: 0.9146
EarlyStopping counter: 22 out of 50

Epoch 68/99
----------
train Loss: 0.7979 LRAP: 0.9006 NDCG: 0.9352
val Loss: 0.9238 LRAP: 0.8824 NDCG: 0.9147
EarlyStopping counter: 23 out of 50

Epoch 69/99
----------
train Loss: 0.7978 LRAP: 0.9030 NDCG: 0.9364
val Loss: 0.9244 LRAP: 0.8818 NDCG: 0.9150
EarlyStopping counter: 24 out of 50

Epoch 70/99
----------
train Loss: 0.7972 LRAP: 0.9013 NDCG: 0.9354
val Loss: 0.9237 LRAP: 0.8838 NDCG: 0.9159
EarlyStopping counter: 25 out of 50

Epoch 71/99
----------
train Loss: 0.7969 LRAP: 0.9013 NDCG: 0.9356
val Loss: 0.9246 LRAP: 0.8841 NDCG: 0.9156
EarlyStopping counter: 26 out of 50

Epoch 72/99
----------
train Loss: 0.7967 LRAP: 0.9022 NDCG: 0.9356
val Loss: 0.9295 LRAP: 0.8827 NDCG: 0.9141
EarlyStopping counter: 27 out of 50

Epoch 73/99
----------
train Loss: 0.7980 LRAP: 0.9035 NDCG: 0.9365
val Loss: 0.9265 LRAP: 0.8858 NDCG: 0.9162
EarlyStopping counter: 28 out of 50

Epoch 74/99
----------
train Loss: 0.7968 LRAP: 0.8996 NDCG: 0.9357
val Loss: 0.9244 LRAP: 0.8852 NDCG: 0.9161
EarlyStopping counter: 29 out of 50

Epoch 75/99
----------
train Loss: 0.7984 LRAP: 0.9008 NDCG: 0.9347
val Loss: 0.9236 LRAP: 0.8852 NDCG: 0.9156
EarlyStopping counter: 30 out of 50

Epoch 76/99
----------
train Loss: 0.7968 LRAP: 0.9047 NDCG: 0.9366
val Loss: 0.9276 LRAP: 0.8830 NDCG: 0.9152
EarlyStopping counter: 31 out of 50

Epoch 77/99
----------
train Loss: 0.7979 LRAP: 0.9004 NDCG: 0.9348
val Loss: 0.9261 LRAP: 0.8847 NDCG: 0.9157
EarlyStopping counter: 32 out of 50

Epoch 78/99
----------
train Loss: 0.7967 LRAP: 0.9024 NDCG: 0.9356
val Loss: 0.9282 LRAP: 0.8821 NDCG: 0.9152
EarlyStopping counter: 33 out of 50

Epoch 79/99
----------
train Loss: 0.7962 LRAP: 0.9016 NDCG: 0.9363
val Loss: 0.9260 LRAP: 0.8824 NDCG: 0.9150
EarlyStopping counter: 34 out of 50

Epoch 80/99
----------
train Loss: 0.7983 LRAP: 0.9014 NDCG: 0.9355
val Loss: 0.9253 LRAP: 0.8810 NDCG: 0.9140
EarlyStopping counter: 35 out of 50

Epoch 81/99
----------
train Loss: 0.7982 LRAP: 0.9007 NDCG: 0.9353
val Loss: 0.9257 LRAP: 0.8844 NDCG: 0.9154
EarlyStopping counter: 36 out of 50

Epoch 82/99
----------
train Loss: 0.7979 LRAP: 0.9035 NDCG: 0.9360
val Loss: 0.9259 LRAP: 0.8815 NDCG: 0.9142
EarlyStopping counter: 37 out of 50

Epoch 83/99
----------
train Loss: 0.7976 LRAP: 0.9029 NDCG: 0.9362
val Loss: 0.9254 LRAP: 0.8818 NDCG: 0.9147
EarlyStopping counter: 38 out of 50

Epoch 84/99
----------
train Loss: 0.7978 LRAP: 0.9019 NDCG: 0.9351
val Loss: 0.9263 LRAP: 0.8807 NDCG: 0.9144
EarlyStopping counter: 39 out of 50

Epoch 85/99
----------
train Loss: 0.7964 LRAP: 0.9002 NDCG: 0.9357
val Loss: 0.9252 LRAP: 0.8821 NDCG: 0.9140
EarlyStopping counter: 40 out of 50

Epoch 86/99
----------
train Loss: 0.7957 LRAP: 0.9023 NDCG: 0.9361
val Loss: 0.9267 LRAP: 0.8844 NDCG: 0.9152
EarlyStopping counter: 41 out of 50

Epoch 87/99
----------
train Loss: 0.7970 LRAP: 0.9014 NDCG: 0.9354
val Loss: 0.9244 LRAP: 0.8815 NDCG: 0.9141
EarlyStopping counter: 42 out of 50

Epoch 88/99
----------
train Loss: 0.7981 LRAP: 0.9020 NDCG: 0.9354
val Loss: 0.9247 LRAP: 0.8824 NDCG: 0.9143
EarlyStopping counter: 43 out of 50

Epoch 89/99
----------
train Loss: 0.7990 LRAP: 0.8995 NDCG: 0.9350
val Loss: 0.9270 LRAP: 0.8830 NDCG: 0.9148
EarlyStopping counter: 44 out of 50

Epoch 90/99
----------
train Loss: 0.7968 LRAP: 0.9004 NDCG: 0.9349
val Loss: 0.9267 LRAP: 0.8855 NDCG: 0.9166
EarlyStopping counter: 45 out of 50

Epoch 91/99
----------
train Loss: 0.7970 LRAP: 0.9015 NDCG: 0.9356
val Loss: 0.9231 LRAP: 0.8818 NDCG: 0.9157
EarlyStopping counter: 46 out of 50

Epoch 92/99
----------
train Loss: 0.7967 LRAP: 0.8992 NDCG: 0.9342
val Loss: 0.9243 LRAP: 0.8850 NDCG: 0.9163
EarlyStopping counter: 47 out of 50

Epoch 93/99
----------
train Loss: 0.7975 LRAP: 0.9023 NDCG: 0.9357
val Loss: 0.9255 LRAP: 0.8844 NDCG: 0.9163
EarlyStopping counter: 48 out of 50

Epoch 94/99
----------
train Loss: 0.7979 LRAP: 0.9015 NDCG: 0.9360
val Loss: 0.9254 LRAP: 0.8858 NDCG: 0.9157
EarlyStopping counter: 49 out of 50

Epoch 95/99
----------
train Loss: 0.7983 LRAP: 0.8996 NDCG: 0.9344
val Loss: 0.9256 LRAP: 0.8807 NDCG: 0.9146
EarlyStopping counter: 50 out of 50
Early stopping
Training complete in 24m 20s
Best val loss: 0.923024, best LRAP score: 0.9631